/*! leaflet.travelnotes - version 1.3.0 - build 1135 - 2019-06-04T20:23:21+0200 - Copyright 2017 2019 Christian Guyette - Contact: http//www.ouaie.be/ - This  program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or any later version.*/


!function a(i,s,l){function d(o,t){if(!s[o]){if(!i[o]){var e="function"==typeof require&&require;if(!t&&e)return e(o,!0);if(c)return c(o,!0);var n=new Error("Cannot find module '"+o+"'");throw n.code="MODULE_NOT_FOUND",n}var r=s[o]={exports:{}};i[o][0].call(r.exports,function(t){var e=i[o][1][t];return d(e||t)},r,r.exports,a,i,s,l)}return s[o].exports}for(var c="function"==typeof require&&require,t=0;t<l.length;t++)d(l[t]);return d}({1:[function(t,e,o){"use strict";var n={};function a(t){return Math.floor(Math.abs(t)+.5)*(0<=t?1:-1)}function s(t,e,o){var n=(t=a(t*o))-(e=a(e*o));n<<=1,t-e<0&&(n=~n);for(var r="";32<=n;)r+=String.fromCharCode(63+(32|31&n)),n>>=5;return r+=String.fromCharCode(n+63)}function r(t){for(var e=[],o=0;o<t.length;o++)e.push(t[o].slice().reverse());return e}n.decode=function(t,e){for(var o,n=0,r=0,a=0,i=[],s=0,l=0,d=null,c=Math.pow(10,e||5);n<t.length;){for(d=null,l=s=0;l|=(31&(d=t.charCodeAt(n++)-63))<<s,s+=5,32<=d;);for(o=1&l?~(l>>1):l>>1,s=l=0;l|=(31&(d=t.charCodeAt(n++)-63))<<s,s+=5,32<=d;);r+=o,a+=1&l?~(l>>1):l>>1,i.push([r/c,a/c])}return i},n.encode=function(t,e){if(!t.length)return"";for(var o=Math.pow(10,e||5),n=s(t[0][0],0,o)+s(t[0][1],0,o),r=1;r<t.length;r++){var a=t[r],i=t[r-1];n+=s(a[0],i[0],o),n+=s(a[1],i[1],o)}return n},n.fromGeoJSON=function(t,e){if(t&&"Feature"===t.type&&(t=t.geometry),!t||"LineString"!==t.type)throw new Error("Input must be a GeoJSON LineString");return n.encode(r(t.coordinates),e)},n.toGeoJSON=function(t,e){return{type:"LineString",coordinates:r(n.decode(t,e))}},"object"==typeof e&&e.exports&&(e.exports=n)},{}],2:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){var n=t("../L.TravelNotes");return Object.seal({getRoute:function(t){return e=t,o=null,(o=n.travel.routes.getAt(e))||e===n.editedRoute.objId&&(o=n.editedRoute),o||console.log("Invalid noteObjId "+e+" for function DataSearchEngine.getRoute ( )"),o;var e,o},getNoteAndRoute:function(t){return function(t){var e=null;if(e=n.travel.notes.getAt(t))return{note:e,route:null};for(var o=n.travel.routes.iterator;!o.done;)if(e=o.value.notes.getAt(t))return{note:e,route:o.value};return(e=n.editedRoute.notes.getAt(t))?{note:e,route:n.editedRoute}:(console.log("Invalid noteObjId "+t+" for function DataSearchEngine.getNote ( )"),{note:null,route:null})}(t)},getWayPoint:function(t){return function(t){for(var e=null,o=n.travel.routes.iterator;!o.done;)if(e=o.value.wayPoints.getAt(t))return e;return(e=n.editedRoute.wayPoints.getAt(t))||(console.log("Invalid wayPointObjId "+t+" for function DataSearchEngine.getWayPoint ( )"),null)}(t)}})})}()},{"../L.TravelNotes":7}],3:[function(u,t,e){!function(){"use strict";var c=u("../data/ObjType")("Itinerary",u("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var a="",i="",s=u("../data/Collection")("ItineraryPoint"),l=u("../data/Collection")("Maneuver"),d=u("../data/ObjId")();return Object.seal({get itineraryPoints(){return s},get maneuvers(){return l},get provider(){return a},set provider(t){a=t},get transitMode(){return i},set transitMode(t){i=t},get objId(){return d},get objType(){return c},get object(){return{itineraryPoints:s.object,maneuvers:l.object,provider:a,transitMode:i,objId:d,objType:c.object}},set object(t){!function(t){t=c.validate(t),s.object=t.itineraryPoints||[],l.object=t.maneuvers||[],a=t.provider||"",i=t.transitMode||"",d=u("../data/ObjId")();for(var e=new Map,o=0,n=s.iterator;!n.done;)e.set(t.itineraryPoints[o].objId,n.value.objId),o++;for(var r=l.iterator;!r.done;)r.value.itineraryPointObjId=e.get(r.value.itineraryPointObjId)}(t)}})})}()},{"../data/Collection":42,"../data/ObjId":49,"../data/ObjType":50,"./Version":6}],4:[function(T,t,e){!function(){"use strict";var m=T("../data/ObjType")("Route",T("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var o="",n=T("../data/Collection")("WayPoint");n.add(T("../data/Waypoint")()),n.add(T("../data/Waypoint")());var r=T("../data/Collection")("Note"),a=T("../data/Itinerary")(),i=T("../L.TravelNotes").config.route.width||5,s=T("../L.TravelNotes").config.route.color||"#ff0000",l=T("../L.TravelNotes").config.route.dashArray||0,d=!1,c=0,u=0,v=0,g=!1,p=T("../data/ObjId")();return Object.seal({get wayPoints(){return n},get itinerary(){return a},get notes(){return r},get name(){return o},set name(t){o=t},get width(){return i},set width(t){i=t},get color(){return s},set color(t){s=t},get dashArray(){return l},set dashArray(t){l=t},get chain(){return d},set chain(t){d=t},get chainedDistance(){return c},set chainedDistance(t){c=t},get distance(){return u},set distance(t){u=t},get duration(){return v},set duration(t){v=t},get hidden(){return g},set hidden(t){g=t},get objId(){return p},get objType(){return m},get object(){return{name:o,wayPoints:n.object,notes:r.object,itinerary:a.object,width:i,color:s,dashArray:l,chain:d,distance:parseFloat(u.toFixed(2)),duration:v,hidden:g,chainedDistance:parseFloat(c.toFixed(2)),objId:p,objType:m.object}},set object(t){var e;e=t,e=m.validate(e),o=e.name||"",n.object=e.wayPoints||[],r.object=e.notes||[],a.object=e.itinerary||T("./Itinerary")().object,i=e.width||5,s=e.color||"#000000",l=e.dashArray||0,d=e.chain||!1,u=e.distance,v=e.duration,g=e.hidden||!1,c=e.chainedDistance,p=T("../data/ObjId")()}})})}()},{"../L.TravelNotes":7,"../data/Collection":42,"../data/Itinerary":45,"../data/ObjId":49,"../data/ObjType":50,"../data/Waypoint":56,"./Itinerary":3,"./Version":6}],5:[function(d,t,e){!function(){"use strict";var l=d("../data/ObjType")("Travel",d("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var o="TravelNotes",n=d("../data/Collection")("Route"),r=d("../data/Collection")("Note"),a=d("../data/ObjId")(),i=!1,s={};return Object.seal({get routes(){return n},get notes(){return r},get name(){return o},set name(t){o=t},get readOnly(){return i},set readOnly(t){i=t},get userData(){return s},set userData(t){s=t},get objId(){return a},get objType(){return l},get object(){return{name:o,routes:n.object,notes:r.object,userData:s,readOnly:i,objId:a,objType:l.object}},set object(t){var e;e=t,e=l.validate(e),o=e.name||"",s=e.userData||{},i=e.readOnly||!1,n.object=e.routes||[],r.object=e.notes||[],a=d("../data/ObjId")()}})})}()},{"../data/Collection":42,"../data/ObjId":49,"../data/ObjType":50,"./Version":6}],6:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports="1.4.0")}()},{}],7:[function(g,t,e){!function(){"use strict";L.travelNotes=function(){var a=g("./data/TravelNotesData")();void 0!==t&&t.exports&&(t.exports=a);var e=[],o=[],n=!1,r=!1,i=null,s=null,l="",d=function(e,o){var n=new XMLHttpRequest;n.timeout=2e4,n.ontimeout=function(t){o("XMLHttpRequest TimeOut. File : "+n.responseURL)},n.onreadystatechange=function(){if(4===n.readyState)if(200===n.status){var t;try{t=JSON.parse(n.responseText)}catch(t){o("JSON parsing error. File : "+n.responseURL)}e(t)}else o("Error XMLHttpRequest - Status : "+n.status+" - StatusText : "+n.statusText+" - File : "+n.responseURL)},n.open("GET",l,!0),n.overrideMimeType("application/json"),n.send(null)},c=function(t,e){var r;a.map=t,r="?",decodeURI(window.location.search).substr(1).split("&").forEach(function(t){if("fil="===t.substr(0,4).toLowerCase())s=decodeURIComponent(escape(atob(t.substr(4)))),r+="?"===r?"":"&",r+=t;else{var e=t.split("=");if(2===e.length)if(-1!==e[0].indexOf("ProviderKey")){var o=e[0].substr(0,e[0].length-11).toLowerCase(),n=a.providers.get(o);n&&n.providerKeyNeeded&&(n.providerKey=e[1]),sessionStorage.setItem(o,btoa(e[1]))}else r+="?"===r?"":"&",r+=t,"lng"===e[0].toLowerCase()&&(i=e[1].toLowerCase())}}),history.replaceState({index:"bar"},"page",r),a.providers.forEach(function(t){if(t.providerKeyNeeded&&0===t.providerKey){var e=null;g("./util/Utilities")().storageAvailable("sessionStorage")&&(e=sessionStorage.getItem(t.name.toLowerCase())),e?t.providerKey=atob(e):a.providers.delete(t.name.toLowerCase())}});var o=[];l=window.location.href.substr(0,window.location.href.lastIndexOf("/")+1)+"TravelNotesConfig.json",o.push(new Promise(d)),l=window.location.href.substr(0,window.location.href.lastIndexOf("/")+1)+"TravelNotes"+(i||a.config.language).toUpperCase()+".json",o.push(new Promise(d)),s&&(l=s,o.push(new Promise(d))),Promise.all(o).then(function(t){i&&(t[0].language=i),a.config=t[0],window.osmSearch?window.osmSearch.getDictionaryPromise(a.config.language,"travelNotes").then(function(){console.log("Dictionary loaded")},function(t){console.log(t)}):console.log("osmSearch not found"),a.providers.forEach(function(t){t.userLanguage=a.config.language}),g("./UI/Translator")().setTranslations(t[1]),a.travel=g("./data/Travel")(),a.travel.routes.add(g("./data/Route")()),a.editedRoute=g("./data/Route")(),document.getElementById(e).appendChild(g("./UI/UserInterface")().UI),g("./UI/TravelEditorUI")().setRoutesList(a.travel.routes),g("./core/TravelEditor")().updateRoadBook(!0),s?g("./core/FileLoader")().openDistantFile(t[2]):a.config.travelEditor.startupRouteEdition?g("./core/TravelEditor")().editRoute(a.travel.routes.first.objId):g("./UI/RouteEditorUI")().reduce()}).catch(function(t){console.log(t)})},u=function(t){a.travel.readOnly||g("./UI/ContextMenu")(t,g("./UI/ContextMenuFactory")().getMapContextMenu([t.latlng.lat,t.latlng.lng]).concat(e))},v=function(t){a.travel.readOnly||g("./UI/ContextMenu")(t,g("./UI/ContextMenuFactory")().getMapContextMenu([t.latlng.lat,t.latlng.lng]).concat(o))};return{addControl:function(t,e){return c(t,e)},addProvider:function(t){a.providers.set(t.name.toLowerCase(),t)},addMapContextMenu:function(t,e){t&&(a.map.on("click",u),n=!0),e&&(a.map.on("contextmenu",u),r=!0)},get baseDialog(){return g("./UI/baseDialog")()},get userData(){return a.travel.userData},set userData(t){a.travel.userData=t},get rightContextMenu(){return r},set rightContextMenu(t){t&&!r?(a.map.on("contextmenu",v),r=!0):!t&&r&&(a.map.off("contextmenu",v),r=!1)},get leftContextMenu(){return n},set leftContextMenu(t){t&&!n?(a.map.on("click",u),n=!0):!t&&n&&(a.map.off("click",u),n=!1)},get leftUserContextMenu(){return e},set leftUserContextMenu(t){e=t},get rightUserContextMenu(){return o},set rightUserContextMenu(t){o=t},get maneuver(){return g("./data/Maneuver")()},get itineraryPoint(){return g("./data/ItineraryPoint")()},get version(){return g("./data/Version")}}}()}()},{"./UI/ContextMenu":11,"./UI/ContextMenuFactory":12,"./UI/RouteEditorUI":21,"./UI/Translator":25,"./UI/TravelEditorUI":26,"./UI/UserInterface":28,"./UI/baseDialog":29,"./core/FileLoader":31,"./core/TravelEditor":39,"./data/ItineraryPoint":46,"./data/Maneuver":47,"./data/Route":51,"./data/Travel":52,"./data/TravelNotesData":53,"./data/Version":54,"./util/Utilities":57}],8:[function(o,t,e){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(t){var e=o("../UI/BaseDialog")();return e.title=o("../UI/Translator")().getText("AboutDialog - About Travel & Notes"),o("./HTMLElementsFactory")().create("div",{id:"TravelNotes-AboutDialog-AboutDiv"},e.content).innerHTML="<p>This  program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or any later version.</p><p>Copyright - 2017 2018 - Christian Guyette</p><p>Contact : <a href='http://www.ouaie.be/blog/pages/contact' target='_blank'>http://www.ouaie.be/</a></p><p>GitHub : <a href='https://github.com/wwwouaiebe/leaflet.TravelNotes' target='_blank'>https://github.com/wwwouaiebe/leaflet.TravelNotes</a></p><p>Version : "+o("../data/Version")+".<p>This program uses: <a href='https://leafletjs.com/' target='_blank'>leaflet</a>, <a href='https://github.com/mapbox/polyline' target='_blank'>mapbox/polyline</a>, <a href='https://github.com/Project-OSRM/osrm-text-instructions' target='_blank'>Project-OSRM/osrm-text-instructions</a> and  <a href='https://github.com/drolbr/Overpass-API' target='_blank'>the Overpass API</a></p>",e.center(),e})}()},{"../UI/BaseDialog":9,"../UI/Translator":25,"../data/Version":54,"./HTMLElementsFactory":15}],9:[function(N,t,e){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){var e=null,o=null,n=null,t=N("./HTMLElementsFactory")(),r=function(t){if("Escape"===t.key||"Esc"===t.key){if(n&&!n())return;document.removeEventListener("keydown",r,!0),document.getElementsByTagName("body")[0].removeChild(document.getElementById("TravelNotes-BaseDialog-BackgroundDiv"))}},a=document.getElementsByTagName("body")[0],i=t.create("div",{id:"TravelNotes-BaseDialog-BackgroundDiv",className:"TravelNotes-BaseDialog-BackgroundDiv"},a);i.addEventListener("dragover",function(t){},!1),i.addEventListener("drop",function(t){},!1);var s=i.clientWidth,l=i.clientHeight,d=0,c=0,u=0,v=0,g=t.create("div",{id:"TravelNotes-BaseDialog-Container",className:"TravelNotes-BaseDialog-Container"},i),p=t.create("div",{id:"TravelNotes-BaseDialog-TopBar",className:"TravelNotes-BaseDialog-TopBar",draggable:!0},g);t.create("div",{innerHTML:"&#x274c",id:"TravelNotes-BaseDialog-CancelButton",title:N("../UI/Translator")().getText("BaseDialog - Cancel")},p).addEventListener("click",function(){o&&!o()||(document.removeEventListener("keydown",r,!0),document.getElementsByTagName("body")[0].removeChild(i))},!1),p.addEventListener("dragstart",function(t){try{t.dataTransfer.setData("Text","1")}catch(t){}d=t.screenX,c=t.screenY},!1),p.addEventListener("dragend",function(t){u+=t.screenX-d,v+=t.screenY-c,u=Math.min(Math.max(u,20),s-g.clientWidth-20),v=Math.max(v,20);var e=l-Math.max(v,0)-20;g.setAttribute("style","top:"+v+"px;left:"+u+"px;max-height:"+e+"px;")},!1);var m=t.create("div",{className:"TravelNotes-BaseDialog-HeaderDiv",id:"TravelNotes-BaseDialog-HeaderDiv"},g),T=t.create("div",{className:"TravelNotes-BaseDialog-ContentDiv",id:"TravelNotes-BaseDialog-ContentDiv"},g),f=(t.create("div",{className:"TravelNotes-BaseDialog-ErrorDiv TravelNotes-BaseDialog-ErrorDivHidden",id:"TravelNotes-BaseDialog-ErrorDiv"},g),t.create("div",{className:"TravelNotes-BaseDialog-FooterDiv",id:"TravelNotes-BaseDialog-FooterDiv"},g));return t.create("div",{innerHTML:"&#x1f4be;",id:"TravelNotes-BaseDialog-OkButton",className:"TravelNotes-BaseDialog-Button"},f).addEventListener("click",function(){e&&!e()||(document.removeEventListener("keydown",r,!0),document.getElementsByTagName("body")[0].removeChild(i))},!1),document.addEventListener("keydown",r,!0),{addClickOkButtonEventListener:function(t){e=t},addClickCancelButtonEventListener:function(t){o=t},addEscapeKeyEventListener:function(t){n=t},get title(){return m.innerHTML},set title(t){m.innerHTML=t},center:function(){u=(s-g.clientWidth)/2,v=(l-g.clientHeight)/2,u=Math.min(Math.max(u,20),s-g.clientWidth-20),v=Math.max(v,20);var t=l-Math.max(v,0)-20;g.setAttribute("style","top:"+v+"px;left:"+u+"px;max-height:"+t+"px;")},get header(){return m},set header(t){m=t},get content(){return T},set content(t){T=t},get footer(){return f},set footer(t){f=t}}})}()},{"../UI/Translator":25,"./HTMLElementsFactory":15}],10:[function(C,t,e){!function(){"use strict";var b=function(){return!0};void 0!==t&&t.exports&&(t.exports=function(t){var o=function(t){return{r:parseInt(t.substr(1,2),16),g:parseInt(t.substr(3,2),16),b:parseInt(t.substr(5,2),16)}},s=function(t,e,o){return String.prototype.padStart||(String.prototype.padStart=function(t,e){return t>>=0,e=String(e||" "),this.length>t?String(this):((t-=this.length)>e.length&&(e+=e.repeat(t/e.length)),e.slice(0,t)+String(this))}),"#"+parseInt(t).toString(16).padStart(2,"0")+parseInt(e).toString(16).padStart(2,"0")+parseInt(o).toString(16).padStart(2,"0")},e=function(t){a=t.target.colorValue;var e=o(a);h.value=e.r,E.value=e.g,y.value=e.b,document.getElementById("TravelNotes-ColorDialog-ColorSampleDiv").setAttribute("style","background-color:"+t.target.colorValue+";")},n=function(t){for(var e=t.target.redValue,o=255,n=255,r=0;++r<7;){var a=0;for(o=255;++a<7;){var i=document.getElementById("TravelNotes-ColorDialog-CellColorDiv"+r+a);i.colorValue=s(e,o,n),i.setAttribute("style","background-color:"+s(e,o,n)),o-=51}n-=51}},r=function(){a=s(h.value,E.value,y.value),document.getElementById("TravelNotes-ColorDialog-ColorSampleDiv").setAttribute("style","background-color:"+a+";")},a=t,i=C("../UI/Translator")(),l=C("./HTMLElementsFactory")(),d=C("../UI/BaseDialog")();d.title=i.getText("ColorDialog - Colors"),d.addClickOkButtonEventListener(b),d.getNewColor=function(){return a};for(var c=l.create("div",{className:"TravelNotes-ColorDialog-ColorDiv",id:"TravelNotes-ColorDialog-ColorDiv"},d.content),u=l.create("div",{className:"TravelNotes-ColorDialog-ButtonsDiv",id:"TravelNotes-ColorDialog-ButtonsDiv"},c),v=255,g=255,p=255,m=0;++m<8;){var T=l.create("div",{className:"TravelNotes-ColorDialog-RowColorDiv",id:"TravelNotes-ColorDialog-RowColorDiv"+m},u),f=0;for(g=255;++f<7;){var N=l.create("div",{className:"TravelNotes-ColorDialog-CellColorDiv",id:"TravelNotes-ColorDialog-CellColorDiv"+m+f},T);if(m<7)N.setAttribute("style","background-color:"+s(v,g,p)),N.colorValue=s(v,g,p),N.addEventListener("click",e,!1),g-=51;else{var I=s(255,v=51*(f-1),v);N.setAttribute("style","background-color:"+I),N.redValue=255-v,N.addEventListener("click",n,!1)}}p-=51}var L=l.create("div",{className:"TravelNotes-ColorDialog-DataDiv",id:"TravelNotes-ColorDialog-DataDiv"},c);l.create("text",{data:i.getText("ColorDialog - Red")},L);var h=l.create("input",{type:"number",className:"TravelNotes-ColorDialog-NumberInput",id:"TravelNotes-ColorDialog-RedInput"},L);h.value=o(t).r,h.min=0,h.max=255,h.addEventListener("input",r,!1),l.create("text",{data:i.getText("ColorDialog - Green")},L);var E=l.create("input",{type:"number",className:"TravelNotes-ColorDialog-NumberInput",id:"TravelNotes-ColorDialog-GreenInput"},L);E.value=o(t).g,E.min=0,E.max=255,E.addEventListener("input",r,!1),l.create("text",{data:i.getText("ColorDialog - Blue")},L);var y=l.create("input",{type:"number",className:"TravelNotes-ColorDialog-NumberInput",id:"TravelNotes-ColorDialog-BlueInput"},L);return y.value=o(t).b,y.min=0,y.max=255,y.addEventListener("input",r,!1),l.create("div",{className:"TravelNotes-ColorDialog-ColorSampleDiv",id:"TravelNotes-ColorDialog-ColorSampleDiv"},c).setAttribute("style","background-color:"+t+";"),d.center(),d})}()},{"../UI/BaseDialog":9,"../UI/Translator":25,"./HTMLElementsFactory":15}],11:[function(h,t,e){!function(){"use strict";var c=[],u=null,v=null,o=0,g=0,p=0,m=null,T=function(){m&&(clearTimeout(m),m=null),p=g=0,document.removeEventListener("keydown",f,!0),document.removeEventListener("keypress",N,!0),document.removeEventListener("keyup",I,!0);var t=u.childNodes;t[0].firstChild.removeEventListener("click",T,!1);for(var e=1;e<t.length;e++)t[e].firstChild.removeEventListener("click",T,!1);document.getElementsByTagName("body")[0].removeChild(u),u=null,o=0},f=function(t){u&&(t.preventDefault(),t.stopPropagation()),"Escape"!==t.key&&"Esc"!==t.key||T(),"ArrowDown"!==t.key&&"ArrowRight"!==t.key&&"Tab"!==t.key||(o=o>=c.length?1:++o,u.childNodes[o].firstChild.focus()),"ArrowUp"!==t.key&&"ArrowLeft"!==t.key||(o=o<=1?c.length:--o,u.childNodes[o].firstChild.focus()),"Home"===t.key&&(o=1,u.childNodes[o].firstChild.focus()),"End"===t.key&&(o=c.length,u.childNodes[o].firstChild.focus()),"Enter"===t.key&&0<o&&c[o-1].action&&u.childNodes[o].firstChild.click()},N=function(t){t.preventDefault(),t.stopPropagation()},I=function(t){t.preventDefault(),t.stopPropagation()},L=function(t){t.stopPropagation(),c[t.target.menuItem].param?c[t.target.menuItem].action.call(c[t.target.menuItem].context,c[t.target.menuItem].param,v):c[t.target.menuItem].action.call(c[t.target.menuItem].context,v),T()};void 0!==t&&t.exports&&(t.exports=function(t,e){if(t.latlng.lat!==g||t.latlng.lng!==p)if(g=t.latlng.lat,p=t.latlng.lng,v=t,u)T();else{c=e;var o=document.getElementsByTagName("body")[0],n=h("./HTMLElementsFactory")(),r=n.create("div",{className:"TravelNotes-ContextMenu-Panel"},o),a=r.clientWidth,i=r.clientHeight;o.removeChild(r),(u=n.create("div",{id:"TravelNotes-ContextMenu-Container",className:"TravelNotes-ContextMenu-Container"},o)).addEventListener("mouseenter",function(){m&&(clearTimeout(m),m=null)},!1),u.addEventListener("mouseleave",function(){m=setTimeout(T,h("../L.TravelNotes").config.contextMenu.timeout)},!1),n.create("div",{innerHTML:"&#x274c",className:"TravelNotes-ContextMenu-CloseButton",title:h("./Translator")().getText("ContextMenu - Close")},u).addEventListener("click",T,!1);var s=0;c.forEach(function(t){var e=n.create("div",{className:"TravelNotes-ContextMenu-ItemContainer"},u),o=n.create("button",{innerHTML:t.name,id:"TravelNotes-ContextMenu-Item"+s,className:t.action?"TravelNotes-ContextMenu-Item":"TravelNotes-ContextMenu-Item TravelNotes-ContextMenu-ItemDisabled"},e);t.action&&o.addEventListener("click",L,!1),o.menuItem=s,++s});var l=Math.min(t.originalEvent.clientY,i-u.clientHeight-20),d=Math.min(t.originalEvent.clientX,a-u.clientWidth-20);u.setAttribute("style","top:"+l+"px;left:"+d+"px;"),document.addEventListener("keydown",f,!0),document.addEventListener("keypress",N,!0),document.addEventListener("keyup",I,!0)}else p=g=0})}()},{"../L.TravelNotes":7,"./HTMLElementsFactory":15,"./Translator":25}],12:[function(d,t,e){!function(){"use strict";var l=d("../L.TravelNotes");void 0!==t&&t.exports&&(t.exports=function(){var o=d("../core/MapEditor")(),n=d("../core/NoteEditor")(),r=d("../core/RouteEditor")(),a=d("../core/TravelEditor")(),i=d("../core/waypointEditor")(),s=d("../UI/Translator")();return Object.seal({getMapContextMenu:function(t){return e=t,[{context:i,name:s.getText("ContextMenuFactory - Select this point as start point"),action:-1!==l.routeEdition.routeInitialObjId&&0===l.editedRoute.wayPoints.first.lat?d("../core/waypointEditor")().setStartPoint:null,param:e},{context:i,name:s.getText("ContextMenuFactory - Select this point as way point"),action:-1!==l.routeEdition.routeInitialObjId?d("../core/waypointEditor")().addWayPoint:null,param:e},{context:i,name:s.getText("ContextMenuFactory - Select this point as end point"),action:-1!==l.routeEdition.routeInitialObjId&&0===l.editedRoute.wayPoints.last.lat?d("../core/waypointEditor")().setEndPoint:null,param:e},{context:n,name:s.getText("ContextMenuFactory - New travel note"),action:n.newTravelNote,param:e},{context:n,name:s.getText("ContextMenuFactory - Hide notes"),action:n.hideNotes},{context:n,name:s.getText("ContextMenuFactory - Show notes"),action:n.showNotes},{context:r,name:s.getText("ContextMenuFactory - Show all routes"),action:r.showRoutes},{context:o,name:s.getText("ContextMenuFactory - Zoom to travel"),action:o.zoomToTravel},{context:null,name:s.getText("ContextMenuFactory - About Travel & Notes"),action:d("../UI/AboutDialog")}];var e},getWayPointContextMenu:function(t){return e=t,[{context:i,name:s.getText("ContextMenuFactory - Delete this waypoint"),action:l.editedRoute.wayPoints.first.objId!==e&&l.editedRoute.wayPoints.last.objId!==e?d("../core/waypointEditor")().removeWayPoint:null,param:e}];var e},getRouteContextMenu:function(t){return e=t,[{context:r,name:s.getText("ContextMenuFactory - Edit this route"),action:l.routeEdition.routeInitialObjId===e||l.routeEdition.routeChanged?null:a.editRoute,param:e},{context:a,name:s.getText("ContextMenuFactory - Delete this route"),action:l.routeEdition.routeInitialObjId===e||l.routeEdition.routeChanged?null:a.removeRoute,param:e},{context:r,name:s.getText("ContextMenuFactory - Hide this route"),action:l.editedRoute.objId!==e?r.hideRoute:null,param:e},{context:i,name:s.getText("ContextMenuFactory - Add a waypoint on the route"),action:-1!==l.routeEdition.routeInitialObjId?i.addWayPointOnRoute:null,param:e},{context:n,name:s.getText("ContextMenuFactory - Add a note on the route"),action:n.newRouteNote,param:e},{context:r,name:s.getText("ContextMenuFactory - Properties"),action:r.routeProperties,param:e},{context:o,name:s.getText("ContextMenuFactory - Zoom to route"),action:o.zoomToRoute,param:e},{context:r,name:s.getText("ContextMenuFactory - Save modifications on this route"),action:l.editedRoute.objId===e?r.saveEdition:null},{context:r,name:s.getText("ContextMenuFactory - Cancel modifications on this route"),action:l.editedRoute.objId===e?r.cancelEdition:null}];var e},getNoteContextMenu:function(t){return function(t){var e=[];e.push({context:n,name:s.getText("ContextMenuFactory - Edit this note"),action:n.editNote,param:t}),e.push({context:n,name:s.getText("ContextMenuFactory - Delete this note"),action:n.removeNote,param:t}),e.push({context:n,name:s.getText("ContextMenuFactory - Zoom to note"),action:n.zoomToNote,param:t});var o=d("../data/DataSearchEngine")().getNoteAndRoute(t).route;return e.push({context:n,name:o?s.getText("ContextMenuFactory - Detach note from route"):s.getText("ContextMenuFactory - Attach note to route"),action:0!==l.travel.routes.length&&-1===l.routeEdition.routeInitialObjId?o?n.detachNoteFromRoute:n.attachNoteToRoute:null,param:t}),e}(t)}})})}()},{"../L.TravelNotes":7,"../UI/AboutDialog":8,"../UI/Translator":25,"../core/MapEditor":33,"../core/NoteEditor":34,"../core/RouteEditor":36,"../core/TravelEditor":39,"../core/waypointEditor":41,"../data/DataSearchEngine":44}],13:[function(d,t,e){!function(){"use strict";var r=-1,a=function(t){t.deltaY&&(t.target.scrollTop=t.target.scrollTop+10*t.deltaY),t.stopPropagation()},i=function(t){e().setItinerary()},s=function(t){e().setTravelNotes()},l=function(t){e().setSearch()},e=function(){var t=d("../UI/TravelNotesPaneUI")(),e=d("../UI/SearchPaneUI")(),o=d("../UI/ItineraryPaneUI")(),n=function(){switch(r){case 0:o.remove();break;case 1:t.remove();break;case 2:window.osmSearch&&e.remove()}};return Object.seal({createUI:function(t){!function(t){if(!document.getElementById("TravelNotes-Control-ItineraryDataDiv")){var e=d("../UI/HTMLElementsFactory")(),o=e.create("div",{id:"TravelNotes-Control-ItineraryHeaderDiv",className:"TravelNotes-Control-HeaderDiv"},t);e.create("div",{innerHTML:d("../UI/Translator")().getText("DataPanesUI - Itinerary"),id:"TravelNotes-Control-ItineraryPaneButton",className:"TravelNotes-Control-PaneButton"},o).addEventListener("click",i,!1),e.create("div",{innerHTML:d("../UI/Translator")().getText("DataPanesUI - Travel notes"),id:"TravelNotes-Control-TravelNotesPaneButton",className:"TravelNotes-Control-PaneButton"},o).addEventListener("click",s,!1),window.osmSearch&&e.create("div",{innerHTML:d("../UI/Translator")().getText("DataPanesUI - Search"),id:"TravelNotes-Control-SearchPaneButton",className:"TravelNotes-Control-PaneButton"},o).addEventListener("click",l,!1),e.create("div",{id:"TravelNotes-Control-ItineraryDataDiv",className:"TravelNotes-Control-DataDiv"},t).addEventListener("wheel",a,!1)}}(t)},setItinerary:function(){n(),o.add(),r=0},updateItinerary:function(){0===r&&(o.remove(),o.add())},setTravelNotes:function(){n(),t.add(),r=1},updateTravelNotes:function(){1===r&&(t.remove(),t.add())},setSearch:function(){n(),e.add(),r=2},updateSearch:function(){2===r&&(e.remove(),e.add())}})};void 0!==t&&t.exports&&(t.exports=e)}()},{"../UI/HTMLElementsFactory":15,"../UI/ItineraryPaneUI":18,"../UI/SearchPaneUI":23,"../UI/Translator":25,"../UI/TravelNotesPaneUI":27}],14:[function(i,t,e){!function(){"use strict";var o=null;void 0!==t&&t.exports&&(t.exports=function(){var r=i("./Translator")(),a=function(){document.getElementById("TravelNotes-Control-ErrorDataDiv").classList.add("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-ErrorMessageDiv").innerHTML=""};return{createUI:function(t){!function(t){if(!document.getElementById("TravelNotes-Control-ErrorDataDiv")){var e=i("./HTMLElementsFactory")(),o=e.create("div",{id:"TravelNotes-Control-ErrorDataDiv",className:"TravelNotes-Control-DataDiv TravelNotes-Control-HiddenList"},t),n=e.create("div",{id:"TravelNotes-Control-ErrorHeaderDiv",className:"TravelNotes-Control-HeaderDiv TravelNotes-Control-HiddenList"},o);e.create("span",{innerHTML:"&#x274c",title:r.getText("ErrorEditorUI - Hide"),id:"TravelNotes-Control-ErrorExpandButton",className:"TravelNotes-Control-HiddenList"},n).addEventListener("click",function(t){t.stopPropagation(),document.getElementById("TravelNotes-Control-ErrorMessageDiv").innerHTML.length&&a()},!1),e.create("div",{id:"TravelNotes-Control-ErrorMessageDiv"},o)}}(t)},set message(t){var e;e=t,o&&(clearTimeout(o),o=null),document.getElementById("TravelNotes-Control-ErrorMessageDiv").innerHTML=e,document.getElementById("TravelNotes-Control-ErrorDataDiv").classList.remove("TravelNotes-Control-HiddenList"),o=setTimeout(a,i("../L.TravelNotes").config.errorMessages.timeout)},get message(){return document.getElementById("TravelNotes-Control-ErrorDataDiv").innerHTML}}})}()},{"../L.TravelNotes":7,"./HTMLElementsFactory":15,"./Translator":25}],15:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){return{create:function(t,e,o){var n;if(n="text"===t.toLowerCase()?document.createTextNode(""):document.createElement(t),o&&o.appendChild(n),e)for(var r in e)try{n[r]=e[r]}catch(t){console.log("Invalid property : "+r)}return n}}})}()},{}],16:[function(f,t,e){!function(){"use strict";var u=f("../UI/HTMLElementsFactory")(),d=f("../L.TravelNotes"),v=f("../UI/Translator")(),g=f("../util/Utilities")(),p=f("../core/NoteEditor")(),e=f("../core/RouteEditor")(),m=f("../L.TravelNotes").config.note.svgIconWidth,T="TravelNotes-Control-";void 0!==t&&t.exports&&(t.exports=function(){var c=function(t,e){var o=u.create("div",{className:T+"Travel-Notes-IconCell",innerHTML:t.iconContent},e),n=1;"svg"===o.firstChild.tagName&&"TravelNotes-Roadbook-"===T&&(n=f("../L.TravelNotes").config.note.svgIconWidthScale,o.firstChild.setAttributeNS(null,"viewBox","0 0 "+m+" "+m)),o.setAttribute("style","width:"+t.iconWidth*n+"px;"),u.create("div",{className:T+"Travel-Notes-Cell",innerHTML:p.getNoteHTML(t,T)},e),e.noteObjId=t.objId},n=function(){var t=u.create("div",{className:T+"Travel-Header"});u.create("div",{className:T+"Travel-Header-Name",innerHTML:d.travel.name},t);for(var e=0,o=d.travel.routes.iterator;!o.done;)u.create("div",{className:T+"Travel-Header-RouteName",innerHTML:'<a href="#route'+o.value.objId+'">'+o.value.name+"</a>&nbsp;:&nbsp;"+g.formatDistance(o.value.distance)+"."},t),o.value.chain&&(e+=o.value.distance);return u.create("div",{className:T+"Travel-Header-TravelDistance",innerHTML:v.getText("HTMLViewsFactory - Travel distance&nbsp;:&nbsp;{distance}",{distance:g.formatDistance(e)})},t),t},r=function(){for(var t=u.create("div",{className:T+"Travel-Notes"}),e=d.travel.notes.iterator;!e.done;){var o=u.create("div",{className:T+"Travel-Notes-Row"},t);c(e.value,o)}return t},a=function(t){return u.create("div",{className:T+"Route-Header",id:"route"+t.objId,innerHTML:e.getRouteHTML(t,T)})},i=function(t){for(var e=u.create("div",{className:T+"Route-ManeuversAndNotes"}),o=t.notes.iterator,n=o.done,r=n?Number.MAX_VALUE:o.value.distance,a=t.itinerary.maneuvers.iterator,i=a.done,s=0;!i||!n;){var l=u.create("div",{className:T+"Route-ManeuversAndNotes-Row"},e);if(s<=r){if(!i){l.className=T+"Route-Maneuvers-Row",u.create("div",{className:T+"Route-ManeuversAndNotes-IconCell TravelNotes-ManeuverNote-"+a.value.iconName},l);var d="<div>"+a.value.instruction+"</div>";0<a.value.distance&&(d+="<div>"+v.getText("HTMLViewsFactory - To next instruction&nbsp;:&nbsp;{distance}&nbsp;-&nbsp;{duration}",{distance:g.formatDistance(a.value.distance),duration:g.formatTime(a.value.duration)})+"</div>"),u.create("div",{className:T+"Route-ManeuversAndNotes-Cell",innerHTML:d},l),l.objId=f("../data/ObjId")(),l.latLng=t.itinerary.itineraryPoints.getAt(a.value.itineraryPointObjId).latLng,l.maneuverObjId=a.value.objId,s+=a.value.distance,(i=a.done)&&(s=Number.MAX_VALUE)}}else n||(l.className=T+"Route-Notes-Row",c(o.value,l),l.objId=f("../data/ObjId")(),l.latLng=o.value.latLng,l.noteObjId=o.value.objId,r=(n=o.done)?Number.MAX_VALUE:o.value.distance)}return e},s=function(t){var e="";return""!==t.itinerary.provider&&""!==t.itinerary.transitMode&&(e=v.getText("HTMLViewsFactory - Itinerary computed by {provider} and optimized for {transitMode}",{provider:t.itinerary.provider,transitMode:v.getText("HTMLViewsFactory - TransitMode "+t.itinerary.transitMode)})),u.create("div",{className:T+"RouteFooter",innerHTML:e})},l=function(){return u.create("div",{className:T+"TravelFooter",innerHTML:v.getText("HTMLViewsFactory - Travel footer")})};return{set classNamePrefix(t){T=t},get classNamePrefix(){return T},get travelHeaderHTML(){return n()},get travelNotesHTML(){return r()},get routeHeaderHTML(){return a(d.editedRoute)},get routeManeuversAndNotesHTML(){return i(d.editedRoute)},get routeFooterHTML(){return s(d.editedRoute)},get travelFooterHTML(){return l()},get travelHTML(){return function(){var t=u.create("div",{className:T+"Travel"});t.appendChild(n()),t.appendChild(r());for(var e=d.travel.routes.iterator;!e.done;){var o=d.config.routeEditor.displayEditionInHTMLPage&&e.value.objId===d.routeEdition.routeInitialObjId;t.appendChild(a(o?d.editedRoute:e.value)),t.appendChild(i(o?d.editedRoute:e.value)),t.appendChild(s(o?d.editedRoute:e.value))}return t.appendChild(l()),t}()}}})}()},{"../L.TravelNotes":7,"../UI/HTMLElementsFactory":15,"../UI/Translator":25,"../core/NoteEditor":34,"../core/RouteEditor":36,"../data/ObjId":49,"../util/Utilities":57}],17:[function(t,e,o){arguments[4][15][0].apply(o,arguments)},{dup:15}],18:[function(c,t,e){!function(){"use strict";var i=function(t){t.stopPropagation();for(var e=t.target;!e.latLng;)e=e.parentNode;c("../core/MapEditor")().zoomToPoint(e.latLng)},s=function(t){t.stopPropagation(),t.preventDefault();for(var e=t.target;!e.latLng;)e=e.parentNode;e.maneuverObjId?c("../core/NoteEditor")().newManeuverNote(e.maneuverObjId,e.latLng):e.noteObjId&&c("../core/NoteEditor")().editNote(e.noteObjId)},l=function(t){t.stopPropagation(),c("../core/MapEditor")().addItineraryPointMarker(t.target.objId,t.target.latLng)},d=function(t){t.stopPropagation(),c("../core/MapEditor")().removeObject(t.target.objId)};void 0!==t&&t.exports&&(t.exports=function(){return Object.seal({remove:function(){!function(){var t=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(t){var e,o,n,r=document.getElementsByClassName("TravelNotes-Control-Route-Header")[0];r&&t.removeChild(r);var a=document.getElementsByClassName("TravelNotes-Control-Route-ManeuversAndNotes")[0];if(a){for(o=a.childNodes,e=0;e<o.length;e++)(n=o[e]).removeEventListener("click",i,!1),n.removeEventListener("contextmenu",s,!1),n.removeEventListener("mouseenter",l,!1),n.removeEventListener("mouseleave",d,!1);t.removeChild(a)}}}()},add:function(){!function(){document.getElementById("TravelNotes-Control-ItineraryPaneButton").classList.add("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-TravelNotesPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),window.osmSearch&&document.getElementById("TravelNotes-Control-SearchPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton");var t=c("../UI/HTMLViewsFactory")();t.classNamePrefix="TravelNotes-Control-";var e=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(e){var o,n,r;e.appendChild(t.routeHeaderHTML),e.appendChild(t.routeManeuversAndNotesHTML);var a=document.getElementsByClassName("TravelNotes-Control-Route-ManeuversAndNotes")[0];if(a)for(n=a.childNodes,o=0;o<n.length;o++)(r=n[o]).addEventListener("click",i,!1),r.addEventListener("contextmenu",s,!1),r.addEventListener("mouseenter",l,!1),r.addEventListener("mouseleave",d,!1)}}()}})})}()},{"../UI/HTMLViewsFactory":16,"../core/MapEditor":33,"../core/NoteEditor":34}],19:[function(U,t,e){!function(){"use strict";var M,R,j=U("../UI/Translator")(),A={editionButtons:[],preDefinedIconsList:[]},B={editionButtons:[],preDefinedIconsList:[]},P={editionButtons:[],preDefinedIconsList:[]},w=function(){return 0===document.getElementById("TravelNotes-NoteDialog-TextArea-IconHtmlContent").value.length?(document.getElementById("TravelNotes-BaseDialog-ErrorDiv").innerHTML=j.getText("Notedialog - The icon content cannot be empty"),document.getElementById("TravelNotes-BaseDialog-ErrorDiv").classList.remove("TravelNotes-BaseDialog-ErrorDivHidden"),!1):(M.iconWidth=document.getElementById("TravelNotes-NoteDialog-WidthNumberInput").value,M.iconHeight=document.getElementById("TravelNotes-NoteDialog-HeightNumberInput").value,M.iconContent=document.getElementById("TravelNotes-NoteDialog-TextArea-IconHtmlContent").value,M.popupContent=document.getElementById("TravelNotes-NoteDialog-TextArea-PopupContent").value,M.tooltipContent=document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value,M.address=document.getElementById("TravelNotes-NoteDialog-InputText-Adress").value,M.url=document.getElementById("TravelNotes-NoteDialog-InputText-Link").value,M.phone=document.getElementById("TravelNotes-NoteDialog-InputText-Phone").value,U("../core/NoteEditor")().afterNoteDialog(M,R),!0)};void 0!==t&&t.exports&&(t.exports=function(e,o,t){var n=function(){P.preDefinedIconsList=B.preDefinedIconsList.concat(A.preDefinedIconsList),P.preDefinedIconsList.sort(function(t,e){return t.name.localeCompare(e.name)});var t=0;for(t=c.length-1;0<=t;t--)c.remove(t);for(t=0;t<P.preDefinedIconsList.length;t++){var e=s.create("option",{text:P.preDefinedIconsList[t].name});c.add(e)}},r=function(t){t.forEach(function(t){s.create("button",{type:"button",innerHTML:t.title||"?",htmlBefore:t.htmlBefore||"",htmlAfter:t.htmlAfter||"",className:"TravelNotes-NoteDialog-EditorButton"},d).addEventListener("click",a,!1)})},a=function(t){if(u){for(var e=t.target;!e.htmlBefore;)e=e.parentNode;var o=e.htmlAfter&&0<e.htmlAfter.length,n=u.selectionStart,r=u.selectionEnd,a=u.value;u.value=a.substring(0,n)+(o?e.htmlBefore+a.substring(n,r)+e.htmlAfter:e.htmlBefore)+a.substring(r),u.setSelectionRange(o||n===r?n+e.htmlBefore.length:n,(o?r:n)+e.htmlBefore.length),u.focus()}};M=e,R=o;var i=U("../UI/BaseDialog")();i.title=j.getText("NoteDialog - Note"),i.addClickOkButtonEventListener(w);var s=U("./HTMLElementsFactory")(),l=s.create("div",{id:"TravelNotes-NoteDialog-MainDataDiv"},i.content),d=s.create("div",{className:"TravelNotes-NoteDialog-ToolbarDiv",id:"TravelNotes-NoteDialog-ToolbarDiv"},l),c=s.create("select",{className:"TravelNotes-NoteDialog-Select",id:"TravelNotes-NoteDialog-IconSelect"},d);c.addEventListener("change",function(t){c.selectedIndex;var e=P.preDefinedIconsList[c.selectedIndex];T.value=e.width,f.value=e.height,h.value=e.icon,y.value=e.tooltip},!1);var u=null,v=s.create("div",{id:"TravelNotes-NoteDialog-OpenEditorFileDiv"},d),g=s.create("input",{id:"TravelNotes-NoteDialog-OpenEditorFileInput",type:"file",accept:".json"},v);g.addEventListener("change",function(t){var o=new FileReader;o.onload=function(t){try{var e=JSON.parse(o.result);A.editionButtons=A.editionButtons.concat(e.editionButtons),A.preDefinedIconsList=A.preDefinedIconsList.concat(e.preDefinedIconsList),r(e.editionButtons),n()}catch(t){}},t.target.files[0].name,o.readAsText(t.target.files[0])},!1);var p=s.create("div",{id:"TravelNotes-NoteDialog-OpenStyleFakeDiv"},v);s.create("button",{id:"TravelNotes-NoteDialog-OpenEditorFileButton",className:"TravelNotes-NoteDialog-EditorButton",title:j.getText("NoteDialog - Open a configuration file"),innerHTML:"&#x23CD;"},p).addEventListener("click",function(){g.click()},!1),r([{title:"div",htmlBefore:"<div>",htmlAfter:"</div>"},{title:"p",htmlBefore:"<p>",htmlAfter:"</p>"},{title:"span",htmlBefore:"<span>",htmlAfter:"</span>"},{title:"a",htmlBefore:'<a target="_blank" href="">',htmlAfter:"</a>"}]),r(B.editionButtons),r(A.editionButtons),n();var m=s.create("div",{className:"TravelNotes-NoteDialog-DataDiv",id:"TravelNotes-NoteDialog-DimensionsDataDiv"},l);s.create("text",{data:j.getText("NoteDialog - Icon width")},m);var T=s.create("input",{type:"number",className:"TravelNotes-NoteDialog-NumberInput",id:"TravelNotes-NoteDialog-WidthNumberInput"},m);T.value=e.iconWidth,s.create("text",{data:j.getText("NoteDialog - Icon height")},m);var f=s.create("input",{type:"number",className:"TravelNotes-NoteDialog-NumberInput",id:"TravelNotes-NoteDialog-HeightNumberInput"},m);f.value=e.iconHeight;var N=U("../core/SvgIconFromOsmFactory")(),I=function(t){document.getElementById("TravelNotes-NoteDialog-TextArea-IconHtmlContent").value=t.svg,t.direction<35?document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=j.getText("NoteDialog - Turn right"):t.direction<80?document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=j.getText("NoteDialog - Turn slight right"):t.direction<100?document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=j.getText("NoteDialog - Continue"):t.direction<145?document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=j.getText("NoteDialog - Turn slight left"):t.direction<200?document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=j.getText("NoteDialog - Turn left"):t.direction<270?document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=j.getText("NoteDialog - Turn sharp left"):t.direction<340?document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=j.getText("NoteDialog - Turn sharp right"):document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=j.getText("NoteDialog - Turn right")};s.create("text",{data:j.getText("NoteDialog - SVG icon from OSM")},m);var L=s.create("input",{type:"checkbox",className:"TravelNotes-NoteDialog-CheckboxInput",id:"TravelNotes-NoteDialog-SvgIconFromOsmInput"},m);L.addEventListener("change",function(t){L.checked&&N.getSvgIcon(e.latLng,o,I)},!1),s.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",id:"TravelNotes-NoteDialog-IconContentTitleDiv",innerHTML:j.getText("NoteDialog - Icon content")},l);var h=s.create("textarea",{className:"TravelNotes-NoteDialog-TextArea",id:"TravelNotes-NoteDialog-TextArea-IconHtmlContent"},l);h.addEventListener("focus",function(t){u=h},!1),h.value=e.iconContent,s.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:j.getText("NoteDialog - Text")},l);var E=s.create("textarea",{className:"TravelNotes-NoteDialog-TextArea",id:"TravelNotes-NoteDialog-TextArea-PopupContent"},l);E.addEventListener("focus",function(t){u=E},!1),E.value=e.popupContent,s.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:j.getText("NoteDialog - Tooltip content")},l);var y=s.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Tooltip"},l);y.addEventListener("focus",function(t){u=y},!1),y.value=e.tooltipContent,s.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:"<span id='TravelNotes-NoteDialog-Reset-Address-Button'>&#x1f504;</span>&nbsp;"+j.getText("NoteDialog - Address&nbsp;:")},l),document.getElementById("TravelNotes-NoteDialog-Reset-Address-Button").addEventListener("click",function(){U("../core/GeoCoder")().getAddress(e.lat,e.lng,function(t){b.value=t})},!1);var b=s.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Adress"},l);b.addEventListener("focus",function(t){u=b},!1),b.value=e.address,s.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:j.getText("NoteDialog - Link")},l);var C=s.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Link"},l);C.addEventListener("focus",function(t){u=null},!1),C.value=e.url,s.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:j.getText("NoteDialog - Phone")},l);var D=s.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Phone"},l);if(D.addEventListener("focus",function(t){u=D},!1),D.value=e.phone,0===B.preDefinedIconsList.length){var x=new XMLHttpRequest;x.onreadystatechange=function(t){if(this.readyState===x.DONE)if(200===this.status)try{B=JSON.parse(this.responseText),r(B.editionButtons),B.preDefinedIconsList.push({name:"",icon:"",tooltip:"",width:40,height:40}),n()}catch(t){console.log("Error reading TravelNotesNoteDialog.json")}else console.log("Error sending request for TravelNotesNoteDialog.json")},x.open("GET",window.location.href.substr(0,window.location.href.lastIndexOf("/")+1)+"TravelNotesNoteDialog.json",!0),x.send(null)}U("../L.TravelNotes").config.note.reverseGeocoding&&""===e.address&&t&&U("../core/GeoCoder")().getAddress(e.lat,e.lng,function(t){b.value=t}),i.center()})}()},{"../L.TravelNotes":7,"../UI/BaseDialog":9,"../UI/Translator":25,"../core/GeoCoder":32,"../core/NoteEditor":34,"../core/SvgIconFromOsmFactory":38,"./HTMLElementsFactory":15}],20:[function(g,t,e){!function(){"use strict";var c=g("../L.TravelNotes"),u=function(t){t.stopPropagation(),c.routing.provider=t.target.provider,document.getElementsByClassName("TravelNotes-Control-ActiveProviderImgButton")[0].classList.remove("TravelNotes-Control-ActiveProviderImgButton"),t.target.classList.add("TravelNotes-Control-ActiveProviderImgButton");var e=c.providers.get(t.target.provider);e.transitModes.car?document.getElementById("TravelNotes-Control-carImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-carImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),e.transitModes.bike?document.getElementById("TravelNotes-Control-bikeImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-bikeImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),e.transitModes.pedestrian?document.getElementById("TravelNotes-Control-pedestrianImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-pedestrianImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),e.transitModes.train?document.getElementById("TravelNotes-Control-trainImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-trainImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),c.providers.get(t.target.provider).transitModes[c.routing.transitMode]||(e.transitModes.bike?document.getElementById("TravelNotes-Control-bikeImgButton").click():e.transitModes.pedestrian?document.getElementById("TravelNotes-Control-pedestrianImgButton").click():e.transitModes.car?document.getElementById("TravelNotes-Control-carImgButton").click():e.transitModes.train&&document.getElementById("TravelNotes-Control-trainImgButton").click()),g("../core/RouteEditor")().startRouting()},v=function(t){t.stopPropagation(),c.routing.transitMode=t.target.transitMode,document.getElementsByClassName("TravelNotes-Control-ActiveTransitModeImgButton")[0].classList.remove("TravelNotes-Control-ActiveTransitModeImgButton"),t.target.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),g("../core/RouteEditor")().startRouting()};void 0!==t&&t.exports&&(t.exports=function(){var o=null,n=g("../UI/HtmlElementsFactory")(),r=!1,a=null,i=null,s=null,l=null,e=function(t){var e=n.create("img",{src:"data:image/png;base64,"+t.icon,id:"TravelNotes-Control-"+t.name+"ImgButton",className:"TravelNotes-Control-ImgButton",title:t.name},o);e.provider=t.name.toLowerCase(),e.addEventListener("click",u,!1),r||(e.classList.add("TravelNotes-Control-ActiveProviderImgButton"),c.routing.provider=e.provider,r=!0,t.transitModes.bike?(a.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),c.routing.transitMode="bike"):t.transitModes.pedestrian?(i.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),c.routing.transitMode="pedestrian"):t.transitModes.car?(s.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),c.routing.transitMode="car"):t.transitModes.train&&(l.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),c.routing.transitMode="train"),t.transitModes.car||s.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),t.transitModes.pedestrian||i.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),t.transitModes.bike||a.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),t.transitModes.train||l.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"))},d=function(t){o=n.create("div",{id:"TravelNotes-Control-ItineraryButtonsDiv",className:"TravelNotes-Control-ButtonsDiv"},t),(a=n.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AoaESkaC0SxrgAABMdJREFUSMfNl1loVGcYhp//n+WcZmbiJE4WjVKVaLWOGxglilFTSmYUF1ILKiIILSjplQiKS65EXG4UvBGrQvVCUAdjoRrEGmtwjQbtWKlpEsTGGDMxkzKTzHr+XiRucbK4ts/lOd/5X853vuU9gj4YN+48Dx58DUBOzrmhnZ0qXykWJBKqKJlkYjyusgAsFtFqMnHPbBa/CcEvaWnir5YWT1vvM3ojUl2cPv1XamqK8fv/MBcWPtwfDhuLlWKYUvSLECAEzTabPHP16uc/uN1fJp6fNShhpRROZ+WSzk7jVDyuTLwDFotIpqXJb4LBkgohRP/Cbvc5/H6krhsnolFVOtAbDoQQoGnCF4nIb91uDL/f8+KefDXQ70e6XOpIJPL+ot2Zg0hElbpc6ojf/7qWBPB6q1FKoevqRCBgrOYDEwgYq3VdnVBK4fVWd2cjL6+SpqYSnM5zi4PBZAUfEafTtCQY9JzJy6tENjWVsH79ZWs4bJziIxMOG6fWr79sbWoq6S4uTTt7MBo1vuMToGnyx2jU+71ITz/rCoWM3w2D3AFKBUj0NIL5nYWl5IndLidJw2CsUgOJwtSp6SQSC7h5czZO50vhIUPMTJrkYMIEO8OHa4Op9FzDYKyUEs9gWqelJUpbm8GcOdcJBmOAARjEYgZFRUOoqZnNyJGDEkZKPOZIRM0bTIricUU8blBePhaQKAXJZBzDUMyYkcnly21cvx7sPRpSEomoeWZgQv9hSUAxYoSD8+efsmdPIxkZVgBMJrDZTKxdO4YLF56Sm/sZT5509jzX76SdYI7FurdMKoqKMti8eQyZmVakFOTkaGzaFGP79gZCoSSaJpk82UFl5VN2727k+PEpxGIGHR0Jdu5s4Natf1KeG4uprD7Lc86cDPbuHc/y5Xd4/DhKa+tXNDZ2cfJkC9euFXLw4EMMA6ZNG8KOHfUcPjyZKVPSWbnyNg0NEXy+aaxadYcbN1KLS6tVtKZK75YtY1ix4i51dZ0sWpTF3bshurqSZGdruN3VLFyYS3HxUEKhJAsXZpGbq1Faeovt28dz716IpUtvs21bfs+neh2rVbSagftAVu+edTotdHUl0XVJdraV+fOvcejQJPLzbSj1lHXr/GiapL09gc83lWg0ycyZDk6ffozNZiIUSpKdbe3p/ze4LzVNVKVIBJcuteHxuOjqSrJvXyNpaSaKi134fM2AoL6+C6/Xxf79X7Bx45/Y7RZ27XpIeXkdoVCcuXMzuXIldZVrmqgSdvvZwnDYuNK7l9PTzVRVzUAIQV1dmLlzh7Jhw32OHm16ZY0r8vPTSCQUXm8WW7fmc/p0C263g5wcK7NmXePZs/gbO9pmk7MGGJkJvN5cRo9O4+efW3j0KNKXaQEMJk50sGzZMOrrwxw79nfKlno+MgexJFR/Lumt458vCQlQVmYvs1hEgj79oHiLNdB3vMUiEmVl9rL/3gh4vdW0t5ec0XXp+1iiui597e0lZ7zeal4YgZecky6XOvKhfZfLJX8KBMQa8BgpXabbjREIiDW6LnxCvL+gEKDrwhcIiDVuN8b/wtCnXJ4FBRfp6PBU1NaO0h0OeUBKmgeTASFASpodDnmgtnaU3tHhqSgouDj4f6dP8dP2L6C7Ld6Z4dDBAAAAAElFTkSuQmCC",id:"TravelNotes-Control-bikeImgButton",className:"TravelNotes-Control-ImgButton"},o)).transitMode="bike",a.addEventListener("click",v,!1),(i=n.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AoaESo7bADyMwAABNlJREFUSMe1V19oU1cY/52Te5Ob3DR/SfzTNNCufxRXxmarONCnPbi+ykYrFdRSkeJLX5ykZcKcFfG5oIJ2Y2sVFZQ+iPoiUhC128OIiJrUlgQTm9o0t23SJufmnj2k2ura5syx7ynknu/7nd93vr8E6wghBJxzAEAgAEsmc3pToWD1y3L6M8NQfABA6eIUY54xs3kh5Xb3JONx5D/WXdX2Wh9crkPIZAbAOVBRcbpvYaHuO87lDZyTCs7lFaochDAQwucANmmzRa7PzfWECFm2IQTsdrdiZuYqHI5quVg80J7P113WdR+AIsTEBEmagsUSOayq539PpVLM5WpFJnO1POOtW+GMRH4dKRa9jZxTABz/TggIMSDLU+Fg8NDuaBTaxyfoux8ORxsAwG7vrI5Ehl7pur+Rc/IJoCX3c05QKGxsnJgYemW3d1avxPgH42AQzkRi6JWuOz3ljReX7k3KnpQkLb158/6aWGyZOS0F0kF4vX45mRwY0XV3WdCGBhsePvwa3d1BAEZZYF13e5LJgRGv1y87nQdLjCmlMAwDqvrj4Wx2x6XyDAw8eLADe/b4AQCqehu5nJj7bbYnHbncT5cppaCGYYBzIJ+vu7TiydcNnP7+GBKJRQwPJ5HL6YLvTlEo1F3iHDAMo4Rkt5/qK6UMFwK+du0NurvDePt2EQ0NdkE9Dl33wW4/1QcApKoKltevrz01DLVWNGKbmhwYHd1dCrEiR0vLY9y7Ny0UaJRmo5WV339OZ2b6NgGyXzRRVFXC4OCXKwwBd+/uRH//VkHmsn9mpm8TZUzxcU4comzb2zciEFCg6yWQZ8/mcOJEGF1dNaivV8tb4MTBmOKjkpSuLdXe8lJZacb5819g374/QEiphJpMBGfPvlxiTwSAZUjSdC0tdZnyCiYTwfBwMx49SuPOnSkA7P3/7/QZM4SC0zCsPkn0bX0+GU+eTCMUGgNAcO7cGEwmCbOzFITI2Lv3ESYmFsWruar2tmWzu4bEjhtLxY4jn/8G2ayByck8mpsfY36+CPEAfbif6ronSggTLgKAgQsXtmF+nuLIkTC2bHGhpcUj3EwIYdB1b5TK8uIUIXxW9LbBoBXt7VW4ciWOGzeSuHnzNQYHvxJ3MeGzZvPiFHW7Q0mApcTUiujtrYHVChw79hyAjOPHX6JYJLh4cZtQwyCEpVyuUJLG48hbrS+uA6aySvX1Kjo7q9HV9fS9a6PRHG7dSqCtLYBAwFp2OlGUF9fjceRJKbcAWf6N67p3zbciBBgZ2Ym6OjsaGh4gk1luDmYzQT7/LUKhZzhzZnyN0kkgSdNg7AAhBKCUUhACWCyRjvVc1dxcgV273Dh58jkymQ+DsVAwcPToX1AUsm5GmM2RjiXQ0tVcroMAbsvZ7Nk/GdvYuNoF/H4ZGzZYEA7PrcpIUSgoBXI5Y9VskOU3Yafzh+2MtTBN++W/jD7iIklauqpqf834+Eejz7tBLBaDpij3myRJS4sNBeXzXpK0tKLcbxofh+Z0tq0/3tbWwhmLDYww5vv/x9vlDaIV0Sg0jye03WYbPSxJ0xBJtQ8H+mlus412eDwntkej0Fyu1k9dYX7uW1ioX3OFoZQB4HOEsEmr9RNXmLWWtspKWDRt9aVN1z1jsryQcjh6komE2NL2N0SHF0QJfjNNAAAAAElFTkSuQmCC",id:"TravelNotes-Control-pedestrianImgButton",className:"TravelNotes-Control-ImgButton"},o)).transitMode="pedestrian",i.addEventListener("click",v,!1),(s=n.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AoaESgBmDpJAwAABQBJREFUSMe9V09MFFcY/703szOz7PLP2WVBV6rtdm21HqhG2wiCh8bL2jWhsl71IhqJJ4oHL4RIxKP1HzESLh4MEGPkoAeNYRWtGkPShGRF+aeFld2psd0BZnZmXg+LW4SdrW3EX/Iub775fe/7977vEdigrCyMmZnrAABZbvGoavkGSh0hy3LtNAzuS57nZAAwTVPhOHOEUnXAstL9Ltd0TFFOJ5dyLAXJtSnLMhRFwaNHoDt3nj2v66vDjHHljDkAsIXf2CKKzB4haRBixgVh6vrAwNEj27bB8ng8SCaTH6aYMcDtPh3StM/6DKNIACz8N1Dw/J+6KI7Xp1It/YTkkliEwsJmnD8PIopdvbOzX90wDPf/UAoAFgzDLczOfn1Dkrp6T5wAKSpqtre4tRXk5MkLV3W9ch8+IgRhsqel5XCkrS0bn4xiWZaRTCqQpK5eTfPVYwUgiq/75ucP/uT1ZmJOvd4wFEWBy9UR0nXPiigFAF331LtcHaFkMomysnDG4mgUdNeuq3OZmK4ceD6lP34ccVZVwSIZN5y9qGlfHLJPJAa/X4LbzeUlnp21MDk5Z1csAChE8XmnpjU1Eln+2fPmzXe/WZZYbkcoyxympn6AaaahKCrIkvpgjKGkpACSJCAQuI2JibR9oVEtXlz862ZeVSs2MMaV57NkzRoHBIFi06aHGB5+m/XC4sIIBAoxMrILfr+YVzFjXPncXPkGSikfytxIeapyIQKHDlUAAIJBN3p7t+Lata0IBt0AGBobVy/IsrxcjDlACL+Htyx3zT+nz3GnEqCyUkJ39wSOHYvh7t1vUVvrz37fu3cNotHfUVs7BElywO+XAKj5VIMxdw01TS5onwwWHjzYjp6ebaiokFBdXYJUSl8mNT9voq6uBH6/hO7uLXjy5HtQamsKTJMLUo7j5NwWMxw44Mf27TIKCnjs3u1DNFqDVGq5bDJp4M6dHQiHV6OggMeWLaU4enQt7Hg5jltF88WjqIjPNo13aGj4fJnc/v3r32swAFBcnD9vqGmaSm5XE5w58xINDYMgBKiru4ebN+NIpxlGR1WMjWXW6KgKTbMwOKigunoAhACHDz/CqVNjsOM1TVPhBOHHsGG4KnOfK41z577BunWFcDgscByDzyfh9u04Xr5UMTmZWT6fhFevVAQCBaiqKkVpKYfLl6fzNI3UEE9pKgr4duSOB0EqZQAAVNXAyIiKp0/fgudJ1qWEAJcujYEQAll2LMiaiwaG5ZyEpKK8ZRn9hKSPM8bnul3R1TWJUGgtLlyYwtDQX3njtn69E01NQVy58gqMEZvyTIMxo586ndMxQsy4Hdn4eBr37ycwPj6/YIH9mprScO9eAs+eaXnuBTPudE7HFprELxc1LZCnSVhLh5W804e9LIUgPO/U9aZGAgDDw6CbN1+dM82VbYscl9JjsYgzEIBFy8rC2LgRlihO1BNirphSQkyI4nh9IAArOwh4vV7MzCQ+7egDAIlEAoQAra0H9wnCRM/HVioIEz2trQf3EYLsjP1eFrS3N7Pjx49ERPF138dwe8a9r/va2o5E2tub2QcO9B0hTVv3aQb6d/B4ZKhqS/+tWxGnJL3opFSLE2IsOifJcXYCQgxQqsUl6UXn4GDEqaot/V6v58PfTpmECyORWPpo4/dYlrvGMLggz3OrFh5tf1BqPuO4VNSyjBsuVzymKB3/+mj7G1dPIltjqpC6AAAAAElFTkSuQmCC",id:"TravelNotes-Control-carImgButton",className:"TravelNotes-Control-ImgButton"},o)).transitMode="car",s.addEventListener("click",v,!1),(l=n.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4goTCiEjvCsRvgAABXRJREFUSMe9V11MFFcU/u7MsDPLrgvu7A80BEhLsRIxEFIlcSXBF41BN2ExqC8kPHQraV80iA+GhKAYaLUihkLaaErig1FCiCZq2kQDjS0YfcGYQKtBg7DL7hbFHdaZnTu3D0tR7C7aRvxeJrn3zP3O3z3nXIIUcLm8mJ0dBADIcpNDUbLWcVxalWFYKnSd/1QQeBkAKKURnqd/cJwyZBjxqxbLzHgk0hF+84w3QZItyrKMSCSC0VFwFRVnuzXtIy9jfBZjaQDY4m/stSMSa4TEQQgNmEzTg0NDXzVs2gTD4XAgHA6/GzFjgNXaUaWqef26bjMBBv4bOAjCvCaKk75otOkqIckkXsOaNY3o7gYRxXOXFxY+u6Lr1v9BCgAGdN1qWlhYf0WSzl0+ehTEZmtMbXFLC8jx499f1LTcPXiPMJmeXGpqOlDb2roUnwSxLMsIhyOQpHOXVdXtwypAFIP9L1/W1zidiZhzTqcXkUgEFkt7laY5VoUUADTN4bNY2qvC4TBcLm/C4uFhcJWVF2OJmK4eBCGq3blTay4thUESbjjbo6qf+JMlks3GYX7egNfrgtv9A+bn55Geng673Y7du3eD0iL4/ffx6JECm03A3JwOxlJnuyj+2auqX3/Jy/Jhh6Ks72SMtyZPDAJNY9i40Yq+vi9QU1OD6elp5OXlIRgMorp6C4qL14BSBkWhCAY1CAJgJL0MDIyl52Rm5v8kKEr2Osb4rJQXw0iob7ebMDIygvLy8qW9/Px89PT0oKSkBGfOfItTpwK4fz8KWU5DMBhH8hrBZ8ViWes4jhOqEhUpORwOEW63Cdu2CSgvL8fY2BgYY2CMobOzEzt27IDD4UBnZydevEi42WYTUp7HWBoIEXYJhmHd+qr8/Rvd3RuQns5j374NOH/+PLKzs9HX1wdCCOx2O+rq6pCTkwNN00AIQSCgYnx8AUAsFTUYs24VKOULl9fe5XjyJIbm5s9x4sQJlJSUwO12g1KaUtHe3l7k5lbg3r35FBIElPKFHM/z8koWHzu2BUNDQ7h27RpKS0tXJAUAv9+Pykr7ChIMPM/bhbfdPb/fj4GBAfT39y+tud1ubN68GRkZGQiFQpiamsKzZ8+gKApisRhGR/sAFK18pymlEYA4U1lNKUVlZSUuXLiA7du3w25fbg1J0nri8Tiam39ewdU0IvA8nYjHmTOVZnv37kVhYSE8Hg/YYmX45zs5OYmZmRmUlZVBkqTF0qhB1/W3uJpOcBwXHU7RlgEA1dXV4HkegiDgwIEGdHR8A13XQQjBxMQEPB4P2tvbl+T379+PgwcPrUBMQEh0mEjSd1tU9eNfGUse7p07HcjOlvD0aRPMZjMGBgaW9nw+HyoqKqAoCjRNA6UUU1NTuH79OmZmfkxOS3SI4iMPWbv2sOP58/IxwxBTVi9CgPr6HITDzXC5XJAkCV1dXSltOnToF5w8qSav1pwayMj4vViYm+sIi2LXoKoWJG0SZjOBIHAoK7OB484gM/M31NXV4e7du7h5U0Ju7gzM5hhu3bqFkZEReDzHcfr0wgoj0dPBubmOMAGABw/AFRdfjFG6um2R56Pa+HituaAABudyeVFUBEMUH/sIoatGSgiFKE76CgpgLA0CTqcTs7OhDzv6AEAoFAIhQEtL/R6T6fGl901qMj2+1NJSv4cQLM3Yy8bbtrZGduRIQ60oBvvfh9sT7g32t7Y21La1NbJ3HOjbq1Q1/8MM9K+avwxFabp640atWZIe9nKcGiBEf01PkkR3AkJ0cJwakKSHvbdv15oVpemq0+l497dTIuG8CIXefLQJuwzDulXX+UJB4O2LTeQvjqMTPB8dNgz9isUSGI9E2t/6aPsbwfNWty4y/a8AAAAASUVORK5CYII=",id:"TravelNotes-Control-trainImgButton",className:"TravelNotes-Control-ImgButton"},o)).transitMode="train",l.addEventListener("click",v,!1),c.providers&&(r=!1,c.providers.forEach(e))};return Object.seal({createUI:function(t){d(t)},get provider(){return c.routing.provider},set provider(t){var e,o;e=t,(o=document.getElementById("TravelNotes-Control-"+e+"ImgButton"))&&o.click()},get transitMode(){return c.routing.transitMode},set transitMode(t){var e,o;e=t,(o=document.getElementById("TravelNotes-Control-"+e+"ImgButton"))&&o.click()}})})}()},{"../L.TravelNotes":7,"../UI/HtmlElementsFactory":17,"../core/RouteEditor":36}],21:[function(I,t,e){!function(){"use strict";var a=I("./Translator")(),i=null,s=function(t){if(t.stopPropagation(),-1!==I("../L.TravelNotes").routeEdition.routeInitialObjId){document.getElementById("TravelNotes-Control-RouteHeaderDiv").classList.toggle("TravelNotes-Control-SmallHeader"),document.getElementById("TravelNotes-Control-RouteDataDiv").classList.toggle("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-RouteButtonsDiv").classList.toggle("TravelNotes-Control-HiddenList");var e=document.getElementById("TravelNotes-Control-RouteDataDiv").classList.contains("TravelNotes-Control-HiddenList");document.getElementById("TravelNotes-Control-RouteExpandButton").innerHTML=e?"&#x25b6;":"&#x25bc;",document.getElementById("TravelNotes-Control-RouteExpandButton").title=e?a.getText("RouteEditorUI - Show"):a.getText("RouteEditorUI - Hide")}},l=function(t){t.stopPropagation(),I("../core/WaypointEditor")().removeWayPoint(t.itemNode.dataObjId)},d=function(t){t.stopPropagation(),I("../core/WaypointEditor")().swapWayPoints(t.itemNode.dataObjId,!0)},c=function(t){t.stopPropagation(),I("../core/WaypointEditor")().swapWayPoints(t.itemNode.dataObjId,!1)},u=function(t){t.stopPropagation(),I("../core/WaypointEditor")().renameWayPoint(t.dataObjId,t.changeValue)},v=function(t){t.stopPropagation(),I("../core/WaypointEditor")().wayPointDropped(t.draggedObjId,t.targetObjId,t.draggedBefore)},g=function(t){t.stopPropagation(),document.getElementById("TravelNotes-Control-RouteDataDiv").classList.toggle("TravelNotes-Control-ExpandedList");var e=document.getElementById("TravelNotes-Control-RouteDataDiv").classList.contains("TravelNotes-Control-ExpandedList");document.getElementById("TravelNotes-Control-ExpandWayPointsListButton").innerHTML=e?"&#x25b3;":"&#x25bd;",document.getElementById("TravelNotes-Control-ExpandWayPointsListButton").title=e?a.getText("RouteEditorUI - Reduce the list"):a.getText("RouteEditorUI - Expand the list")},p=function(t){t.stopPropagation(),I("../core/RouteEditor")().cancelEdition()},m=function(t){t.stopPropagation(),I("../core/RouteEditor")().saveEdition()},T=function(t){t.stopPropagation(),I("../core/RouteEditor")().saveGpx()},f=function(t){t.stopPropagation(),I("../core/WaypointEditor")().reverseWayPoints()},N=function(t){t.stopPropagation(),I("../core/WaypointEditor")().removeAllWayPoints()};void 0!==t&&t.exports&&(t.exports=function(){return Object.seal({createUI:function(t){!function(t){if(!document.getElementById("TravelNotes-Control-RouteDataDiv")){var e=I("./HTMLElementsFactory")(),o=e.create("div",{id:"TravelNotes-Control-RouteHeaderDiv",className:"TravelNotes-Control-HeaderDiv"},t);e.create("span",{innerHTML:"&#x25bc;",id:"TravelNotes-Control-RouteExpandButton",className:"TravelNotes-Control-ExpandButton"},o).addEventListener("click",s,!1),e.create("span",{innerHTML:a.getText("RouteEditorUI - Waypoints"),id:"TravelNotes-Control-RouteHeaderText",className:"TravelNotes-Control-HeaderText"},o);var n=e.create("div",{id:"TravelNotes-Control-RouteDataDiv",className:"TravelNotes-Control-DataDiv"},t);(i=I("./SortableList")({minSize:0,listStyle:"LimitedSort",id:"TravelNotes-Control-RouteWaypointsList"},n)).container.addEventListener("SortableListDelete",l,!1),i.container.addEventListener("SortableListUpArrow",d,!1),i.container.addEventListener("SortableListDownArrow",c,!1),i.container.addEventListener("SortableListChange",u,!1),i.container.addEventListener("SortableListDrop",v,!1);var r=e.create("div",{id:"TravelNotes-Control-RouteButtonsDiv",className:"TravelNotes-Control-ButtonsDiv"},t);e.create("div",{id:"TravelNotes-Control-ExpandWayPointsListButton",className:"TravelNotes-Control-Button",title:a.getText("RouteEditorUI - Expand the list"),innerHTML:"&#x25bd;"},r).addEventListener("click",g,!1),e.create("div",{id:"TravelNotes-Control-CancelRouteButton",className:"TravelNotes-Control-Button",title:a.getText("RouteEditorUI - Cancel"),innerHTML:"&#x274c"},r).addEventListener("click",p,!1),e.create("div",{id:"TravelNotes-Control-SaveRouteButton",className:"TravelNotes-Control-Button",title:a.getText("RouteEditorUI - Save"),innerHTML:"&#x1f4be;"},r).addEventListener("click",m,!1),e.create("div",{id:"TravelNotes-Control-gpxButton",className:"TravelNotes-Control-Button",title:a.getText("RouteEditorUI - Save the route in a gpx file"),innerHTML:"gpx"},r).addEventListener("click",T,!1),e.create("div",{id:"TravelNotes-Control-ReverseWayPointsButton",className:"TravelNotes-Control-Button",title:a.getText("RouteEditorUI - Invert waypoints"),innerHTML:"&#x21C5;"},r).addEventListener("click",f,!1),e.create("div",{id:"TravelNotes-Control-RemoveAllWayPointsButton",className:"TravelNotes-Control-Button",title:a.getText("RouteEditorUI - Delete all waypoints"),innerHTML:"&#x267b;"},r).addEventListener("click",N,!1)}}(t)},expand:function(){document.getElementById("TravelNotes-Control-RouteExpandButton").innerHTML="&#x25bc;",document.getElementById("TravelNotes-Control-RouteExpandButton").title="Masquer",document.getElementById("TravelNotes-Control-RouteDataDiv").classList.remove("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-RouteButtonsDiv").classList.remove("TravelNotes-Control-HiddenList")},reduce:function(){document.getElementById("TravelNotes-Control-RouteExpandButton").innerHTML="&#x25b6;",document.getElementById("TravelNotes-Control-RouteExpandButton").title="Afficher",document.getElementById("TravelNotes-Control-RouteDataDiv").classList.add("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-RouteButtonsDiv").classList.add("TravelNotes-Control-HiddenList")},setWayPointsList:function(){!function(){if(i.removeAllItems(),-1!==I("../L.TravelNotes").routeEdition.routeInitialObjId)for(var t=I("../L.TravelNotes").editedRoute.wayPoints.iterator;!t.done;){var e=t.first?"A":t.last?" B":t.index,o=t.first?a.getText("RouteEditorUI - Start"):t.last?a.getText("RouteEditorUI - End"):a.getText("RouteEditorUI - Via");i.addItem(t.value.UIName,e,o,t.value.objId,t.last)}}()}})})}()},{"../L.TravelNotes":7,"../core/RouteEditor":36,"../core/WaypointEditor":40,"./HTMLElementsFactory":15,"./SortableList":24,"./Translator":25}],22:[function(g,t,e){!function(){"use strict";var v=g("../UI/Translator")();void 0!==t&&t.exports&&(t.exports=function(t){var e=g("../UI/ColorDialog")(t.color);e.title=v.getText("RoutePropertiesDialog - Route properties"),e.addClickOkButtonEventListener(function(){return t.color=e.getNewColor(),t.width=parseInt(a.value),t.chain=u.checked,t.dashArray=s.selectedIndex,g("../core/MapEditor")().editRoute(t),g("../core/RouteEditor")().chainRoutes(),g("../UI/TravelEditorUI")().setRoutesList(),g("../core/TravelEditor")().updateRoadBook(),!0});var o=g("./HTMLElementsFactory")(),n=o.create("div",{id:"TravelNotes-RoutePropertiesDialog-MainDataDiv"},e.content),r=o.create("div",{className:"TravelNotes-RoutePropertiesDialog-DataDiv",id:"TravelNotes-RoutePropertiesDialog-WithDiv"},n);r.innerHTML="<span>"+v.getText("RoutePropertiesDialog - Width")+"</span>";var a=o.create("input",{type:"number",id:"TravelNotes-RoutePropertiesDialog-WidthInput"},r);a.value=t.width,a.min=1,a.max=40;var i=o.create("div",{className:"TravelNotes-RoutePropertiesDialog-DataDiv",id:"TravelNotes-RoutePropertiesDialog-dashDiv"},n);i.innerHTML="<span>"+v.getText("RoutePropertiesDialog - Linetype")+"</span>";for(var s=o.create("select",{className:"TravelNotes-RoutePropertiesDialog-Select",id:"TravelNotes-RoutePropertiesDialog-DashSelect"},i),l=g("../L.TravelNotes").config.route.dashChoices,d=0;d<l.length;d++)s.add(o.create("option",{text:l[d].text}));s.selectedIndex=t.dashArray<l.length?t.dashArray:0;var c=o.create("div",{className:"TravelNotes-RoutePropertiesDialog-DataDiv",id:"TravelNotes-RoutePropertiesDialog-ChainDiv"},n);c.innerHTML="<span>"+v.getText("RoutePropertiesDialog - Chained route")+"</span>";var u=o.create("input",{type:"checkbox",id:"TravelNotes-RoutePropertiesDialog-ChainInput"},c);return u.checked=t.chain,e})}()},{"../L.TravelNotes":7,"../UI/ColorDialog":10,"../UI/Translator":25,"../UI/TravelEditorUI":26,"../core/MapEditor":33,"../core/RouteEditor":36,"../core/TravelEditor":39,"./HTMLElementsFactory":15}],23:[function(g,t,e){!function(){"use strict";var a=g("../core/OsmSearchEngine")(),i="",s=function(t){"Enter"===t.key&&l(t)},l=function(t){i=document.getElementById("TravelNotes-Control-SearchInput").value;for(var e=document.getElementById("TravelNotes-Control-SearchDiv"),o=document.getElementsByClassName("TravelNotes-Control-SearchResult");0!==o.length;)o[0].removeEventListener("click",d,!1),o[0].removeEventListener("contextmenu",c,!1),o[0].removeEventListener("mouseenter",u,!1),o[0].removeEventListener("mouseleave",v,!1),e.removeChild(o[0]);if(!document.getElementById("TravelNotes-Control-SearchWaitBullet")){var n=g("./HTMLElementsFactory")();n.create("div",{id:"TravelNotes-Control-SearchWaitBullet"},n.create("div",{id:"TravelNotes-Control-SearchWait"},e))}a.search()},d=function(t){t.stopPropagation();for(var e=t.target;!e.latLng;)e=e.parentNode;g("../core/MapEditor")().zoomToSearchResult(e.latLng,e.geometry)},c=function(t){t.stopPropagation(),t.preventDefault();for(var e=t.target;!e.latLng;)e=e.parentNode;g("../core/NoteEditor")().newSearchNote(e.searchResult)},u=function(t){t.stopPropagation(),g("../core/MapEditor")().addSearchPointMarker(t.target.objId,t.target.latLng,t.target.geometry)},v=function(t){t.stopPropagation(),g("../core/MapEditor")().removeObject(t.target.objId)};void 0!==t&&t.exports&&(t.exports=function(){return Object.seal({remove:function(){!function(){var t=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(t){a.hide();var e=document.getElementById("TravelNotes-Control-SearchButton");e&&e.removeEventListener("click",l,!1);var o=document.getElementById("TravelNotes-Control-SearchInput");o&&o.removeEventListener("change",l,!1);var n=document.getElementById("TravelNotes-Control-SearchDiv"),r=document.getElementsByClassName("TravelNotes-Control-SearchResult");Array.prototype.forEach.call(r,function(t){t.removeEventListener("click",d,!1),t.removeEventListener("contextmenu",c,!1),t.removeEventListener("mouseenter",u,!1),t.removeEventListener("mouseleave",v,!1)}),n&&t.removeChild(n)}}()},add:function(){!function(){document.getElementById("TravelNotes-Control-ItineraryPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-TravelNotesPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-SearchPaneButton").classList.add("TravelNotes-Control-ActivePaneButton");var t=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(t){a.show();var o=g("./HTMLElementsFactory")(),n=o.create("div",{id:"TravelNotes-Control-SearchDiv"},t);o.create("div",{id:"TravelNotes-Control-SearchButton",className:"TravelNotes-Control-Button",title:g("./Translator")().getText("SearchPaneUI - Search OpenStreetMap"),innerHTML:"&#x1f50e"},n).addEventListener("click",l,!1);var e=o.create("input",{type:"text",id:"TravelNotes-Control-SearchInput",placeholder:g("./Translator")().getText("SearchPaneUI - Search phrase"),value:i},n);e.addEventListener("change",l,!1),e.addEventListener("keydown",s,!1),e.focus();var r=0;g("../L.TravelNotes").searchData.forEach(function(t){var e=o.create("div",{id:"TravelNotes-Control-SearchResult"+r++,className:"TravelNotes-Control-SearchResult",innerHTML:(""!=t.description?"<p class='TravelNotes-Control-SearchResultDescription'>"+t.description+"</p>":"")+(t.tags.name?"<p>"+t.tags.name+"</p>":"")+(t.tags["addr:street"]?"<p>"+t.tags["addr:street"]+" "+(t.tags["addr:housenumber"]?t.tags["addr:housenumber"]:"")+"</p>":"")+(t.tags["addr:city"]?"<p>"+(t.tags["addr:postcode"]?t.tags["addr:postcode"]+" ":"")+t.tags["addr:city"]+"</p>":"")+(t.tags.phone?"<p>"+t.tags.phone+"</p>":"")+(t.tags.email?"<p><a href='mailto:"+t.tags.email+"'>"+t.tags.email+"</a></p>":"")+(t.tags.website?"<p><a href='"+t.tags.website+"' target='_blank'>"+t.tags.website+"</a></p>":"")+(t.ranking?"<p>&#x26ab;"+t.ranking+"</p>":"")},n);e.searchResult=t,e.objId=g("../data/ObjId")(),e.osmId=t.id,e.latLng=L.latLng([t.lat,t.lon]),e.geometry=t.geometry,e.addEventListener("click",d,!1),e.addEventListener("contextmenu",c,!1),e.addEventListener("mouseenter",u,!1),e.addEventListener("mouseleave",v,!1)})}}()}})})}()},{"../L.TravelNotes":7,"../core/MapEditor":33,"../core/NoteEditor":34,"../core/OsmSearchEngine":35,"../data/ObjId":49,"./HTMLElementsFactory":15,"./Translator":25}],24:[function(n,t,e){!function(){"use strict";var d=n("../UI/Translator")(),r=0,c=function(t){t.stopPropagation();try{t.dataTransfer.setData("Text",t.target.dataObjId),t.dataTransfer.dropEffect="move"}catch(t){}r=t.target.dataObjId-1},a=function(t){t.preventDefault()},i=function(t){t.preventDefault();for(var e=t.target;!e.dataObjId;)e=e.parentElement;var o=e.getBoundingClientRect(),n=new Event("SortableListDrop");n.draggedObjId=r+1,n.targetObjId=e.dataObjId,n.draggedBefore=t.clientY-o.top<o.bottom-t.clientY,e.parentNode.dispatchEvent(n)},u=function(t){var e=new Event("SortableListDelete");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},v=function(t){var e=new Event("SortableListUpArrow");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},g=function(t){var e=new Event("SortableListDownArrow");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},p=function(t){var e=new Event("SortableListRightArrow");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},m=function(t){var e=new Event("SortableListChange");e.dataObjId=t.target.parentNode.dataObjId,e.changeValue=t.target.value,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},s=function(t){t.deltaY&&(t.target.scrollTop=t.target.scrollTop+10*t.deltaY),t.stopPropagation()},o=function(t,e){var l=n("./HTMLElementsFactory")();this.items=[],this.removeAllItems=function(){for(var t=0;t<this.items.length;t++)this.container.removeChild(this.items[t]);this.items.length=0},this.addItem=function(t,e,o,n,r){t=t||"",e=e||"",o=o||"",n=n||-1;var a=l.create("div",{draggable:!1,className:"TravelNotes-SortableList-Item"});l.create("div",{className:"TravelNotes-SortableList-ItemTextIndex",innerHTML:e},a);var i=l.create("input",{type:"text",className:"TravelNotes-SortableList-ItemInput",placeholder:o,value:t},a);i.addEventListener("change",m,!1),i.addEventListener("focus",function(t){t.target.parentElement.draggable=!1},!1),i.addEventListener("blur",function(t){t.target.parentElement.draggable=t.target.parentElement.canDrag},!1),l.create("div",{className:"TravelNotes-SortableList-ItemUpArrowButton",title:d.getText("SortableList - Move up"),innerHTML:String.fromCharCode(8679)},a).addEventListener("click",v,!1),l.create("div",{className:"TravelNotes-SortableList-ItemDownArrowButton",title:d.getText("SortableList - Move down"),innerHTML:String.fromCharCode(8681)},a).addEventListener("click",g,!1);var s=l.create("div",{className:"TravelNotes-SortableList-ItemRightArrowButton",title:d.getText("SortableList - Edit"),innerHTML:String.fromCharCode(8688)},a);"AllSort"===this.options.listStyle&&s.addEventListener("click",p,!1),l.create("div",{className:"TravelNotes-SortableList-ItemDeleteButton",title:d.getText("SortableList - Delete"),innerHTML:"&#x267b;"},a).addEventListener("click",u,!1),a.dataObjId=n,a.canDrag=!1,("LimitedSort"!==this.options.listStyle||1<this.items.length)&&!r&&(a.draggable=!0,a.addEventListener("dragstart",c,!1),a.classList.add("TravelNotes-SortableList-MoveCursor"),a.canDrag=!0),this.items.push(a),this.container.appendChild(a)},this._create=function(t,e){for(var o in this.options={minSize:2,listStyle:"AllSort",id:"TravelNotes-SortableList-Container"},t)this.options[o]=t[o];"LimitedSort"===this.options.listStyle&&this.options.minSize<2&&(this.options.minSize=0),this.container=l.create("div",{id:t.id,className:"TravelNotes-SortableList-Container"}),this.container.classList.add(this.options.listStyle),this.container.addEventListener("drop",i,!1),this.container.addEventListener("dragover",a,!1),this.container.addEventListener("wheel",s,!1),e&&e.appendChild(this.container);for(var n=0;n<this.options.minSize;n++)this.addItem()},this._create(t,e)};void 0!==t&&t.exports&&(t.exports=function(t,e){return new o(t,e)})}()},{"../UI/Translator":25,"./HTMLElementsFactory":15}],25:[function(t,e,o){(function(n){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){return n.translations||(n.translations=new Map),{setTranslations:function(t){t.forEach(function(t){n.translations.set(t.msgid,t.msgstr)})},getText:function(t,e){var o=n.translations.get(t);return e&&o&&Object.getOwnPropertyNames(e).forEach(function(t){o=o.replace("{"+t+"}",e[t])}),o||t}}})}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],26:[function(A,t,e){!function(){"use strict";var c=A("./Translator")(),u=A("../L.TravelNotes"),v=null,e=null,g=function(t){e&&(clearTimeout(e),e=null),document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Minimize"),document.getElementById("TravelNotes-Control-MainDiv").classList.add("TravelNotes-Control-MainDiv-Maximize")},o=function(){document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Maximize"),document.getElementById("TravelNotes-Control-MainDiv").classList.add("TravelNotes-Control-MainDiv-Minimize")},p=function(t){e=setTimeout(o,u.config.travelEditor.timeout)},m=function(t){t.stopPropagation(),document.getElementById("TravelNotes-Control-TravelHeaderDiv").classList.toggle("TravelNotes-Control-SmallHeader"),document.getElementById("TravelNotes-Control-TravelDataDiv").classList.toggle("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-ControlTravelButtonsDiv").classList.toggle("TravelNotes-Control-HiddenList");var e=document.getElementById("TravelNotes-Control-TravelDataDiv").classList.contains("TravelNotes-Control-HiddenList");document.getElementById("TravelNotes-ControlTravelExpandButton").innerHTML=e?"&#x25b6;":"&#x25bc;",document.getElementById("TravelNotes-ControlTravelExpandButton").title=e?c.getText("TravelEditorUI - Show"):c.getText("TravelEditorUI - Hide"),t.stopPropagation()},T=function(t){var e=document.getElementById("TravelNotes-Control-MainDiv");10060===t.target.innerHTML.charCodeAt(0)?(t.target.innerHTML="&#x1f4cc;",e.addEventListener("mouseenter",g,!1),e.addEventListener("mouseleave",p,!1)):(t.target.innerHTML="&#x274c;",e.removeEventListener("mouseenter",g,!1),e.removeEventListener("mouseleave",p,!1))},f=function(t){t.stopPropagation(),A("../core/TravelEditor")().removeRoute(t.itemNode.dataObjId)},N=function(t){t.stopPropagation(),A("../core/TravelEditor")().swapRoute(t.itemNode.dataObjId,!0)},I=function(t){t.stopPropagation(),A("../core/TravelEditor")().swapRoute(t.itemNode.dataObjId,!1)},L=function(t){t.stopPropagation(),A("../core/TravelEditor")().editRoute(t.itemNode.dataObjId)},h=function(t){t.stopPropagation(),A("../core/TravelEditor")().renameRoute(t.dataObjId,t.changeValue)},E=function(t){t.stopPropagation(),A("../core/TravelEditor")().routeDropped(t.draggedObjId,t.targetObjId,t.draggedBefore)},y=function(t){t.stopPropagation(),document.getElementById("TravelNotes-Control-TravelDataDiv").classList.toggle("TravelNotes-Control-ExpandedList");var e=document.getElementById("TravelNotes-Control-TravelDataDiv").classList.contains("TravelNotes-Control-ExpandedList");document.getElementById("TravelNotes-Control-ExpandRoutesListButton").innerHTML=e?"&#x25b3;":"&#x25bd;",document.getElementById("TravelNotes-Control-ExpandRoutesListButton").title=e?c.getText("TravelEditorUI - Reduce the list"):c.getText("TravelEditorUI - Expand the list")},b=function(t){t.stopPropagation(),A("../core/TravelEditor")().clear(),A("../L.TravelNotes").config.travelEditor.startupRouteEdition&&A("../core/RouteEditor")().editRoute(A("../L.TravelNotes").travel.routes.first.objId),A("../L.TravelNotes").map.fire("travelnotesfileloaded",{readOnly:!1,name:""})},C=function(t){t.stopPropagation(),A("../core/TravelEditor")().saveTravel()},D=function(t){t.stopPropagation(),A("../core/RouteEditor")().cancelEdition(),A("../core/FileLoader")().openLocalFile(t)},x=function(){A("../core/TravelEditor")().confirmClose()&&document.getElementById("TravelNotes-Control-OpenTravelInput").click()},M=function(t){t.stopPropagation(),A("../core/FileLoader")().mergeLocalFile(t)},R=function(t){document.getElementById("TravelNotes-Control-ImportTravelInput").click()},j=function(t){t.stopPropagation(),A("../core/TravelEditor")().addRoute()};void 0!==t&&t.exports&&(t.exports=function(){return Object.seal({createUI:function(t){!function(t){if(!document.getElementById("TravelNotes-Control-TravelDataDiv")){var e=A("./HTMLElementsFactory")(),o=e.create("div",{id:"TravelNotes-Control-TravelHeaderDiv",className:"TravelNotes-Control-HeaderDiv"},t);e.create("span",{innerHTML:"&#x25bc;",id:"TravelNotes-ControlTravelExpandButton",className:"TravelNotes-Control-ExpandButton"},o).addEventListener("click",m,!1),e.create("span",{innerHTML:c.getText("TravelEditorUI - Travel routes"),id:"TravelNotes-Control-TravelHeaderText",className:"TravelNotes-Control-HeaderText"},o);var n=e.create("span",{innerHTML:"&#x274c;",id:"TravelNotes-Control-PinButton"},o);n.addEventListener("click",T,!1);var r=e.create("div",{id:"TravelNotes-Control-TravelDataDiv",className:"TravelNotes-Control-DataDiv"},t);(v=A("./SortableList")({minSize:0,id:"TravelNotes-Control-TravelRoutesList"},r)).container.addEventListener("SortableListDelete",f,!1),v.container.addEventListener("SortableListUpArrow",N,!1),v.container.addEventListener("SortableListDownArrow",I,!1),v.container.addEventListener("SortableListRightArrow",L,!1),v.container.addEventListener("SortableListChange",h,!1),v.container.addEventListener("SortableListDrop",E,!1);var a=e.create("div",{id:"TravelNotes-ControlTravelButtonsDiv",className:"TravelNotes-Control-ButtonsDiv"},t);e.create("div",{id:"TravelNotes-Control-ExpandRoutesListButton",className:"TravelNotes-Control-Button",title:c.getText("TravelEditorUI - Expand the list"),innerHTML:"&#x25bd;"},a).addEventListener("click",y,!1),e.create("div",{id:"TravelNotes-Control-CancelTravelButton",className:"TravelNotes-Control-Button",title:c.getText("TravelEditorUI - Cancel travel"),innerHTML:"&#x274c"},a).addEventListener("click",b,!1),e.create("div",{id:"TravelNotes-Control-SaveTravelButton",className:"TravelNotes-Control-Button",title:c.getText("TravelEditorUI - Save travel"),innerHTML:"&#x1f4be;"},a).addEventListener("click",C,!1);var i=e.create("div",{id:"TravelNotes-Control-OpenTravelDiv"},a);e.create("input",{id:"TravelNotes-Control-OpenTravelInput",type:"file",accept:".trv"},i).addEventListener("change",D,!1);var s=e.create("div",{id:"TravelNotes-Control-OpenTravelFakeDiv"},i);e.create("div",{id:"TravelNotes-Control-OpenTravelButton",className:"TravelNotes-Control-Button",title:c.getText("TravelEditorUI - Open travel"),innerHTML:"&#x1F4C2;"},s).addEventListener("click",x,!1);var l=e.create("div",{id:"TravelNotes-Control-ImportTravelDiv"},a);e.create("input",{id:"TravelNotes-Control-ImportTravelInput",type:"file",accept:".trv,.map"},l).addEventListener("change",M,!1);var d=e.create("div",{id:"TravelNotes-Control-ImportTravelFakeDiv"},l);e.create("div",{id:"TravelNotes-Control-ImportTravelButton",className:"TravelNotes-Control-Button",title:c.getText("TravelEditorUI - Import travel"),innerHTML:"&#x1F30F;"},d).addEventListener("click",R,!1),e.create("div",{id:"TravelNotes-Control-OpenTravelRoadbookButton",className:"TravelNotes-Control-Button",title:c.getText("TravelEditorUI - Open travel roadbook"),innerHTML:'<a id="TravelNotes-Control-OpenTravelRoadbookLink" href="TravelNotesRoadbook.html?page='+u.UUID+'" target="_blank">&#x1F4CB;</a>'},a),e.create("div",{id:"TravelNotes-Control-AddRoutesButton",className:"TravelNotes-Control-Button",title:c.getText("TravelEditorUI - New route"),innerHTML:"+"},a).addEventListener("click",j,!1),u.config.travelEditor.startMinimized?(n.innerHTML="&#x1f4cc;",t.addEventListener("mouseenter",g,!1),t.addEventListener("mouseleave",p,!1),t.classList.add("TravelNotes-Control-MainDiv-Minimize")):t.classList.add("TravelNotes-Control-MainDiv-Maximize")}}(t)},setRoutesList:function(){!function(){v.removeAllItems();for(var t=u.travel.routes.iterator;!t.done;)v.addItem(t.value.name,t.value.chain?"&#x26d3;":"",c.getText("TravelEditorUI - Route"),t.value.objId,!1)}()}})})}()},{"../L.TravelNotes":7,"../core/FileLoader":31,"../core/RouteEditor":36,"../core/TravelEditor":39,"./HTMLElementsFactory":15,"./SortableList":24,"./Translator":25}],27:[function(d,t,e){!function(){"use strict";var n=0,r=function(t){t.stopPropagation();try{t.dataTransfer.setData("Text",t.target.dataObjId),t.dataTransfer.dropEffect="move"}catch(t){}n=t.target.noteObjId-1},a=function(t){t.preventDefault()},i=function(t){t.preventDefault();for(var e=t.target;!e.noteObjId;)e=e.parentElement;var o=e.getBoundingClientRect();d("../core/NoteEditor")().noteDropped(n+1,e.noteObjId,t.clientY-o.top<o.bottom-t.clientY)},s=function(t){t.stopPropagation(),t.preventDefault();for(var e=t.target;!e.noteObjId;)e=e.parentNode;d("../core/MapEditor")().zoomToNote(e.noteObjId)},l=function(t){t.stopPropagation(),t.preventDefault();for(var e=t.target;!e.noteObjId;)e=e.parentNode;d("../core/NoteEditor")().editNote(e.noteObjId)};void 0!==t&&t.exports&&(t.exports=function(){return Object.seal({remove:function(){!function(){var t=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(t){var e=t.firstChild;e&&(e.childNodes.forEach(function(t){t.removeEventListener("click",s,!1),t.removeEventListener("contextmenu",l,!1),t.removeEventListener("dragstart",r,!1)}),t.removeChild(e))}}()},add:function(){!function(){document.getElementById("TravelNotes-Control-ItineraryPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-TravelNotesPaneButton").classList.add("TravelNotes-Control-ActivePaneButton"),window.osmSearch&&document.getElementById("TravelNotes-Control-SearchPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton");var t=d("../UI/HTMLViewsFactory")();t.classNamePrefix="TravelNotes-Control-";var e=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(e){var o=t.travelNotesHTML;o.addEventListener("drop",i,!1),o.addEventListener("dragover",a,!1),e.appendChild(o),o.childNodes.forEach(function(t){t.addEventListener("click",s,!1),t.addEventListener("contextmenu",l,!1),t.draggable=!0,t.addEventListener("dragstart",r,!1),t.classList.add("TravelNotes-SortableList-MoveCursor")})}}()}})})}()},{"../UI/HTMLViewsFactory":16,"../core/MapEditor":33,"../core/NoteEditor":34}],28:[function(e,t,o){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){var t=document.getElementById("TravelNotes-Control-MainDiv");return t||(t=e("./HTMLElementsFactory")().create("div",{id:"TravelNotes-Control-MainDiv"}),e("./HTMLElementsFactory")().create("div",{id:"TravelNotes-Control-MainDiv-Title",innerHTML:"Travel&nbsp;&amp;&nbsp;Notes"},t),e("./TravelEditorUI")().createUI(t),e("./RouteEditorUI")().createUI(t),e("./DataPanesUI")().createUI(t),e("./ProvidersToolbarUI")().createUI(t),e("./ErrorEditorUI")().createUI(t),t.addEventListener("click",function(t){t.target.classList.contains("TravelNotes-SortableList-ItemInput")||t.target.id&&-1!==["TravelNotes-Control-OpenTravelInput","TravelNotes-Control-OpenTravelButton","TravelNotes-Control-ImportTravelInput","TravelNotes-Control-ImportTravelButton","TravelNotes-Control-OpenTravelRoadbookLink"].indexOf(t.target.id)||(t.stopPropagation(),t.preventDefault())},!1),t.addEventListener("dblclick",function(t){t.stopPropagation(),t.preventDefault()},!1),t.addEventListener("wheel",function(t){t.stopPropagation(),t.preventDefault()},!1)),{get UI(){return t}}})}()},{"./DataPanesUI":13,"./ErrorEditorUI":14,"./HTMLElementsFactory":15,"./ProvidersToolbarUI":20,"./RouteEditorUI":21,"./TravelEditorUI":26}],29:[function(t,e,o){arguments[4][9][0].apply(o,arguments)},{"../UI/Translator":25,"./HTMLElementsFactory":15,dup:9}],30:[function(e,t,o){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){return{showError:function(t){e("../UI/ErrorEditorUI")().message='<span class="TravelNotes-Control-Error">'+t+"</span>"},clear:function(){e("../UI/ErrorEditorUI")().message=""}}})}()},{"../UI/ErrorEditorUI":14}],31:[function(c,t,e){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){var n=c("../L.TravelNotes"),e=!1,o="",r=!1,a={},i=function(){a.routes.forEach(function(o){o.itinerary.itineraryPoints.latLngs=c("@mapbox/polyline").decode(o.itinerary.itineraryPoints.latLngs,6);var n=[],r=0;o.itinerary.itineraryPoints.latLngs.forEach(function(t){var e={};e.lat=t[0],e.lng=t[1],e.distance=o.itinerary.itineraryPoints.distances[r],e.objId=o.itinerary.itineraryPoints.objIds[r],e.objType=o.itinerary.itineraryPoints.objType,n.push(e),r++}),o.itinerary.itineraryPoints=n}),e?t():s()},t=function(){var t=c("../Data/Travel")();t.object=a;for(var e=t.routes.iterator;!e.done;)n.travel.routes.add(e.value);for(var o=t.notes.iterator;!o.done;)n.travel.notes.add(o.value);l()},s=function(){n.travel.object=a,""!==o&&(n.travel.name=o.substr(0,o.lastIndexOf("."))),n.travel.readOnly=r,l()},l=function(){var t=c("../core/MapEditor")();t.removeAllObjects();for(var e=n.travel.routes.iterator;!e.done;)t.addRoute(e.value,!0,!1,r);for(var o=n.travel.notes.iterator;!o.done;)t.addNote(o.value,r);t.zoomToTravel(),r?(document.getElementById("TravelNotes-Control-MainDiv").classList.add("TravelNotes-Control-MainDiv-Hidden"),document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Maximize"),document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Minimize")):(c("../UI/TravelEditorUI")().setRoutesList(),c("../core/TravelEditor")().updateRoadBook(!1)),n.map.fire("travelnotesfileloaded",{readOnly:r,name:n.travel.name})},d=function(t){o=t.target.files[0].name;var e=new FileReader;e.onload=function(t){try{a=JSON.parse(e.result),i()}catch(t){}},e.readAsText(t.target.files[0])};return Object.seal({openLocalFile:function(t){r=e=!1,d(t)},mergeLocalFile:function(t){r=!(e=!0),d(t)},openDistantFile:function(t){r=!0,a=t,i()}})})}()},{"../Data/Travel":5,"../L.TravelNotes":7,"../UI/TravelEditorUI":26,"../core/MapEditor":33,"../core/TravelEditor":39,"@mapbox/polyline":1}],32:[function(s,t,e){!function(){"use strict";var i=!1;void 0!==t&&t.exports&&(t.exports=function(){return{getAddress:function(t,e,o,n){if(!i){i=!0;var r="https://nominatim.openstreetmap.org/reverse?format=json&lat="+t+"&lon="+e+"&zoom=18&addressdetails=1&accept-language="+s("../L.TravelNotes").config.language,a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var t;i=!1;try{t=JSON.parse(this.responseText)}catch(t){return}var e="";void 0!==t.address.house_number&&(e+=t.address.house_number+" "),void 0!==t.address.road?e+=t.address.road+" ":void 0!==t.address.pedestrian&&(e+=t.address.pedestrian+" "),void 0!==t.address.village?e+=t.address.village:void 0!==t.address.town?e+=t.address.town:void 0!==t.address.city&&(e+=t.address.city),0===e.length&&(e+=t.address.country),o.call(null,e,n)}},a.open("GET",r,!0),a.send(null)}}}})}()},{"../L.TravelNotes":7}],33:[function(T,t,e){!function(){"use strict";var m=T("../L.TravelNotes");void 0!==t&&t.exports&&(t.exports=function(){var d=T("../Data/DataSearchEngine")(),c=function(t){var e=d.getRoute(t.target.objId),o=T("../core/RouteEditor")().getClosestLatLngDistance(e,[t.latlng.lat,t.latlng.lng]).distance;o+=e.chainedDistance,o=T("../util/Utilities")().formatDistance(o);var n=m.mapObjects.get(t.target.objId);n.closeTooltip();var r=d.getRoute(t.target.objId).name;r+=0===r.length?"":" - ",r+=o,n.setTooltipContent(r),n.openTooltip(t.latlng)},u=function(t,e){e.objId=t,e.addTo(m.map),m.mapObjects.set(t,e)},a=function(t){var e=m.mapObjects.get(t);e&&(L.DomEvent.off(e),m.map.removeLayer(e),m.mapObjects.delete(t))},s=function(t){var e=L.latLng([90,180]),o=L.latLng([-90,-180]);return t.forEach(function(t){e.lat=Math.min(e.lat,t[0]),e.lng=Math.min(e.lng,t[1]),o.lat=Math.max(o.lat,t[0]),o.lng=Math.max(o.lng,t[1])}),L.latLngBounds(e,o)},n=function(t){var e=[];return t.itinerary.itineraryPoints.forEach(function(t){e.push(t.latLng)}),t.notes.forEach(function(t){e.push(t.latLng),e.push(t.iconLatLng)}),e},v=function(t){t.dashArray>=m.config.route.dashChoices.length&&(t.dashArray=0);var e=m.config.route.dashChoices[t.dashArray].iDashArray;if(e){var o="",n=0;for(n=0;n<e.length-1;n++)o+=e[n]*t.width+",";return o+=e[n]*t.width}return null},r=function(t){m.map.setView(t,m.config.itineraryPointZoom)},g=function(t,e){if(0!==t.lat||0!==t.lng){var o='<div class="TravelNotes-WayPoint TravelNotes-WayPoint'+("A"===e?"Start":"B"===e?"End":"Via")+'"></div><div class="TravelNotes-WayPointText">'+e+"</div>",n=L.marker(t.latLng,{icon:L.divIcon({iconSize:[40,40],iconAnchor:[20,40],html:o,className:"TravelNotes-WayPointStyle"}),draggable:!0});n.bindTooltip(function(t){return d.getWayPoint(t.objId).UIName}),n.getTooltip().options.offset=[20,-20],L.DomEvent.on(n,"contextmenu",function(t){T("../UI/ContextMenu")(t,T("../UI/ContextMenuFactory")().getWayPointContextMenu(t.target.objId))}),n.objId=t.objId,u(t.objId,n),L.DomEvent.on(n,"dragend",function(t){m.editedRoute.wayPoints.getAt(t.target.objId).latLng=[t.target.getLatLng().lat,t.target.getLatLng().lng],T("../core/WaypointEditor")().wayPointDragEnd(t.target.objId)})}},p=function(t,e){e=e||!1;var o=L.marker(t.latLng,{icon:L.divIcon({iconSize:[m.config.note.grip.size,m.config.note.grip.size],iconAnchor:[m.config.note.grip.size/2,m.config.note.grip.size/2],html:"<div></div>"}),zIndexOffset:-1e3,opacity:m.config.note.grip.opacity,draggable:!e});o.objId=t.objId,e||(L.DomEvent.on(o,"dragend",function(t){var e=d.getNoteAndRoute(t.target.objId),o=e.note,n=e.route,r=m.mapObjects.get(t.target.objId);if(null!=n){var a=T("../core/RouteEditor")().getClosestLatLngDistance(n,[t.target.getLatLng().lat,t.target.getLatLng().lng]);o.latLng=a.latLng,o.distance=a.distance,n.notes.sort(function(t,e){return t.distance-e.distance}),r.getLayer(r.bulletId).setLatLng(a.latLng),T("../UI/DataPanesUI")().updateItinerary()}else o.latLng=[t.target.getLatLng().lat,t.target.getLatLng().lng],T("../UI/DataPanesUI")().updateTravelNotes();r.getLayer(r.polylineId).setLatLngs([o.latLng,o.iconLatLng]),T("../core/TravelEditor")().updateRoadBook()}),L.DomEvent.on(o,"drag",function(t){var e=d.getNoteAndRoute(t.target.objId).note,o=m.mapObjects.get(t.target.objId);o.getLayer(o.polylineId).setLatLngs([[t.latlng.lat,t.latlng.lng],e.iconLatLng])}));var n=L.divIcon({iconSize:[t.iconWidth,t.iconHeight],iconAnchor:[t.iconWidth/2,t.iconHeight/2],popupAnchor:[0,-t.iconHeight/2],html:t.iconContent,className:m.config.note.style}),r=L.marker(t.iconLatLng,{icon:n,draggable:!e});r.objId=t.objId,r.bindPopup(function(t){var e=d.getNoteAndRoute(t.objId).note;return T("../core/NoteEditor")().getNoteHTML(e,"TravelNotes-")}),0!==t.tooltipContent.length&&(r.bindTooltip(function(t){return d.getNoteAndRoute(t.objId).note.tooltipContent}),r.getTooltip().options.offset[0]=t.iconWidth/2),e||(L.DomEvent.on(r,"contextmenu",function(t){T("../UI/ContextMenu")(t,T("../UI/ContextMenuFactory")().getNoteContextMenu(t.target.objId))}),L.DomEvent.on(r,"dragend",function(t){var e=d.getNoteAndRoute(t.target.objId).note;e.iconLatLng=[t.target.getLatLng().lat,t.target.getLatLng().lng];var o=m.mapObjects.get(t.target.objId);o.getLayer(o.polylineId).setLatLngs([e.latLng,e.iconLatLng])}),L.DomEvent.on(r,"drag",function(t){var e=d.getNoteAndRoute(t.target.objId).note,o=m.mapObjects.get(t.target.objId);o.getLayer(o.polylineId).setLatLngs([e.latLng,[t.latlng.lat,t.latlng.lng]])}));var a=L.polyline([t.latLng,t.iconLatLng],m.config.note.polyline);a.objId=t.objId;var i=L.layerGroup([r,a,o]);i.markerId=L.Util.stamp(r),i.polylineId=L.Util.stamp(a),i.bulletId=L.Util.stamp(o),u(t.objId,i)};return Object.seal({removeRoute:function(t,e,o){!function(t,e,o){if(a(t.objId),e)for(var n=t.notes.iterator;!n.done;)a(n.value.objId);if(o)for(var r=t.wayPoints.iterator;!r.done;)a(r.value.objId)}(t,e,o)},addRoute:function(t,e,o,n){!function(t,e,o,n){n=n||!1;for(var r=[],a=t.itinerary.itineraryPoints.iterator;!a.done;)r.push(a.value.latLng);var i=L.polyline(r,{color:t.color,weight:t.width,dashArray:v(t)});if(u(t.objId,i),i.bindTooltip(t.name,{sticky:!0,direction:"right"}),i.on("mouseover",c),i.on("mousemove",c),i.bindPopup(function(t){var e=d.getRoute(t.objId);return T("../core/RouteEditor")().getRouteHTML(e,"TravelNotes-")}),L.DomEvent.on(i,"click",function(t){t.target.openPopup(t.latlng)}),n||L.DomEvent.on(i,"contextmenu",function(t){T("../UI/ContextMenu")(t,T("../UI/ContextMenuFactory")().getRouteContextMenu(t.target.objId))}),e)for(var s=t.notes.iterator;!s.done;)p(s.value,n);if(o)for(var l=m.editedRoute.wayPoints.iterator;!l.done;)g(l.value,l.first?"A":l.last?"B":l.index)}(t,e,o,n)},editRoute:function(t){var e;e=t,m.mapObjects.get(e.objId).setStyle({color:e.color,weight:e.width,dashArray:v(e)})},removeObject:function(t){a(t)},removeAllObjects:function(){m.mapObjects.forEach(function(t,e,o){L.DomEvent.off(t),m.map.removeLayer(t)}),m.mapObjects.clear()},zoomToPoint:function(t){r(t)},zoomToSearchResult:function(t,e){!function(t,e){if(e){var o=[];e.forEach(function(t){o=o.concat(t)}),m.map.fitBounds(s(o))}else r(t)}(t,e)},zoomToNote:function(t){var e;e=t,r(d.getNoteAndRoute(e).note.iconLatLng)},zoomToRoute:function(t){var e,o;e=t,0!==(o=n(d.getRoute(e))).length&&m.map.fitBounds(s(o))},zoomToTravel:function(){var e;e=[],m.travel.routes.forEach(function(t){e=e.concat(n(t))}),m.travel.notes.forEach(function(t){e.push(t.latLng),e.push(t.iconLatLng)}),0!==e.length&&m.map.fitBounds(s(e))},addItineraryPointMarker:function(t,e){var o;o=e,u(t,L.circleMarker(o,m.config.itineraryPointMarker))},addSearchPointMarker:function(t,e,o){!function(t,e,o){var n=!1;if(o){var r=[];o.forEach(function(t){r=r.concat(t)});var a=s(r),i=m.map.getBounds();n=.01<(a.getEast()-a.getWest())/(i.getEast()-i.getWest())&&.01<(a.getNorth()-a.getSouth())/(i.getNorth()-i.getSouth())}u(t,n?L.polyline(o,m.config.searchPointPolyline):L.circleMarker(e,m.config.searchPointMarker))}(t,e,o)},addRectangle:function(t,e,o){var n,r;n=e,r=o,u(t,L.rectangle(n,r))},addWayPoint:function(t,e){g(t,e)},redrawNote:function(t){var e;a((e=t).objId),p(e)},addNote:function(t,e){p(t,e)},editNote:function(t){var e,o,n,r;e=t,o=L.divIcon({iconSize:[e.iconWidth,e.iconHeight],iconAnchor:[e.iconWidth/2,e.iconHeight/2],popupAnchor:[0,-e.iconHeight/2],html:e.iconContent,className:m.config.note.style}),n=m.mapObjects.get(e.objId),(r=n.getLayer(n.markerId)).setIcon(o),r.unbindTooltip(),0!==e.tooltipContent.length&&(r.bindTooltip(function(t){return d.getNoteAndRoute(t.objId).note.tooltipContent}),r.getTooltip().options.offset[0]=e.iconWidth/2),r.isPopupOpen()&&(r.closePopup(),r.openPopup())}})})}()},{"../Data/DataSearchEngine":2,"../L.TravelNotes":7,"../UI/ContextMenu":11,"../UI/ContextMenuFactory":12,"../UI/DataPanesUI":13,"../core/NoteEditor":34,"../core/RouteEditor":36,"../core/TravelEditor":39,"../core/WaypointEditor":40,"../util/Utilities":57}],34:[function(c,t,e){!function(){"use strict";var d=c("../L.TravelNotes");void 0!==t&&t.exports&&(t.exports=function(){var r=c("../UI/Translator")(),l=c("../Data/DataSearchEngine")(),s=function(t){var e=c("../data/Note")();return e.latLng=t,e.iconLatLng=t,e},o=function(){for(var t=d.travel.notes.iterator;!t.done;)c("../core/MapEditor")().removeObject(t.value.objId);for(var e=d.travel.routes.iterator;!e.done;)for(t=e.value.notes.iterator;!t.done;)c("../core/MapEditor")().removeObject(t.value.objId)};return Object.seal({newRouteNote:function(t,e){var o,n,r,a;o=t,n=e,r=c("../core/RouteEditor")().getClosestLatLngDistance(l.getRoute(o),[n.latlng.lat,n.latlng.lng]),(a=s(r.latLng)).distance=r.distance,c("../UI/NoteDialog")(a,o,!0)},newSearchNote:function(t){var e,o;(o=s([(e=t).lat,e.lon])).address=(e.tags["addr:housenumber"]?e.tags["addr:housenumber"]+" ":"")+(e.tags["addr:street"]?e.tags["addr:street"]+" ":"")+(e.tags["addr:city"]?e.tags["addr:city"]+" ":""),o.url=e.tags.website||"",o.phone=e.tags.phone||"",o.tooltipContent=e.tags.name||"",o.popupContent=e.tags.name||"",c("../UI/NoteDialog")(o,-1,!0)},newManeuverNote:function(t,e){var o,n,r,a,i;o=t,n=e,r=c("../core/RouteEditor")().getClosestLatLngDistance(d.editedRoute,n),a=d.editedRoute.itinerary.maneuvers.getAt(o),(i=s(n)).distance=r.distance,i.iconContent="<div class='TravelNotes-ManeuverNote TravelNotes-ManeuverNote-"+a.iconName+"'></div>",i.popupContent=a.instruction,i.iconWidth=40,i.iconHeight=40,c("../UI/NoteDialog")(i,d.editedRoute.objId,!0)},newTravelNote:function(t){var e;e=s(t),c("../UI/NoteDialog")(e,-1,!0)},afterNoteDialog:function(t,e){!function(t,e){var o=l.getNoteAndRoute(t.objId);if(o.note)c("../core/MapEditor")().editNote(t),o.route?c("../UI/DataPanesUI")().setItinerary():c("../UI/DataPanesUI")().setTravelNotes();else{if(-1===e)d.travel.notes.add(t),c("../UI/DataPanesUI")().setTravelNotes();else{var n=l.getRoute(e);n.notes.add(t),t.chainedDistance=n.chainedDistance,n.notes.sort(function(t,e){return t.distance-e.distance}),c("../UI/DataPanesUI")().setItinerary()}c("../core/MapEditor")().addNote(t)}c("../core/TravelEditor")().updateRoadBook()}(t,e)},editNote:function(t){var e,o;e=t,o=l.getNoteAndRoute(e),c("../UI/NoteDialog")(o.note,null===o.route?-1:o.route.objId,!1)},removeNote:function(t){!function(t){c("../core/MapEditor")().removeObject(t);var e=l.getNoteAndRoute(t);e.route?(e.route.notes.remove(t),c("../UI/DataPanesUI")().updateItinerary()):(d.travel.notes.remove(t),c("../UI/DataPanesUI")().updateTravelNotes()),c("../core/TravelEditor")().updateRoadBook()}(t)},hideNotes:function(){o()},showNotes:function(){!function(){o();for(var t=d.travel.notes.iterator;!t.done;)c("../core/MapEditor")().addNote(t.value);for(var e=d.travel.routes.iterator;!e.done;)for(t=e.value.notes.iterator;!t.done;)c("../core/MapEditor")().addNote(t.value)}()},zoomToNote:function(t){var e;e=t,c("../core/MapEditor")().zoomToPoint(l.getNoteAndRoute(e).note.latLng)},attachNoteToRoute:function(t){var e,n,r,a,i,s;e=t,n=l.getNoteAndRoute(e),r=Number.MAX_VALUE,s=i=a=null,d.travel.routes.forEach(function(t){var e=c("../core/RouteEditor")().getClosestLatLngDistance(t,n.note.latLng);if(e){var o=L.latLng(n.note.latLng).distanceTo(L.latLng(e.latLng));o<r&&(r=o,a=t,i=e.latLng,s=e.distance)}}),a&&(d.travel.notes.remove(e),n.note.distance=s,n.note.latLng=i,n.note.chainedDistance=a.chainedDistance,a.notes.add(n.note),a.notes.sort(function(t,e){return t.distance-e.distance}),c("../core/MapEditor")().redrawNote(n.note),c("../UI/DataPanesUI")().updateItinerary(),c("../UI/DataPanesUI")().updateTravelNotes(),c("../core/TravelEditor")().updateRoadBook())},detachNoteFromRoute:function(t){var e,o;e=t,(o=l.getNoteAndRoute(e)).route.notes.remove(e),o.note.distance=-1,o.note.chainedDistance=0,d.travel.notes.add(o.note),c("../UI/DataPanesUI")().updateItinerary(),c("../UI/DataPanesUI")().updateTravelNotes(),c("../core/TravelEditor")().updateRoadBook()},noteDropped:function(t,e,o){var n,r,a;n=t,r=e,a=o,d.travel.notes.moveTo(n,r,a),c("../UI/DataPanesUI")().updateTravelNotes(),c("../core/TravelEditor")().updateRoadBook()},getNoteHTML:function(t,e){return function(t,e){var o="";0!==t.tooltipContent.length&&(o+='<div class="'+e+'NoteHtml-TooltipContent">'+t.tooltipContent+"</div>"),0!==t.popupContent.length&&(o+='<div class="'+e+'NoteHtml-PopupContent">'+t.popupContent+"</div>"),0!==t.address.length&&(o+='<div class="'+e+'NoteHtml-Address">'+r.getText("NoteEditor - Address")+t.address+"</div>"),0!==t.phone.length&&(o+='<div class="'+e+'NoteHtml-Phone">'+r.getText("NoteEditor - Phone")+t.phone+"</div>"),0!==t.url.length&&(o+='<div class="'+e+'NoteHtml-Url">'+r.getText("NoteEditor - Link")+'<a href="'+t.url+'" target="_blank">'+t.url.substr(0,40)+"...</a></div>");var n=c("../util/Utilities")();return o+='<div class="'+e+'NoteHtml-LatLng">'+r.getText("NoteEditor - Latitude Longitude",{lat:n.formatLat(t.lat),lng:n.formatLng(t.lng)})+"</div>",-1!==t.distance&&(o+='<div class="'+e+'NoteHtml-Distance">'+r.getText("NoteEditor - Distance",{distance:n.formatDistance(t.chainedDistance+t.distance)})+"</div>"),o}(t,e)}})})}()},{"../Data/DataSearchEngine":2,"../L.TravelNotes":7,"../UI/DataPanesUI":13,"../UI/NoteDialog":19,"../UI/Translator":25,"../core/MapEditor":33,"../core/RouteEditor":36,"../core/TravelEditor":39,"../data/Note":48,"../util/Utilities":57}],35:[function(c,u,t){!function(){"use strict";var o=c("../L.TravelNotes"),e=!1,n={searchPhrase:"",bbox:null},t=-1,r=-1,a=window.osmSearch?window.osmSearch.searchLimits:null,i=function(){n.bbox&&(-1!==t?c("../core/MapEditor")().removeObject(t):t=c("../data/ObjId")(),c("../core/MapEditor")().addRectangle(t,L.latLngBounds(n.bbox.southWest,n.bbox.northEast),o.config.previousSearchLimit))},s=function(t){o.searchData=t,e=!1,i(),c("../UI/DataPanesUI")().updateSearch()},l=function(t){console.log(t),e=!1},d=function(t){var e=o.map.getCenter();-1!==r?c("../core/MapEditor")().removeObject(r):r=c("../data/ObjId")(),c("../core/MapEditor")().addRectangle(r,L.latLngBounds(L.latLng(e.lat-a.lat,e.lng-a.lng),L.latLng(e.lat+a.lat,e.lng+a.lng)),o.config.nextSearchLimit)};void 0!==u&&u.exports&&(u.exports=function(){return Object.seal({search:function(){!function(){if(!e){e=!0;var t=o.map.getBounds();n={bbox:{southWest:t.getSouthWest(),northEast:t.getNorthEast()},searchPhrase:document.getElementById("TravelNotes-Control-SearchInput").value},o.searchData=[],window.osmSearch.getSearchPromise(n).then(s,l)}}()},show:function(){o.map.on("zoom",d),o.map.on("move",d),d(),i()},hide:function(){o.map.off("zoom",d),o.map.off("move",d),-1!==r&&(c("../core/MapEditor")().removeObject(r),r=-1),-1!==t&&(c("../core/MapEditor")().removeObject(t),t=-1)}})})}()},{"../L.TravelNotes":7,"../UI/DataPanesUI":13,"../core/MapEditor":33,"../data/ObjId":49}],36:[function(v,t,e){!function(){"use strict";var c=v("../L.TravelNotes"),s=!1;void 0!==t&&t.exports&&(t.exports=function(){var n=v("../Data/DataSearchEngine")(),i=v("../UI/Translator")(),r=(v("../core/NoteEditor")(),v("../core/MapEditor")()),o=v("../UI/RouteEditorUI")(),u=function(t,e){if(0===t.itinerary.itineraryPoints.length)return null;for(var o=t.itinerary.itineraryPoints.iterator,n=(o.done,Number.MAX_VALUE),r=L.Projection.SphericalMercator.project(L.latLng(e[0],e[1])),a=L.Projection.SphericalMercator.project(L.latLng(o.value.lat,o.value.lng)),i=null,s=0,l=o.value.distance;!o.done;){var d=L.Projection.SphericalMercator.project(L.latLng(o.value.lat,o.value.lng)),c=L.LineUtil.pointToSegmentDistance(r,a,d);c<n&&(n=c,s=l-(i=L.Projection.SphericalMercator.unproject(L.LineUtil.closestPointOnSegment(r,a,d))).distanceTo(L.latLng(o.value.lat,o.value.lng))),l+=o.value.distance,a=d}return{latLng:[i.lat,i.lng],distance:s}},a=function(){for(var t=c.travel.routes.iterator,e=0;!t.done;){t.value.chain?(t.value.chainedDistance=e,e+=t.value.distance):t.value.chainedDistance=0;for(var o=t.value.notes.iterator;!o.done;)o.value.chainedDistance=t.value.chainedDistance}},e=function(){r.removeRoute(c.editedRoute,!0,!0),-1!==c.routeEdition.routeInitialObjId&&r.addRoute(n.getRoute(c.routeEdition.routeInitialObjId),!0,!1),c.editedRoute=v("../data/Route")(),c.routeEdition.routeChanged=!1,c.routeEdition.routeInitialObjId=-1,v("../UI/TravelEditorUI")().setRoutesList(),o.setWayPointsList(),o.reduce(),v("../UI/DataPanesUI")().setItinerary(),a(),v("../core/TravelEditor")().updateRoadBook()};return Object.seal({cutRoute:function(t,e){return function(t,e){var o=[v("../data/Route")(),v("../data/Route")()];o[0].object=t.object,o[1].object=t.object,o[0].itinerary.itineraryPoints.removeAll(),o[1].itinerary.itineraryPoints.removeAll();for(var n,r=u(t,e),a=t.itinerary.itineraryPoints.iterator,i=0,s=null,l=0;!a.done;){if((n=v("../data/ItineraryPoint")()).object=a.value.object,0===l&&0!=i&&i>r.distance){var d=L.latLng(r.latLng).distanceTo(L.latLng(a.value.latLng)),c=v("../data/ItineraryPoint")();c.latLng=r.latLng,o[0].itinerary.itineraryPoints.add(c),o[0].distance=i-d,s&&(s.distance-=d),l=1,(c=v("../data/ItineraryPoint")()).latLng=r.latLng,c.distance=d,o[1].itinerary.itineraryPoints.add(c),i=d}o[l].itinerary.itineraryPoints.add(n),i+=a.value.distance,s=n}return o[l].distance=i,o}(t,e)},computeRouteDistances:function(t){!function(t){var e=t.itinerary.itineraryPoints.iterator,o=t.itinerary.maneuvers.iterator;e.done,o.done;var n=e.value,r=o.value;for(r.distance=0,o.done,t.distance=0,t.duration=0;!e.done;)n.distance=L.latLng(n.latLng).distanceTo(L.latLng(e.value.latLng)),o.value.itineraryPointObjId===e.value.objId&&(t.duration+=r.duration,r=o.value,o.value.distance=0,o.done),t.distance+=n.distance,r.distance+=n.distance,n=e.value}(t)},getClosestLatLngDistance:function(t,e){return u(t,e)},saveGpx:function(){!function(){var t="\n\t",e="\n\t\t",o="time='"+(new Date).toISOString()+"' ",n="<?xml version='1.0'?>\n";n+="<gpx xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xsi:schemaLocation='http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd' version='1.1' creator='leaflet.TravelNotes'>";for(var r=c.editedRoute.wayPoints.iterator;!r.done;)n+=t+"<wpt lat='"+r.value.lat+"' lon='"+r.value.lng+"' "+o+"/>";n+=t+"<rte>";for(var a=c.editedRoute.itinerary.maneuvers.iterator;!a.done;){var i=c.editedRoute.itinerary.itineraryPoints.getAt(a.value.itineraryPointObjId),s=a.value.instruction.replace("&","&amp;").replace("'","&apos;").replace('"',"&quote;").replace(">","&gt;").replace("<","&lt;");n+=e+"<rtept lat='"+i.lat+"' lon='"+i.lng+"' "+o+"desc='"+s+"' />"}n+=t+"</rte>",n+=t+"<trk>",n+=e+"<trkseg>";for(var l=c.editedRoute.itinerary.itineraryPoints.iterator;!l.done;)n+="\n\t\t\t<trkpt lat='"+l.value.lat+"' lon='"+l.value.lng+"' "+o+" />";n+=e+"</trkseg>",n+=t+"</trk>",n+="\n</gpx>";var d=c.editedRoute.name;""===d&&(d="TravelNote"),d+=".gpx",v("../util/Utilities")().saveFile(d,n)}()},getRouteHTML:function(t,e){return o=t,n=e,r=v("../util/Utilities")(),a='<div class="'+n+'Route-Header-Name">'+o.name+"</div>",0!==o.distance&&(a+='<div class="'+n+'Route-Header-Distance">'+i.getText("RouteEditor - Distance",{distance:r.formatDistance(o.distance)})+'</div><div class="'+n+'Route-Header-Duration">'+i.getText("RouteEditor - Duration",{duration:r.formatTime(o.duration)})+"</div>"),a;var o,n,r,a},chainRoutes:function(){a()},startRouting:function(){c.config.routing.auto&&(s=0===c.editedRoute.itinerary.itineraryPoints.length,v("../core/Router")().startRouting(c.editedRoute))},endRouting:function(){!function(){r.removeRoute(c.editedRoute,!0,!0);for(var t=c.editedRoute.notes.iterator;!t.done;){var e=u(c.editedRoute,t.value.latLng);t.value.latLng=e.latLng,t.value.distance=e.distance}c.editedRoute.notes.sort(function(t,e){return t.distance-e.distance}),r.addRoute(c.editedRoute,!0,!0),s&&r.zoomToRoute(c.editedRoute.objId),v("../UI/DataPanesUI")().setItinerary(),o.setWayPointsList(),a(),v("../core/TravelEditor")().updateRoadBook()}()},saveEdition:function(){var t;(t=v("../data/Route")()).object=c.editedRoute.object,c.travel.routes.replace(c.routeEdition.routeInitialObjId,t),c.routeEdition.routeInitialObjId=t.objId,e()},cancelEdition:function(){e()},routeProperties:function(t){var e,o;e=t,o=n.getRoute(e),v("../UI/RoutePropertiesDialog")(o)},hideRoute:function(t){var e,o;e=t,(o=n.getRoute(e))&&(r.removeRoute(o,!0,!0),o.hidden=!0)},showRoutes:function(){!function(){for(var t=c.travel.routes.iterator;!t.done;)t.value.hidden&&r.addRoute(t.value,!0,!0,!1)}()}})})}()},{"../Data/DataSearchEngine":2,"../L.TravelNotes":7,"../UI/DataPanesUI":13,"../UI/RouteEditorUI":21,"../UI/RoutePropertiesDialog":22,"../UI/Translator":25,"../UI/TravelEditorUI":26,"../core/MapEditor":33,"../core/NoteEditor":34,"../core/Router":37,"../core/TravelEditor":39,"../data/ItineraryPoint":46,"../data/Route":51,"../util/Utilities":57}],37:[function(a,t,e){!function(){"use strict";var n=!1,r=a("../L.TravelNotes");void 0!==t&&t.exports&&(t.exports=function(){var e=function(t){n=!1,a("../core/ErrorEditor")().showError(t)},o=function(t){n=!1,a("./RouteEditor")().computeRouteDistances(r.editedRoute);for(var e=r.editedRoute.wayPoints.iterator;!e.done;)e.first?e.value.latLng=r.editedRoute.itinerary.itineraryPoints.first.latLng:e.last?e.value.latLng=r.editedRoute.itinerary.itineraryPoints.last.latLng:e.value.latLng=a("./RouteEditor")().getClosestLatLngDistance(r.editedRoute,e.value.latLng).latLng;a("./RouteEditor")().endRouting()},t=function(){if(n)return!1;if(!r.editedRoute.wayPoints.forEach(function(t,e){return null===e&&(e=!0),e&=0!==t.lat&&0!==t.lng}))return!1;n=!0;var t=r.providers.get(r.routing.provider);return r.editedRoute.itinerary.provider=t.name,r.editedRoute.itinerary.transitMode=r.routing.transitMode,t.getPromiseRoute(r.editedRoute,null).then(o,e),!0};return Object.seal({startRouting:function(){return t()}})})}()},{"../L.TravelNotes":7,"../core/ErrorEditor":30,"./RouteEditor":36}],38:[function(t,e,o){!function(){"use strict";var C=t("../L.TravelNotes"),D=!1;void 0!==e&&e.exports&&(e.exports=function(){var p=L.latLng(0,0),m=0,n=null,a={},r=0,i=[],s="",l=new Map,d=new Map,c=null,T=L.point(0,0),f="",N=0,I=0,h=t("../L.TravelNotes").config.note.svgIconWidth,E=t("../Data/DataSearchEngine")(),u=function(t){D=!1},v=function(t){D=!1,n({svg:c.outerHTML,direction:I})},g=function(t,e){l.clear(),d.clear(),a.elements.forEach(function(t){switch(t.type){case"way":t.nodesIds=t.nodes,delete t.nodes,l.set(t.id,t);break;case"node":d.set(t.id,t)}}),(c=document.createElementNS("http://www.w3.org/2000/svg","svg")).setAttributeNS(null,"viewBox",h/4+" "+h/4+" "+h/2+" "+h/2);var o,n=document.createElementNS("http://www.w3.org/2000/svg","rect");n.setAttributeNS(null,"class","TravelNotes-SvgIcon-Background"),n.setAttributeNS(null,"width",h.toFixed(0)),n.setAttributeNS(null,"height",h.toFixed(0)),c.appendChild(n),(o=document.createElementNS("http://www.w3.org/2000/svg","polyline")).setAttributeNS(null,"points",f),o.setAttributeNS(null,"fill","none"),o.setAttributeNS(null,"stroke","red"),o.setAttributeNS(null,"stroke-width","6"),o.setAttributeNS(null,"transform","rotate("+N+","+h/2+","+h/2+")"),c.appendChild(o),l.forEach(function(t){var n="";t.nodesIds.forEach(function(t){var e=d.get(t),o=C.map.project(L.latLng(e.lat,e.lon),17).add(T);n+=o.x.toFixed(0)+","+o.y.toFixed(0)+" "});var e=document.createElementNS("http://www.w3.org/2000/svg","polyline");e.setAttributeNS(null,"points",n),e.setAttributeNS(null,"class","TravelNotes-OSM-Highway TravelNotes-OSM-Highway-"+t.tags.highway),e.setAttributeNS(null,"transform","rotate("+N+","+h/2+","+h/2+")"),c.appendChild(e)});var r=document.createElementNS("http://www.w3.org/2000/svg","rect");r.setAttributeNS(null,"class","TravelNotes-SvgIcon-Foreground"),r.setAttributeNS(null,"width",h.toFixed(0)),r.setAttributeNS(null,"height",h.toFixed(0)),c.appendChild(r),t("")},y=function(t,e){var o=new XMLHttpRequest;o.timeout=5e3,o.ontimeout=function(t){e("TimeOut error")},o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status){try{a=JSON.parse(o.responseText)}catch(t){e("JSON parsing error")}t(new Promise(i[r++]))}else e("Status : "+this.status+" statusText : "+this.statusText)},o.open("GET",s,!0),o.overrideMimeType("application/json"),o.send(null)},b=function(t,e,o){if(D)return!1;D=!0,p=L.latLng(t),m=e,n=o,a={},c=null,function(){var t=E.getRoute(m);if(t){var o=Number.MAX_VALUE,n=-1,r=0,e=t.itinerary.itineraryPoints.object;e.forEach(function(t){var e=p.distanceTo(L.latLng(t.lat,t.lng));e<o&&(o=e,n=r),r++}),p=L.latLng(t.itinerary.itineraryPoints.getAt(e[n].objId).latLng),T=L.point(h/2,h/2).subtract(C.map.project(p,17)),r=n-1;for(var a=0;0<=r&&a<100;)a+=e[r].distance,r--;var i=r;for(r=n-1,a=0;0<=r&&a<10;)a+=e[r].distance,r--;var s=r,l=C.map.project(L.latLng(e[n].lat,e[n].lng),17).add(T),d=C.map.project(L.latLng(e[s].lat,e[s].lng),17).add(T);for((N=180*Math.atan((l.y-d.y)/(d.x-l.x))/Math.PI)<0&&(N+=360),N-=270,d.x-l.x<0&&(N+=180),r=n,a=0;r<n+1||r<e.length&&a<100;)a+=e[r].distance,r++;var c=r;for(r=n,a=0;r<n+1||r<e.length&&a<10;)a+=e[r].distance,r++;var u=r,v=C.map.project(L.latLng(e[u].lat,e[u].lng),17).add(T);for(I=180*Math.atan((l.y-v.y)/(v.x-l.x))/Math.PI,v.x-l.x<0&&(I+=180),I-=N;I<0;)I+=360;for(;360<I;)I-=360;for(console.log("m_direction = "+I),f="",r=i;r<=c;r++){var g=C.map.project(L.latLng(e[r].lat,e[r].lng),17).add(T);f+=g.x.toFixed(0)+","+g.y.toFixed(0)+" "}}}(),s="https://lz4.overpass-api.de/api/interpreter?data=[out:json];way[highway](around:"+h+","+p.lat.toFixed(6)+","+p.lng.toFixed(6)+")->.a;(.a >;.a;);out;",r=0,(i=[]).push(y),i.push(g),new Promise(i[r++]).then(v,u)};return Object.seal({getSvgIcon:function(t,e,o){return b(t,e,o)}})})}()},{"../Data/DataSearchEngine":2,"../L.TravelNotes":7}],39:[function(c,t,e){!function(){"use strict";var d=c("../L.TravelNotes"),o=!1,n=!1;void 0!==t&&t.exports&&(t.exports=function(){var i=c("../UI/Translator")(),s=c("../UI/TravelEditorUI")(),l=function(t){if(n||(window.addEventListener("unload",function(t){localStorage.removeItem(c("../L.TravelNotes").UUID+"-TravelNotesHTML")}),n=!0),t||o||!d.config.haveBeforeUnloadWarning||(window.addEventListener("beforeunload",function(t){return t.returnValue="x"}),o=!0),c("../util/Utilities")().storageAvailable("localStorage")){var e=c("../UI/HTMLViewsFactory")();e.classNamePrefix="TravelNotes-Roadbook-",localStorage.setItem(d.UUID+"-TravelNotesHTML",e.travelHTML.outerHTML)}},t=function(){return!o||window.confirm(i.getText("TravelEditor - This page ask to close; data are perhaps not saved."))};return Object.seal({updateRoadBook:function(t){l(t)},addRoute:function(){d.travel.routes.add(c("../Data/Route")()),s.setRoutesList(),c("../core/RouteEditor")().chainRoutes(),l()},removeRoute:function(t){var e;(e=t)===d.routeEdition.routeInitialObjId&&d.routeEdition.routeChanged?c("./ErrorEditor")().showError(i.getText("TravelEditor - Cannot remove an edited route")):(c("./MapEditor")().removeRoute(c("../Data/DataSearchEngine")().getRoute(e),!0,!0),d.travel.routes.remove(e),s.setRoutesList(),e===d.routeEdition.routeInitialObjId&&c("./RouteEditor")().cancelEdition(),c("../core/RouteEditor")().chainRoutes(),l())},editRoute:function(t){!function(t){if(d.routeEdition.routeChanged)c("../core/ErrorEditor")().showError(i.getText("RouteEditor - Not possible to edit a route without a save or cancel"));else{-1!==d.routeEdition.routeInitialObjId&&c("../core/RouteEditor")().cancelEdition();var e=c("../data/DataSearchEngine")().getRoute(t),o=e.itinerary.provider;if(!o||""===o||d.providers.get(o.toLowerCase())){c("../UI/ProvidersToolbarUI")().provider=o;var n=e.itinerary.transitMode;n&&""!==n&&(c("../UI/ProvidersToolbarUI")().transitMode=n),d.editedRoute=c("../data/Route")(),d.editedRoute.object=e.object,d.routeEdition.routeInitialObjId=e.objId,d.editedRoute.hidden=!1,e.hidden=!1;var r=c("../core/MapEditor")();r.removeRoute(e,!0,!1),r.addRoute(d.editedRoute,!0,!0),c("../core/RouteEditor")().chainRoutes();var a=c("../UI/RouteEditorUI")();a.expand(),a.setWayPointsList(),c("../UI/DataPanesUI")().setItinerary()}else c("../core/ErrorEditor")().showError(i.getText("RouteEditor - Not possible to edit a route created with this provider",{provider:o}))}}(t)},renameRoute:function(t,e){var o,n;o=t,n=e,c("../Data/DataSearchEngine")().getRoute(o).name=n,s.setRoutesList(),o===d.routeEdition.routeInitialObjId&&(d.editedRoute.name=n),l()},swapRoute:function(t,e){var o,n;o=t,n=e,d.travel.routes.swap(o,n),s.setRoutesList(),c("../core/RouteEditor")().chainRoutes(),l()},routeDropped:function(t,e,o){var n,r,a;n=t,r=e,a=o,d.travel.routes.moveTo(n,r,a),s.setRoutesList(),c("../core/RouteEditor")().chainRoutes(),l()},saveTravel:function(){!function(){if(d.routeEdition.routeChanged)c("./ErrorEditor")().showError(i.getText("TravelEditor - Not possible to save a travel without a save or cancel"));else{for(var t=d.travel.routes.iterator;!t.done;)t.value.hidden=!1;var e=d.travel.object;e.routes.forEach(function(t){var e={};0!==t.itinerary.itineraryPoints.length&&(e=t.itinerary.itineraryPoints[0].objType);var o={latLngs:[],distances:[],objIds:[],objType:e};t.itinerary.itineraryPoints.forEach(function(t){o.latLngs.push([t.lat,t.lng]),o.distances.push(t.distance),o.objIds.push(t.objId)}),o.latLngs=c("@mapbox/polyline").encode(o.latLngs,6),t.itinerary.itineraryPoints=o}),c("../util/Utilities")().saveFile(e.name+".trv",JSON.stringify(e))}}()},confirmClose:function(){return t()},clear:function(){t()&&(c("../core/MapEditor")().removeAllObjects(),d.editedRoute=c("../Data/Route")(),d.routeEdition.routeChanged=!1,d.routeEdition.routeInitialObjId=-1,d.travel=c("../Data/Travel")(),d.travel.routes.add(c("../Data/Route")()),c("../UI/TravelEditorUI")().setRoutesList(),c("../UI/RouteEditorUI")().setWayPointsList(),c("../UI/DataPanesUI")().setItinerary(),l(!0))}})})}()},{"../Data/DataSearchEngine":2,"../Data/Route":4,"../Data/Travel":5,"../L.TravelNotes":7,"../UI/DataPanesUI":13,"../UI/HTMLViewsFactory":16,"../UI/ProvidersToolbarUI":20,"../UI/RouteEditorUI":21,"../UI/Translator":25,"../UI/TravelEditorUI":26,"../core/ErrorEditor":30,"../core/MapEditor":33,"../core/RouteEditor":36,"../data/DataSearchEngine":44,"../data/Route":51,"../util/Utilities":57,"./ErrorEditor":30,"./MapEditor":33,"./RouteEditor":36,"@mapbox/polyline":1}],40:[function(c,t,e){!function(){"use strict";var d=c("../L.TravelNotes");void 0!==t&&t.exports&&(t.exports=function(){var r=c("../core/MapEditor")(),a=c("../core/RouteEditor")(),i=c("../UI/RouteEditorUI")(),s=function(t,e){d.routeEdition.routeChanged=!0;var o=c("../data/Waypoint.js")();if(t&&(o.latLng=t,d.config.wayPoint.reverseGeocoding&&c("../core/GeoCoder")().getAddress(t[0],t[1],l,o.objId)),d.editedRoute.wayPoints.add(o),r.addWayPoint(d.editedRoute.wayPoints.last,d.editedRoute.wayPoints.length-2),e){for(var n=d.editedRoute.wayPoints.iterator;!n.done;)if(e<a.getClosestLatLngDistance(d.editedRoute,n.value.latLng).distance){d.editedRoute.wayPoints.moveTo(o.objId,n.value.objId,!0);break}}else d.editedRoute.wayPoints.swap(o.objId,!0);i.setWayPointsList(),a.startRouting()},l=function(t,e){d.routeEdition.routeChanged=!0,d.editedRoute.wayPoints.getAt(e).name=t,i.setWayPointsList()};return Object.seal({addWayPoint:function(t){s(t)},addWayPointOnRoute:function(t,e){var o,n,r;o=t,n=e,r=a.getClosestLatLngDistance(c("../Data/DataSearchEngine")().getRoute(o),[n.latlng.lat,n.latlng.lng]),s(r.latLng,r.distance)},reverseWayPoints:function(){!function(){d.routeEdition.routeChanged=!0;for(var t=d.editedRoute.wayPoints.iterator;!t.done;)r.removeObject(t.value.objId);for(d.editedRoute.wayPoints.reverse(),t=d.editedRoute.wayPoints.iterator;!t.done;)r.addWayPoint(t.value,t.first?"A":t.last?"B":t.index);i.setWayPointsList(),a.startRouting()}()},removeAllWayPoints:function(){!function(){d.routeEdition.routeChanged=!0;for(var t=d.editedRoute.wayPoints.iterator;!t.done;)r.removeObject(t.value.objId);d.editedRoute.wayPoints.removeAll(!0),i.setWayPointsList(),a.startRouting()}()},removeWayPoint:function(t){var e;e=t,d.routeEdition.routeChanged=!0,r.removeObject(e),d.editedRoute.wayPoints.remove(e),i.setWayPointsList(),a.startRouting()},renameWayPoint:function(t,e){l(t,e)},swapWayPoints:function(t,e){var o,n;o=t,n=e,d.routeEdition.routeChanged=!0,d.editedRoute.wayPoints.swap(o,n),i.setWayPointsList(),a.startRouting()},setStartPoint:function(t){var e;e=t,d.routeEdition.routeChanged=!0,0!==d.editedRoute.wayPoints.first.lat&&r.removeObject(d.editedRoute.wayPoints.first.objId),d.editedRoute.wayPoints.first.latLng=e,d.config.wayPoint.reverseGeocoding&&c("../core/GeoCoder")().getAddress(e[0],e[1],l,d.editedRoute.wayPoints.first.objId),r.addWayPoint(d.editedRoute.wayPoints.first,"A"),i.setWayPointsList(),a.startRouting()},setEndPoint:function(t){var e;e=t,d.routeEdition.routeChanged=!0,0!==d.editedRoute.wayPoints.last.lat&&r.removeObject(d.editedRoute.wayPoints.last.objId),d.editedRoute.wayPoints.last.latLng=e,d.config.wayPoint.reverseGeocoding&&c("../core/GeoCoder")().getAddress(e[0],e[1],l,d.editedRoute.wayPoints.last.objId),r.addWayPoint(d.editedRoute.wayPoints.last,"B"),i.setWayPointsList(),a.startRouting()},wayPointDragEnd:function(t){!function(t){if(d.routeEdition.routeChanged=!0,d.config.wayPoint.reverseGeocoding){var e=d.editedRoute.wayPoints.getAt(t).latLng;c("../core/GeoCoder")().getAddress(e[0],e[1],l,t)}i.setWayPointsList(),a.startRouting()}(t)},wayPointDropped:function(t,e,o){!function(t,e,o){if(d.routeEdition.routeChanged=!0,(e!==d.editedRoute.wayPoints.first.objId||!o)&&(e!==d.editedRoute.wayPoints.last.objId||o)){d.editedRoute.wayPoints.moveTo(t,e,o),i.setWayPointsList();for(var n=d.editedRoute.wayPoints.iterator;!n.done;)r.removeObject(n.value.objId),r.addWayPoint(n.value,n.first?"A":n.last?"B":n.index);a.startRouting()}}(t,e,o)}})})}()},{"../Data/DataSearchEngine":2,"../L.TravelNotes":7,"../UI/RouteEditorUI":21,"../core/GeoCoder":32,"../core/MapEditor":33,"../core/RouteEditor":36,"../data/Waypoint.js":56}],41:[function(t,e,o){arguments[4][40][0].apply(o,arguments)},{"../Data/DataSearchEngine":2,"../L.TravelNotes":7,"../UI/RouteEditorUI":21,"../core/GeoCoder":32,"../core/MapEditor":33,"../core/RouteEditor":36,"../data/Waypoint.js":56,dup:40}],42:[function(i,t,e){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(t){var s=[],n=t,r=function(t){if(!t.objType||!t.objType.name||t.objType.name!==n)throw"invalid object name for add function";s.push(t)},l=function(e){return s.findIndex(function(t){return t.objId===e})},a=function(){var t=-1;return{get value(){return t<s.length?s[t]:null},get done(){return++t>=s.length},get first(){return 0===t},get last(){return t>=s.length-1},get index(){return t}}};return Object.seal({add:function(t){r(t)},forEach:function(t){return function(t){for(var e=null,o=a();!o.done;)e=t(o.value,e);return e}(t)},getAt:function(t){return-1===(e=l(t))?null:s[e];var e},moveTo:function(t,e,o){var n,r,a,i;n=e,r=o,a=l(t),i=l(n),r||i++,s.splice(i,0,s[a]),i<a&&a++,s.splice(a,1)},remove:function(t){!function(t){if(-1===l(t))throw"invalid objId for remove function";s.splice(l(t),1)}(t)},removeAll:function(t){t?s.splice(1,s.length-2):s.length=0},replace:function(t,e){!function(t,e){var o=l(t);if(-1===o)throw"invalid objId for replace function";s[o]=e}(t,e)},reverse:function(){s.reverse()},sort:function(t){var e;e=t,s.sort(e)},swap:function(t,e){!function(t,e){var o=l(t);if(-1===o||0===o&&e||s.length-1===o&&!e)throw"invalid objId for swap function";var n=s[o];s[o]=s[o+(e?-1:1)],s[o+(e?-1:1)]=n}(t,e)},get first(){return s[0]},get iterator(){return a()},get last(){return s[s.length-1]},get length(){return s.length},get object(){return function(){for(var t=[],e=a();!e.done;)t.push(e.value.object);return t}()},set object(t){var e,o;e=t,s.length=0,e.forEach(function(t){switch(n){case"Route":o=i("../data/Route")();break;case"Note":o=i("../data/Note")();break;case"WayPoint":o=i("../data/WayPoint")();break;case"Maneuver":o=i("../data/Maneuver")();break;case"ItineraryPoint":o=i("../data/ItineraryPoint")();break;default:throw"invalid ObjName ( "+n+" ) in Collection.m_SetObject"}o.object=t,r(o)})}})})}()},{"../data/ItineraryPoint":46,"../data/Maneuver":47,"../data/Note":48,"../data/Route":51,"../data/WayPoint":55}],43:[function(t,r,e){!function(){"use strict";var e,n,o;void 0!==r&&r.exports&&(r.exports=(e={contextMenu:{timeout:1500},errorMessages:{timeout:2e4},routing:{auto:!0},language:"fr",itineraryPointMarker:{color:"red",weight:2,radius:7,fill:!1},searchPointMarker:{color:"green",weight:4,radius:20,fill:!1},searchPointPolyline:{color:"green",weight:4,radius:20,fill:!1},previousSearchLimit:{color:"green",fill:!1,weight:1},nextSearchLimit:{color:"red",fill:!1,weight:1},wayPoint:{reverseGeocoding:!1},route:{color:"#ff0000",width:3,dashArray:0,dashChoices:[{text:"——————",iDashArray:null},{text:"— — — — —",iDashArray:[4,2]},{text:"—‧—‧—‧—‧—",iDashArray:[4,2,0,2]},{text:"················",iDashArray:[0,2]}]},note:{reverseGeocoding:!1,grip:{size:10,opacity:0},polyline:{color:"gray",weight:1},style:"TravelNotes-NotesStyle",svgIconWidthScale:10,svgIconWidth:200},itineraryPointZoom:17,routeEditor:{displayEditionInHTMLPage:!0},travelEditor:{clearAfterSave:!0,startMinimized:!0,timeout:1e3,startupRouteEdition:!0},haveBeforeUnloadWarning:!0},n=function(t,e){if("object"==typeof t&&"object"==typeof e)try{var o;for(o in e)"object"==typeof e[o]?n(t[o],e[o]):e[o]=t[o]||e[o];for(o in t)"object"==typeof t[o]?("[object Array]"==Object.prototype.toString.call(t[o])?e[o]=e[o]||[]:e[o]=e[o]||{},n(t[o],e[o])):e[o]=t[o]}catch(t){console.log(t),console.log("Not possible to overload Config")}},o=function(t){var e;for(e in t)"object"==typeof t[e]&&(t[e]=o(t[e]));return Object.freeze(t)},{get contextMenu(){return e.contextMenu},get errorMessages(){return e.errorMessages},get routing(){return e.routing},get language(){return e.language},get itineraryPointMarker(){return e.itineraryPointMarker},get searchPointMarker(){return e.searchPointMarker},get searchPointPolyline(){return e.searchPointPolyline},get previousSearchLimit(){return e.previousSearchLimit},get nextSearchLimit(){return e.nextSearchLimit},get wayPoint(){return e.wayPoint},get route(){return e.route},get note(){return e.note},get itineraryPointZoom(){return e.itineraryPointZoom},get routeEditor(){return e.routeEditor},get travelEditor(){return e.travelEditor},get haveBeforeUnloadWarning(){return e.haveBeforeUnloadWarning},overload:function(t){n(t,e),e=o(e)}}))}()},{}],44:[function(t,e,o){arguments[4][2][0].apply(o,arguments)},{"../L.TravelNotes":7,dup:2}],45:[function(t,e,o){arguments[4][3][0].apply(o,arguments)},{"../data/Collection":42,"../data/ObjId":49,"../data/ObjType":50,"./Version":54,dup:3}],46:[function(s,t,e){!function(){"use strict";var i=s("../data/ObjType")("ItineraryPoint",s("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var o=0,n=0,r=0,a=s("../data/ObjId")();return Object.seal({get lat(){return o},set lat(t){o=t},get lng(){return n},set lng(t){n=t},get latLng(){return[o,n]},set latLng(t){o=t[0],n=t[1]},get distance(){return r},set distance(t){r=t},get objId(){return a},get objType(){return i},get object(){return{lat:parseFloat(o.toFixed(6)),lng:parseFloat(n.toFixed(6)),distance:parseFloat(r.toFixed(2)),objId:a,objType:i.object}},set object(t){var e;e=t,e=i.validate(e),o=e.lat||0,n=e.lng||0,r=e.distance||0,a=s("../data/ObjId")()}})})}()},{"../data/ObjId":49,"../data/ObjType":50,"./Version":54}],47:[function(d,t,e){!function(){"use strict";var l=d("../data/ObjType")("Maneuver",d("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var o=d("../data/ObjId")(),n="",r="",a=-1,i=0,s=0;return Object.seal({get iconName(){return n},set iconName(t){n=t},get instruction(){return r},set instruction(t){r=t},get itineraryPointObjId(){return a},set itineraryPointObjId(t){a=t},get distance(){return i},set distance(t){i=t},get duration(){return s},set duration(t){s=t},get objId(){return o},get objType(){return l},get object(){return{iconName:n,instruction:r,distance:parseFloat(i.toFixed(2)),duration:s,itineraryPointObjId:a,objId:o,objType:l.object}},set object(t){var e;e=t,e=l.validate(e),n=e.iconName||"",r=e.instruction||"",i=e.distance||0,s=e.duration||0,a=e.itineraryPointObjId||-1,o=d("../data/ObjId")()}})})}()},{"../data/ObjId":49,"../data/ObjType":50,"./Version":54}],48:[function(N,t,e){!function(){"use strict";var f=N("../data/ObjType")("Note",N("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var o=N("../data/ObjId")(),n=40,r=40,a="",i="",s="",l="",d="",c="",u=0,v=0,g=0,p=0,m=-1,T=0;return Object.seal({get isRouteNote(){return-1!==m},get iconHeight(){return n},set iconHeight(t){n=t},get iconWidth(){return r},set iconWidth(t){r=t},get iconContent(){return a},set iconContent(t){a=t},get popupContent(){return i},set popupContent(t){i=t},get tooltipContent(){return s},set tooltipContent(t){s=t},get phone(){return l},set phone(t){l=t},get url(){return d},set url(t){d=t},get address(){return c},set address(t){c=t},get iconLat(){return u},set iconLat(t){u=t},get iconLng(){return v},set iconLng(t){v=t},get iconLatLng(){return[u,v]},set iconLatLng(t){u=t[0],v=t[1]},get lat(){return g},set lat(t){g=t},get lng(){return p},set lng(t){p=t},get latLng(){return[g,p]},set latLng(t){g=t[0],p=t[1]},get distance(){return m},set distance(t){m=t},get chainedDistance(){return T},set chainedDistance(t){T=t},get objId(){return o},get objType(){return f},get object(){return{iconHeight:n,iconWidth:r,iconContent:a,popupContent:i,tooltipContent:s,phone:l,url:d,address:c,iconLat:parseFloat(u.toFixed(6)),iconLng:parseFloat(v.toFixed(6)),lat:parseFloat(g.toFixed(6)),lng:parseFloat(p.toFixed(6)),distance:parseFloat(m.toFixed(2)),chainedDistance:parseFloat(T.toFixed(2)),objId:o,objType:f.object}},set object(t){var e;e=t,e=f.validate(e),n=e.iconHeight||40,r=e.iconWidth||40,a=e.iconContent||"",i=e.popupContent||"",s=e.tooltipContent||"",l=e.phone||"",d=e.url||"",c=e.address||"",u=e.iconLat||0,v=e.iconLng||0,g=e.lat||0,p=e.lng||0,m=e.distance||-1,T=e.chainedDistance,o=N("../data/ObjId")()}})})}()},{"../data/ObjId":49,"../data/ObjType":50,"./Version":54}],49:[function(t,e,o){(function(t){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){return t.TravelNotesObjId||(t.TravelNotesObjId=0),++t.TravelNotesObjId})}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],50:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(t,e){var o=t,n=e;return Object.seal({get name(){return o},get version(){return n},get object(){return{name:o,version:n}},validate:function(t){return function(t){if(!t.objType)throw"No objType for "+o;if(!t.objType.name)throw"No name for "+o;if(o!==t.objType.name)throw"Invalid name for "+o;if(!t.objType.version)throw"No version for "+o;if(n!==t.objType.version&&("1.0.0"===t.objType.version&&("Route"===t.objType.name&&(t.dashArray=0,t.hidden=!1),t.objType.version="1.1.0"),"1.1.0"===t.objType.version&&(t.objType.version="1.2.0"),"1.2.0"===t.objType.version&&(t.objType.version="1.3.0"),"1.3.0"===t.objType.version&&(t.objType.version="1.4.0"),n!==t.objType.version))throw"invalid version for "+o;if(!t.objId)throw"No objId for "+o;return t}(t)}})})}()},{}],51:[function(t,e,o){arguments[4][4][0].apply(o,arguments)},{"../L.TravelNotes":7,"../data/Collection":42,"../data/Itinerary":45,"../data/ObjId":49,"../data/ObjType":50,"../data/Waypoint":56,"./Itinerary":45,"./Version":54,dup:4}],52:[function(t,e,o){arguments[4][5][0].apply(o,arguments)},{"../data/Collection":42,"../data/ObjId":49,"../data/ObjType":50,"./Version":54,dup:5}],53:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){var e={config:t("../data/Config"),map:null,providers:new Map,mapObjects:new Map,travel:t("../data/Travel")(),editedRoute:null,routeEdition:Object.seal({routeChanged:!1,routeInitialObjId:-1}),routing:Object.seal({provider:"",transitMode:""}),searchData:[],UUID:t("../util/Utilities")().UUID};return Object.seal({get config(){return e.config},set config(t){e.config.overload(t)},get map(){return e.map},set map(t){e.map=t},get providers(){return e.providers},get mapObjects(){return e.mapObjects},get travel(){return e.travel},set travel(t){e.travel=t},get editedRoute(){return e.editedRoute},set editedRoute(t){e.editedRoute=t},get routeEdition(){return e.routeEdition},get routing(){return e.routing},get searchData(){return e.searchData},set searchData(t){e.searchData=t},get UUID(){return e.UUID}})})}()},{"../data/Config":43,"../data/Travel":52,"../util/Utilities":57}],54:[function(t,e,o){arguments[4][6][0].apply(o,arguments)},{dup:6}],55:[function(s,t,e){!function(){"use strict";var i=s("../data/ObjType")("WayPoint",s("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var o="",n=0,r=0,a=s("../data/ObjId")();return Object.seal({get name(){return o},set name(t){o=t},get UIName(){return""!==o?o:0!==n&&0!==r?n.toFixed(6)+(0<n?" N - ":" S - ")+r.toFixed(6)+(0<r?" E":" W"):""},get lat(){return n},set lat(t){n=t},get lng(){return r},set lng(t){r=t},get latLng(){return[n,r]},set latLng(t){n=t[0],r=t[1]},get objId(){return a},get objType(){return i},get object(){return{name:o,lat:parseFloat(n.toFixed(6)),lng:parseFloat(r.toFixed(6)),objId:a,objType:i.object}},set object(t){var e;e=t,e=i.validate(e),o=e.name||"",n=e.lat||0,r=e.lng||0,a=s("../data/ObjId")()}})})}()},{"../data/ObjId":49,"../data/ObjType":50,"./Version":54}],56:[function(t,e,o){arguments[4][55][0].apply(o,arguments)},{"../data/ObjId":49,"../data/ObjType":50,"./Version":54,dup:55}],57:[function(t,e,o){!function(){"use strict";var a=t("../UI/Translator")();void 0!==e&&e.exports&&(e.exports=function(){return{get UUID(){return function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}()},storageAvailable:function(t){try{var e=window[t],o="__storage_test__";return e.setItem(o,o),e.removeItem(o),!0}catch(t){return!1}},fileAPIAvailable:function(){try{return new File(["testdata"],{type:"text/plain"}),!0}catch(t){return!!window.navigator.msSaveOrOpenBlob}},saveFile:function(t,e,o){if(o||(o="text/plain"),window.navigator.msSaveOrOpenBlob)try{window.navigator.msSaveOrOpenBlob(new Blob([e]),t)}catch(t){}else try{var n=window.URL.createObjectURL(new File([e],{type:o})),r=document.createElement("a");r.setAttribute("href",n),r.setAttribute("download",t),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(n)}catch(t){}},formatTime:function(t){if(0===(t=Math.floor(t)))return"";var e=Math.floor(t/86400),o=Math.floor(t%86400/3600),n=Math.floor(t%3600/60),r=Math.floor(t%60);return 0<e?e+"&nbsp;"+a.getText("Utilities - Day")+"&nbsp;"+o+"&nbsp;"+a.getText("Utilities - Hour"):0<o?o+"&nbsp;"+a.getText("Utilities - Hour")+"&nbsp;"+n+"&nbsp;"+a.getText("Utilities - Minute"):0<n?n+"&nbsp;"+a.getText("Utilities - Minute"):r+"&nbsp;"+a.getText("Utilities - Second")},formatDistance:function(t){return 0===(t=Math.floor(t))?"":t<1e3?t.toFixed(0)+"&nbsp;m":Math.floor(t/1e3)+"."+Math.floor(t%1e3/100)+"&nbsp;km"},formatLat:function(t){return 0<t?t.toFixed(6)+"&nbsp;N":(-t).toFixed(6)+"&nbsp;S"},formatLng:function(t){return 0<t?t.toFixed(6)+"&nbsp;E":(-t).toFixed(6)+"&nbsp;W"},formatLatLng:function(t){return this.formatLat(t[0])+"&nbsp;-&nbsp;"+this.formatLng(t[1])}}})}()},{"../UI/Translator":25}]},{},[7]);