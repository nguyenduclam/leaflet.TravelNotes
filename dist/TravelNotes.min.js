/*! leaflet.travelnotes - version 1.3.0 - build 0745 - 2018-12-15T21:50:59+0100 - Copyright 2017 2018 Christian Guyette - Contact: http//www.ouaie.be/ - This  program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or any later version.*/


!function a(i,s,l){function d(o,t){if(!s[o]){if(!i[o]){var e="function"==typeof require&&require;if(!t&&e)return e(o,!0);if(c)return c(o,!0);var r=new Error("Cannot find module '"+o+"'");throw r.code="MODULE_NOT_FOUND",r}var n=s[o]={exports:{}};i[o][0].call(n.exports,function(t){var e=i[o][1][t];return d(e||t)},n,n.exports,a,i,s,l)}return s[o].exports}for(var c="function"==typeof require&&require,t=0;t<l.length;t++)d(l[t]);return d}({1:[function(t,e,o){"use strict";var r={};function a(t){return Math.floor(Math.abs(t)+.5)*(0<=t?1:-1)}function s(t,e,o){var r=(t=a(t*o))-(e=a(e*o));r<<=1,t-e<0&&(r=~r);for(var n="";32<=r;)n+=String.fromCharCode(63+(32|31&r)),r>>=5;return n+=String.fromCharCode(r+63)}function n(t){for(var e=[],o=0;o<t.length;o++)e.push(t[o].slice().reverse());return e}r.decode=function(t,e){for(var o,r=0,n=0,a=0,i=[],s=0,l=0,d=null,c=Math.pow(10,e||5);r<t.length;){for(d=null,l=s=0;l|=(31&(d=t.charCodeAt(r++)-63))<<s,s+=5,32<=d;);for(o=1&l?~(l>>1):l>>1,s=l=0;l|=(31&(d=t.charCodeAt(r++)-63))<<s,s+=5,32<=d;);n+=o,a+=1&l?~(l>>1):l>>1,i.push([n/c,a/c])}return i},r.encode=function(t,e){if(!t.length)return"";for(var o=Math.pow(10,e||5),r=s(t[0][0],0,o)+s(t[0][1],0,o),n=1;n<t.length;n++){var a=t[n],i=t[n-1];r+=s(a[0],i[0],o),r+=s(a[1],i[1],o)}return r},r.fromGeoJSON=function(t,e){if(t&&"Feature"===t.type&&(t=t.geometry),!t||"LineString"!==t.type)throw new Error("Input must be a GeoJSON LineString");return r.encode(n(t.coordinates),e)},r.toGeoJSON=function(t,e){return{type:"LineString",coordinates:n(r.decode(t,e))}},"object"==typeof e&&e.exports&&(e.exports=r)},{}],2:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){var r=t("../L.TravelNotes");return{getRoute:function(t){return e=t,o=null,(o=r.travel.routes.getAt(e))||e===r.editedRoute.objId&&(o=r.editedRoute),o||console.log("Invalid noteObjId "+e+" for function DataSearchEngine.getRoute ( )"),o;var e,o},getNoteAndRoute:function(t){return function(t){var e=null;if(e=r.travel.notes.getAt(t))return{note:e,route:null};for(var o=r.travel.routes.iterator;!o.done;)if(e=o.value.notes.getAt(t))return{note:e,route:o.value};return(e=r.editedRoute.notes.getAt(t))?{note:e,route:r.editedRoute}:(console.log("Invalid noteObjId "+t+" for function DataSearchEngine.getNote ( )"),{note:null,route:null})}(t)},getWayPoint:function(t){return function(t){for(var e=null,o=r.travel.routes.iterator;!o.done;)if(e=o.value.wayPoints.getAt(t))return e;return(e=r.editedRoute.wayPoints.getAt(t))||(console.log("Invalid wayPointObjId "+t+" for function DataSearchEngine.getWayPoint ( )"),null)}(t)}}})}()},{"../L.TravelNotes":7}],3:[function(u,t,e){!function(){"use strict";var c=u("../data/ObjType")("Itinerary",u("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var a="",i="",s=u("../data/Collection")("ItineraryPoint"),l=u("../data/Collection")("Maneuver"),d=u("../data/ObjId")();return{get itineraryPoints(){return s},get maneuvers(){return l},get provider(){return a},set provider(t){a=t},get transitMode(){return i},set transitMode(t){i=t},get objId(){return d},get objType(){return c},get object(){return{itineraryPoints:s.object,maneuvers:l.object,provider:a,transitMode:i,objId:d,objType:c.object}},set object(t){t=c.validate(t),s.object=t.itineraryPoints||[],l.object=t.maneuvers||[],a=t.provider||"",i=t.transitMode||"",d=u("../data/ObjId")();for(var e=new Map,o=0,r=s.iterator;!r.done;)e.set(t.itineraryPoints[o].objId,r.value.objId),o++;for(var n=l.iterator;!n.done;)n.value.itineraryPointObjId=e.get(n.value.itineraryPointObjId)}}})}()},{"../data/Collection":38,"../data/ObjId":44,"../data/ObjType":45,"./Version":6}],4:[function(m,t,e){!function(){"use strict";var p=m("../data/ObjType")("Route",m("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var e="",o=m("../data/Collection")("WayPoint");o.add(m("../data/Waypoint")()),o.add(m("../data/Waypoint")());var r=m("../data/Collection")("Note"),n=m("../data/Itinerary")(),a=m("../L.TravelNotes").config.route.width||5,i=m("../L.TravelNotes").config.route.color||"#ff0000",s=m("../L.TravelNotes").config.route.dashArray||0,l=!1,d=0,c=0,u=0,v=!1,g=m("../data/ObjId")();return{get wayPoints(){return o},get itinerary(){return n},get notes(){return r},get name(){return e},set name(t){e=t},get width(){return a},set width(t){a=t},get color(){return i},set color(t){i=t},get dashArray(){return s},set dashArray(t){s=t},get chain(){return l},set chain(t){l=t},get chainedDistance(){return d},set chainedDistance(t){d=t},get distance(){return c},set distance(t){c=t},get duration(){return u},set duration(t){u=t},get hidden(){return v},set hidden(t){v=t},get objId(){return g},get objType(){return p},get object(){return{name:e,wayPoints:o.object,notes:r.object,itinerary:n.object,width:a,color:i,dashArray:s,chain:l,distance:parseFloat(c.toFixed(2)),duration:u,hidden:v,chainedDistance:parseFloat(d.toFixed(2)),objId:g,objType:p.object}},set object(t){t=p.validate(t),e=t.name||"",o.object=t.wayPoints||[],r.object=t.notes||[],n.object=t.itinerary||m("./Itinerary")().object,a=t.width||5,i=t.color||"#000000",s=t.dashArray||0,l=t.chain||!1,c=t.distance,u=t.duration,v=t.hidden||!1,d=t.chainedDistance,g=m("../data/ObjId")()}}})}()},{"../L.TravelNotes":7,"../data/Collection":38,"../data/Itinerary":40,"../data/ObjId":44,"../data/ObjType":45,"../data/Waypoint":51,"./Itinerary":3,"./Version":6}],5:[function(s,t,e){!function(){"use strict";var i=s("../data/ObjType")("Travel",s("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var e="TravelNotes",o=s("../data/Collection")("Route"),r=s("../data/Collection")("Note"),n=s("../data/ObjId")(),a={};return{get routes(){return o},get notes(){return r},get name(){return e},set name(t){e=t},get userData(){return a},set userData(t){a=t},get objId(){return n},get objType(){return i},get object(){return{name:e,routes:o.object,notes:r.object,userData:a,objId:n,objType:i.object}},set object(t){t=i.validate(t),e=t.name||"",a=t.userData||{},o.object=t.routes||[],r.object=t.notes||[],n=s("../data/ObjId")()}}})}()},{"../data/Collection":38,"../data/ObjId":44,"../data/ObjType":45,"./Version":6}],6:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports="1.3.0")}()},{}],7:[function(g,t,e){!function(){"use strict";L.travelNotes=function(){var a=g("./data/TravelNotesData")();void 0!==t&&t.exports&&(t.exports=a);var e=[],o=[],r=!1,n=!1,i=null,s=null,l="",d=function(e,o){var r=new XMLHttpRequest;r.timeout=2e4,r.ontimeout=function(t){o("XMLHttpRequest TimeOut. File : "+r.responseURL)},r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){var t;try{t=JSON.parse(r.responseText)}catch(t){o("JSON parsing error. File : "+r.responseURL)}e(t)}else o("Error XMLHttpRequest - Status : "+r.status+" - StatusText : "+r.statusText+" - File : "+r.responseURL)},r.open("GET",l,!0),r.overrideMimeType("application/json"),r.send(null)},c=function(t,e){var n;a.map=t,n="?",decodeURI(window.location.search).substr(1).split("&").forEach(function(t){if("fil="===t.substr(0,4).toLowerCase())s=decodeURIComponent(escape(atob(t.substr(4)))),n+="?"===n?"":"&",n+=t;else{var e=t.split("=");if(2===e.length)if(-1!==e[0].indexOf("ProviderKey")){var o=e[0].substr(0,e[0].length-11).toLowerCase(),r=a.providers.get(o);r&&r.providerKeyNeeded&&(r.providerKey=e[1]),sessionStorage.setItem(o,btoa(e[1]))}else n+="?"===n?"":"&",n+=t,"lng"===e[0].toLowerCase()&&(i=e[1].toLowerCase())}}),history.replaceState({index:"bar"},"page",n),a.providers.forEach(function(t){if(t.providerKeyNeeded&&0===t.providerKey){var e=null;g("./util/Utilities")().storageAvailable("sessionStorage")&&(e=sessionStorage.getItem(t.name.toLowerCase())),e?t.providerKey=atob(e):a.providers.delete(t.name.toLowerCase())}});var o=[];l=window.location.href.substr(0,window.location.href.lastIndexOf("/")+1)+"TravelNotesConfig.json",o.push(new Promise(d)),l=window.location.href.substr(0,window.location.href.lastIndexOf("/")+1)+"TravelNotes"+(i||a.config.language).toUpperCase()+".json",o.push(new Promise(d)),s&&(l=s,o.push(new Promise(d))),Promise.all(o).then(function(t){i&&(t[0].language=i),a.config=t[0],window.osmSearch?window.osmSearch.getDictionaryPromise(a.config.language).then(function(){console.log("Dictionary loaded")},function(t){console.log(t)}):console.log("osmSearch not found"),a.providers.forEach(function(t){t.userLanguage=a.config.language}),g("./UI/Translator")().setTranslations(t[1]),a.travel=g("./data/Travel")(),a.travel.routes.add(g("./data/Route")()),a.editedRoute=g("./data/Route")(),document.getElementById(e).appendChild(g("./UI/UserInterface")().UI),g("./UI/TravelEditorUI")().setRoutesList(a.travel.routes),g("./core/TravelEditor")().updateRoadBook(!0),s?g("./core/FileLoader")().openDistantFile(t[2]):a.config.travelEditor.startupRouteEdition?g("./core/TravelEditor")().editRoute(a.travel.routes.first.objId):g("./UI/RouteEditorUI")().reduce()}).catch(function(t){console.log(t)})},u=function(t){a.travel.readOnly||g("./UI/ContextMenu")(t,g("./core/RouteEditor")().getMapContextMenu([t.latlng.lat,t.latlng.lng]).concat(g("./core/NoteEditor")().getMapContextMenu([t.latlng.lat,t.latlng.lng])).concat(e))},v=function(t){a.travel.readOnly||g("./UI/ContextMenu")(t,g("./core/RouteEditor")().getMapContextMenu([t.latlng.lat,t.latlng.lng]).concat(g("./core/NoteEditor")().getMapContextMenu([t.latlng.lat,t.latlng.lng])).concat(g("./core/TravelEditor")().getMapContextMenu([t.latlng.lat,t.latlng.lng])).concat(o))};return{addControl:function(t,e){return c(t,e)},addProvider:function(t){a.providers.set(t.name.toLowerCase(),t)},addMapContextMenu:function(t,e){t&&(a.map.on("click",u),r=!0),e&&(a.map.on("contextmenu",u),n=!0)},get baseDialog(){return g("./UI/baseDialog")()},get userData(){return a.travel.userData},set userData(t){a.travel.userData=t},get rightContextMenu(){return n},set rightContextMenu(t){t&&!n?(a.map.on("contextmenu",v),n=!0):!t&&n&&(a.map.off("contextmenu",v),n=!1)},get leftContextMenu(){return r},set leftContextMenu(t){t&&!r?(a.map.on("click",u),r=!0):!t&&r&&(a.map.off("click",u),r=!1)},get leftUserContextMenu(){return e},set leftUserContextMenu(t){e=t},get rightUserContextMenu(){return o},set rightUserContextMenu(t){o=t},get maneuver(){return g("./data/Maneuver")()},get itineraryPoint(){return g("./data/ItineraryPoint")()},get version(){return g("./data/Version")}}}()}()},{"./UI/ContextMenu":11,"./UI/RouteEditorUI":20,"./UI/Translator":24,"./UI/TravelEditorUI":25,"./UI/UserInterface":27,"./UI/baseDialog":28,"./core/FileLoader":30,"./core/NoteEditor":34,"./core/RouteEditor":35,"./core/TravelEditor":37,"./data/ItineraryPoint":41,"./data/Maneuver":42,"./data/Route":46,"./data/Travel":47,"./data/TravelNotesData":48,"./data/Version":49,"./util/Utilities":52}],8:[function(o,t,e){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(t){var e=o("../UI/BaseDialog")();return e.title=o("../UI/Translator")().getText("AboutDialog - About Travel & Notes"),o("./HTMLElementsFactory")().create("div",{id:"TravelNotes-AboutDialog-AboutDiv"},e.content).innerHTML="<p>This  program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or any later version.</p><p>Copyright - 2017 2018 - Christian Guyette</p><p>Contact : <a href='http://www.ouaie.be/blog/pages/contact' target='_blank'>http://www.ouaie.be/</a></p><p>GitHub : <a href='https://github.com/wwwouaiebe/leaflet.TravelNotes' target='_blank'>https://github.com/wwwouaiebe/leaflet.TravelNotes</a></p><p>Version : "+o("../data/Version")+".<p>This program uses: <a href='https://leafletjs.com/' target='_blank'>leaflet</a>, <a href='https://github.com/mapbox/polyline' target='_blank'>mapbox/polyline</a>, <a href='https://github.com/Project-OSRM/osrm-text-instructions' target='_blank'>Project-OSRM/osrm-text-instructions</a> and  <a href='https://github.com/drolbr/Overpass-API' target='_blank'>the Overpass API</a></p>",e.center(),e})}()},{"../UI/BaseDialog":9,"../UI/Translator":24,"../data/Version":49,"./HTMLElementsFactory":14}],9:[function(N,t,e){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){var e=null,o=null,r=null,t=N("./HTMLElementsFactory")(),n=function(t){if("Escape"===t.key||"Esc"===t.key){if(r&&!r())return;document.removeEventListener("keydown",n,!0),document.getElementsByTagName("body")[0].removeChild(document.getElementById("TravelNotes-BaseDialog-BackgroundDiv"))}},a=document.getElementsByTagName("body")[0],i=t.create("div",{id:"TravelNotes-BaseDialog-BackgroundDiv",className:"TravelNotes-BaseDialog-BackgroundDiv"},a);i.addEventListener("dragover",function(t){},!1),i.addEventListener("drop",function(t){},!1);var s=i.clientWidth,l=i.clientHeight,d=0,c=0,u=0,v=0,g=t.create("div",{id:"TravelNotes-BaseDialog-Container",className:"TravelNotes-BaseDialog-Container"},i),p=t.create("div",{id:"TravelNotes-BaseDialog-TopBar",className:"TravelNotes-BaseDialog-TopBar",draggable:!0},g);t.create("div",{innerHTML:"&#x274c",id:"TravelNotes-BaseDialog-CancelButton",title:N("../UI/Translator")().getText("BaseDialog - Cancel")},p).addEventListener("click",function(){o&&!o()||(document.removeEventListener("keydown",n,!0),document.getElementsByTagName("body")[0].removeChild(i))},!1),p.addEventListener("dragstart",function(t){try{t.dataTransfer.setData("Text","1")}catch(t){}d=t.screenX,c=t.screenY},!1),p.addEventListener("dragend",function(t){u+=t.screenX-d,v+=t.screenY-c,u=Math.min(Math.max(u,20),s-g.clientWidth-20),v=Math.max(v,20);var e=l-Math.max(v,0)-20;g.setAttribute("style","top:"+v+"px;left:"+u+"px;max-height:"+e+"px;")},!1);var m=t.create("div",{className:"TravelNotes-BaseDialog-HeaderDiv",id:"TravelNotes-BaseDialog-HeaderDiv"},g),T=t.create("div",{className:"TravelNotes-BaseDialog-ContentDiv",id:"TravelNotes-BaseDialog-ContentDiv"},g),f=(t.create("div",{className:"TravelNotes-BaseDialog-ErrorDiv TravelNotes-BaseDialog-ErrorDivHidden",id:"TravelNotes-BaseDialog-ErrorDiv"},g),t.create("div",{className:"TravelNotes-BaseDialog-FooterDiv",id:"TravelNotes-BaseDialog-FooterDiv"},g));return t.create("div",{innerHTML:"&#x1f4be;",id:"TravelNotes-BaseDialog-OkButton",className:"TravelNotes-BaseDialog-Button"},f).addEventListener("click",function(){e&&!e()||(document.removeEventListener("keydown",n,!0),document.getElementsByTagName("body")[0].removeChild(i))},!1),document.addEventListener("keydown",n,!0),{addClickOkButtonEventListener:function(t){e=t},addClickCancelButtonEventListener:function(t){o=t},addEscapeKeyEventListener:function(t){r=t},get title(){return m.innerHTML},set title(t){m.innerHTML=t},center:function(){u=(s-g.clientWidth)/2,v=(l-g.clientHeight)/2,u=Math.min(Math.max(u,20),s-g.clientWidth-20),v=Math.max(v,20);var t=l-Math.max(v,0)-20;g.setAttribute("style","top:"+v+"px;left:"+u+"px;max-height:"+t+"px;")},get header(){return m},set header(t){m=t},get content(){return T},set content(t){T=t},get footer(){return f},set footer(t){f=t}}})}()},{"../UI/Translator":24,"./HTMLElementsFactory":14}],10:[function(C,t,e){!function(){"use strict";var b=function(){return!0};void 0!==t&&t.exports&&(t.exports=function(t){var o=function(t){return{r:parseInt(t.substr(1,2),16),g:parseInt(t.substr(3,2),16),b:parseInt(t.substr(5,2),16)}},s=function(t,e,o){return String.prototype.padStart||(String.prototype.padStart=function(t,e){return t>>=0,e=String(e||" "),this.length>t?String(this):((t-=this.length)>e.length&&(e+=e.repeat(t/e.length)),e.slice(0,t)+String(this))}),"#"+parseInt(t).toString(16).padStart(2,"0")+parseInt(e).toString(16).padStart(2,"0")+parseInt(o).toString(16).padStart(2,"0")},e=function(t){a=t.target.colorValue;var e=o(a);L.value=e.r,E.value=e.g,y.value=e.b,document.getElementById("TravelNotes-ColorDialog-ColorSampleDiv").setAttribute("style","background-color:"+t.target.colorValue+";")},r=function(t){for(var e=t.target.redValue,o=255,r=255,n=0;++n<7;){var a=0;for(o=255;++a<7;){var i=document.getElementById("TravelNotes-ColorDialog-CellColorDiv"+n+a);i.colorValue=s(e,o,r),i.setAttribute("style","background-color:"+s(e,o,r)),o-=51}r-=51}},n=function(){a=s(L.value,E.value,y.value),document.getElementById("TravelNotes-ColorDialog-ColorSampleDiv").setAttribute("style","background-color:"+a+";")},a=t,i=C("../UI/Translator")(),l=C("./HTMLElementsFactory")(),d=C("../UI/BaseDialog")();d.title=i.getText("ColorDialog - Colors"),d.addClickOkButtonEventListener(b),d.getNewColor=function(){return a};for(var c=l.create("div",{className:"TravelNotes-ColorDialog-ColorDiv",id:"TravelNotes-ColorDialog-ColorDiv"},d.content),u=l.create("div",{className:"TravelNotes-ColorDialog-ButtonsDiv",id:"TravelNotes-ColorDialog-ButtonsDiv"},c),v=255,g=255,p=255,m=0;++m<8;){var T=l.create("div",{className:"TravelNotes-ColorDialog-RowColorDiv",id:"TravelNotes-ColorDialog-RowColorDiv"+m},u),f=0;for(g=255;++f<7;){var N=l.create("div",{className:"TravelNotes-ColorDialog-CellColorDiv",id:"TravelNotes-ColorDialog-CellColorDiv"+m+f},T);if(m<7)N.setAttribute("style","background-color:"+s(v,g,p)),N.colorValue=s(v,g,p),N.addEventListener("click",e,!1),g-=51;else{var h=s(255,v=51*(f-1),v);N.setAttribute("style","background-color:"+h),N.redValue=255-v,N.addEventListener("click",r,!1)}}p-=51}var I=l.create("div",{className:"TravelNotes-ColorDialog-DataDiv",id:"TravelNotes-ColorDialog-DataDiv"},c);l.create("text",{data:i.getText("ColorDialog - Red")},I);var L=l.create("input",{type:"number",className:"TravelNotes-ColorDialog-NumberInput",id:"TravelNotes-ColorDialog-RedInput"},I);L.value=o(t).r,L.min=0,L.max=255,L.addEventListener("input",n,!1),l.create("text",{data:i.getText("ColorDialog - Green")},I);var E=l.create("input",{type:"number",className:"TravelNotes-ColorDialog-NumberInput",id:"TravelNotes-ColorDialog-GreenInput"},I);E.value=o(t).g,E.min=0,E.max=255,E.addEventListener("input",n,!1),l.create("text",{data:i.getText("ColorDialog - Blue")},I);var y=l.create("input",{type:"number",className:"TravelNotes-ColorDialog-NumberInput",id:"TravelNotes-ColorDialog-BlueInput"},I);return y.value=o(t).b,y.min=0,y.max=255,y.addEventListener("input",n,!1),l.create("div",{className:"TravelNotes-ColorDialog-ColorSampleDiv",id:"TravelNotes-ColorDialog-ColorSampleDiv"},c).setAttribute("style","background-color:"+t+";"),d.center(),d})}()},{"../UI/BaseDialog":9,"../UI/Translator":24,"./HTMLElementsFactory":14}],11:[function(L,t,e){!function(){"use strict";var c=[],u=null,v=null,o=0,g=0,p=0,m=null,T=function(){m&&(clearTimeout(m),m=null),p=g=0,document.removeEventListener("keydown",f,!0),document.removeEventListener("keypress",N,!0),document.removeEventListener("keyup",h,!0);var t=u.childNodes;t[0].firstChild.removeEventListener("click",T,!1);for(var e=1;e<t.length;e++)t[e].firstChild.removeEventListener("click",T,!1);document.getElementsByTagName("body")[0].removeChild(u),u=null,o=0},f=function(t){u&&(t.preventDefault(),t.stopPropagation()),"Escape"!==t.key&&"Esc"!==t.key||T(),"ArrowDown"!==t.key&&"ArrowRight"!==t.key&&"Tab"!==t.key||(o=o>=c.length?1:++o,u.childNodes[o].firstChild.focus()),"ArrowUp"!==t.key&&"ArrowLeft"!==t.key||(o=o<=1?c.length:--o,u.childNodes[o].firstChild.focus()),"Home"===t.key&&(o=1,u.childNodes[o].firstChild.focus()),"End"===t.key&&(o=c.length,u.childNodes[o].firstChild.focus()),"Enter"===t.key&&0<o&&c[o-1].action&&u.childNodes[o].firstChild.click()},N=function(t){t.preventDefault(),t.stopPropagation()},h=function(t){t.preventDefault(),t.stopPropagation()},I=function(t){t.stopPropagation(),c[t.target.menuItem].param?c[t.target.menuItem].action.call(c[t.target.menuItem].context,c[t.target.menuItem].param,v):c[t.target.menuItem].action.call(c[t.target.menuItem].context,v),T()};void 0!==t&&t.exports&&(t.exports=function(t,e){if(t.latlng.lat!==g||t.latlng.lng!==p)if(g=t.latlng.lat,p=t.latlng.lng,v=t,u)T();else{c=e;var o=document.getElementsByTagName("body")[0],r=L("./HTMLElementsFactory")(),n=r.create("div",{className:"TravelNotes-ContextMenu-Panel"},o),a=n.clientWidth,i=n.clientHeight;o.removeChild(n),(u=r.create("div",{id:"TravelNotes-ContextMenu-Container",className:"TravelNotes-ContextMenu-Container"},o)).addEventListener("mouseenter",function(){m&&(clearTimeout(m),m=null)},!1),u.addEventListener("mouseleave",function(){m=setTimeout(T,L("../L.TravelNotes").config.contextMenu.timeout)},!1),r.create("div",{innerHTML:"&#x274c",className:"TravelNotes-ContextMenu-CloseButton",title:L("./Translator")().getText("ContextMenu - Close")},u).addEventListener("click",T,!1);var s=0;c.forEach(function(t){var e=r.create("div",{className:"TravelNotes-ContextMenu-ItemContainer"},u),o=r.create("button",{innerHTML:t.name,id:"TravelNotes-ContextMenu-Item"+s,className:t.action?"TravelNotes-ContextMenu-Item":"TravelNotes-ContextMenu-Item TravelNotes-ContextMenu-ItemDisabled"},e);t.action&&o.addEventListener("click",I,!1),o.menuItem=s,++s});var l=Math.min(t.originalEvent.clientY,i-u.clientHeight-20),d=Math.min(t.originalEvent.clientX,a-u.clientWidth-20);u.setAttribute("style","top:"+l+"px;left:"+d+"px;"),document.addEventListener("keydown",f,!0),document.addEventListener("keypress",N,!0),document.addEventListener("keyup",h,!0)}else p=g=0})}()},{"../L.TravelNotes":7,"./HTMLElementsFactory":14,"./Translator":24}],12:[function(d,t,e){!function(){"use strict";var n=-1,a=function(t){t.deltaY&&(t.target.scrollTop=t.target.scrollTop+10*t.deltaY),t.stopPropagation()},i=function(t){e().setItinerary()},s=function(t){e().setTravelNotes()},l=function(t){e().setSearch()},e=function(){var t=d("../UI/TravelNotesPaneUI")(),e=d("../UI/SearchPaneUI")(),o=d("../UI/ItineraryPaneUI")(),r=function(){switch(n){case 0:o.remove();break;case 1:t.remove();break;case 2:window.osmSearch&&e.remove()}};return{createUI:function(t){!function(t){if(!document.getElementById("TravelNotes-Control-ItineraryDataDiv")){var e=d("../UI/HTMLElementsFactory")(),o=e.create("div",{id:"TravelNotes-Control-ItineraryHeaderDiv",className:"TravelNotes-Control-HeaderDiv"},t);e.create("div",{innerHTML:d("../UI/Translator")().getText("DataPanesUI - Itinerary"),id:"TravelNotes-Control-ItineraryPaneButton",className:"TravelNotes-Control-PaneButton"},o).addEventListener("click",i,!1),e.create("div",{innerHTML:d("../UI/Translator")().getText("DataPanesUI - Travel notes"),id:"TravelNotes-Control-TravelNotesPaneButton",className:"TravelNotes-Control-PaneButton"},o).addEventListener("click",s,!1),window.osmSearch&&e.create("div",{innerHTML:d("../UI/Translator")().getText("DataPanesUI - Search"),id:"TravelNotes-Control-SearchPaneButton",className:"TravelNotes-Control-PaneButton"},o).addEventListener("click",l,!1),e.create("div",{id:"TravelNotes-Control-ItineraryDataDiv",className:"TravelNotes-Control-DataDiv"},t).addEventListener("wheel",a,!1)}}(t)},setItinerary:function(){r(),o.add(),n=0},updateItinerary:function(){0===n&&(o.remove(),o.add())},setTravelNotes:function(){r(),t.add(),n=1},updateTravelNotes:function(){1===n&&(t.remove(),t.add())},setSearch:function(){r(),e.add(),n=2},updateSearch:function(){2===n&&(e.remove(),e.add())}}};void 0!==t&&t.exports&&(t.exports=e)}()},{"../UI/HTMLElementsFactory":14,"../UI/ItineraryPaneUI":17,"../UI/SearchPaneUI":22,"../UI/Translator":24,"../UI/TravelNotesPaneUI":26}],13:[function(i,t,e){!function(){"use strict";var o=null;void 0!==t&&t.exports&&(t.exports=function(){var n=i("./Translator")(),a=function(){document.getElementById("TravelNotes-Control-ErrorDataDiv").classList.add("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-ErrorMessageDiv").innerHTML=""};return{createUI:function(t){!function(t){if(!document.getElementById("TravelNotes-Control-ErrorDataDiv")){var e=i("./HTMLElementsFactory")(),o=e.create("div",{id:"TravelNotes-Control-ErrorDataDiv",className:"TravelNotes-Control-DataDiv TravelNotes-Control-HiddenList"},t),r=e.create("div",{id:"TravelNotes-Control-ErrorHeaderDiv",className:"TravelNotes-Control-HeaderDiv TravelNotes-Control-HiddenList"},o);e.create("span",{innerHTML:"&#x274c",title:n.getText("ErrorEditorUI - Hide"),id:"TravelNotes-Control-ErrorExpandButton",className:"TravelNotes-Control-HiddenList"},r).addEventListener("click",function(t){t.stopPropagation(),document.getElementById("TravelNotes-Control-ErrorMessageDiv").innerHTML.length&&a()},!1),e.create("div",{id:"TravelNotes-Control-ErrorMessageDiv"},o)}}(t)},set message(t){var e;e=t,o&&(clearTimeout(o),o=null),document.getElementById("TravelNotes-Control-ErrorMessageDiv").innerHTML=e,document.getElementById("TravelNotes-Control-ErrorDataDiv").classList.remove("TravelNotes-Control-HiddenList"),o=setTimeout(a,i("../L.TravelNotes").config.errorMessages.timeout)},get message(){return document.getElementById("TravelNotes-Control-ErrorDataDiv").innerHTML}}})}()},{"../L.TravelNotes":7,"./HTMLElementsFactory":14,"./Translator":24}],14:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){return{create:function(t,e,o){var r;if(r="text"===t.toLowerCase()?document.createTextNode(""):document.createElement(t),o&&o.appendChild(r),e)for(var n in e)try{r[n]=e[n]}catch(t){console.log("Invalid property : "+n)}return r}}})}()},{}],15:[function(m,t,e){!function(){"use strict";var u=m("../UI/HTMLElementsFactory")(),d=m("../L.TravelNotes"),v=m("../UI/Translator")(),g=m("../util/Utilities")(),o=m("../core/NoteEditor")(),e=m("../core/RouteEditor")(),p="TravelNotes-Control-";void 0!==t&&t.exports&&(t.exports=function(){var c=function(t,e){u.create("div",{className:p+"Travel-Notes-IconCell",innerHTML:t.iconContent},e).setAttribute("style","width:"+t.iconWidth+"px;"),u.create("div",{className:p+"Travel-Notes-Cell",innerHTML:o.getNoteHTML(t,p)},e),e.noteObjId=t.objId},r=function(){var t=u.create("div",{className:p+"Travel-Header"});u.create("div",{className:p+"Travel-Header-Name",innerHTML:d.travel.name},t);for(var e=0,o=d.travel.routes.iterator;!o.done;)u.create("div",{className:p+"Travel-Header-RouteName",innerHTML:'<a href="#route'+o.value.objId+'">'+o.value.name+"</a>&nbsp;:&nbsp;"+g.formatDistance(o.value.distance)+"."},t),o.value.chain&&(e+=o.value.distance);return u.create("div",{className:p+"Travel-Header-TravelDistance",innerHTML:v.getText("HTMLViewsFactory - Travel distance&nbsp;:&nbsp;{distance}",{distance:g.formatDistance(e)})},t),t},n=function(){for(var t=u.create("div",{className:p+"Travel-Notes"}),e=d.travel.notes.iterator;!e.done;){var o=u.create("div",{className:p+"Travel-Notes-Row"},t);c(e.value,o)}return t},a=function(t){return u.create("div",{className:p+"Route-Header",id:"route"+t.objId,innerHTML:e.getRouteHTML(t,p)})},i=function(t){for(var e=u.create("div",{className:p+"Route-ManeuversAndNotes"}),o=t.notes.iterator,r=o.done,n=r?999999999:o.value.distance,a=t.itinerary.maneuvers.iterator,i=a.done,s=0;!i||!r;){var l=u.create("div",{className:p+"Route-ManeuversAndNotes-Row"},e);if(s<=n){if(!i){l.className=p+"Route-Maneuvers-Row",u.create("div",{className:p+"Route-ManeuversAndNotes-IconCell TravelNotes-ManeuverNote-"+a.value.iconName},l);var d="<div>"+a.value.instruction+"</div>";0<a.value.distance&&(d+="<div>"+v.getText("HTMLViewsFactory - To next instruction&nbsp;:&nbsp;{distance}&nbsp;-&nbsp;{duration}",{distance:g.formatDistance(a.value.distance),duration:g.formatTime(a.value.duration)})+"</div>"),u.create("div",{className:p+"Route-ManeuversAndNotes-Cell",innerHTML:d},l),l.objId=m("../data/ObjId")(),l.latLng=t.itinerary.itineraryPoints.getAt(a.value.itineraryPointObjId).latLng,l.maneuverObjId=a.value.objId,s+=a.value.distance,(i=a.done)&&(s=999999999)}}else r||(l.className=p+"Route-Notes-Row",c(o.value,l),l.objId=m("../data/ObjId")(),l.latLng=o.value.latLng,l.noteObjId=o.value.objId,n=(r=o.done)?999999999:o.value.distance)}return e},s=function(t){var e="";return""!==t.itinerary.provider&&""!==t.itinerary.transitMode&&(e=v.getText("HTMLViewsFactory - Itinerary computed by {provider} and optimized for {transitMode}",{provider:t.itinerary.provider,transitMode:v.getText("HTMLViewsFactory - TransitMode "+t.itinerary.transitMode)})),u.create("div",{className:p+"RouteFooter",innerHTML:e})},l=function(){return u.create("div",{className:p+"TravelFooter",innerHTML:v.getText("HTMLViewsFactory - Travel footer")})};return{set classNamePrefix(t){p=t},get classNamePrefix(){return p},get travelHeaderHTML(){return r()},get travelNotesHTML(){return n()},get routeHeaderHTML(){return a(d.editedRoute)},get routeManeuversAndNotesHTML(){return i(d.editedRoute)},get routeFooterHTML(){return s(d.editedRoute)},get travelFooterHTML(){return l()},get travelHTML(){return function(){var t=u.create("div",{className:p+"Travel"});t.appendChild(r()),t.appendChild(n());for(var e=d.travel.routes.iterator;!e.done;){var o=d.config.routeEditor.displayEditionInHTMLPage&&e.value.objId===d.routeEdition.routeInitialObjId;t.appendChild(a(o?d.editedRoute:e.value)),t.appendChild(i(o?d.editedRoute:e.value)),t.appendChild(s(o?d.editedRoute:e.value))}return t.appendChild(l()),t}()}}})}()},{"../L.TravelNotes":7,"../UI/HTMLElementsFactory":14,"../UI/Translator":24,"../core/NoteEditor":34,"../core/RouteEditor":35,"../data/ObjId":44,"../util/Utilities":52}],16:[function(t,e,o){arguments[4][14][0].apply(o,arguments)},{dup:14}],17:[function(c,t,e){!function(){"use strict";var i=function(t){t.stopPropagation();for(var e=t.target;!e.latLng;)e=e.parentNode;c("../core/MapEditor")().zoomToPoint(e.latLng)},s=function(t){t.stopPropagation(),t.preventDefault();for(var e=t.target;!e.latLng;)e=e.parentNode;e.maneuverObjId?c("../core/NoteEditor")().newManeuverNote(e.maneuverObjId,e.latLng):e.noteObjId&&c("../core/NoteEditor")().editNote(e.noteObjId)},l=function(t){t.stopPropagation(),c("../core/MapEditor")().addItineraryPointMarker(t.target.objId,t.target.latLng)},d=function(t){t.stopPropagation(),c("../core/MapEditor")().removeObject(t.target.objId)};void 0!==t&&t.exports&&(t.exports=function(){return{remove:function(){!function(){var t=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(t){var e,o,r,n=document.getElementsByClassName("TravelNotes-Control-Route-Header")[0];n&&t.removeChild(n);var a=document.getElementsByClassName("TravelNotes-Control-Route-ManeuversAndNotes")[0];if(a){for(o=a.childNodes,e=0;e<o.length;e++)(r=o[e]).removeEventListener("click",i,!1),r.removeEventListener("contextmenu",s,!1),r.removeEventListener("mouseenter",l,!1),r.removeEventListener("mouseleave",d,!1);t.removeChild(a)}}}()},add:function(){!function(){document.getElementById("TravelNotes-Control-ItineraryPaneButton").classList.add("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-TravelNotesPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),window.osmSearch&&document.getElementById("TravelNotes-Control-SearchPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton");var t=c("../UI/HTMLViewsFactory")();t.classNamePrefix="TravelNotes-Control-";var e=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(e){var o,r,n;e.appendChild(t.routeHeaderHTML),e.appendChild(t.routeManeuversAndNotesHTML);var a=document.getElementsByClassName("TravelNotes-Control-Route-ManeuversAndNotes")[0];if(a)for(r=a.childNodes,o=0;o<r.length;o++)(n=r[o]).addEventListener("click",i,!1),n.addEventListener("contextmenu",s,!1),n.addEventListener("mouseenter",l,!1),n.addEventListener("mouseleave",d,!1)}}()}}})}()},{"../UI/HTMLViewsFactory":15,"../core/MapEditor":33,"../core/NoteEditor":34}],18:[function(j,t,e){!function(){"use strict";var C,D,x=j("../UI/Translator")(),R={editionButtons:[],preDefinedIconsList:[]},M={editionButtons:[],preDefinedIconsList:[]},B={editionButtons:[],preDefinedIconsList:[]},A=function(){return 0===document.getElementById("TravelNotes-NoteDialog-TextArea-IconHtmlContent").value.length?(document.getElementById("TravelNotes-BaseDialog-ErrorDiv").innerHTML=x.getText("Notedialog - The icon content cannot be empty"),document.getElementById("TravelNotes-BaseDialog-ErrorDiv").classList.remove("TravelNotes-BaseDialog-ErrorDivHidden"),!1):(C.iconWidth=document.getElementById("TravelNotes-NoteDialog-WidthNumberInput").value,C.iconHeight=document.getElementById("TravelNotes-NoteDialog-HeightNumberInput").value,C.iconContent=document.getElementById("TravelNotes-NoteDialog-TextArea-IconHtmlContent").value,C.popupContent=document.getElementById("TravelNotes-NoteDialog-TextArea-PopupContent").value,C.tooltipContent=document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value,C.address=document.getElementById("TravelNotes-NoteDialog-InputText-Adress").value,C.url=document.getElementById("TravelNotes-NoteDialog-InputText-Link").value,C.phone=document.getElementById("TravelNotes-NoteDialog-InputText-Phone").value,j("../core/NoteEditor")().endNoteDialog(C,D),!0)};void 0!==t&&t.exports&&(t.exports=function(t,e,o){var r=function(){B.preDefinedIconsList=M.preDefinedIconsList.concat(R.preDefinedIconsList),B.preDefinedIconsList.sort(function(t,e){return t.name.localeCompare(e.name)});var t=0;for(t=c.length-1;0<=t;t--)c.remove(counter);for(t=0;t<B.preDefinedIconsList.length;t++){var e=s.create("option",{text:B.preDefinedIconsList[t].name});c.add(e)}},n=function(t){t.forEach(function(t){s.create("button",{type:"button",innerHTML:t.title||"?",htmlBefore:t.htmlBefore||"",htmlAfter:t.htmlAfter||"",className:"TravelNotes-NoteDialog-EditorButton"},d).addEventListener("click",a,!1)})},a=function(t){if(u){for(var e=t.target;!e.htmlBefore;)e=e.parentNode;var o=e.htmlAfter&&0<e.htmlAfter.length,r=u.selectionStart,n=u.selectionEnd,a=u.value;u.value=a.substring(0,r)+(o?e.htmlBefore+a.substring(r,n)+e.htmlAfter:e.htmlBefore)+a.substring(n),u.setSelectionRange(o||r===n?r+e.htmlBefore.length:r,(o?n:r)+e.htmlBefore.length),u.focus()}};C=t,D=e;var i=j("../UI/BaseDialog")();i.title=x.getText("NoteDialog - Note"),i.addClickOkButtonEventListener(A);var s=j("./HTMLElementsFactory")(),l=s.create("div",{id:"TravelNotes-NoteDialog-MainDataDiv"},i.content),d=s.create("div",{className:"TravelNotes-NoteDialog-ToolbarDiv",id:"TravelNotes-NoteDialog-ToolbarDiv"},l),c=s.create("select",{className:"TravelNotes-NoteDialog-Select",id:"TravelNotes-NoteDialog-IconSelect"},d);c.addEventListener("change",function(t){c.selectedIndex;var e=B.preDefinedIconsList[c.selectedIndex];T.value=e.width,f.value=e.height,N.value=e.icon,I.value=e.tooltip},!1);var u=null,v=s.create("div",{id:"TravelNotes-NoteDialog-OpenEditorFileDiv"},d),g=s.create("input",{id:"TravelNotes-NoteDialog-OpenEditorFileInput",type:"file",accept:".json"},v);g.addEventListener("change",function(t){var o=new FileReader;o.onload=function(t){try{var e=JSON.parse(o.result);R.editionButtons=R.editionButtons.concat(e.editionButtons),R.preDefinedIconsList=R.preDefinedIconsList.concat(e.preDefinedIconsList),n(e.editionButtons),r()}catch(t){}},t.target.files[0].name,o.readAsText(t.target.files[0])},!1);var p=s.create("div",{id:"TravelNotes-NoteDialog-OpenStyleFakeDiv"},v);s.create("button",{id:"TravelNotes-NoteDialog-OpenEditorFileButton",className:"TravelNotes-NoteDialog-EditorButton",title:x.getText("NoteDialog - Open a configuration file"),innerHTML:"&#x23CD;"},p).addEventListener("click",function(){g.click()},!1),n([{title:"div",htmlBefore:"<div>",htmlAfter:"</div>"},{title:"p",htmlBefore:"<p>",htmlAfter:"</p>"},{title:"span",htmlBefore:"<span>",htmlAfter:"</span>"},{title:"a",htmlBefore:'<a target="_blank" href="">',htmlAfter:"</a>"}]),n(M.editionButtons),n(R.editionButtons),r();var m=s.create("div",{className:"TravelNotes-NoteDialog-DataDiv",id:"TravelNotes-NoteDialog-DimensionsDataDiv"},l);s.create("text",{data:x.getText("NoteDialog - Icon width")},m);var T=s.create("input",{type:"number",className:"TravelNotes-NoteDialog-NumberInput",id:"TravelNotes-NoteDialog-WidthNumberInput"},m);T.value=t.iconWidth,s.create("text",{data:x.getText("NoteDialog - Icon height")},m);var f=s.create("input",{type:"number",className:"TravelNotes-NoteDialog-NumberInput",id:"TravelNotes-NoteDialog-HeightNumberInput"},m);f.value=t.iconHeight,s.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",id:"TravelNotes-NoteDialog-IconContentTitleDiv",innerHTML:x.getText("NoteDialog - Icon content")},l);var N=s.create("textarea",{className:"TravelNotes-NoteDialog-TextArea",id:"TravelNotes-NoteDialog-TextArea-IconHtmlContent"},l);N.addEventListener("focus",function(t){u=N},!1),N.value=t.iconContent,s.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:x.getText("NoteDialog - Text")},l);var h=s.create("textarea",{className:"TravelNotes-NoteDialog-TextArea",id:"TravelNotes-NoteDialog-TextArea-PopupContent"},l);h.addEventListener("focus",function(t){u=h},!1),h.value=t.popupContent,s.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:x.getText("NoteDialog - Tooltip content")},l);var I=s.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Tooltip"},l);I.addEventListener("focus",function(t){u=I},!1),I.value=t.tooltipContent,s.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:"<span id='TravelNotes-NoteDialog-Reset-Address-Button'>&#x1f504;</span>&nbsp;"+x.getText("NoteDialog - Address&nbsp;:")},l),document.getElementById("TravelNotes-NoteDialog-Reset-Address-Button").addEventListener("click",function(){j("../core/GeoCoder")().getAddress(t.lat,t.lng,function(t){L.value=t},this)},!1);var L=s.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Adress"},l);L.addEventListener("focus",function(t){u=L},!1),L.value=t.address,s.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:x.getText("NoteDialog - Link")},l);var E=s.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Link"},l);E.addEventListener("focus",function(t){u=null},!1),E.value=t.url,s.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:x.getText("NoteDialog - Phone")},l);var y=s.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Phone"},l);if(y.addEventListener("focus",function(t){u=y},!1),y.value=t.phone,0===M.preDefinedIconsList.length){var b=new XMLHttpRequest;b.onreadystatechange=function(t){if(this.readyState===b.DONE)if(200===this.status)try{M=JSON.parse(this.responseText),n(M.editionButtons),M.preDefinedIconsList.push({name:"",icon:"",tooltip:"",width:40,height:40}),r()}catch(t){console.log("Error reading TravelNotesNoteDialog.json")}else console.log("Error sending request for TravelNotesNoteDialog.json")},b.open("GET",window.location.href.substr(0,window.location.href.lastIndexOf("/")+1)+"TravelNotesNoteDialog.json",!0),b.send(null)}j("../L.TravelNotes").config.note.reverseGeocoding&&""===t.address&&o&&j("../core/GeoCoder")().getAddress(t.lat,t.lng,function(t){L.value=t},this),i.center()})}()},{"../L.TravelNotes":7,"../UI/BaseDialog":9,"../UI/Translator":24,"../core/GeoCoder":31,"../core/NoteEditor":34,"./HTMLElementsFactory":14}],19:[function(g,t,e){!function(){"use strict";var c=g("../L.TravelNotes"),u=function(t){t.stopPropagation(),c.routing.provider=t.target.provider,document.getElementsByClassName("TravelNotes-Control-ActiveProviderImgButton")[0].classList.remove("TravelNotes-Control-ActiveProviderImgButton"),t.target.classList.add("TravelNotes-Control-ActiveProviderImgButton");var e=c.providers.get(t.target.provider);e.transitModes.car?document.getElementById("TravelNotes-Control-carImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-carImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),e.transitModes.bike?document.getElementById("TravelNotes-Control-bikeImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-bikeImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),e.transitModes.pedestrian?document.getElementById("TravelNotes-Control-pedestrianImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-pedestrianImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),e.transitModes.train?document.getElementById("TravelNotes-Control-trainImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-trainImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),c.providers.get(t.target.provider).transitModes[c.routing.transitMode]||(e.transitModes.bike?document.getElementById("TravelNotes-Control-bikeImgButton").click():e.transitModes.pedestrian?document.getElementById("TravelNotes-Control-pedestrianImgButton").click():e.transitModes.car?document.getElementById("TravelNotes-Control-carImgButton").click():e.transitModes.train&&document.getElementById("TravelNotes-Control-trainImgButton").click()),g("../core/RouteEditor")().startRouting()},v=function(t){t.stopPropagation(),c.routing.transitMode=t.target.transitMode,document.getElementsByClassName("TravelNotes-Control-ActiveTransitModeImgButton")[0].classList.remove("TravelNotes-Control-ActiveTransitModeImgButton"),t.target.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),g("../core/RouteEditor")().startRouting()};void 0!==t&&t.exports&&(t.exports=function(){var o=null,r=g("../UI/HtmlElementsFactory")(),n=!1,a=null,i=null,s=null,l=null,e=function(t){var e=r.create("img",{src:"data:image/png;base64,"+t.icon,id:"TravelNotes-Control-"+t.name+"ImgButton",className:"TravelNotes-Control-ImgButton",title:t.name},o);e.provider=t.name.toLowerCase(),e.addEventListener("click",u,!1),n||(e.classList.add("TravelNotes-Control-ActiveProviderImgButton"),c.routing.provider=e.provider,n=!0,t.transitModes.bike?(a.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),c.routing.transitMode="bike"):t.transitModes.pedestrian?(i.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),c.routing.transitMode="pedestrian"):t.transitModes.car?(s.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),c.routing.transitMode="car"):t.transitModes.train&&(l.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),c.routing.transitMode="train"),t.transitModes.car||s.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),t.transitModes.pedestrian||i.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),t.transitModes.bike||a.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),t.transitModes.train||l.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"))},d=function(t){o=r.create("div",{id:"TravelNotes-Control-ItineraryButtonsDiv",className:"TravelNotes-Control-ButtonsDiv"},t),(a=r.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AoaESkaC0SxrgAABMdJREFUSMfNl1loVGcYhp//n+WcZmbiJE4WjVKVaLWOGxglilFTSmYUF1ILKiIILSjplQiKS65EXG4UvBGrQvVCUAdjoRrEGmtwjQbtWKlpEsTGGDMxkzKTzHr+XiRucbK4ts/lOd/5X853vuU9gj4YN+48Dx58DUBOzrmhnZ0qXykWJBKqKJlkYjyusgAsFtFqMnHPbBa/CcEvaWnir5YWT1vvM3ojUl2cPv1XamqK8fv/MBcWPtwfDhuLlWKYUvSLECAEzTabPHP16uc/uN1fJp6fNShhpRROZ+WSzk7jVDyuTLwDFotIpqXJb4LBkgohRP/Cbvc5/H6krhsnolFVOtAbDoQQoGnCF4nIb91uDL/f8+KefDXQ70e6XOpIJPL+ot2Zg0hElbpc6ojf/7qWBPB6q1FKoevqRCBgrOYDEwgYq3VdnVBK4fVWd2cjL6+SpqYSnM5zi4PBZAUfEafTtCQY9JzJy6tENjWVsH79ZWs4bJziIxMOG6fWr79sbWoq6S4uTTt7MBo1vuMToGnyx2jU+71ITz/rCoWM3w2D3AFKBUj0NIL5nYWl5IndLidJw2CsUgOJwtSp6SQSC7h5czZO50vhIUPMTJrkYMIEO8OHa4Op9FzDYKyUEs9gWqelJUpbm8GcOdcJBmOAARjEYgZFRUOoqZnNyJGDEkZKPOZIRM0bTIricUU8blBePhaQKAXJZBzDUMyYkcnly21cvx7sPRpSEomoeWZgQv9hSUAxYoSD8+efsmdPIxkZVgBMJrDZTKxdO4YLF56Sm/sZT5509jzX76SdYI7FurdMKoqKMti8eQyZmVakFOTkaGzaFGP79gZCoSSaJpk82UFl5VN2727k+PEpxGIGHR0Jdu5s4Natf1KeG4uprD7Lc86cDPbuHc/y5Xd4/DhKa+tXNDZ2cfJkC9euFXLw4EMMA6ZNG8KOHfUcPjyZKVPSWbnyNg0NEXy+aaxadYcbN1KLS6tVtKZK75YtY1ix4i51dZ0sWpTF3bshurqSZGdruN3VLFyYS3HxUEKhJAsXZpGbq1Faeovt28dz716IpUtvs21bfs+neh2rVbSagftAVu+edTotdHUl0XVJdraV+fOvcejQJPLzbSj1lHXr/GiapL09gc83lWg0ycyZDk6ffozNZiIUSpKdbe3p/ze4LzVNVKVIBJcuteHxuOjqSrJvXyNpaSaKi134fM2AoL6+C6/Xxf79X7Bx45/Y7RZ27XpIeXkdoVCcuXMzuXIldZVrmqgSdvvZwnDYuNK7l9PTzVRVzUAIQV1dmLlzh7Jhw32OHm16ZY0r8vPTSCQUXm8WW7fmc/p0C263g5wcK7NmXePZs/gbO9pmk7MGGJkJvN5cRo9O4+efW3j0KNKXaQEMJk50sGzZMOrrwxw79nfKlno+MgexJFR/Lumt458vCQlQVmYvs1hEgj79oHiLNdB3vMUiEmVl9rL/3gh4vdW0t5ec0XXp+1iiui597e0lZ7zeal4YgZecky6XOvKhfZfLJX8KBMQa8BgpXabbjREIiDW6LnxCvL+gEKDrwhcIiDVuN8b/wtCnXJ4FBRfp6PBU1NaO0h0OeUBKmgeTASFASpodDnmgtnaU3tHhqSgouDj4f6dP8dP2L6C7Ld6Z4dDBAAAAAElFTkSuQmCC",id:"TravelNotes-Control-bikeImgButton",className:"TravelNotes-Control-ImgButton"},o)).transitMode="bike",a.addEventListener("click",v,!1),(i=r.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AoaESo7bADyMwAABNlJREFUSMe1V19oU1cY/52Te5Ob3DR/SfzTNNCufxRXxmarONCnPbi+ykYrFdRSkeJLX5ykZcKcFfG5oIJ2Y2sVFZQ+iPoiUhC128OIiJrUlgQTm9o0t23SJufmnj2k2ura5syx7ynknu/7nd93vr8E6wghBJxzAEAgAEsmc3pToWD1y3L6M8NQfABA6eIUY54xs3kh5Xb3JONx5D/WXdX2Wh9crkPIZAbAOVBRcbpvYaHuO87lDZyTCs7lFaochDAQwucANmmzRa7PzfWECFm2IQTsdrdiZuYqHI5quVg80J7P113WdR+AIsTEBEmagsUSOayq539PpVLM5WpFJnO1POOtW+GMRH4dKRa9jZxTABz/TggIMSDLU+Fg8NDuaBTaxyfoux8ORxsAwG7vrI5Ehl7pur+Rc/IJoCX3c05QKGxsnJgYemW3d1avxPgH42AQzkRi6JWuOz3ljReX7k3KnpQkLb158/6aWGyZOS0F0kF4vX45mRwY0XV3WdCGBhsePvwa3d1BAEZZYF13e5LJgRGv1y87nQdLjCmlMAwDqvrj4Wx2x6XyDAw8eLADe/b4AQCqehu5nJj7bbYnHbncT5cppaCGYYBzIJ+vu7TiydcNnP7+GBKJRQwPJ5HL6YLvTlEo1F3iHDAMo4Rkt5/qK6UMFwK+du0NurvDePt2EQ0NdkE9Dl33wW4/1QcApKoKltevrz01DLVWNGKbmhwYHd1dCrEiR0vLY9y7Ny0UaJRmo5WV339OZ2b6NgGyXzRRVFXC4OCXKwwBd+/uRH//VkHmsn9mpm8TZUzxcU4comzb2zciEFCg6yWQZ8/mcOJEGF1dNaivV8tb4MTBmOKjkpSuLdXe8lJZacb5819g374/QEiphJpMBGfPvlxiTwSAZUjSdC0tdZnyCiYTwfBwMx49SuPOnSkA7P3/7/QZM4SC0zCsPkn0bX0+GU+eTCMUGgNAcO7cGEwmCbOzFITI2Lv3ESYmFsWruar2tmWzu4bEjhtLxY4jn/8G2ayByck8mpsfY36+CPEAfbif6ronSggTLgKAgQsXtmF+nuLIkTC2bHGhpcUj3EwIYdB1b5TK8uIUIXxW9LbBoBXt7VW4ciWOGzeSuHnzNQYHvxJ3MeGzZvPiFHW7Q0mApcTUiujtrYHVChw79hyAjOPHX6JYJLh4cZtQwyCEpVyuUJLG48hbrS+uA6aySvX1Kjo7q9HV9fS9a6PRHG7dSqCtLYBAwFp2OlGUF9fjceRJKbcAWf6N67p3zbciBBgZ2Ym6OjsaGh4gk1luDmYzQT7/LUKhZzhzZnyN0kkgSdNg7AAhBKCUUhACWCyRjvVc1dxcgV273Dh58jkymQ+DsVAwcPToX1AUsm5GmM2RjiXQ0tVcroMAbsvZ7Nk/GdvYuNoF/H4ZGzZYEA7PrcpIUSgoBXI5Y9VskOU3Yafzh+2MtTBN++W/jD7iIklauqpqf834+Eejz7tBLBaDpij3myRJS4sNBeXzXpK0tKLcbxofh+Z0tq0/3tbWwhmLDYww5vv/x9vlDaIV0Sg0jye03WYbPSxJ0xBJtQ8H+mlus412eDwntkej0Fyu1k9dYX7uW1ioX3OFoZQB4HOEsEmr9RNXmLWWtspKWDRt9aVN1z1jsryQcjh6komE2NL2N0SHF0QJfjNNAAAAAElFTkSuQmCC",id:"TravelNotes-Control-pedestrianImgButton",className:"TravelNotes-Control-ImgButton"},o)).transitMode="pedestrian",i.addEventListener("click",v,!1),(s=r.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AoaESgBmDpJAwAABQBJREFUSMe9V09MFFcY/703szOz7PLP2WVBV6rtdm21HqhG2wiCh8bL2jWhsl71IhqJJ4oHL4RIxKP1HzESLh4MEGPkoAeNYRWtGkPShGRF+aeFld2psd0BZnZmXg+LW4SdrW3EX/Iub775fe/7977vEdigrCyMmZnrAABZbvGoavkGSh0hy3LtNAzuS57nZAAwTVPhOHOEUnXAstL9Ltd0TFFOJ5dyLAXJtSnLMhRFwaNHoDt3nj2v66vDjHHljDkAsIXf2CKKzB4haRBixgVh6vrAwNEj27bB8ng8SCaTH6aYMcDtPh3StM/6DKNIACz8N1Dw/J+6KI7Xp1It/YTkkliEwsJmnD8PIopdvbOzX90wDPf/UAoAFgzDLczOfn1Dkrp6T5wAKSpqtre4tRXk5MkLV3W9ch8+IgRhsqel5XCkrS0bn4xiWZaRTCqQpK5eTfPVYwUgiq/75ucP/uT1ZmJOvd4wFEWBy9UR0nXPiigFAF331LtcHaFkMomysnDG4mgUdNeuq3OZmK4ceD6lP34ccVZVwSIZN5y9qGlfHLJPJAa/X4LbzeUlnp21MDk5Z1csAChE8XmnpjU1Eln+2fPmzXe/WZZYbkcoyxympn6AaaahKCrIkvpgjKGkpACSJCAQuI2JibR9oVEtXlz862ZeVSs2MMaV57NkzRoHBIFi06aHGB5+m/XC4sIIBAoxMrILfr+YVzFjXPncXPkGSikfytxIeapyIQKHDlUAAIJBN3p7t+Lata0IBt0AGBobVy/IsrxcjDlACL+Htyx3zT+nz3GnEqCyUkJ39wSOHYvh7t1vUVvrz37fu3cNotHfUVs7BElywO+XAKj5VIMxdw01TS5onwwWHjzYjp6ebaiokFBdXYJUSl8mNT9voq6uBH6/hO7uLXjy5HtQamsKTJMLUo7j5NwWMxw44Mf27TIKCnjs3u1DNFqDVGq5bDJp4M6dHQiHV6OggMeWLaU4enQt7Hg5jltF88WjqIjPNo13aGj4fJnc/v3r32swAFBcnD9vqGmaSm5XE5w58xINDYMgBKiru4ebN+NIpxlGR1WMjWXW6KgKTbMwOKigunoAhACHDz/CqVNjsOM1TVPhBOHHsGG4KnOfK41z577BunWFcDgscByDzyfh9u04Xr5UMTmZWT6fhFevVAQCBaiqKkVpKYfLl6fzNI3UEE9pKgr4duSOB0EqZQAAVNXAyIiKp0/fgudJ1qWEAJcujYEQAll2LMiaiwaG5ZyEpKK8ZRn9hKSPM8bnul3R1TWJUGgtLlyYwtDQX3njtn69E01NQVy58gqMEZvyTIMxo586ndMxQsy4Hdn4eBr37ycwPj6/YIH9mprScO9eAs+eaXnuBTPudE7HFprELxc1LZCnSVhLh5W804e9LIUgPO/U9aZGAgDDw6CbN1+dM82VbYscl9JjsYgzEIBFy8rC2LgRlihO1BNirphSQkyI4nh9IAArOwh4vV7MzCQ+7egDAIlEAoQAra0H9wnCRM/HVioIEz2trQf3EYLsjP1eFrS3N7Pjx49ERPF138dwe8a9r/va2o5E2tub2QcO9B0hTVv3aQb6d/B4ZKhqS/+tWxGnJL3opFSLE2IsOifJcXYCQgxQqsUl6UXn4GDEqaot/V6v58PfTpmECyORWPpo4/dYlrvGMLggz3OrFh5tf1BqPuO4VNSyjBsuVzymKB3/+mj7G1dPIltjqpC6AAAAAElFTkSuQmCC",id:"TravelNotes-Control-carImgButton",className:"TravelNotes-Control-ImgButton"},o)).transitMode="car",s.addEventListener("click",v,!1),(l=r.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4goTCiEjvCsRvgAABXRJREFUSMe9V11MFFcU/u7MsDPLrgvu7A80BEhLsRIxEFIlcSXBF41BN2ExqC8kPHQraV80iA+GhKAYaLUihkLaaErig1FCiCZq2kQDjS0YfcGYQKtBg7DL7hbFHdaZnTu3D0tR7C7aRvxeJrn3zP3O3z3nXIIUcLm8mJ0dBADIcpNDUbLWcVxalWFYKnSd/1QQeBkAKKURnqd/cJwyZBjxqxbLzHgk0hF+84w3QZItyrKMSCSC0VFwFRVnuzXtIy9jfBZjaQDY4m/stSMSa4TEQQgNmEzTg0NDXzVs2gTD4XAgHA6/GzFjgNXaUaWqef26bjMBBv4bOAjCvCaKk75otOkqIckkXsOaNY3o7gYRxXOXFxY+u6Lr1v9BCgAGdN1qWlhYf0WSzl0+ehTEZmtMbXFLC8jx499f1LTcPXiPMJmeXGpqOlDb2roUnwSxLMsIhyOQpHOXVdXtwypAFIP9L1/W1zidiZhzTqcXkUgEFkt7laY5VoUUADTN4bNY2qvC4TBcLm/C4uFhcJWVF2OJmK4eBCGq3blTay4thUESbjjbo6qf+JMlks3GYX7egNfrgtv9A+bn55Geng673Y7du3eD0iL4/ffx6JECm03A3JwOxlJnuyj+2auqX3/Jy/Jhh6Ks72SMtyZPDAJNY9i40Yq+vi9QU1OD6elp5OXlIRgMorp6C4qL14BSBkWhCAY1CAJgJL0MDIyl52Rm5v8kKEr2Osb4rJQXw0iob7ebMDIygvLy8qW9/Px89PT0oKSkBGfOfItTpwK4fz8KWU5DMBhH8hrBZ8ViWes4jhOqEhUpORwOEW63Cdu2CSgvL8fY2BgYY2CMobOzEzt27IDD4UBnZydevEi42WYTUp7HWBoIEXYJhmHd+qr8/Rvd3RuQns5j374NOH/+PLKzs9HX1wdCCOx2O+rq6pCTkwNN00AIQSCgYnx8AUAsFTUYs24VKOULl9fe5XjyJIbm5s9x4sQJlJSUwO12g1KaUtHe3l7k5lbg3r35FBIElPKFHM/z8koWHzu2BUNDQ7h27RpKS0tXJAUAv9+Pykr7ChIMPM/bhbfdPb/fj4GBAfT39y+tud1ubN68GRkZGQiFQpiamsKzZ8+gKApisRhGR/sAFK18pymlEYA4U1lNKUVlZSUuXLiA7du3w25fbg1J0nri8Tiam39ewdU0IvA8nYjHmTOVZnv37kVhYSE8Hg/YYmX45zs5OYmZmRmUlZVBkqTF0qhB1/W3uJpOcBwXHU7RlgEA1dXV4HkegiDgwIEGdHR8A13XQQjBxMQEPB4P2tvbl+T379+PgwcPrUBMQEh0mEjSd1tU9eNfGUse7p07HcjOlvD0aRPMZjMGBgaW9nw+HyoqKqAoCjRNA6UUU1NTuH79OmZmfkxOS3SI4iMPWbv2sOP58/IxwxBTVi9CgPr6HITDzXC5XJAkCV1dXSltOnToF5w8qSav1pwayMj4vViYm+sIi2LXoKoWJG0SZjOBIHAoK7OB484gM/M31NXV4e7du7h5U0Ju7gzM5hhu3bqFkZEReDzHcfr0wgoj0dPBubmOMAGABw/AFRdfjFG6um2R56Pa+HituaAABudyeVFUBEMUH/sIoatGSgiFKE76CgpgLA0CTqcTs7OhDzv6AEAoFAIhQEtL/R6T6fGl901qMj2+1NJSv4cQLM3Yy8bbtrZGduRIQ60oBvvfh9sT7g32t7Y21La1NbJ3HOjbq1Q1/8MM9K+avwxFabp640atWZIe9nKcGiBEf01PkkR3AkJ0cJwakKSHvbdv15oVpemq0+l497dTIuG8CIXefLQJuwzDulXX+UJB4O2LTeQvjqMTPB8dNgz9isUSGI9E2t/6aPsbwfNWty4y/a8AAAAASUVORK5CYII=",id:"TravelNotes-Control-trainImgButton",className:"TravelNotes-Control-ImgButton"},o)).transitMode="train",l.addEventListener("click",v,!1),c.providers&&(n=!1,c.providers.forEach(e))};return{createUI:function(t){d(t)},get provider(){return c.routing.provider},set provider(t){var e,o;e=t,(o=document.getElementById("TravelNotes-Control-"+e+"ImgButton"))&&o.click()},get transitMode(){return c.routing.transitMode},set transitMode(t){var e,o;e=t,(o=document.getElementById("TravelNotes-Control-"+e+"ImgButton"))&&o.click()}}})}()},{"../L.TravelNotes":7,"../UI/HtmlElementsFactory":16,"../core/RouteEditor":35}],20:[function(d,t,e){!function(){"use strict";var a=d("./Translator")(),i=null,s=function(t){if(t.stopPropagation(),-1!==d("../L.TravelNotes").routeEdition.routeInitialObjId){document.getElementById("TravelNotes-Control-RouteHeaderDiv").classList.toggle("TravelNotes-Control-SmallHeader"),document.getElementById("TravelNotes-Control-RouteDataDiv").classList.toggle("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-RouteButtonsDiv").classList.toggle("TravelNotes-Control-HiddenList");var e=document.getElementById("TravelNotes-Control-RouteDataDiv").classList.contains("TravelNotes-Control-HiddenList");document.getElementById("TravelNotes-Control-RouteExpandButton").innerHTML=e?"&#x25b6;":"&#x25bc;",document.getElementById("TravelNotes-Control-RouteExpandButton").title=e?a.getText("RouteEditorUI - Show"):a.getText("RouteEditorUI - Hide")}},l=function(t){t.stopPropagation(),document.getElementById("TravelNotes-Control-RouteDataDiv").classList.toggle("TravelNotes-Control-ExpandedList");var e=document.getElementById("TravelNotes-Control-RouteDataDiv").classList.contains("TravelNotes-Control-ExpandedList");document.getElementById("TravelNotes-Control-ExpandWayPointsListButton").innerHTML=e?"&#x25b3;":"&#x25bd;",document.getElementById("TravelNotes-Control-ExpandWayPointsListButton").title=e?a.getText("RouteEditorUI - Reduce the list"):a.getText("RouteEditorUI - Expand the list")};void 0!==t&&t.exports&&(t.exports=function(){return{createUI:function(t){!function(t){if(!document.getElementById("TravelNotes-Control-RouteDataDiv")){var e=d("./HTMLElementsFactory")(),o=e.create("div",{id:"TravelNotes-Control-RouteHeaderDiv",className:"TravelNotes-Control-HeaderDiv"},t);e.create("span",{innerHTML:"&#x25bc;",id:"TravelNotes-Control-RouteExpandButton",className:"TravelNotes-Control-ExpandButton"},o).addEventListener("click",s,!1),e.create("span",{innerHTML:a.getText("RouteEditorUI - Waypoints"),id:"TravelNotes-Control-RouteHeaderText",className:"TravelNotes-Control-HeaderText"},o);var r=e.create("div",{id:"TravelNotes-Control-RouteDataDiv",className:"TravelNotes-Control-DataDiv"},t);(i=d("./SortableList")({minSize:0,listStyle:"LimitedSort",id:"TravelNotes-Control-RouteWaypointsList"},r)).container.addEventListener("SortableListDelete",function(t){t.stopPropagation(),d("../core/RouteEditor")().removeWayPoint(t.itemNode.dataObjId)},!1),i.container.addEventListener("SortableListUpArrow",function(t){t.stopPropagation(),d("../core/RouteEditor")().swapWayPoints(t.itemNode.dataObjId,!0)},!1),i.container.addEventListener("SortableListDownArrow",function(t){t.stopPropagation(),d("../core/RouteEditor")().swapWayPoints(t.itemNode.dataObjId,!1)},!1),i.container.addEventListener("SortableListChange",function(t){t.stopPropagation(),d("../core/RouteEditor")().renameWayPoint(t.dataObjId,t.changeValue)},!1),i.container.addEventListener("SortableListDrop",function(t){t.stopPropagation(),d("../core/RouteEditor")().wayPointDropped(t.draggedObjId,t.targetObjId,t.draggedBefore)},!1);var n=e.create("div",{id:"TravelNotes-Control-RouteButtonsDiv",className:"TravelNotes-Control-ButtonsDiv"},t);e.create("div",{id:"TravelNotes-Control-ExpandWayPointsListButton",className:"TravelNotes-Control-Button",title:a.getText("RouteEditorUI - Expand the list"),innerHTML:"&#x25bd;"},n).addEventListener("click",l,!1),e.create("div",{id:"TravelNotes-Control-CancelRouteButton",className:"TravelNotes-Control-Button",title:a.getText("RouteEditorUI - Cancel"),innerHTML:"&#x274c"},n).addEventListener("click",function(t){t.stopPropagation(),d("../core/RouteEditor")().cancelEdition()},!1),e.create("div",{id:"TravelNotes-Control-SaveRouteButton",className:"TravelNotes-Control-Button",title:a.getText("RouteEditorUI - Save"),innerHTML:"&#x1f4be;"},n).addEventListener("click",function(t){t.stopPropagation(),d("../core/RouteEditor")().saveEdition()},!1),e.create("div",{id:"TravelNotes-Control-gpxButton",className:"TravelNotes-Control-Button",title:a.getText("RouteEditorUI - Save the route in a gpx file"),innerHTML:"gpx"},n).addEventListener("click",function(t){t.stopPropagation(),d("../core/RouteEditor")().saveGpx()},!1),e.create("div",{id:"TravelNotes-Control-ReverseWayPointsButton",className:"TravelNotes-Control-Button",title:a.getText("RouteEditorUI - Invert waypoints"),innerHTML:"&#x21C5;"},n).addEventListener("click",function(t){t.stopPropagation(),d("../core/RouteEditor")().reverseWayPoints()},!1),e.create("div",{id:"TravelNotes-Control-RemoveAllWayPointsButton",className:"TravelNotes-Control-Button",title:a.getText("RouteEditorUI - Delete all waypoints"),innerHTML:"&#x267b;"},n).addEventListener("click",function(t){t.stopPropagation(),d("../core/RouteEditor")().removeAllWayPoints()},!1)}}(t)},expand:function(){document.getElementById("TravelNotes-Control-RouteExpandButton").innerHTML="&#x25bc;",document.getElementById("TravelNotes-Control-RouteExpandButton").title="Masquer",document.getElementById("TravelNotes-Control-RouteDataDiv").classList.remove("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-RouteButtonsDiv").classList.remove("TravelNotes-Control-HiddenList")},reduce:function(){document.getElementById("TravelNotes-Control-RouteExpandButton").innerHTML="&#x25b6;",document.getElementById("TravelNotes-Control-RouteExpandButton").title="Afficher",document.getElementById("TravelNotes-Control-RouteDataDiv").classList.add("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-RouteButtonsDiv").classList.add("TravelNotes-Control-HiddenList")},setWayPointsList:function(){!function(){if(i.removeAllItems(),-1!==d("../L.TravelNotes").routeEdition.routeInitialObjId)for(var t=d("../L.TravelNotes").editedRoute.wayPoints.iterator;!t.done;){var e=t.first?"A":t.last?" B":t.index,o=t.first?a.getText("RouteEditorUI - Start"):t.last?a.getText("RouteEditorUI - End"):a.getText("RouteEditorUI - Via");i.addItem(t.value.UIName,e,o,t.value.objId,t.last)}}()}}})}()},{"../L.TravelNotes":7,"../core/RouteEditor":35,"./HTMLElementsFactory":14,"./SortableList":23,"./Translator":24}],21:[function(g,t,e){!function(){"use strict";var v=g("../UI/Translator")();void 0!==t&&t.exports&&(t.exports=function(t){var e=g("../UI/ColorDialog")(t.color);e.title=v.getText("RoutePropertiesDialog - Route properties"),e.addClickOkButtonEventListener(function(){return t.color=e.getNewColor(),t.width=parseInt(a.value),t.chain=u.checked,t.dashArray=s.selectedIndex,g("../core/MapEditor")().editRoute(t),g("../core/RouteEditor")().chainRoutes(),g("../UI/TravelEditorUI")().setRoutesList(),g("../core/TravelEditor")().updateRoadBook(),!0});var o=g("./HTMLElementsFactory")(),r=o.create("div",{id:"TravelNotes-RoutePropertiesDialog-MainDataDiv"},e.content),n=o.create("div",{className:"TravelNotes-RoutePropertiesDialog-DataDiv",id:"TravelNotes-RoutePropertiesDialog-WithDiv"},r);n.innerHTML="<span>"+v.getText("RoutePropertiesDialog - Width")+"</span>";var a=o.create("input",{type:"number",id:"TravelNotes-RoutePropertiesDialog-WidthInput"},n);a.value=t.width,a.min=1,a.max=40;var i=o.create("div",{className:"TravelNotes-RoutePropertiesDialog-DataDiv",id:"TravelNotes-RoutePropertiesDialog-dashDiv"},r);i.innerHTML="<span>"+v.getText("RoutePropertiesDialog - Linetype")+"</span>";for(var s=o.create("select",{className:"TravelNotes-RoutePropertiesDialog-Select",id:"TravelNotes-RoutePropertiesDialog-DashSelect"},i),l=g("../L.TravelNotes").config.route.dashChoices,d=0;d<l.length;d++)s.add(o.create("option",{text:l[d].text}));s.selectedIndex=t.dashArray<l.length?t.dashArray:0;var c=o.create("div",{className:"TravelNotes-RoutePropertiesDialog-DataDiv",id:"TravelNotes-RoutePropertiesDialog-ChainDiv"},r);c.innerHTML="<span>"+v.getText("RoutePropertiesDialog - Chained route")+"</span>";var u=o.create("input",{type:"checkbox",id:"TravelNotes-RoutePropertiesDialog-ChainInput"},c);return u.checked=t.chain,e})}()},{"../L.TravelNotes":7,"../UI/ColorDialog":10,"../UI/Translator":24,"../UI/TravelEditorUI":25,"../core/MapEditor":33,"../core/RouteEditor":35,"../core/TravelEditor":37,"./HTMLElementsFactory":14}],22:[function(f,t,e){!function(){"use strict";var a=f("../L.TravelNotes"),o=!1,i={searchPhrase:"",bbox:null},n=-1,s=-1,r=window.osmSearch?window.osmSearch.searchLimits:null,l=function(){i.bbox&&(-1!==n?f("../core/MapEditor")().removeObject(n):n=f("../data/ObjId")(),f("../core/MapEditor")().addRectangle(n,L.latLngBounds(i.bbox.southWest,i.bbox.northEast),a.config.previousSearchLimit))},d=function(t){a.searchData=t,o=!1,l(),f("../UI/DataPanesUI")().updateSearch()},c=function(t){console.log(t),o=!1},u=function(t){if(!o){o=!0;var e=a.map.getBounds();i={bbox:{southWest:e.getSouthWest(),northEast:e.getNorthEast()},searchPhrase:document.getElementById("TravelNotes-Control-SearchInput").value},a.searchData=[],window.osmSearch.getSearchPromise(i).then(d,c)}},v=function(t){var e=a.map.getCenter();-1!==s?f("../core/MapEditor")().removeObject(s):s=f("../data/ObjId")(),f("../core/MapEditor")().addRectangle(s,L.latLngBounds(L.latLng(e.lat-r.lat,e.lng-r.lng),L.latLng(e.lat+r.lat,e.lng+r.lng)),a.config.nextSearchLimit)},g=function(t){t.stopPropagation();for(var e=t.target;!e.latLng;)e=e.parentNode;f("../core/MapEditor")().zoomToPoint(e.latLng)},p=function(t){t.stopPropagation(),t.preventDefault();for(var e=t.target;!e.latLng;)e=e.parentNode;f("../core/NoteEditor")().newSearchNote(e.searchResult)},m=function(t){t.stopPropagation(),f("../core/MapEditor")().addSearchPointMarker(t.target.objId,t.target.latLng,t.target.geometry)},T=function(t){t.stopPropagation(),f("../core/MapEditor")().removeObject(t.target.objId)};void 0!==t&&t.exports&&(t.exports=function(){return{remove:function(){!function(){a.map.off("zoom",v),a.map.off("move",v),-1!==s&&(f("../core/MapEditor")().removeObject(s),s=-1),-1!==n&&(f("../core/MapEditor")().removeObject(n),n=-1);var t=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(t){var e=document.getElementById("TravelNotes-Control-SearchInput");e&&e.removeEventListener("change",u,!1);var o=document.getElementById("TravelNotes-Control-SearchDiv"),r=document.getElementsByClassName("TravelNotes-Control-SearchResult");Array.prototype.forEach.call(r,function(t){t.removeEventListener("click",g),t.removeEventListener("contextmenu",p,!1),t.removeEventListener("mouseenter",m,!1),t.removeEventListener("mouseleave",T,!1)}),o&&t.removeChild(o)}}()},add:function(){!function(){document.getElementById("TravelNotes-Control-ItineraryPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-TravelNotesPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-SearchPaneButton").classList.add("TravelNotes-Control-ActivePaneButton"),a.map.on("zoom",v),a.map.on("move",v),v(),l();var t=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(t){var o=f("./HTMLElementsFactory")(),r=o.create("div",{id:"TravelNotes-Control-SearchDiv"},t);o.create("div",{id:"TravelNotes-Control-SearchButton",className:"TravelNotes-Control-Button",title:f("./Translator")().getText("SearchPaneUI - Search OpenStreetMap"),innerHTML:"&#x1f50e"},r).addEventListener("click",u,!1);var e=o.create("input",{type:"text",id:"TravelNotes-Control-SearchInput",placeholder:f("./Translator")().getText("SearchPaneUI - Search phrase"),value:i.searchPhrase},r);e.addEventListener("change",u,!1),e.focus();var n=0;a.searchData.forEach(function(t){var e=o.create("div",{id:"TravelNotes-Control-SearchResult"+n++,className:"TravelNotes-Control-SearchResult",innerHTML:(""!=t.description?"<p class='TravelNotes-Control-SearchResultDescription'>"+t.description+"</p>":"")+(t.tags.name?"<p>"+t.tags.name+"</p>":"")+(t.tags["addr:street"]?"<p>"+t.tags["addr:street"]+" "+(t.tags["addr:housenumber"]?t.tags["addr:housenumber"]:"")+"</p>":"")+(t.tags["addr:city"]?"<p>"+(t.tags["addr:postcode"]?t.tags["addr:postcode"]+" ":"")+t.tags["addr:city"]+"</p>":"")+(t.tags.phone?"<p>"+t.tags.phone+"</p>":"")+(t.tags.email?"<p><a href='mailto:"+t.tags.email+"'>"+t.email+"</a></p>":"")+(t.tags.website?"<p><a href='"+t.tags.website+"' target='_blank'>"+t.tags.website+"</a></p>":"")+(t.ranking?"<p>&#x26ab;"+t.ranking+"</p>":"")},r);e.searchResult=t,e.objId=f("../data/ObjId")(),e.osmId=t.id,e.latLng=L.latLng([t.lat,t.lon]),e.geometry=t.geometry,e.addEventListener("click",g,!1),e.addEventListener("contextmenu",p,!1),e.addEventListener("mouseenter",m,!1),e.addEventListener("mouseleave",T,!1)})}}()}}})}()},{"../L.TravelNotes":7,"../UI/DataPanesUI":12,"../core/MapEditor":33,"../core/NoteEditor":34,"../data/ObjId":44,"./HTMLElementsFactory":14,"./Translator":24}],23:[function(r,t,e){!function(){"use strict";var d=r("../UI/Translator")(),n=0,c=function(t){t.stopPropagation();try{t.dataTransfer.setData("Text",t.target.dataObjId),t.dataTransfer.dropEffect="move"}catch(t){}n=t.target.dataObjId-1},a=function(t){t.preventDefault()},i=function(t){t.preventDefault();for(var e=t.target;!e.dataObjId;)e=e.parentElement;var o=e.getBoundingClientRect(),r=new Event("SortableListDrop");r.draggedObjId=n+1,r.targetObjId=e.dataObjId,r.draggedBefore=t.clientY-o.top<o.bottom-t.clientY,e.parentNode.dispatchEvent(r)},u=function(t){var e=new Event("SortableListDelete");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},v=function(t){var e=new Event("SortableListUpArrow");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},g=function(t){var e=new Event("SortableListDownArrow");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},p=function(t){var e=new Event("SortableListRightArrow");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},m=function(t){var e=new Event("SortableListChange");e.dataObjId=t.target.parentNode.dataObjId,e.changeValue=t.target.value,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()},s=function(t){t.deltaY&&(t.target.scrollTop=t.target.scrollTop+10*t.deltaY),t.stopPropagation()},o=function(t,e){var l=r("./HTMLElementsFactory")();this.items=[],this.removeAllItems=function(){for(var t=0;t<this.items.length;t++)this.container.removeChild(this.items[t]);this.items.length=0},this.addItem=function(t,e,o,r,n){t=t||"",e=e||"",o=o||"",r=r||-1;var a=l.create("div",{draggable:!1,className:"TravelNotes-SortableList-Item"});l.create("div",{className:"TravelNotes-SortableList-ItemTextIndex",innerHTML:e},a);var i=l.create("input",{type:"text",className:"TravelNotes-SortableList-ItemInput",placeholder:o,value:t},a);i.addEventListener("change",m,!1),i.addEventListener("focus",function(t){t.target.parentElement.draggable=!1},!1),i.addEventListener("blur",function(t){t.target.parentElement.draggable=t.target.parentElement.canDrag},!1),l.create("div",{className:"TravelNotes-SortableList-ItemUpArrowButton",title:d.getText("SortableList - Move up"),innerHTML:String.fromCharCode(8679)},a).addEventListener("click",v,!1),l.create("div",{className:"TravelNotes-SortableList-ItemDownArrowButton",title:d.getText("SortableList - Move down"),innerHTML:String.fromCharCode(8681)},a).addEventListener("click",g,!1);var s=l.create("div",{className:"TravelNotes-SortableList-ItemRightArrowButton",title:d.getText("SortableList - Edit"),innerHTML:String.fromCharCode(8688)},a);"AllSort"===this.options.listStyle&&s.addEventListener("click",p,!1),l.create("div",{className:"TravelNotes-SortableList-ItemDeleteButton",title:d.getText("SortableList - Delete"),innerHTML:"&#x267b;"},a).addEventListener("click",u,!1),a.dataObjId=r,a.canDrag=!1,("LimitedSort"!==this.options.listStyle||1<this.items.length)&&!n&&(a.draggable=!0,a.addEventListener("dragstart",c,!1),a.classList.add("TravelNotes-SortableList-MoveCursor"),a.canDrag=!0),this.items.push(a),this.container.appendChild(a)},this._create=function(t,e){for(var o in this.options={minSize:2,listStyle:"AllSort",id:"TravelNotes-SortableList-Container"},t)this.options[o]=t[o];"LimitedSort"===this.options.listStyle&&this.options.minSize<2&&(this.options.minSize=0),this.container=l.create("div",{id:t.id,className:"TravelNotes-SortableList-Container"}),this.container.classList.add(this.options.listStyle),this.container.addEventListener("drop",i,!1),this.container.addEventListener("dragover",a,!1),this.container.addEventListener("wheel",s,!1),e&&e.appendChild(this.container);for(var r=0;r<this.options.minSize;r++)this.addItem()},this._create(t,e)};void 0!==t&&t.exports&&(t.exports=function(t,e){return new o(t,e)})}()},{"../UI/Translator":24,"./HTMLElementsFactory":14}],24:[function(t,e,o){(function(r){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){return r.translations||(r.translations=new Map),{setTranslations:function(t){t.forEach(function(t){r.translations.set(t.msgid,t.msgstr)})},getText:function(t,e){var o=r.translations.get(t);return e&&o&&Object.getOwnPropertyNames(e).forEach(function(t){o=o.replace("{"+t+"}",e[t])}),o||t}}})}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],25:[function(L,t,e){!function(){"use strict";var v=L("./Translator")(),g=L("../L.TravelNotes"),p=null,m=function(t){t.stopPropagation(),document.getElementById("TravelNotes-Control-TravelHeaderDiv").classList.toggle("TravelNotes-Control-SmallHeader"),document.getElementById("TravelNotes-Control-TravelDataDiv").classList.toggle("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-ControlTravelButtonsDiv").classList.toggle("TravelNotes-Control-HiddenList");var e=document.getElementById("TravelNotes-Control-TravelDataDiv").classList.contains("TravelNotes-Control-HiddenList");document.getElementById("TravelNotes-ControlTravelExpandButton").innerHTML=e?"&#x25b6;":"&#x25bc;",document.getElementById("TravelNotes-ControlTravelExpandButton").title=e?v.getText("TravelEditorUI - Show"):v.getText("TravelEditorUI - Hide"),t.stopPropagation()},T=function(t){t.stopPropagation(),document.getElementById("TravelNotes-Control-TravelDataDiv").classList.toggle("TravelNotes-Control-ExpandedList");var e=document.getElementById("TravelNotes-Control-TravelDataDiv").classList.contains("TravelNotes-Control-ExpandedList");document.getElementById("TravelNotes-Control-ExpandRoutesListButton").innerHTML=e?"&#x25b3;":"&#x25bd;",document.getElementById("TravelNotes-Control-ExpandRoutesListButton").title=e?v.getText("TravelEditorUI - Reduce the list"):v.getText("TravelEditorUI - Expand the list")},e=null,f=function(t){e&&(clearTimeout(e),e=null),document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Minimize"),document.getElementById("TravelNotes-Control-MainDiv").classList.add("TravelNotes-Control-MainDiv-Maximize")},o=function(){document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Maximize"),document.getElementById("TravelNotes-Control-MainDiv").classList.add("TravelNotes-Control-MainDiv-Minimize")},N=function(t){e=setTimeout(o,g.config.travelEditor.timeout)},h=function(t){var e=document.getElementById("TravelNotes-Control-MainDiv");10060===t.target.innerHTML.charCodeAt(0)?(t.target.innerHTML="&#x1f4cc;",e.addEventListener("mouseenter",f,!1),e.addEventListener("mouseleave",N,!1)):(t.target.innerHTML="&#x274c;",e.removeEventListener("mouseenter",f,!1),e.removeEventListener("mouseleave",N,!1))},I=function(t){t.stopPropagation(),L("../core/TravelEditor")().clear(),L("../L.TravelNotes").config.travelEditor.startupRouteEdition&&L("../core/TravelEditor")().editRoute(L("../L.TravelNotes").travel.routes.first.objId),L("../L.TravelNotes").map.fire("travelnotesfileloaded",{readOnly:!1,name:""})};void 0!==t&&t.exports&&(t.exports=function(){return{createUI:function(t){!function(t){if(!document.getElementById("TravelNotes-Control-TravelDataDiv")){var e=L("./HTMLElementsFactory")(),o=e.create("div",{id:"TravelNotes-Control-TravelHeaderDiv",className:"TravelNotes-Control-HeaderDiv"},t);e.create("span",{innerHTML:"&#x25bc;",id:"TravelNotes-ControlTravelExpandButton",className:"TravelNotes-Control-ExpandButton"},o).addEventListener("click",m,!1),e.create("span",{innerHTML:v.getText("TravelEditorUI - Travel routes"),id:"TravelNotes-Control-TravelHeaderText",className:"TravelNotes-Control-HeaderText"},o);var r=e.create("span",{innerHTML:"&#x274c;",id:"TravelNotes-Control-PinButton"},o);r.addEventListener("click",h,!1);var n=e.create("div",{id:"TravelNotes-Control-TravelDataDiv",className:"TravelNotes-Control-DataDiv"},t);(p=L("./SortableList")({minSize:0,id:"TravelNotes-Control-TravelRoutesList"},n)).container.addEventListener("SortableListDelete",function(t){t.stopPropagation(),L("../core/TravelEditor")().removeRoute(t.itemNode.dataObjId)},!1),p.container.addEventListener("SortableListUpArrow",function(t){t.stopPropagation(),L("../core/TravelEditor")().swapRoute(t.itemNode.dataObjId,!0)},!1),p.container.addEventListener("SortableListDownArrow",function(t){t.stopPropagation(),L("../core/TravelEditor")().swapRoute(t.itemNode.dataObjId,!1)},!1),p.container.addEventListener("SortableListRightArrow",function(t){t.stopPropagation(),L("../core/TravelEditor")().editRoute(t.itemNode.dataObjId)},!1),p.container.addEventListener("SortableListChange",function(t){t.stopPropagation(),L("../core/TravelEditor")().renameRoute(t.dataObjId,t.changeValue)},!1),p.container.addEventListener("SortableListDrop",function(t){t.stopPropagation(),L("../core/TravelEditor")().routeDropped(t.draggedObjId,t.targetObjId,t.draggedBefore)},!1);var a=e.create("div",{id:"TravelNotes-ControlTravelButtonsDiv",className:"TravelNotes-Control-ButtonsDiv"},t);e.create("div",{id:"TravelNotes-Control-ExpandRoutesListButton",className:"TravelNotes-Control-Button",title:v.getText("TravelEditorUI - Expand the list"),innerHTML:"&#x25bd;"},a).addEventListener("click",T,!1),e.create("div",{id:"TravelNotes-Control-CancelTravelButton",className:"TravelNotes-Control-Button",title:v.getText("TravelEditorUI - Cancel travel"),innerHTML:"&#x274c"},a).addEventListener("click",I,!1),e.create("div",{id:"TravelNotes-Control-SaveTravelButton",className:"TravelNotes-Control-Button",title:v.getText("TravelEditorUI - Save travel"),innerHTML:"&#x1f4be;"},a).addEventListener("click",function(t){t.stopPropagation(),L("../core/TravelEditor")().saveTravel()},!1);var i=e.create("div",{id:"TravelNotes-Control-OpenTravelDiv"},a),s=e.create("input",{id:"TravelNotes-Control-OpenTravelInput",type:"file",accept:".trv"},i);s.addEventListener("change",function(t){t.stopPropagation(),L("../core/RouteEditor")().cancelEdition(),L("../core/FileLoader")().openLocalFile(t)},!1);var l=e.create("div",{id:"TravelNotes-Control-OpenTravelFakeDiv"},i);e.create("div",{id:"TravelNotes-Control-OpenTravelButton",className:"TravelNotes-Control-Button",title:v.getText("TravelEditorUI - Open travel"),innerHTML:"&#x1F4C2;"},l).addEventListener("click",function(){L("../core/TravelEditor")().confirmClose()&&s.click()},!1);var d=e.create("div",{id:"TravelNotes-Control-ImportTravelDiv"},a),c=e.create("input",{id:"TravelNotes-Control-ImportTravelInput",type:"file",accept:".trv,.map"},d);c.addEventListener("change",function(t){t.stopPropagation(),L("../core/FileLoader")().mergeLocalFile(t)},!1);var u=e.create("div",{id:"TravelNotes-Control-ImportTravelFakeDiv"},d);e.create("div",{id:"TravelNotes-Control-ImportTravelButton",className:"TravelNotes-Control-Button",title:v.getText("TravelEditorUI - Import travel"),innerHTML:"&#x1F30F;"},u).addEventListener("click",function(t){c.click()},!1),e.create("div",{id:"TravelNotes-Control-OpenTravelRoadbookButton",className:"TravelNotes-Control-Button",title:v.getText("TravelEditorUI - Open travel roadbook"),innerHTML:'<a id="TravelNotes-Control-OpenTravelRoadbookLink" href="TravelNotesRoadbook.html?page='+g.UUID+'" target="_blank">&#x1F4CB;</a>'},a),e.create("div",{id:"TravelNotes-Control-AddRoutesButton",className:"TravelNotes-Control-Button",title:v.getText("TravelEditorUI - New route"),innerHTML:"+"},a).addEventListener("click",function(t){t.stopPropagation(),L("../core/TravelEditor")().addRoute()},!1),g.config.travelEditor.startMinimized?(r.innerHTML="&#x1f4cc;",t.addEventListener("mouseenter",f,!1),t.addEventListener("mouseleave",N,!1),t.classList.add("TravelNotes-Control-MainDiv-Minimize")):t.classList.add("TravelNotes-Control-MainDiv-Maximize")}}(t)},setRoutesList:function(){!function(){p.removeAllItems();for(var t=g.travel.routes.iterator;!t.done;)p.addItem(t.value.name,t.value.chain?"&#x26d3;":"",v.getText("TravelEditorUI - Route"),t.value.objId,!1)}()}}})}()},{"../L.TravelNotes":7,"../core/FileLoader":30,"../core/RouteEditor":35,"../core/TravelEditor":37,"./HTMLElementsFactory":14,"./SortableList":23,"./Translator":24}],26:[function(c,t,e){!function(){"use strict";var r=0,n=function(t){t.stopPropagation();try{t.dataTransfer.setData("Text",t.target.dataObjId),t.dataTransfer.dropEffect="move"}catch(t){}r=t.target.noteObjId-1},a=function(t){t.preventDefault()},i=function(t){t.preventDefault();for(var e=t.target;!e.noteObjId;)e=e.parentElement;var o=e.getBoundingClientRect();c("../L.TravelNotes").travel.notes.moveTo(r+1,e.noteObjId,t.clientY-o.top<o.bottom-t.clientY),d().remove(),d().add(),c("../core/TravelEditor")().updateRoadBook()},s=function(t){t.stopPropagation(),t.preventDefault();for(var e=t.target;!e.noteObjId;)e=e.parentNode;c("../core/MapEditor")().zoomToNote(e.noteObjId)},l=function(t){t.stopPropagation(),t.preventDefault();for(var e=t.target;!e.noteObjId;)e=e.parentNode;c("../core/NoteEditor")().editNote(e.noteObjId)},d=function(){return{remove:function(){!function(){var t=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(t){var e=t.firstChild;e&&(e.childNodes.forEach(function(t){t.removeEventListener("click",l,!1),t.removeEventListener("contextmenu",s,!1)}),t.removeChild(e))}}()},add:function(){!function(){document.getElementById("TravelNotes-Control-ItineraryPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-TravelNotesPaneButton").classList.add("TravelNotes-Control-ActivePaneButton"),window.osmSearch&&document.getElementById("TravelNotes-Control-SearchPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton");var t=c("../UI/HTMLViewsFactory")();t.classNamePrefix="TravelNotes-Control-";var e=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(e){var o=t.travelNotesHTML;o.addEventListener("drop",i,!1),o.addEventListener("dragover",a,!1),e.appendChild(o),o.childNodes.forEach(function(t){t.addEventListener("click",l,!1),t.addEventListener("contextmenu",s,!1),t.draggable=!0,t.addEventListener("dragstart",n,!1),t.classList.add("TravelNotes-SortableList-MoveCursor")})}}()}}};void 0!==t&&t.exports&&(t.exports=d)}()},{"../L.TravelNotes":7,"../UI/HTMLViewsFactory":15,"../core/MapEditor":33,"../core/NoteEditor":34,"../core/TravelEditor":37}],27:[function(e,t,o){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){var t=document.getElementById("TravelNotes-Control-MainDiv");return t||(t=e("./HTMLElementsFactory")().create("div",{id:"TravelNotes-Control-MainDiv"}),e("./HTMLElementsFactory")().create("div",{id:"TravelNotes-Control-MainDiv-Title",innerHTML:"Travel&nbsp;&amp;&nbsp;Notes"},t),e("./TravelEditorUI")().createUI(t),e("./RouteEditorUI")().createUI(t),e("./DataPanesUI")().createUI(t),e("./ProvidersToolbarUI")().createUI(t),e("./ErrorEditorUI")().createUI(t),t.addEventListener("click",function(t){t.target.classList.contains("TravelNotes-SortableList-ItemInput")||t.target.id&&-1!==["TravelNotes-Control-OpenTravelInput","TravelNotes-Control-OpenTravelButton","TravelNotes-Control-ImportTravelInput","TravelNotes-Control-ImportTravelButton","TravelNotes-Control-OpenTravelRoadbookLink"].indexOf(t.target.id)||(t.stopPropagation(),t.preventDefault())},!1),t.addEventListener("dblclick",function(t){t.stopPropagation(),t.preventDefault()},!1),t.addEventListener("wheel",function(t){t.stopPropagation(),t.preventDefault()},!1)),{get UI(){return t}}})}()},{"./DataPanesUI":12,"./ErrorEditorUI":13,"./HTMLElementsFactory":14,"./ProvidersToolbarUI":19,"./RouteEditorUI":20,"./TravelEditorUI":25}],28:[function(t,e,o){arguments[4][9][0].apply(o,arguments)},{"../UI/Translator":24,"./HTMLElementsFactory":14,dup:9}],29:[function(e,t,o){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){return{showError:function(t){e("../UI/ErrorEditorUI")().message='<span class="TravelNotes-Control-Error">'+t+"</span>"},clear:function(){e("../UI/ErrorEditorUI")().message=""}}})}()},{"../UI/ErrorEditorUI":13}],30:[function(u,t,e){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){var r=u("../L.TravelNotes"),o=u("../core/MapEditor")(),e=!1,t="",n=!1,a={},i=function(){a.routes.forEach(function(o){o.itinerary.itineraryPoints.latLngs=u("@mapbox/polyline").decode(o.itinerary.itineraryPoints.latLngs,6);var r=[],n=0;o.itinerary.itineraryPoints.latLngs.forEach(function(t){var e={};e.lat=t[0],e.lng=t[1],e.distance=o.itinerary.itineraryPoints.distances[n],e.objId=o.itinerary.itineraryPoints.objIds[n],e.objType=o.itinerary.itineraryPoints.objType,r.push(e),n++}),o.itinerary.itineraryPoints=r}),e?s():l()},s=function(){var t=u("../Data/Travel")();t.object=a;for(var e=t.routes.iterator;!e.done;)r.travel.routes.add(e.value);for(var o=t.notes.iterator;!o.done;)r.travel.notes.add(o.value);d()},l=function(){r.travel.object=a,""!==t&&(r.travel.name=t.substr(0,t.lastIndexOf("."))),r.travel.readOnly=n,d()},d=function(){o.removeAllObjects();for(var t=r.travel.routes.iterator;!t.done;)o.addRoute(t.value,!0,!1,n);for(var e=r.travel.notes.iterator;!e.done;)o.addNote(e.value,n);o.zoomToTravel(),n?(document.getElementById("TravelNotes-Control-MainDiv").classList.add("TravelNotes-Control-MainDiv-Hidden"),document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Maximize"),document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Minimize")):(u("../UI/TravelEditorUI")().setRoutesList(),u("../core/TravelEditor")().updateRoadBook(!1)),r.map.fire("travelnotesfileloaded",{readOnly:n,name:r.travel.name})},c=function(){t=event.target.files[0].name;var e=new FileReader;e.onload=function(t){try{a=JSON.parse(e.result),i()}catch(t){}},e.readAsText(event.target.files[0])};return{openLocalFile:function(t){n=e=!1,c()},mergeLocalFile:function(t){n=!(e=!0),c()},openDistantFile:function(t){n=!0,a=t,i()}}})}()},{"../Data/Travel":5,"../L.TravelNotes":7,"../UI/TravelEditorUI":25,"../core/MapEditor":33,"../core/TravelEditor":37,"@mapbox/polyline":1}],31:[function(l,t,e){!function(){"use strict";var s=!1;void 0!==t&&t.exports&&(t.exports=function(){return{getAddress:function(t,e,o,r,n){if(!s){s=!0;var a="https://nominatim.openstreetmap.org/reverse?format=json&lat="+t+"&lon="+e+"&zoom=18&addressdetails=1&accept-language="+l("../L.TravelNotes").config.language,i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){var t;s=!1;try{t=JSON.parse(this.responseText)}catch(t){return}var e="";void 0!==t.address.house_number&&(e+=t.address.house_number+" "),void 0!==t.address.road?e+=t.address.road+" ":void 0!==t.address.pedestrian&&(e+=t.address.pedestrian+" "),void 0!==t.address.village?e+=t.address.village:void 0!==t.address.town?e+=t.address.town:void 0!==t.address.city&&(e+=t.address.city),0===e.length&&(e+=t.address.country),o.call(r,e,n)}},i.open("GET",a,!0),i.send(null)}}}})}()},{"../L.TravelNotes":7}],32:[function(e,t,o){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){return{setItinerary:function(){e("../UI/DataPanesUI")().setItinerary()},setTravelNotes:function(){e("../UI/DataPanesUI")().setTravelNotes()},setSearch:function(){e("../UI/DataPanesUI")().setSearch()},updateItinerary:function(){e("../UI/DataPanesUI")().updateItinerary()},updateTravelNotes:function(){e("../UI/DataPanesUI")().updateTravelNotes()},updateSearch:function(){e("../UI/DataPanesUI")().updateSearch()},get provider(){return e("../L.TravelNotes").routing.provider},set provider(t){e("../UI/DataPanesUI")().provider=t},get transitMode(){return e("../L.TravelNotes").routing.transitMode},set transitMode(t){e("../UI/DataPanesUI")().transitMode=t}}})}()},{"../L.TravelNotes":7,"../UI/DataPanesUI":12}],33:[function(p,t,e){!function(){"use strict";var v=p("../L.TravelNotes"),g=p("../Data/DataSearchEngine")();void 0!==t&&t.exports&&(t.exports=function(){var d=function(t){var e=g.getRoute(t.target.objId),o=p("../core/RouteEditor")().getClosestLatLngDistance(e,[t.latlng.lat,t.latlng.lng]).distance;o+=e.chainedDistance,o=p("../util/Utilities")().formatDistance(o);var r=v.mapObjects.get(t.target.objId);r.closeTooltip();var n=g.getRoute(t.target.objId).name;n+=0===n.length?"":" - ",n+=o,r.setTooltipContent(n),r.openTooltip(t.latlng)},c=function(t,e){e.objId=t,e.addTo(v.map),v.mapObjects.set(t,e)},o=function(t){var e=L.latLng([90,180]),o=L.latLng([-90,-180]);return t.forEach(function(t){e.lat=Math.min(e.lat,t[0]),e.lng=Math.min(e.lng,t[1]),o.lat=Math.max(o.lat,t[0]),o.lng=Math.max(o.lng,t[1])}),L.latLngBounds(e,o)},r=function(t){var e=[];return t.itinerary.itineraryPoints.forEach(function(t){e.push(t.latLng)}),t.notes.forEach(function(t){e.push(t.latLng),e.push(t.iconLatLng)}),e},u=function(t){t.dashArray>=v.config.route.dashChoices.length&&(t.dashArray=0);var e=v.config.route.dashChoices[t.dashArray].iDashArray;if(e){var o="",r=0;for(r=0;r<e.length-1;r++)o+=e[r]*t.width+",";return o+=e[r]*t.width}return null};return{removeRoute:function(t,e,o){if(this.removeObject(t.objId),e)for(var r=t.notes.iterator;!r.done;)this.removeObject(r.value.objId);if(o)for(var n=t.wayPoints.iterator;!n.done;)this.removeObject(n.value.objId)},addRoute:function(t,e,o,r){r=r||!1;for(var n=[],a=t.itinerary.itineraryPoints.iterator;!a.done;)n.push(a.value.latLng);var i=L.polyline(n,{color:t.color,weight:t.width,dashArray:u(t)});if(c(t.objId,i),i.bindTooltip(t.name,{sticky:!0,direction:"right"}),i.on("mouseover",d),i.on("mousemove",d),i.bindPopup(function(t){var e=g.getRoute(t.objId);return p("../core/RouteEditor")().getRouteHTML(e,"TravelNotes-")}),L.DomEvent.on(i,"click",function(t){t.target.openPopup(t.latlng)}),r||L.DomEvent.on(i,"contextmenu",function(t){p("../UI/ContextMenu")(t,p("../core/RouteEditor")().getRouteContextMenu(t.target.objId))}),e)for(var s=t.notes.iterator;!s.done;)this.addNote(s.value,r);if(o)for(var l=v.editedRoute.wayPoints.iterator;!l.done;)this.addWayPoint(l.value,l.first?"A":l.last?"B":l.index)},editRoute:function(t){v.mapObjects.get(t.objId).setStyle({color:t.color,weight:t.width,dashArray:u(t)})},removeObject:function(t){var e,o;e=t,(o=v.mapObjects.get(e))&&(L.DomEvent.off(o),v.map.removeLayer(o),v.mapObjects.delete(e))},removeAllObjects:function(){v.mapObjects.forEach(function(t,e,o){L.DomEvent.off(t),v.map.removeLayer(t)}),v.mapObjects.clear()},zoomToPoint:function(t){v.map.setView(t,v.config.itineraryPointZoom)},zoomToNote:function(t){this.zoomToPoint(g.getNoteAndRoute(t).note.iconLatLng)},zoomToRoute:function(t){var e=r(g.getRoute(t));0!==e.length&&v.map.fitBounds(o(e))},zoomToTravel:function(){var e=[];v.travel.routes.forEach(function(t){e=e.concat(r(t))}),v.travel.notes.forEach(function(t){e.push(t.latLng),e.push(t.iconLatLng)}),0!==e.length&&v.map.fitBounds(o(e))},addItineraryPointMarker:function(t,e){c(t,L.circleMarker(e,v.config.itineraryPointMarker))},addRectangle:function(t,e,o){c(t,L.rectangle(e,o))},addSearchPointMarker:function(t,e,o){o&&v.config.searchPointPolyline.minZoom<=v.map.getZoom()?c(t,L.polyline(o,v.config.searchPointPolyline.polyline)):c(t,L.circleMarker(e,v.config.searchPointMarker))},addWayPoint:function(t,e){if(0!==t.lat||0!==t.lng){var o='<div class="TravelNotes-WayPoint TravelNotes-WayPoint'+("A"===e?"Start":"B"===e?"End":"Via")+'"></div><div class="TravelNotes-WayPointText">'+e+"</div>",r=L.marker(t.latLng,{icon:L.divIcon({iconSize:[40,40],iconAnchor:[20,40],html:o,className:"TravelNotes-WayPointStyle"}),draggable:!0});r.bindTooltip(function(t){return g.getWayPoint(t.objId).UIName}),r.getTooltip().options.offset=[20,-20],L.DomEvent.on(r,"contextmenu",function(t){p("../UI/ContextMenu")(t,p("./RouteEditor")().getWayPointContextMenu(t.target.objId))}),r.objId=t.objId,c(t.objId,r),L.DomEvent.on(r,"dragend",function(t){v.editedRoute.wayPoints.getAt(t.target.objId).latLng=[t.target.getLatLng().lat,t.target.getLatLng().lng],p("../core/RouteEditor")().wayPointDragEnd(t.target.objId)})}},redrawNote:function(t){this.removeObject(t.objId),this.addNote(t)},addNote:function(t,e){e=e||!1;var o=L.marker(t.latLng,{icon:L.divIcon({iconSize:[v.config.note.grip.size,v.config.note.grip.size],iconAnchor:[v.config.note.grip.size/2,v.config.note.grip.size/2],html:"<div></div>"}),zIndexOffset:-1e3,opacity:v.config.note.grip.opacity,draggable:!e});o.objId=t.objId,e||(L.DomEvent.on(o,"dragend",function(t){var e=g.getNoteAndRoute(t.target.objId),o=e.note,r=e.route,n=v.mapObjects.get(t.target.objId);if(null!=r){var a=p("../core/RouteEditor")().getClosestLatLngDistance(r,[t.target.getLatLng().lat,t.target.getLatLng().lng]);o.latLng=a.latLng,o.distance=a.distance,r.notes.sort(function(t,e){return t.distance-e.distance}),n.getLayer(n.bulletId).setLatLng(a.latLng)}else o.latLng=[t.target.getLatLng().lat,t.target.getLatLng().lng];n.getLayer(n.polylineId).setLatLngs([o.latLng,o.iconLatLng]),p("../core/TravelEditor")().updateRoadBook()}),L.DomEvent.on(o,"drag",function(t){var e=g.getNoteAndRoute(t.target.objId).note,o=v.mapObjects.get(t.target.objId);o.getLayer(o.polylineId).setLatLngs([[t.latlng.lat,t.latlng.lng],e.iconLatLng])}));var r=L.divIcon({iconSize:[t.iconWidth,t.iconHeight],iconAnchor:[t.iconWidth/2,t.iconHeight/2],popupAnchor:[0,-t.iconHeight/2],html:t.iconContent,className:v.config.note.style}),n=L.marker(t.iconLatLng,{icon:r,draggable:!e});n.objId=t.objId,n.bindPopup(function(t){var e=g.getNoteAndRoute(t.objId).note;return p("../core/NoteEditor")().getNoteHTML(e,"TravelNotes-")}),0!==t.tooltipContent.length&&(n.bindTooltip(function(t){return g.getNoteAndRoute(t.objId).note.tooltipContent}),n.getTooltip().options.offset[0]=t.iconWidth/2),e||(L.DomEvent.on(n,"contextmenu",function(t){p("../UI/ContextMenu")(t,p("./NoteEditor")().getNoteContextMenu(t.target.objId))}),L.DomEvent.on(n,"dragend",function(t){var e=g.getNoteAndRoute(t.target.objId).note;e.iconLatLng=[t.target.getLatLng().lat,t.target.getLatLng().lng];var o=v.mapObjects.get(t.target.objId);o.getLayer(o.polylineId).setLatLngs([e.latLng,e.iconLatLng])}),L.DomEvent.on(n,"drag",function(t){var e=g.getNoteAndRoute(t.target.objId).note,o=v.mapObjects.get(t.target.objId);o.getLayer(o.polylineId).setLatLngs([e.latLng,[t.latlng.lat,t.latlng.lng]])}));var a=L.polyline([t.latLng,t.iconLatLng],v.config.note.polyline);a.objId=t.objId;var i=L.layerGroup([n,a,o]);i.markerId=L.Util.stamp(n),i.polylineId=L.Util.stamp(a),i.bulletId=L.Util.stamp(o),c(t.objId,i)},editNote:function(t){var e=L.divIcon({iconSize:[t.iconWidth,t.iconHeight],iconAnchor:[t.iconWidth/2,t.iconHeight/2],popupAnchor:[0,-t.iconHeight/2],html:t.iconContent,className:v.config.note.style}),o=v.mapObjects.get(t.objId),r=o.getLayer(o.markerId);r.setIcon(e),r.unbindTooltip(),0!==t.tooltipContent.length&&(r.bindTooltip(function(t){return g.getNoteAndRoute(t.objId).note.tooltipContent}),r.getTooltip().options.offset[0]=t.iconWidth/2)}}})}()},{"../Data/DataSearchEngine":2,"../L.TravelNotes":7,"../UI/ContextMenu":11,"../core/NoteEditor":34,"../core/RouteEditor":35,"../core/TravelEditor":37,"../util/Utilities":52,"./NoteEditor":34,"./RouteEditor":35}],34:[function(d,t,e){!function(){"use strict";var r=d("../UI/Translator")(),s=d("../L.TravelNotes"),l=d("../Data/DataSearchEngine")(),n=d("../util/Utilities")();void 0!==t&&t.exports&&(t.exports=function(){return{newNote:function(t){var e=d("../data/Note")();return e.latLng=t,e.iconLatLng=t,e},newRouteNote:function(t,e){var o=d("../core/RouteEditor")().getClosestLatLngDistance(l.getRoute(t),[e.latlng.lat,e.latlng.lng]),r=this.newNote(o.latLng);r.distance=o.distance,d("../UI/NoteDialog")(r,t,!0)},newSearchNote:function(t){var e=this.newNote([t.lat,t.lon]);e.address=(t.tags["addr:housenumber"]?t.tags["addr:housenumber"]+" ":"")+(t.tags["addr:street"]?t.tags["addr:street"]+" ":"")+(t.tags["addr:city"]?t.tags["addr:city"]+" ":""),e.url=t.tags.website||"",e.phone=t.tags.phone||"",e.tooltipContent=t.tags.name||"",e.popupContent=t.tags.name||"",d("../UI/NoteDialog")(e,-1,!0)},newManeuverNote:function(t,e){var o=d("../core/RouteEditor")().getClosestLatLngDistance(s.editedRoute,e),r=s.editedRoute.itinerary.maneuvers.getAt(t),n=this.newNote(e);n.distance=o.distance,n.iconContent="<div class='TravelNotes-ManeuverNote TravelNotes-ManeuverNote-"+r.iconName+"'></div>",n.popupContent=r.instruction,n.width=40,n.height=40,d("../UI/NoteDialog")(n,s.editedRoute.objId,!0)},newTravelNote:function(t){var e=this.newNote(t);d("../UI/NoteDialog")(e,-1,!0)},endNoteDialog:function(t,e){var o=l.getNoteAndRoute(t.objId);if(o.note)d("../core/MapEditor")().editNote(t),o.route||d("../UI/DataPanesUI")().setTravelNotes();else{if(-1===e)s.travel.notes.add(t),d("../UI/DataPanesUI")().setTravelNotes();else{var r=l.getRoute(e);r.notes.add(t),t.chainedDistance=r.chainedDistance,r.notes.sort(function(t,e){return t.distance-e.distance}),d("../core/ItineraryEditor")().setItinerary()}d("../core/MapEditor")().addNote(t)}d("../core/TravelEditor")().updateRoadBook()},editNote:function(t){var e=l.getNoteAndRoute(t);d("../UI/NoteDialog")(e.note,null===e.route?-1:e.route.objId,!1)},removeNote:function(t){d("../core/MapEditor")().removeObject(t);var e=l.getNoteAndRoute(t);e.route?(e.route.notes.remove(t),d("../core/ItineraryEditor")().setItinerary()):s.travel.notes.remove(t),d("../core/TravelEditor")().updateRoadBook()},hideNotes:function(){for(var t=s.travel.notes.iterator;!t.done;)d("../core/MapEditor")().removeObject(t.value.objId);for(var e=s.travel.routes.iterator;!e.done;)for(t=e.value.notes.iterator;!t.done;)d("../core/MapEditor")().removeObject(t.value.objId)},showNotes:function(){this.hideNotes();for(var t=s.travel.notes.iterator;!t.done;)d("../core/MapEditor")().addNote(t.value);for(var e=s.travel.routes.iterator;!e.done;)for(t=e.value.notes.iterator;!t.done;)d("../core/MapEditor")().addNote(t.value)},zoomToNote:function(t){d("../core/MapEditor")().zoomToPoint(l.getNoteAndRoute(t).note.latLng)},getMapContextMenu:function(t){var e=[];return e.push({context:this,name:r.getText("NoteEditor - New travel note"),action:this.newTravelNote,param:t}),e.push({context:this,name:r.getText("NoteEditor - Hide notes"),action:this.hideNotes}),e.push({context:this,name:r.getText("NoteEditor - Show notes"),action:this.showNotes}),e},getNoteContextMenu:function(t){var e=[];e.push({context:this,name:r.getText("NoteEditor - Edit this note"),action:this.editNote,param:t}),e.push({context:this,name:r.getText("NoteEditor - Delete this note"),action:this.removeNote,param:t}),e.push({context:this,name:r.getText("NoteEditor - Zoom to note"),action:this.zoomToNote,param:t});var o=l.getNoteAndRoute(t).route;return e.push({context:this,name:o?r.getText("NoteEditor - Detach note from route"):r.getText("NoteEditor - Attach note to route"),action:-1===s.routeEdition.routeInitialObjId?o?this.detachNoteFromRoute:this.attachNoteToRoute:null,param:t}),e},attachNoteToRoute:function(t){var e,r,n,a,i;e=t,r=l.getNoteAndRoute(e),n=999999999,i=a=null,s.travel.routes.forEach(function(t){var e=d("../core/RouteEditor")().getClosestLatLngDistance(t,r.note.latLng);if(e){var o=L.latLng(r.note.latLng).distanceTo(L.latLng(e.latLng));o<n&&(n=o,a=t,i=e.latLng)}}),a&&(s.travel.notes.remove(e),r.note.distance=n,r.note.latLng=i,r.note.chainedDistance=a.chainedDistance,a.notes.add(r.note),a.notes.sort(function(t,e){return t.distance-e.distance}),d("../core/MapEditor")().redrawNote(r.note),d("../core/ItineraryEditor")().updateItinerary(),d("../core/ItineraryEditor")().updateTravelNotes(),d("../core/TravelEditor")().updateRoadBook())},detachNoteFromRoute:function(t){var e,o;e=t,(o=l.getNoteAndRoute(e)).route.notes.remove(e),o.note.distance=-1,o.note.chainedDistance=0,s.travel.notes.add(o.note),d("../core/ItineraryEditor")().updateItinerary(),d("../core/ItineraryEditor")().updateTravelNotes(),d("../core/TravelEditor")().updateRoadBook()},getNoteHTML:function(t,e){var o="";return 0!==t.tooltipContent.length&&(o+='<div class="'+e+'NoteHtml-TooltipContent">'+t.tooltipContent+"</div>"),0!==t.popupContent.length&&(o+='<div class="'+e+'NoteHtml-PopupContent">'+t.popupContent+"</div>"),0!==t.address.length&&(o+='<div class="'+e+'NoteHtml-Address">'+r.getText("NoteEditor - Address")+t.address+"</div>"),0!==t.phone.length&&(o+='<div class="'+e+'NoteHtml-Phone">'+r.getText("NoteEditor - Phone")+t.phone+"</div>"),0!==t.url.length&&(o+='<div class="'+e+'NoteHtml-Url">'+r.getText("NoteEditor - Link")+'<a href="'+t.url+'" target="_blank">'+t.url.substr(0,40)+"...</a></div>"),o+='<div class="'+e+'NoteHtml-LatLng">'+r.getText("NoteEditor - Latitude Longitude",{lat:n.formatLat(t.lat),lng:n.formatLng(t.lng)})+"</div>",-1!==t.distance&&(o+='<div class="'+e+'NoteHtml-Distance">'+r.getText("NoteEditor - Distance",{distance:n.formatDistance(t.chainedDistance+t.distance)})+"</div>"),o}}})}()},{"../Data/DataSearchEngine":2,"../L.TravelNotes":7,"../UI/DataPanesUI":12,"../UI/NoteDialog":18,"../UI/Translator":24,"../core/ItineraryEditor":32,"../core/MapEditor":33,"../core/RouteEditor":35,"../core/TravelEditor":37,"../data/Note":43,"../util/Utilities":52}],35:[function(u,t,e){!function(){"use strict";var c=u("../L.TravelNotes"),n=u("../Data/DataSearchEngine")(),a=u("../UI/Translator")(),r=u("../core/NoteEditor")(),i=u("../core/MapEditor")(),s=u("../UI/RouteEditorUI")(),l=u("../core/ItineraryEditor")(),d=u("../util/Utilities")();void 0!==t&&t.exports&&(t.exports=function(){return{cutRoute:function(t,e){var o=[u("../data/Route")(),u("../data/Route")()];o[0].object=t.object,o[1].object=t.object,o[0].itinerary.itineraryPoints.removeAll(),o[1].itinerary.itineraryPoints.removeAll();for(var r,n=this.getClosestLatLngDistance(t,e),a=t.itinerary.itineraryPoints.iterator,i=0,s=null,l=0;!a.done;){if((r=u("../data/ItineraryPoint")()).object=a.value.object,0===l&&0!=i&&i>n.distance){var d=L.latLng(n.latLng).distanceTo(L.latLng(a.value.latLng)),c=u("../data/ItineraryPoint")();c.latLng=n.latLng,o[0].itinerary.itineraryPoints.add(c),o[0].distance=i-d,s&&(s.distance-=d),l=1,(c=u("../data/ItineraryPoint")()).latLng=n.latLng,c.distance=d,o[1].itinerary.itineraryPoints.add(c),i=d}o[l].itinerary.itineraryPoints.add(r),i+=a.value.distance,s=r}return o[l].distance=i,o},getClosestLatLngDistance:function(t,e){if(0===t.itinerary.itineraryPoints.length)return null;for(var o=t.itinerary.itineraryPoints.iterator,r=(o.done,Number.MAX_VALUE),n=L.Projection.SphericalMercator.project(L.latLng(e[0],e[1])),a=L.Projection.SphericalMercator.project(L.latLng(o.value.lat,o.value.lng)),i=null,s=0,l=o.value.distance;!o.done;){var d=L.Projection.SphericalMercator.project(L.latLng(o.value.lat,o.value.lng)),c=L.LineUtil.pointToSegmentDistance(n,a,d);c<r&&(r=c,s=l-(i=L.Projection.SphericalMercator.unproject(L.LineUtil.closestPointOnSegment(n,a,d))).distanceTo(L.latLng(o.value.lat,o.value.lng))),l+=o.value.distance,a=d}return{latLng:[i.lat,i.lng],distance:s}},saveGpx:function(){var t="\n\t",e="\n\t\t",o="time='"+(new Date).toISOString()+"' ",r="<?xml version='1.0'?>\n";r+="<gpx xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xsi:schemaLocation='http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd' version='1.1' creator='Leaflet-Routing-Gpx'>";for(var n=c.editedRoute.wayPoints.iterator;!n.done;)r+=t+"<wpt lat='"+n.value.lat+"' lon='"+n.value.lng+"' "+o+"/>";r+=t+"<rte>";for(var a=c.editedRoute.itinerary.maneuvers.iterator;!a.done;){var i=c.editedRoute.itinerary.itineraryPoints.getAt(a.value.itineraryPointObjId),s=a.value.instruction.replace("&","&amp;").replace("'","&apos;").replace('"',"&quote;").replace(">","&gt;").replace("<","&lt;");r+=e+"<rtept lat='"+i.lat+"' lon='"+i.lng+"' "+o+"desc='"+s+"' />"}r+=t+"</rte>",r+=t+"<trk>",r+=e+"<trkseg>";for(var l=c.editedRoute.itinerary.itineraryPoints.iterator;!l.done;)r+="\n\t\t\t<trkpt lat='"+l.value.lat+"' lon='"+l.value.lng+"' "+o+" />";r+=e+"</trkseg>",r+=t+"</trk>",r+="\n</gpx>";var d=c.editedRoute.name;""===d&&(d="TravelNote"),d+=".gpx",u("../util/Utilities")().saveFile(d,r)},getRouteHTML:function(t,e){var o='<div class="'+e+'Route-Header-Name">'+t.name+"</div>";return 0!==t.distance&&(o+='<div class="'+e+'Route-Header-Distance">'+a.getText("RouteEditor - Distance",{distance:d.formatDistance(t.distance)})+'</div><div class="'+e+'Route-Header-Duration">'+a.getText("RouteEditor - Duration",{duration:d.formatTime(t.duration)})+"</div>"),o},chainRoutes:function(){for(var t=c.travel.routes.iterator,e=0;!t.done;){t.value.chain?(t.value.chainedDistance=e,e+=t.value.distance):t.value.chainedDistance=0;for(var o=t.value.notes.iterator;!o.done;)o.value.chainedDistance=t.value.chainedDistance}},startRouting:function(){c.config.routing.auto&&u("../core/Router")().startRouting(c.editedRoute)},endRouting:function(){i.removeRoute(c.editedRoute,!0,!0);for(var t=c.editedRoute.notes.iterator;!t.done;){var e=this.getClosestLatLngDistance(c.editedRoute,t.value.latLng);t.value.latLng=e.latLng,t.value.distance=e.distance}c.editedRoute.notes.sort(function(t,e){return t.distance-e.distance}),i.addRoute(c.editedRoute,!0,!0),0!==c.editedRoute.itinerary.itineraryPoints.length&&i.zoomToRoute(c.editedRoute.objId),l.setItinerary(),s.setWayPointsList(),this.chainRoutes(),u("../core/TravelEditor")().updateRoadBook()},saveEdition:function(){var t=u("../data/Route")();t.object=c.editedRoute.object,c.travel.routes.replace(c.routeEdition.routeInitialObjId,t),c.routeEdition.routeInitialObjId=t.objId,this.clear()},cancelEdition:function(){this.clear()},clear:function(){i.removeRoute(c.editedRoute,!0,!0),-1!==c.routeEdition.routeInitialObjId&&i.addRoute(n.getRoute(c.routeEdition.routeInitialObjId),!0,!1),c.editedRoute=u("../data/Route")(),c.routeEdition.routeChanged=!1,c.routeEdition.routeInitialObjId=-1,u("../UI/TravelEditorUI")().setRoutesList(),s.setWayPointsList(),s.reduce(),l.setItinerary(),this.chainRoutes(),u("../core/TravelEditor")().updateRoadBook()},editRoute:function(t){if(c.routeEdition.routeChanged)u("../core/ErrorEditor")().showError(a.getText("RouteEditor - Not possible to edit a route without a save or cancel"));else{-1!==c.routeEdition.routeInitialObjId&&this.clear();var e=n.getRoute(t),o=e.itinerary.provider;if(!o||""===o||c.providers.get(o.toLowerCase())){u("../UI/ProvidersToolbarUI")().provider=o;var r=e.itinerary.transitMode;r&&""!==r&&(u("../UI/ProvidersToolbarUI")().transitMode=r),c.editedRoute=u("../data/Route")(),c.editedRoute.object=e.object,c.routeEdition.routeInitialObjId=e.objId,c.editedRoute.hidden=!1,e.hidden=!1,i.removeRoute(e,!0,!1),i.addRoute(c.editedRoute,!0,!0),this.chainRoutes(),s.expand(),s.setWayPointsList(),l.setItinerary()}else u("../core/ErrorEditor")().showError(a.getText("RouteEditor - Not possible to edit a route created with this provider",{provider:o}))}},routeProperties:function(t){var e=n.getRoute(t);u("../UI/RoutePropertiesDialog")(e)},addWayPoint:function(t,e,o){c.routeEdition.routeChanged=!0;var r=u("../data/Waypoint.js")();if(t&&(r.latLng=t,c.config.wayPoint.reverseGeocoding&&u("../core/GeoCoder")().getAddress(t[0],t[1],this.renameWayPoint,this,r.objId)),c.editedRoute.wayPoints.add(r),i.addWayPoint(c.editedRoute.wayPoints.last,c.editedRoute.wayPoints.length-2),o){for(var n=c.editedRoute.wayPoints.iterator;!n.done;)if(o<this.getClosestLatLngDistance(c.editedRoute,n.value.latLng).distance){c.editedRoute.wayPoints.moveTo(r.objId,n.value.objId,!0);break}}else c.editedRoute.wayPoints.swap(r.objId,!0);s.setWayPointsList(),this.startRouting()},addWayPointOnRoute:function(t,e){var o=this.getClosestLatLngDistance(n.getRoute(t),[e.latlng.lat,e.latlng.lng]);this.addWayPoint(o.latLng,null,o.distance)},reverseWayPoints:function(){c.routeEdition.routeChanged=!0;for(var t=c.editedRoute.wayPoints.iterator;!t.done;)i.removeObject(t.value.objId);for(c.editedRoute.wayPoints.reverse(),t=c.editedRoute.wayPoints.iterator;!t.done;)i.addWayPoint(t.value,t.first?"A":t.last?"B":t.index);s.setWayPointsList(),this.startRouting()},removeAllWayPoints:function(){c.routeEdition.routeChanged=!0;for(var t=c.editedRoute.wayPoints.iterator;!t.done;)i.removeObject(t.value.objId);c.editedRoute.wayPoints.removeAll(!0),s.setWayPointsList(),this.startRouting()},removeWayPoint:function(t){c.routeEdition.routeChanged=!0,i.removeObject(t),c.editedRoute.wayPoints.remove(t),s.setWayPointsList(),this.startRouting()},renameWayPoint:function(t,e){c.routeEdition.routeChanged=!0,c.editedRoute.wayPoints.getAt(e).name=t,s.setWayPointsList()},swapWayPoints:function(t,e){c.routeEdition.routeChanged=!0,c.editedRoute.wayPoints.swap(t,e),s.setWayPointsList(),this.startRouting()},setStartPoint:function(t){c.routeEdition.routeChanged=!0,0!==c.editedRoute.wayPoints.first.lat&&i.removeObject(c.editedRoute.wayPoints.first.objId),c.editedRoute.wayPoints.first.latLng=t,c.config.wayPoint.reverseGeocoding&&u("../core/GeoCoder")().getAddress(t[0],t[1],this.renameWayPoint,this,c.editedRoute.wayPoints.first.objId),i.addWayPoint(c.editedRoute.wayPoints.first,"A"),s.setWayPointsList(),this.startRouting()},setEndPoint:function(t){c.routeEdition.routeChanged=!0,0!==c.editedRoute.wayPoints.last.lat&&i.removeObject(c.editedRoute.wayPoints.last.objId),c.editedRoute.wayPoints.last.latLng=t,c.config.wayPoint.reverseGeocoding&&u("../core/GeoCoder")().getAddress(t[0],t[1],this.renameWayPoint,this,c.editedRoute.wayPoints.last.objId),i.addWayPoint(c.editedRoute.wayPoints.last,"B"),s.setWayPointsList(),this.startRouting()},wayPointDragEnd:function(t){if(c.routeEdition.routeChanged=!0,c.config.wayPoint.reverseGeocoding){var e=c.editedRoute.wayPoints.getAt(t).latLng;u("../core/GeoCoder")().getAddress(e[0],e[1],this.renameWayPoint,this,t)}s.setWayPointsList(),this.startRouting()},wayPointDropped:function(t,e,o){if(c.routeEdition.routeChanged=!0,(e!==c.editedRoute.wayPoints.first.objId||!o)&&(e!==c.editedRoute.wayPoints.last.objId||o)){c.editedRoute.wayPoints.moveTo(t,e,o),s.setWayPointsList();for(var r=c.editedRoute.wayPoints.iterator;!r.done;)i.removeObject(r.value.objId),i.addWayPoint(r.value,r.first?"A":r.last?"B":r.index);this.startRouting()}},hideRoute:function(t){var e=n.getRoute(t);e&&(i.removeRoute(e,!0,!0),e.hidden=!0)},showRoutes:function(){for(var t=c.travel.routes.iterator;!t.done;)t.value.hidden&&i.addRoute(t.value,!0,!0,!1)},getMapContextMenu:function(t){var e=[];return e.push({context:this,name:a.getText("RouteEditor - Select this point as start point"),action:-1!==c.routeEdition.routeInitialObjId&&0===c.editedRoute.wayPoints.first.lat?this.setStartPoint:null,param:t}),e.push({context:this,name:a.getText("RouteEditor - Select this point as way point"),action:-1!==c.routeEdition.routeInitialObjId?this.addWayPoint:null,param:t}),e.push({context:this,name:a.getText("RouteEditor - Select this point as end point"),action:-1!==c.routeEdition.routeInitialObjId&&0===c.editedRoute.wayPoints.last.lat?this.setEndPoint:null,param:t}),e},getWayPointContextMenu:function(t){var e=[];return e.push({context:this,name:a.getText("RouteEditor - Delete this waypoint"),action:c.editedRoute.wayPoints.first.objId!==t&&c.editedRoute.wayPoints.last.objId!==t?this.removeWayPoint:null,param:t}),e},getRouteContextMenu:function(t){var e=[],o=u("../core/TravelEditor")();return e.push({context:this,name:a.getText("RouteEditor - Edit this route"),action:c.routeEdition.routeInitialObjId===t||c.routeEdition.routeChanged?null:this.editRoute,param:t}),e.push({context:o,name:a.getText("RouteEditor - Delete this route"),action:c.routeEdition.routeInitialObjId===t||c.routeEdition.routeChanged?null:o.removeRoute,param:t}),e.push({context:o,name:a.getText("RouteEditor - Hide this route"),action:c.editedRoute.objId!==t?this.hideRoute:null,param:t}),e.push({context:this,name:a.getText("RouteEditor - Add a waypoint on the route"),action:-1!==c.routeEdition.routeInitialObjId?this.addWayPointOnRoute:null,param:t}),e.push({context:r,name:a.getText("RouteEditor - Add a note on the route"),action:r.newRouteNote,param:t}),e.push({context:this,name:a.getText("RouteEditor - Properties"),action:this.routeProperties,param:t}),e.push({context:i,name:a.getText("RouteEditor - Zoom to route"),action:i.zoomToRoute,param:t}),e.push({context:this,name:a.getText("RouteEditor - Save modifications on this route"),action:c.editedRoute.objId===t?this.saveEdition:null}),e.push({context:this,name:a.getText("RouteEditor - Cancel modifications on this route"),action:c.editedRoute.objId===t?this.cancelEdition:null}),e}}})}()},{"../Data/DataSearchEngine":2,"../L.TravelNotes":7,"../UI/ProvidersToolbarUI":19,"../UI/RouteEditorUI":20,"../UI/RoutePropertiesDialog":21,"../UI/Translator":24,"../UI/TravelEditorUI":25,"../core/ErrorEditor":29,"../core/GeoCoder":31,"../core/ItineraryEditor":32,"../core/MapEditor":33,"../core/NoteEditor":34,"../core/Router":36,"../core/TravelEditor":37,"../data/ItineraryPoint":41,"../data/Route":46,"../data/Waypoint.js":51,"../util/Utilities":52}],36:[function(d,t,e){!function(){"use strict";var s=!1,r=null,l=d("../L.TravelNotes");d("../UI/Translator")();void 0!==t&&t.exports&&(t.exports=function(){var t=function(t){s=!1,d("../core/ErrorEditor")().showError(t)},e=function(t){s=!1;for(var e=l.editedRoute.itinerary.itineraryPoints.iterator,o=0,r=(e.done,e.value);!e.done;)0===r.distance&&(r.distance=L.latLng(r.latLng).distanceTo(L.latLng(e.value.latLng))),o+=r.distance,r=e.value;l.editedRoute.distance=0,l.editedRoute.duration=0;for(var n=l.editedRoute.itinerary.maneuvers.iterator;!n.done;)l.editedRoute.distance+=n.value.distance,l.editedRoute.duration+=n.value.duration;if(0!=l.editedRoute.distance){var a=l.editedRoute.distance/o;for(e=l.editedRoute.itinerary.itineraryPoints.iterator;!e.done;)e.value.distance*=a}else l.editedRoute.distance=o;for(var i=l.editedRoute.wayPoints.iterator;!i.done;)i.first?i.value.latLng=l.editedRoute.itinerary.itineraryPoints.first.latLng:i.last?i.value.latLng=l.editedRoute.itinerary.itineraryPoints.last.latLng:i.value.latLng=d("./RouteEditor")().getClosestLatLngDistance(l.editedRoute,i.value.latLng).latLng;d("./RouteEditor")().endRouting()},o=function(){return!s&&!!l.editedRoute.wayPoints.forEach(function(t,e){return null===e&&(e=!0),e&=0!==t.lat&&0!==t.lng})&&(s=!0,r=l.providers.get(l.routing.provider),l.editedRoute.itinerary.provider=r.name,l.editedRoute.itinerary.transitMode=l.routing.transitMode,r.getPromiseRoute(l.editedRoute,null).then(e,t),!0)};return{startRouting:function(){return o()}}})}()},{"../L.TravelNotes":7,"../UI/Translator":24,"../core/ErrorEditor":29,"./RouteEditor":35}],37:[function(l,e,t){!function(){"use strict";var n=l("../UI/Translator")(),r=l("../L.TravelNotes"),o=l("../Data/DataSearchEngine")(),t=l("../core/MapEditor")(),a=l("../UI/TravelEditorUI")(),i=!1,s=!1;void 0!==e&&e.exports&&(e.exports=function(){return{updateRoadBook:function(t){!function(t){if(s||(window.addEventListener("unload",function(t){localStorage.removeItem(l("../L.TravelNotes").UUID+"-TravelNotesHTML")}),s=!0),t||i||!r.config.haveBeforeUnloadWarning||(window.addEventListener("beforeunload",function(t){return t.returnValue="x"}),i=!0),l("../util/Utilities")().storageAvailable("localStorage")){var e=l("../UI/HTMLViewsFactory")();e.classNamePrefix="TravelNotes-Roadbook-",localStorage.setItem(r.UUID+"-TravelNotesHTML",e.travelHTML.outerHTML)}}(t)},addRoute:function(){r.travel.routes.add(l("../Data/Route")()),a.setRoutesList(),l("../core/RouteEditor")().chainRoutes(),this.updateRoadBook()},editRoute:function(t){l("../core/RouteEditor")().editRoute(t)},removeRoute:function(t){t===r.routeEdition.routeInitialObjId&&r.routeEdition.routeChanged?l("./ErrorEditor")().showError(n.getText("TravelEditor - Cannot remove an edited route")):(l("./MapEditor")().removeRoute(o.getRoute(t),!0,!0),r.travel.routes.remove(t),a.setRoutesList(),t===r.routeEdition.routeInitialObjId&&l("./RouteEditor")().clear(),l("../core/RouteEditor")().chainRoutes(),this.updateRoadBook())},renameRoute:function(t,e){o.getRoute(t).name=e,a.setRoutesList(),t===r.routeEdition.routeInitialObjId&&(r.editedRoute.name=e),this.updateRoadBook()},swapRoute:function(t,e){r.travel.routes.swap(t,e),a.setRoutesList(),l("../core/RouteEditor")().chainRoutes(),this.updateRoadBook()},routeDropped:function(t,e,o){r.travel.routes.moveTo(t,e,o),a.setRoutesList(),l("../core/RouteEditor")().chainRoutes(),this.updateRoadBook()},saveTravel:function(){if(r.routeEdition.routeChanged)l("./ErrorEditor")().showError(n.getText("TravelEditor - Not possible to save a travel without a save or cancel"));else{for(var t=r.travel.routes.iterator;!t.done;)t.value.hidden=!1;var e=r.travel.object;e.routes.forEach(function(t){var e={};0!==t.itinerary.itineraryPoints.length&&(e=t.itinerary.itineraryPoints[0].objType);var o={latLngs:[],distances:[],objIds:[],objType:e};t.itinerary.itineraryPoints.forEach(function(t){o.latLngs.push([t.lat,t.lng]),o.distances.push(t.distance),o.objIds.push(t.objId)}),o.latLngs=l("@mapbox/polyline").encode(o.latLngs,6),t.itinerary.itineraryPoints=o}),l("../util/Utilities")().saveFile(e.name+".trv",JSON.stringify(e))}},confirmClose:function(){return!i||window.confirm(n.getText("TravelEditor - This page ask to close; data are perhaps not saved."))},clear:function(){this.confirmClose()&&(t.removeAllObjects(),r.editedRoute=l("../Data/Route")(),r.routeEdition.routeChanged=!1,r.routeEdition.routeInitialObjId=-1,r.travel=l("../Data/Travel")(),r.travel.routes.add(l("../Data/Route")()),l("../UI/TravelEditorUI")().setRoutesList(),l("../UI/RouteEditorUI")().setWayPointsList(),l("../core/ItineraryEditor")().setItinerary(),this.updateRoadBook(!0))},getMapContextMenu:function(t){var e=l("../core/MapEditor")(),o=l("../core/RouteEditor")(),r=[];return r.push({context:o,name:n.getText("TravelEditor - Show all routes"),action:o.showRoutes}),r.push({context:e,name:n.getText("TravelEditor - Zoom to travel"),action:e.zoomToTravel}),r.push({context:null,name:n.getText("TravelEditor - About Travel & Notes"),action:l("../UI/AboutDialog")}),r}}})}()},{"../Data/DataSearchEngine":2,"../Data/Route":4,"../Data/Travel":5,"../L.TravelNotes":7,"../UI/AboutDialog":8,"../UI/HTMLViewsFactory":15,"../UI/RouteEditorUI":20,"../UI/Translator":24,"../UI/TravelEditorUI":25,"../core/ItineraryEditor":32,"../core/MapEditor":33,"../core/RouteEditor":35,"../util/Utilities":52,"./ErrorEditor":29,"./MapEditor":33,"./RouteEditor":35,"@mapbox/polyline":1}],38:[function(i,t,e){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(t){var s=[],r=t,n=function(t){if(!t.objType||!t.objType.name||t.objType.name!==r)throw"invalid object name for add function";s.push(t)},l=function(e){return s.findIndex(function(t){return t.objId===e})},a=function(){var t=-1;return{get value(){return t<s.length?s[t]:null},get done(){return++t>=s.length},get first(){return 0===t},get last(){return t>=s.length-1},get index(){return t}}};return Object.seal({add:function(t){n(t)},forEach:function(t){return function(t){for(var e=null,o=a();!o.done;)e=t(o.value,e);return e}(t)},getAt:function(t){return-1===(e=l(t))?null:s[e];var e},moveTo:function(t,e,o){var r,n,a,i;r=e,n=o,a=l(t),i=l(r),n||i++,s.splice(i,0,s[a]),i<a&&a++,s.splice(a,1)},remove:function(t){!function(t){if(-1===l(t))throw"invalid objId for remove function";s.splice(l(t),1)}(t)},removeAll:function(t){t?s.splice(1,s.length-2):s.length=0},replace:function(t,e){!function(t,e){var o=l(t);if(-1===o)throw"invalid objId for replace function";s[o]=e}(t,e)},reverse:function(){s.reverse()},sort:function(t){var e;e=t,s.sort(e)},swap:function(t,e){!function(t,e){var o=l(t);if(-1===o||0===o&&e||s.length-1===o&&!e)throw"invalid objId for swap function";var r=s[o];s[o]=s[o+(e?-1:1)],s[o+(e?-1:1)]=r}(t,e)},get first(){return s[0]},get iterator(){return a()},get last(){return s[s.length-1]},get length(){return s.length},get object(){return function(){for(var t=[],e=a();!e.done;)t.push(e.value.object);return t}()},set object(t){var e,o;e=t,s.length=0,e.forEach(function(t){switch(r){case"Route":o=i("../data/Route")();break;case"Note":o=i("../data/Note")();break;case"WayPoint":o=i("../data/WayPoint")();break;case"Maneuver":o=i("../data/Maneuver")();break;case"ItineraryPoint":o=i("../data/ItineraryPoint")();break;default:throw"invalid ObjName ( "+r+" ) in Collection.m_SetObject"}o.object=t,n(o)})}})})}()},{"../data/ItineraryPoint":41,"../data/Maneuver":42,"../data/Note":43,"../data/Route":46,"../data/WayPoint":50}],39:[function(t,n,e){!function(){"use strict";var r,o,e;void 0!==n&&n.exports&&(n.exports=(e={contextMenu:{timeout:1500},errorMessages:{timeout:2e4},routing:{auto:!0},language:"fr",itineraryPointMarker:{color:"red",weight:2,radius:7,fill:!(o=function(t){var e;for(e in t)"object"==typeof t[e]&&(t[e]=o(t[e]));return Object.freeze(t)})},searchPointMarker:{color:"green",weight:4,radius:20,fill:!(r=function(t,e){if("object"==typeof t&&"object"==typeof e)try{var o;for(o in e)"object"==typeof e[o]?r(t[o],e[o]):e[o]=t[o]||e[o];for(o in t)"object"==typeof t[o]?("[object Array]"==Object.prototype.toString.call(t[o])?e[o]=e[o]||[]:e[o]=e[o]||{},r(t[o],e[o])):e[o]=t[o]}catch(t){console.log(t),console.log("Not possible to overload Config")}})},searchPointPolyline:{polyline:{color:"green",weight:4,radius:20,fill:!1},minZoom:17},previousSearchLimit:{color:"green",fill:!1,weight:1},nextSearchLimit:{color:"red",fill:!1,weight:1},wayPoint:{reverseGeocoding:!1},route:{color:"#ff0000",width:3,dashArray:0,dashChoices:[{text:"——————",iDashArray:null},{text:"— — — — —",iDashArray:[4,2]},{text:"—‧—‧—‧—‧—",iDashArray:[4,2,0,2]},{text:"················",iDashArray:[0,2]}]},note:{reverseGeocoding:!1,grip:{size:10,opacity:0},polyline:{color:"gray",weight:1},style:"TravelNotes-NotesStyle"},itineraryPointZoom:17,routeEditor:{displayEditionInHTMLPage:!0},travelEditor:{clearAfterSave:!0,startMinimized:!0,timeout:1e3,startupRouteEdition:!0},haveBeforeUnloadWarning:!0},{get contextMenu(){return e.contextMenu},get errorMessages(){return e.errorMessages},get routing(){return e.routing},get language(){return e.language},get itineraryPointMarker(){return e.itineraryPointMarker},get searchPointMarker(){return e.searchPointMarker},get searchPointPolyline(){return e.searchPointPolyline},get previousSearchLimit(){return e.previousSearchLimit},get nextSearchLimit(){return e.nextSearchLimit},get wayPoint(){return e.wayPoint},get route(){return e.route},get note(){return e.note},get itineraryPointZoom(){return e.itineraryPointZoom},get routeEditor(){return e.routeEditor},get travelEditor(){return e.travelEditor},get haveBeforeUnloadWarning(){return e.haveBeforeUnloadWarning},overload:function(t){r(t,e),e=o(e)}}))}()},{}],40:[function(t,e,o){arguments[4][3][0].apply(o,arguments)},{"../data/Collection":38,"../data/ObjId":44,"../data/ObjType":45,"./Version":49,dup:3}],41:[function(i,t,e){!function(){"use strict";var a=i("../data/ObjType")("ItineraryPoint",i("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var e=0,o=0,r=0,n=i("../data/ObjId")();return{get lat(){return e},set lat(t){e=t},get lng(){return o},set lng(t){o=t},get latLng(){return[e,o]},set latLng(t){e=t[0],o=t[1]},get distance(){return r},set distance(t){r=t},get objId(){return n},get objType(){return a},get object(){return{lat:parseFloat(e.toFixed(6)),lng:parseFloat(o.toFixed(6)),distance:parseFloat(r.toFixed(2)),objId:n,objType:a.object}},set object(t){t=a.validate(t),e=t.lat||0,o=t.lng||0,r=t.distance||0,n=i("../data/ObjId")()}}})}()},{"../data/ObjId":44,"../data/ObjType":45,"./Version":49}],42:[function(l,t,e){!function(){"use strict";var s=l("../data/ObjType")("Maneuver",l("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var e=l("../data/ObjId")(),o="",r="",n=-1,a=0,i=0;return{get iconName(){return o},set iconName(t){o=t},get instruction(){return r},set instruction(t){r=t},get itineraryPointObjId(){return n},set itineraryPointObjId(t){n=t},get distance(){return a},set distance(t){a=t},get duration(){return i},set duration(t){i=t},get objId(){return e},get objType(){return s},get object(){return{iconName:o,instruction:r,distance:parseFloat(a.toFixed(2)),duration:i,itineraryPointObjId:n,objId:e,objType:s.object}},set object(t){t=s.validate(t),o=t.iconName||"",r=t.instruction||"",a=t.distance||0,i=t.duration||0,n=t.itineraryPointObjId||-1,e=l("../data/ObjId")()}}})}()},{"../data/ObjId":44,"../data/ObjType":45,"./Version":49}],43:[function(f,t,e){!function(){"use strict";var T=f("../data/ObjType")("Note",f("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var e=f("../data/ObjId")(),o=40,r=40,n="",a="",i="",s="",l="",d="",c=0,u=0,v=0,g=0,p=-1,m=0;return{get isRouteNote(){return-1!==p},get iconHeight(){return o},set iconHeight(t){o=t},get iconWidth(){return r},set iconWidth(t){r=t},get iconContent(){return n},set iconContent(t){n=t},get popupContent(){return a},set popupContent(t){a=t},get tooltipContent(){return i},set tooltipContent(t){i=t},get phone(){return s},set phone(t){s=t},get url(){return l},set url(t){l=t},get address(){return d},set address(t){d=t},get iconLat(){return c},set iconLat(t){c=t},get iconLng(){return u},set iconLng(t){u=t},get iconLatLng(){return[c,u]},set iconLatLng(t){c=t[0],u=t[1]},get lat(){return v},set lat(t){v=t},get lng(){return g},set lng(t){g=t},get latLng(){return[v,g]},set latLng(t){v=t[0],g=t[1]},get distance(){return p},set distance(t){p=t},get chainedDistance(){return m},set chainedDistance(t){m=t},get objId(){return e},get objType(){return T},get object(){return{iconHeight:o,iconWidth:r,iconContent:n,popupContent:a,tooltipContent:i,phone:s,url:l,address:d,iconLat:parseFloat(c.toFixed(6)),iconLng:parseFloat(u.toFixed(6)),lat:parseFloat(v.toFixed(6)),lng:parseFloat(g.toFixed(6)),distance:parseFloat(p.toFixed(2)),chainedDistance:parseFloat(m.toFixed(2)),objId:e,objType:T.object}},set object(t){t=T.validate(t),o=t.iconHeight||40,r=t.iconWidth||40,n=t.iconContent||"",a=t.popupContent||"",i=t.tooltipContent||"",s=t.phone||"",l=t.url||"",d=t.address||"",c=t.iconLat||0,u=t.iconLng||0,v=t.lat||0,g=t.lng||0,p=t.distance||-1,m=t.chainedDistance,e=f("../data/ObjId")()}}})}()},{"../data/ObjId":44,"../data/ObjType":45,"./Version":49}],44:[function(t,e,o){(function(t){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){return t.TravelNotesObjId||(t.TravelNotesObjId=0),++t.TravelNotesObjId})}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],45:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(t,e){var o=t,r=e;return{get name(){return o},get version(){return r},get object(){return{name:o,version:r}},validate:function(t){if(!t.objType)throw"No objType for "+o;if(!t.objType.name)throw"No name for "+o;if(o!==t.objType.name)throw"Invalid name for "+o;if(!t.objType.version)throw"No version for "+o;if(r!==t.objType.version&&("1.0.0"===t.objType.version&&("Route"===t.objType.name&&(t.dashArray=0,t.hidden=!1),t.objType.version="1.1.0"),"1.1.0"===t.objType.version&&(t.objType.version="1.2.0"),"1.2.0"===t.objType.version&&(t.objType.version="1.3.0"),r!==t.objType.version))throw"invalid version for "+o;if(!t.objId)throw"No objId for "+o;return t}}})}()},{}],46:[function(t,e,o){arguments[4][4][0].apply(o,arguments)},{"../L.TravelNotes":7,"../data/Collection":38,"../data/Itinerary":40,"../data/ObjId":44,"../data/ObjType":45,"../data/Waypoint":51,"./Itinerary":40,"./Version":49,dup:4}],47:[function(t,e,o){arguments[4][5][0].apply(o,arguments)},{"../data/Collection":38,"../data/ObjId":44,"../data/ObjType":45,"./Version":49,dup:5}],48:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){var e={config:t("../data/Config"),map:null,providers:new Map,mapObjects:new Map,travel:t("../data/Travel")(),editedRoute:null,routeEdition:Object.seal({routeChanged:!1,routeInitialObjId:-1}),routing:Object.seal({provider:"",transitMode:""}),searchData:[],UUID:t("../util/Utilities")().UUID};return{get config(){return e.config},set config(t){e.config.overload(t)},get map(){return e.map},set map(t){e.map=t},get providers(){return e.providers},get mapObjects(){return e.mapObjects},get travel(){return e.travel},set travel(t){e.travel=t},get editedRoute(){return e.editedRoute},set editedRoute(t){e.editedRoute=t},get routeEdition(){return e.routeEdition},get routing(){return e.routing},get searchData(){return e.searchData},set searchData(t){e.searchData=t},get UUID(){return e.UUID}}})}()},{"../data/Config":39,"../data/Travel":47,"../util/Utilities":52}],49:[function(t,e,o){arguments[4][6][0].apply(o,arguments)},{dup:6}],50:[function(i,t,e){!function(){"use strict";var a=i("../data/ObjType")("WayPoint",i("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var e="",o=0,r=0,n=i("../data/ObjId")();return{get name(){return e},set name(t){e=t},get UIName(){return""!==e?e:0!==o&&0!==r?o.toFixed(6)+(0<o?" N - ":" S - ")+r.toFixed(6)+(0<r?" E":" W"):""},get lat(){return o},set lat(t){o=t},get lng(){return r},set lng(t){r=t},get latLng(){return[o,r]},set latLng(t){o=t[0],r=t[1]},get objId(){return n},get objType(){return a},get object(){return{name:e,lat:parseFloat(o.toFixed(6)),lng:parseFloat(r.toFixed(6)),objId:n,objType:a.object}},set object(t){t=a.validate(t),e=t.name||"",o=t.lat||0,r=t.lng||0,n=i("../data/ObjId")()}}})}()},{"../data/ObjId":44,"../data/ObjType":45,"./Version":49}],51:[function(t,e,o){arguments[4][50][0].apply(o,arguments)},{"../data/ObjId":44,"../data/ObjType":45,"./Version":49,dup:50}],52:[function(t,e,o){!function(){"use strict";var a=t("../UI/Translator")();void 0!==e&&e.exports&&(e.exports=function(){return{get UUID(){return function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}()},storageAvailable:function(t){try{var e=window[t],o="__storage_test__";return e.setItem(o,o),e.removeItem(o),!0}catch(t){return!1}},fileAPIAvailable:function(){try{return new File(["testdata"],{type:"text/plain"}),!0}catch(t){return!!window.navigator.msSaveOrOpenBlob}},saveFile:function(t,e,o){if(o||(o="text/plain"),window.navigator.msSaveOrOpenBlob)try{window.navigator.msSaveOrOpenBlob(new Blob([e]),t)}catch(t){}else try{var r=window.URL.createObjectURL(new File([e],{type:o})),n=document.createElement("a");n.setAttribute("href",r),n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(r)}catch(t){}},formatTime:function(t){if(0===(t=Math.floor(t)))return"";var e=Math.floor(t/86400),o=Math.floor(t%86400/3600),r=Math.floor(t%3600/60),n=Math.floor(t%60);return 0<e?e+"&nbsp;"+a.getText("Utilities - Day")+"&nbsp;"+o+"&nbsp;"+a.getText("Utilities - Hour"):0<o?o+"&nbsp;"+a.getText("Utilities - Hour")+"&nbsp;"+r+"&nbsp;"+a.getText("Utilities - Minute"):0<r?r+"&nbsp;"+a.getText("Utilities - Minute"):n+"&nbsp;"+a.getText("Utilities - Second")},formatDistance:function(t){return 0===(t=Math.floor(t))?"":t<1e3?t.toFixed(0)+"&nbsp;m":Math.floor(t/1e3)+"."+Math.floor(t%1e3/100)+"&nbsp;km"},formatLat:function(t){return 0<t?t.toFixed(6)+"&nbsp;N":(-t).toFixed(6)+"&nbsp;S"},formatLng:function(t){return 0<t?t.toFixed(6)+"&nbsp;E":(-t).toFixed(6)+"&nbsp;W"},formatLatLng:function(t){return this.formatLat(t[0])+"&nbsp;-&nbsp;"+this.formatLng(t[1])}}})}()},{"../UI/Translator":24}]},{},[7]);