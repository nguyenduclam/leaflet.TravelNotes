/*! leaflet.travelnotes - version 1.3.0 - build 1232 - 2019-06-06T14:19:20+0200 - Copyright 2017 2019 Christian Guyette - Contact: http//www.ouaie.be/ - This  program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or any later version.*/


!function a(i,s,l){function d(o,e){if(!s[o]){if(!i[o]){var t="function"==typeof require&&require;if(!e&&t)return t(o,!0);if(c)return c(o,!0);var n=new Error("Cannot find module '"+o+"'");throw n.code="MODULE_NOT_FOUND",n}var r=s[o]={exports:{}};i[o][0].call(r.exports,function(e){var t=i[o][1][e];return d(t||e)},r,r.exports,a,i,s,l)}return s[o].exports}for(var c="function"==typeof require&&require,e=0;e<l.length;e++)d(l[e]);return d}({1:[function(e,t,o){"use strict";var n={};function a(e){return Math.floor(Math.abs(e)+.5)*(0<=e?1:-1)}function s(e,t,o){var n=(e=a(e*o))-(t=a(t*o));n<<=1,e-t<0&&(n=~n);for(var r="";32<=n;)r+=String.fromCharCode(63+(32|31&n)),n>>=5;return r+=String.fromCharCode(n+63)}function r(e){for(var t=[],o=0;o<e.length;o++)t.push(e[o].slice().reverse());return t}n.decode=function(e,t){for(var o,n=0,r=0,a=0,i=[],s=0,l=0,d=null,c=Math.pow(10,t||5);n<e.length;){for(d=null,l=s=0;l|=(31&(d=e.charCodeAt(n++)-63))<<s,s+=5,32<=d;);for(o=1&l?~(l>>1):l>>1,s=l=0;l|=(31&(d=e.charCodeAt(n++)-63))<<s,s+=5,32<=d;);r+=o,a+=1&l?~(l>>1):l>>1,i.push([r/c,a/c])}return i},n.encode=function(e,t){if(!e.length)return"";for(var o=Math.pow(10,t||5),n=s(e[0][0],0,o)+s(e[0][1],0,o),r=1;r<e.length;r++){var a=e[r],i=e[r-1];n+=s(a[0],i[0],o),n+=s(a[1],i[1],o)}return n},n.fromGeoJSON=function(e,t){if(e&&"Feature"===e.type&&(e=e.geometry),!e||"LineString"!==e.type)throw new Error("Input must be a GeoJSON LineString");return n.encode(r(e.coordinates),t)},n.toGeoJSON=function(e,t){return{type:"LineString",coordinates:r(n.decode(e,t))}},"object"==typeof t&&t.exports&&(t.exports=n)},{}],2:[function(e,t,o){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){var n=e("../L.TravelNotes");return Object.seal({getRoute:function(e){return t=e,o=null,(o=n.travel.routes.getAt(t))||t===n.editedRoute.objId&&(o=n.editedRoute),o||console.log("Invalid noteObjId "+t+" for function DataSearchEngine.getRoute ( )"),o;var t,o},getNoteAndRoute:function(e){return function(e){var t=null;if(t=n.travel.notes.getAt(e))return{note:t,route:null};for(var o=n.travel.routes.iterator;!o.done;)if(t=o.value.notes.getAt(e))return{note:t,route:o.value};return(t=n.editedRoute.notes.getAt(e))?{note:t,route:n.editedRoute}:(console.log("Invalid noteObjId "+e+" for function DataSearchEngine.getNote ( )"),{note:null,route:null})}(e)},getWayPoint:function(e){return function(e){for(var t=null,o=n.travel.routes.iterator;!o.done;)if(t=o.value.wayPoints.getAt(e))return t;return(t=n.editedRoute.wayPoints.getAt(e))||(console.log("Invalid wayPointObjId "+e+" for function DataSearchEngine.getWayPoint ( )"),null)}(e)}})})}()},{"../L.TravelNotes":7}],3:[function(u,e,t){!function(){"use strict";var c=u("../data/ObjType")("Itinerary",u("./Version"));void 0!==e&&e.exports&&(e.exports=function(){var a="",i="",s=u("../data/Collection")("ItineraryPoint"),l=u("../data/Collection")("Maneuver"),d=u("../data/ObjId")();return Object.seal({get itineraryPoints(){return s},get maneuvers(){return l},get provider(){return a},set provider(e){a=e},get transitMode(){return i},set transitMode(e){i=e},get objId(){return d},get objType(){return c},get object(){return{itineraryPoints:s.object,maneuvers:l.object,provider:a,transitMode:i,objId:d,objType:c.object}},set object(e){!function(e){e=c.validate(e),s.object=e.itineraryPoints||[],l.object=e.maneuvers||[],a=e.provider||"",i=e.transitMode||"",d=u("../data/ObjId")();for(var t=new Map,o=0,n=s.iterator;!n.done;)t.set(e.itineraryPoints[o].objId,n.value.objId),o++;for(var r=l.iterator;!r.done;)r.value.itineraryPointObjId=t.get(r.value.itineraryPointObjId)}(e)}})})}()},{"../data/Collection":42,"../data/ObjId":49,"../data/ObjType":50,"./Version":6}],4:[function(T,e,t){!function(){"use strict";var m=T("../data/ObjType")("Route",T("./Version"));void 0!==e&&e.exports&&(e.exports=function(){var o="",n=T("../data/Collection")("WayPoint");n.add(T("../data/Waypoint")()),n.add(T("../data/Waypoint")());var r=T("../data/Collection")("Note"),a=T("../data/Itinerary")(),i=T("../L.TravelNotes").config.route.width||5,s=T("../L.TravelNotes").config.route.color||"#ff0000",l=T("../L.TravelNotes").config.route.dashArray||0,d=!1,c=0,u=0,v=0,g=!1,p=T("../data/ObjId")();return Object.seal({get wayPoints(){return n},get itinerary(){return a},get notes(){return r},get name(){return o},set name(e){o=e},get width(){return i},set width(e){i=e},get color(){return s},set color(e){s=e},get dashArray(){return l},set dashArray(e){l=e},get chain(){return d},set chain(e){d=e},get chainedDistance(){return c},set chainedDistance(e){c=e},get distance(){return u},set distance(e){u=e},get duration(){return v},set duration(e){v=e},get hidden(){return g},set hidden(e){g=e},get objId(){return p},get objType(){return m},get object(){return{name:o,wayPoints:n.object,notes:r.object,itinerary:a.object,width:i,color:s,dashArray:l,chain:d,distance:parseFloat(u.toFixed(2)),duration:v,hidden:g,chainedDistance:parseFloat(c.toFixed(2)),objId:p,objType:m.object}},set object(e){var t;t=e,t=m.validate(t),o=t.name||"",n.object=t.wayPoints||[],r.object=t.notes||[],a.object=t.itinerary||T("./Itinerary")().object,i=t.width||5,s=t.color||"#000000",l=t.dashArray||0,d=t.chain||!1,u=t.distance,v=t.duration,g=t.hidden||!1,c=t.chainedDistance,p=T("../data/ObjId")()}})})}()},{"../L.TravelNotes":7,"../data/Collection":42,"../data/Itinerary":45,"../data/ObjId":49,"../data/ObjType":50,"../data/Waypoint":56,"./Itinerary":3,"./Version":6}],5:[function(d,e,t){!function(){"use strict";var l=d("../data/ObjType")("Travel",d("./Version"));void 0!==e&&e.exports&&(e.exports=function(){var o="TravelNotes",n=d("../data/Collection")("Route"),r=d("../data/Collection")("Note"),a=d("../data/ObjId")(),i=!1,s={};return Object.seal({get routes(){return n},get notes(){return r},get name(){return o},set name(e){o=e},get readOnly(){return i},set readOnly(e){i=e},get userData(){return s},set userData(e){s=e},get objId(){return a},get objType(){return l},get object(){return{name:o,routes:n.object,notes:r.object,userData:s,readOnly:i,objId:a,objType:l.object}},set object(e){var t;t=e,t=l.validate(t),o=t.name||"",s=t.userData||{},i=t.readOnly||!1,n.object=t.routes||[],r.object=t.notes||[],a=d("../data/ObjId")()}})})}()},{"../data/Collection":42,"../data/ObjId":49,"../data/ObjType":50,"./Version":6}],6:[function(e,t,o){!function(){"use strict";void 0!==t&&t.exports&&(t.exports="1.4.0")}()},{}],7:[function(g,e,t){!function(){"use strict";L.travelNotes=function(){var a=g("./data/TravelNotesData")();void 0!==e&&e.exports&&(e.exports=a);var t=[],o=[],n=!1,r=!1,i=null,s=null,l="",d=function(t,o){var n=new XMLHttpRequest;n.timeout=2e4,n.ontimeout=function(e){o("XMLHttpRequest TimeOut. File : "+n.responseURL)},n.onreadystatechange=function(){if(4===n.readyState)if(200===n.status){var e;try{e=JSON.parse(n.responseText)}catch(e){o("JSON parsing error. File : "+n.responseURL)}t(e)}else o("Error XMLHttpRequest - Status : "+n.status+" - StatusText : "+n.statusText+" - File : "+n.responseURL)},n.open("GET",l,!0),n.overrideMimeType("application/json"),n.send(null)},c=function(e,t){var r;a.map=e,r="?",decodeURI(window.location.search).substr(1).split("&").forEach(function(e){if("fil="===e.substr(0,4).toLowerCase())s=decodeURIComponent(escape(atob(e.substr(4)))),r+="?"===r?"":"&",r+=e;else{var t=e.split("=");if(2===t.length)if(-1!==t[0].indexOf("ProviderKey")){var o=t[0].substr(0,t[0].length-11).toLowerCase(),n=a.providers.get(o);n&&n.providerKeyNeeded&&(n.providerKey=t[1]),sessionStorage.setItem(o,btoa(t[1]))}else r+="?"===r?"":"&",r+=e,"lng"===t[0].toLowerCase()&&(i=t[1].toLowerCase())}}),history.replaceState({index:"bar"},"page",r),a.providers.forEach(function(e){if(e.providerKeyNeeded&&0===e.providerKey){var t=null;g("./util/Utilities")().storageAvailable("sessionStorage")&&(t=sessionStorage.getItem(e.name.toLowerCase())),t?e.providerKey=atob(t):a.providers.delete(e.name.toLowerCase())}});var o=[];l=window.location.href.substr(0,window.location.href.lastIndexOf("/")+1)+"TravelNotesConfig.json",o.push(new Promise(d)),l=window.location.href.substr(0,window.location.href.lastIndexOf("/")+1)+"TravelNotes"+(i||a.config.language).toUpperCase()+".json",o.push(new Promise(d)),s&&(l=s,o.push(new Promise(d))),Promise.all(o).then(function(e){i&&(e[0].language=i),a.config=e[0],window.osmSearch?window.osmSearch.getDictionaryPromise(a.config.language,"travelNotes").then(function(){console.log("Dictionary loaded")},function(e){console.log(e)}):console.log("osmSearch not found"),a.providers.forEach(function(e){e.userLanguage=a.config.language}),g("./UI/Translator")().setTranslations(e[1]),a.travel=g("./data/Travel")(),a.travel.routes.add(g("./data/Route")()),a.editedRoute=g("./data/Route")(),document.getElementById(t).appendChild(g("./UI/UserInterface")().UI),g("./UI/TravelEditorUI")().setRoutesList(a.travel.routes),g("./core/TravelEditor")().updateRoadBook(!0),s?g("./core/FileLoader")().openDistantFile(e[2]):a.config.travelEditor.startupRouteEdition?g("./core/TravelEditor")().editRoute(a.travel.routes.first.objId):g("./UI/RouteEditorUI")().reduce()}).catch(function(e){console.log(e)})},u=function(e){a.travel.readOnly||g("./UI/ContextMenu")(e,g("./UI/ContextMenuFactory")().getMapContextMenu([e.latlng.lat,e.latlng.lng]).concat(t))},v=function(e){a.travel.readOnly||g("./UI/ContextMenu")(e,g("./UI/ContextMenuFactory")().getMapContextMenu([e.latlng.lat,e.latlng.lng]).concat(o))};return{addControl:function(e,t){return c(e,t)},addProvider:function(e){a.providers.set(e.name.toLowerCase(),e)},addMapContextMenu:function(e,t){e&&(a.map.on("click",u),n=!0),t&&(a.map.on("contextmenu",u),r=!0)},get baseDialog(){return g("./UI/baseDialog")()},get userData(){return a.travel.userData},set userData(e){a.travel.userData=e},get rightContextMenu(){return r},set rightContextMenu(e){e&&!r?(a.map.on("contextmenu",v),r=!0):!e&&r&&(a.map.off("contextmenu",v),r=!1)},get leftContextMenu(){return n},set leftContextMenu(e){e&&!n?(a.map.on("click",u),n=!0):!e&&n&&(a.map.off("click",u),n=!1)},get leftUserContextMenu(){return t},set leftUserContextMenu(e){t=e},get rightUserContextMenu(){return o},set rightUserContextMenu(e){o=e},get maneuver(){return g("./data/Maneuver")()},get itineraryPoint(){return g("./data/ItineraryPoint")()},get version(){return g("./data/Version")}}}()}()},{"./UI/ContextMenu":11,"./UI/ContextMenuFactory":12,"./UI/RouteEditorUI":21,"./UI/Translator":25,"./UI/TravelEditorUI":26,"./UI/UserInterface":28,"./UI/baseDialog":29,"./core/FileLoader":31,"./core/TravelEditor":39,"./data/ItineraryPoint":46,"./data/Maneuver":47,"./data/Route":51,"./data/Travel":52,"./data/TravelNotesData":53,"./data/Version":54,"./util/Utilities":57}],8:[function(o,e,t){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(e){var t=o("../UI/BaseDialog")();return t.title=o("../UI/Translator")().getText("AboutDialog - About Travel & Notes"),o("./HTMLElementsFactory")().create("div",{id:"TravelNotes-AboutDialog-AboutDiv"},t.content).innerHTML="<p>This  program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or any later version.</p><p>Copyright - 2017 2018 - Christian Guyette</p><p>Contact : <a href='http://www.ouaie.be/blog/pages/contact' target='_blank'>http://www.ouaie.be/</a></p><p>GitHub : <a href='https://github.com/wwwouaiebe/leaflet.TravelNotes' target='_blank'>https://github.com/wwwouaiebe/leaflet.TravelNotes</a></p><p>Version : "+o("../data/Version")+".<p>This program uses: <a href='https://leafletjs.com/' target='_blank'>leaflet</a>, <a href='https://github.com/mapbox/polyline' target='_blank'>mapbox/polyline</a>, <a href='https://github.com/Project-OSRM/osrm-text-instructions' target='_blank'>Project-OSRM/osrm-text-instructions</a> and  <a href='https://github.com/drolbr/Overpass-API' target='_blank'>the Overpass API</a></p>",t.center(),t})}()},{"../UI/BaseDialog":9,"../UI/Translator":25,"../data/Version":54,"./HTMLElementsFactory":15}],9:[function(N,e,t){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){var t=null,o=null,n=null,e=N("./HTMLElementsFactory")(),r=function(e){if("Escape"===e.key||"Esc"===e.key){if(n&&!n())return;document.removeEventListener("keydown",r,!0),document.getElementsByTagName("body")[0].removeChild(document.getElementById("TravelNotes-BaseDialog-BackgroundDiv"))}},a=document.getElementsByTagName("body")[0],i=e.create("div",{id:"TravelNotes-BaseDialog-BackgroundDiv",className:"TravelNotes-BaseDialog-BackgroundDiv"},a);i.addEventListener("dragover",function(e){},!1),i.addEventListener("drop",function(e){},!1);var s=i.clientWidth,l=i.clientHeight,d=0,c=0,u=0,v=0,g=e.create("div",{id:"TravelNotes-BaseDialog-Container",className:"TravelNotes-BaseDialog-Container"},i),p=e.create("div",{id:"TravelNotes-BaseDialog-TopBar",className:"TravelNotes-BaseDialog-TopBar",draggable:!0},g);e.create("div",{innerHTML:"&#x274c",id:"TravelNotes-BaseDialog-CancelButton",title:N("../UI/Translator")().getText("BaseDialog - Cancel")},p).addEventListener("click",function(){o&&!o()||(document.removeEventListener("keydown",r,!0),document.getElementsByTagName("body")[0].removeChild(i))},!1),p.addEventListener("dragstart",function(e){try{e.dataTransfer.setData("Text","1")}catch(e){}d=e.screenX,c=e.screenY},!1),p.addEventListener("dragend",function(e){u+=e.screenX-d,v+=e.screenY-c,u=Math.min(Math.max(u,20),s-g.clientWidth-20),v=Math.max(v,20);var t=l-Math.max(v,0)-20;g.setAttribute("style","top:"+v+"px;left:"+u+"px;max-height:"+t+"px;")},!1);var m=e.create("div",{className:"TravelNotes-BaseDialog-HeaderDiv",id:"TravelNotes-BaseDialog-HeaderDiv"},g),T=e.create("div",{className:"TravelNotes-BaseDialog-ContentDiv",id:"TravelNotes-BaseDialog-ContentDiv"},g),f=(e.create("div",{className:"TravelNotes-BaseDialog-ErrorDiv TravelNotes-BaseDialog-ErrorDivHidden",id:"TravelNotes-BaseDialog-ErrorDiv"},g),e.create("div",{className:"TravelNotes-BaseDialog-FooterDiv",id:"TravelNotes-BaseDialog-FooterDiv"},g));return e.create("div",{innerHTML:"&#x1f4be;",id:"TravelNotes-BaseDialog-OkButton",className:"TravelNotes-BaseDialog-Button"},f).addEventListener("click",function(){t&&!t()||(document.removeEventListener("keydown",r,!0),document.getElementsByTagName("body")[0].removeChild(i))},!1),document.addEventListener("keydown",r,!0),{addClickOkButtonEventListener:function(e){t=e},addClickCancelButtonEventListener:function(e){o=e},addEscapeKeyEventListener:function(e){n=e},get title(){return m.innerHTML},set title(e){m.innerHTML=e},center:function(){u=(s-g.clientWidth)/2,v=(l-g.clientHeight)/2,u=Math.min(Math.max(u,20),s-g.clientWidth-20),v=Math.max(v,20);var e=l-Math.max(v,0)-20;g.setAttribute("style","top:"+v+"px;left:"+u+"px;max-height:"+e+"px;")},get header(){return m},set header(e){m=e},get content(){return T},set content(e){T=e},get footer(){return f},set footer(e){f=e}}})}()},{"../UI/Translator":25,"./HTMLElementsFactory":15}],10:[function(C,e,t){!function(){"use strict";var b=function(){return!0};void 0!==e&&e.exports&&(e.exports=function(e){var o=function(e){return{r:parseInt(e.substr(1,2),16),g:parseInt(e.substr(3,2),16),b:parseInt(e.substr(5,2),16)}},s=function(e,t,o){return String.prototype.padStart||(String.prototype.padStart=function(e,t){return e>>=0,t=String(t||" "),this.length>e?String(this):((e-=this.length)>t.length&&(t+=t.repeat(e/t.length)),t.slice(0,e)+String(this))}),"#"+parseInt(e).toString(16).padStart(2,"0")+parseInt(t).toString(16).padStart(2,"0")+parseInt(o).toString(16).padStart(2,"0")},t=function(e){a=e.target.colorValue;var t=o(a);h.value=t.r,E.value=t.g,y.value=t.b,document.getElementById("TravelNotes-ColorDialog-ColorSampleDiv").setAttribute("style","background-color:"+e.target.colorValue+";")},n=function(e){for(var t=e.target.redValue,o=255,n=255,r=0;++r<7;){var a=0;for(o=255;++a<7;){var i=document.getElementById("TravelNotes-ColorDialog-CellColorDiv"+r+a);i.colorValue=s(t,o,n),i.setAttribute("style","background-color:"+s(t,o,n)),o-=51}n-=51}},r=function(){a=s(h.value,E.value,y.value),document.getElementById("TravelNotes-ColorDialog-ColorSampleDiv").setAttribute("style","background-color:"+a+";")},a=e,i=C("../UI/Translator")(),l=C("./HTMLElementsFactory")(),d=C("../UI/BaseDialog")();d.title=i.getText("ColorDialog - Colors"),d.addClickOkButtonEventListener(b),d.getNewColor=function(){return a};for(var c=l.create("div",{className:"TravelNotes-ColorDialog-ColorDiv",id:"TravelNotes-ColorDialog-ColorDiv"},d.content),u=l.create("div",{className:"TravelNotes-ColorDialog-ButtonsDiv",id:"TravelNotes-ColorDialog-ButtonsDiv"},c),v=255,g=255,p=255,m=0;++m<8;){var T=l.create("div",{className:"TravelNotes-ColorDialog-RowColorDiv",id:"TravelNotes-ColorDialog-RowColorDiv"+m},u),f=0;for(g=255;++f<7;){var N=l.create("div",{className:"TravelNotes-ColorDialog-CellColorDiv",id:"TravelNotes-ColorDialog-CellColorDiv"+m+f},T);if(m<7)N.setAttribute("style","background-color:"+s(v,g,p)),N.colorValue=s(v,g,p),N.addEventListener("click",t,!1),g-=51;else{var I=s(255,v=51*(f-1),v);N.setAttribute("style","background-color:"+I),N.redValue=255-v,N.addEventListener("click",n,!1)}}p-=51}var L=l.create("div",{className:"TravelNotes-ColorDialog-DataDiv",id:"TravelNotes-ColorDialog-DataDiv"},c);l.create("text",{data:i.getText("ColorDialog - Red")},L);var h=l.create("input",{type:"number",className:"TravelNotes-ColorDialog-NumberInput",id:"TravelNotes-ColorDialog-RedInput"},L);h.value=o(e).r,h.min=0,h.max=255,h.addEventListener("input",r,!1),l.create("text",{data:i.getText("ColorDialog - Green")},L);var E=l.create("input",{type:"number",className:"TravelNotes-ColorDialog-NumberInput",id:"TravelNotes-ColorDialog-GreenInput"},L);E.value=o(e).g,E.min=0,E.max=255,E.addEventListener("input",r,!1),l.create("text",{data:i.getText("ColorDialog - Blue")},L);var y=l.create("input",{type:"number",className:"TravelNotes-ColorDialog-NumberInput",id:"TravelNotes-ColorDialog-BlueInput"},L);return y.value=o(e).b,y.min=0,y.max=255,y.addEventListener("input",r,!1),l.create("div",{className:"TravelNotes-ColorDialog-ColorSampleDiv",id:"TravelNotes-ColorDialog-ColorSampleDiv"},c).setAttribute("style","background-color:"+e+";"),d.center(),d})}()},{"../UI/BaseDialog":9,"../UI/Translator":25,"./HTMLElementsFactory":15}],11:[function(h,e,t){!function(){"use strict";var c=[],u=null,v=null,o=0,g=0,p=0,m=null,T=function(){m&&(clearTimeout(m),m=null),p=g=0,document.removeEventListener("keydown",f,!0),document.removeEventListener("keypress",N,!0),document.removeEventListener("keyup",I,!0);var e=u.childNodes;e[0].firstChild.removeEventListener("click",T,!1);for(var t=1;t<e.length;t++)e[t].firstChild.removeEventListener("click",T,!1);document.getElementsByTagName("body")[0].removeChild(u),u=null,o=0},f=function(e){u&&(e.preventDefault(),e.stopPropagation()),"Escape"!==e.key&&"Esc"!==e.key||T(),"ArrowDown"!==e.key&&"ArrowRight"!==e.key&&"Tab"!==e.key||(o=o>=c.length?1:++o,u.childNodes[o].firstChild.focus()),"ArrowUp"!==e.key&&"ArrowLeft"!==e.key||(o=o<=1?c.length:--o,u.childNodes[o].firstChild.focus()),"Home"===e.key&&(o=1,u.childNodes[o].firstChild.focus()),"End"===e.key&&(o=c.length,u.childNodes[o].firstChild.focus()),"Enter"===e.key&&0<o&&c[o-1].action&&u.childNodes[o].firstChild.click()},N=function(e){e.preventDefault(),e.stopPropagation()},I=function(e){e.preventDefault(),e.stopPropagation()},L=function(e){e.stopPropagation(),c[e.target.menuItem].param?c[e.target.menuItem].action.call(c[e.target.menuItem].context,c[e.target.menuItem].param,v):c[e.target.menuItem].action.call(c[e.target.menuItem].context,v),T()};void 0!==e&&e.exports&&(e.exports=function(e,t){if(e.latlng.lat!==g||e.latlng.lng!==p)if(g=e.latlng.lat,p=e.latlng.lng,v=e,u)T();else{c=t;var o=document.getElementsByTagName("body")[0],n=h("./HTMLElementsFactory")(),r=n.create("div",{className:"TravelNotes-ContextMenu-Panel"},o),a=r.clientWidth,i=r.clientHeight;o.removeChild(r),(u=n.create("div",{id:"TravelNotes-ContextMenu-Container",className:"TravelNotes-ContextMenu-Container"},o)).addEventListener("mouseenter",function(){m&&(clearTimeout(m),m=null)},!1),u.addEventListener("mouseleave",function(){m=setTimeout(T,h("../L.TravelNotes").config.contextMenu.timeout)},!1),n.create("div",{innerHTML:"&#x274c",className:"TravelNotes-ContextMenu-CloseButton",title:h("./Translator")().getText("ContextMenu - Close")},u).addEventListener("click",T,!1);var s=0;c.forEach(function(e){var t=n.create("div",{className:"TravelNotes-ContextMenu-ItemContainer"},u),o=n.create("button",{innerHTML:e.name,id:"TravelNotes-ContextMenu-Item"+s,className:e.action?"TravelNotes-ContextMenu-Item":"TravelNotes-ContextMenu-Item TravelNotes-ContextMenu-ItemDisabled"},t);e.action&&o.addEventListener("click",L,!1),o.menuItem=s,++s});var l=Math.min(e.originalEvent.clientY,i-u.clientHeight-20),d=Math.min(e.originalEvent.clientX,a-u.clientWidth-20);u.setAttribute("style","top:"+l+"px;left:"+d+"px;"),document.addEventListener("keydown",f,!0),document.addEventListener("keypress",N,!0),document.addEventListener("keyup",I,!0)}else p=g=0})}()},{"../L.TravelNotes":7,"./HTMLElementsFactory":15,"./Translator":25}],12:[function(d,e,t){!function(){"use strict";var l=d("../L.TravelNotes");void 0!==e&&e.exports&&(e.exports=function(){var o=d("../core/MapEditor")(),n=d("../core/NoteEditor")(),r=d("../core/RouteEditor")(),a=d("../core/TravelEditor")(),i=d("../core/waypointEditor")(),s=d("../UI/Translator")();return Object.seal({getMapContextMenu:function(e){return t=e,[{context:i,name:s.getText("ContextMenuFactory - Select this point as start point"),action:-1!==l.routeEdition.routeInitialObjId&&0===l.editedRoute.wayPoints.first.lat?d("../core/waypointEditor")().setStartPoint:null,param:t},{context:i,name:s.getText("ContextMenuFactory - Select this point as way point"),action:-1!==l.routeEdition.routeInitialObjId?d("../core/waypointEditor")().addWayPoint:null,param:t},{context:i,name:s.getText("ContextMenuFactory - Select this point as end point"),action:-1!==l.routeEdition.routeInitialObjId&&0===l.editedRoute.wayPoints.last.lat?d("../core/waypointEditor")().setEndPoint:null,param:t},{context:n,name:s.getText("ContextMenuFactory - New travel note"),action:n.newTravelNote,param:t},{context:n,name:s.getText("ContextMenuFactory - Hide notes"),action:n.hideNotes},{context:n,name:s.getText("ContextMenuFactory - Show notes"),action:n.showNotes},{context:r,name:s.getText("ContextMenuFactory - Show all routes"),action:r.showRoutes},{context:o,name:s.getText("ContextMenuFactory - Zoom to travel"),action:o.zoomToTravel},{context:null,name:s.getText("ContextMenuFactory - About Travel & Notes"),action:d("../UI/AboutDialog")}];var t},getWayPointContextMenu:function(e){return t=e,[{context:i,name:s.getText("ContextMenuFactory - Delete this waypoint"),action:l.editedRoute.wayPoints.first.objId!==t&&l.editedRoute.wayPoints.last.objId!==t?d("../core/waypointEditor")().removeWayPoint:null,param:t}];var t},getRouteContextMenu:function(e){return t=e,[{context:r,name:s.getText("ContextMenuFactory - Edit this route"),action:l.routeEdition.routeInitialObjId===t||l.routeEdition.routeChanged?null:a.editRoute,param:t},{context:a,name:s.getText("ContextMenuFactory - Delete this route"),action:l.routeEdition.routeInitialObjId===t||l.routeEdition.routeChanged?null:a.removeRoute,param:t},{context:r,name:s.getText("ContextMenuFactory - Hide this route"),action:l.editedRoute.objId!==t?r.hideRoute:null,param:t},{context:i,name:s.getText("ContextMenuFactory - Add a waypoint on the route"),action:-1!==l.routeEdition.routeInitialObjId?i.addWayPointOnRoute:null,param:t},{context:n,name:s.getText("ContextMenuFactory - Add a note on the route"),action:n.newRouteNote,param:t},{context:r,name:s.getText("ContextMenuFactory - Properties"),action:r.routeProperties,param:t},{context:o,name:s.getText("ContextMenuFactory - Zoom to route"),action:o.zoomToRoute,param:t},{context:r,name:s.getText("ContextMenuFactory - Save modifications on this route"),action:l.editedRoute.objId===t?r.saveEdition:null},{context:r,name:s.getText("ContextMenuFactory - Cancel modifications on this route"),action:l.editedRoute.objId===t?r.cancelEdition:null}];var t},getNoteContextMenu:function(e){return function(e){var t=[];t.push({context:n,name:s.getText("ContextMenuFactory - Edit this note"),action:n.editNote,param:e}),t.push({context:n,name:s.getText("ContextMenuFactory - Delete this note"),action:n.removeNote,param:e}),t.push({context:n,name:s.getText("ContextMenuFactory - Zoom to note"),action:n.zoomToNote,param:e});var o=d("../data/DataSearchEngine")().getNoteAndRoute(e).route;return t.push({context:n,name:o?s.getText("ContextMenuFactory - Detach note from route"):s.getText("ContextMenuFactory - Attach note to route"),action:0!==l.travel.routes.length&&-1===l.routeEdition.routeInitialObjId?o?n.detachNoteFromRoute:n.attachNoteToRoute:null,param:e}),t}(e)}})})}()},{"../L.TravelNotes":7,"../UI/AboutDialog":8,"../UI/Translator":25,"../core/MapEditor":33,"../core/NoteEditor":34,"../core/RouteEditor":36,"../core/TravelEditor":39,"../core/waypointEditor":41,"../data/DataSearchEngine":44}],13:[function(d,e,t){!function(){"use strict";var r=-1,a=function(e){e.deltaY&&(e.target.scrollTop=e.target.scrollTop+10*e.deltaY),e.stopPropagation()},i=function(e){t().setItinerary()},s=function(e){t().setTravelNotes()},l=function(e){t().setSearch()},t=function(){var e=d("../UI/TravelNotesPaneUI")(),t=d("../UI/SearchPaneUI")(),o=d("../UI/ItineraryPaneUI")(),n=function(){switch(r){case 0:o.remove();break;case 1:e.remove();break;case 2:window.osmSearch&&t.remove()}};return Object.seal({createUI:function(e){!function(e){if(!document.getElementById("TravelNotes-Control-ItineraryDataDiv")){var t=d("../UI/HTMLElementsFactory")(),o=t.create("div",{id:"TravelNotes-Control-ItineraryHeaderDiv",className:"TravelNotes-Control-HeaderDiv"},e);t.create("div",{innerHTML:d("../UI/Translator")().getText("DataPanesUI - Itinerary"),id:"TravelNotes-Control-ItineraryPaneButton",className:"TravelNotes-Control-PaneButton"},o).addEventListener("click",i,!1),t.create("div",{innerHTML:d("../UI/Translator")().getText("DataPanesUI - Travel notes"),id:"TravelNotes-Control-TravelNotesPaneButton",className:"TravelNotes-Control-PaneButton"},o).addEventListener("click",s,!1),window.osmSearch&&t.create("div",{innerHTML:d("../UI/Translator")().getText("DataPanesUI - Search"),id:"TravelNotes-Control-SearchPaneButton",className:"TravelNotes-Control-PaneButton"},o).addEventListener("click",l,!1),t.create("div",{id:"TravelNotes-Control-ItineraryDataDiv",className:"TravelNotes-Control-DataDiv"},e).addEventListener("wheel",a,!1)}}(e)},setItinerary:function(){n(),o.add(),r=0},updateItinerary:function(){0===r&&(o.remove(),o.add())},setTravelNotes:function(){n(),e.add(),r=1},updateTravelNotes:function(){1===r&&(e.remove(),e.add())},setSearch:function(){n(),t.add(),r=2},updateSearch:function(){2===r&&(t.remove(),t.add())}})};void 0!==e&&e.exports&&(e.exports=t)}()},{"../UI/HTMLElementsFactory":15,"../UI/ItineraryPaneUI":18,"../UI/SearchPaneUI":23,"../UI/Translator":25,"../UI/TravelNotesPaneUI":27}],14:[function(i,e,t){!function(){"use strict";var o=null;void 0!==e&&e.exports&&(e.exports=function(){var r=i("./Translator")(),a=function(){document.getElementById("TravelNotes-Control-ErrorDataDiv").classList.add("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-ErrorMessageDiv").innerHTML=""};return{createUI:function(e){!function(e){if(!document.getElementById("TravelNotes-Control-ErrorDataDiv")){var t=i("./HTMLElementsFactory")(),o=t.create("div",{id:"TravelNotes-Control-ErrorDataDiv",className:"TravelNotes-Control-DataDiv TravelNotes-Control-HiddenList"},e),n=t.create("div",{id:"TravelNotes-Control-ErrorHeaderDiv",className:"TravelNotes-Control-HeaderDiv TravelNotes-Control-HiddenList"},o);t.create("span",{innerHTML:"&#x274c",title:r.getText("ErrorEditorUI - Hide"),id:"TravelNotes-Control-ErrorExpandButton",className:"TravelNotes-Control-HiddenList"},n).addEventListener("click",function(e){e.stopPropagation(),document.getElementById("TravelNotes-Control-ErrorMessageDiv").innerHTML.length&&a()},!1),t.create("div",{id:"TravelNotes-Control-ErrorMessageDiv"},o)}}(e)},set message(e){var t;t=e,o&&(clearTimeout(o),o=null),document.getElementById("TravelNotes-Control-ErrorMessageDiv").innerHTML=t,document.getElementById("TravelNotes-Control-ErrorDataDiv").classList.remove("TravelNotes-Control-HiddenList"),o=setTimeout(a,i("../L.TravelNotes").config.errorMessages.timeout)},get message(){return document.getElementById("TravelNotes-Control-ErrorDataDiv").innerHTML}}})}()},{"../L.TravelNotes":7,"./HTMLElementsFactory":15,"./Translator":25}],15:[function(e,t,o){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){return{create:function(e,t,o){var n;if(n="text"===e.toLowerCase()?document.createTextNode(""):document.createElement(e),o&&o.appendChild(n),t)for(var r in t)try{n[r]=t[r]}catch(e){console.log("Invalid property : "+r)}return n}}})}()},{}],16:[function(f,e,t){!function(){"use strict";var g=f("../UI/HTMLElementsFactory")(),d=f("../L.TravelNotes"),p=f("../UI/Translator")(),m=f("../util/Utilities")(),c=f("../core/NoteEditor")(),t=f("../core/RouteEditor")(),u=f("../L.TravelNotes").config.note.svgIconWidth,T="TravelNotes-Control-";void 0!==e&&e.exports&&(e.exports=function(){var v=function(e,t){var o=g.create("div",{className:T+"Travel-Notes-IconCell",innerHTML:e.iconContent},t);"svg"===o.firstChild.tagName&&"TravelNotes-Roadbook-"===T&&o.firstChild.setAttributeNS(null,"viewBox","0 0 "+u+" "+u),g.create("div",{className:T+"Travel-Notes-Cell",innerHTML:c.getNoteHTML(e,T)},t),t.noteObjId=e.objId},n=function(){var e=g.create("div",{className:T+"Travel-Header"});g.create("div",{className:T+"Travel-Header-Name",innerHTML:d.travel.name},e);for(var t=0,o=d.travel.routes.iterator;!o.done;)g.create("div",{className:T+"Travel-Header-RouteName",innerHTML:'<a href="#route'+o.value.objId+'">'+o.value.name+"</a>&nbsp;:&nbsp;"+m.formatDistance(o.value.distance)+"."},e),o.value.chain&&(t+=o.value.distance);return g.create("div",{className:T+"Travel-Header-TravelDistance",innerHTML:p.getText("HTMLViewsFactory - Travel distance&nbsp;:&nbsp;{distance}",{distance:m.formatDistance(t)})},e),e},r=function(){for(var e=g.create("div",{className:T+"Travel-Notes"}),t=d.travel.notes.iterator;!t.done;){var o=g.create("div",{className:T+"Travel-Notes-Row"},e);v(t.value,o)}return e},a=function(e){return g.create("div",{className:T+"Route-Header",id:"route"+e.objId,innerHTML:t.getRouteHTML(e,T)})},i=function(e){for(var t=g.create("div",{className:T+"Route-ManeuversAndNotes"}),o=e.notes.iterator,n=o.done,r=n?Number.MAX_VALUE:o.value.distance,a=r,i=e.itinerary.maneuvers.iterator,s=i.done,l=0;!s||!n;){var d=g.create("div",{className:T+"Route-ManeuversAndNotes-Row"},t);if(l<=r){if(!s){d.className=T+"Route-Maneuvers-Row",g.create("div",{className:T+"Route-ManeuversAndNotes-IconCell TravelNotes-ManeuverNote-"+i.value.iconName},d);var c="<div>"+i.value.instruction+"</div>";0<i.value.distance&&(c+="<div>"+p.getText("HTMLViewsFactory - To next instruction&nbsp;:&nbsp;{distance}&nbsp;-&nbsp;{duration}",{distance:m.formatDistance(i.value.distance),duration:m.formatTime(i.value.duration)})+"</div>"),g.create("div",{className:T+"Route-ManeuversAndNotes-Cell",innerHTML:c},d),d.objId=f("../data/ObjId")(),d.latLng=e.itinerary.itineraryPoints.getAt(i.value.itineraryPointObjId).latLng,d.maneuverObjId=i.value.objId,l+=i.value.distance,(s=i.done)&&(l=Number.MAX_VALUE)}}else if(!n&&(d.className=T+"Route-Notes-Row",v(o.value,d),d.objId=f("../data/ObjId")(),d.latLng=o.value.latLng,d.noteObjId=o.value.objId,a=o.value.distance,r=(n=o.done)?Number.MAX_VALUE:o.value.distance,!n)){var u=o.value.distance-a;2<u&&g.create("div",{className:T+"NoteHtml-NextDistance",innerHTML:p.getText("HTMLViewsFactory - Next distance&nbsp;:&nbsp;{distance}",{distance:m.formatDistance(u)})},d.lastChild)}}return t},s=function(e){var t="";return""!==e.itinerary.provider&&""!==e.itinerary.transitMode&&(t=p.getText("HTMLViewsFactory - Itinerary computed by {provider} and optimized for {transitMode}",{provider:e.itinerary.provider,transitMode:p.getText("HTMLViewsFactory - TransitMode "+e.itinerary.transitMode)})),g.create("div",{className:T+"RouteFooter",innerHTML:t})},l=function(){return g.create("div",{className:T+"TravelFooter",innerHTML:p.getText("HTMLViewsFactory - Travel footer")})};return{set classNamePrefix(e){T=e},get classNamePrefix(){return T},get travelHeaderHTML(){return n()},get travelNotesHTML(){return r()},get routeHeaderHTML(){return a(d.editedRoute)},get routeManeuversAndNotesHTML(){return i(d.editedRoute)},get routeFooterHTML(){return s(d.editedRoute)},get travelFooterHTML(){return l()},get travelHTML(){return function(){var e=g.create("div",{className:T+"Travel"});e.appendChild(n()),e.appendChild(r());for(var t=d.travel.routes.iterator;!t.done;){var o=d.config.routeEditor.displayEditionInHTMLPage&&t.value.objId===d.routeEdition.routeInitialObjId;e.appendChild(a(o?d.editedRoute:t.value)),e.appendChild(i(o?d.editedRoute:t.value)),e.appendChild(s(o?d.editedRoute:t.value))}return e.appendChild(l()),e}()}}})}()},{"../L.TravelNotes":7,"../UI/HTMLElementsFactory":15,"../UI/Translator":25,"../core/NoteEditor":34,"../core/RouteEditor":36,"../data/ObjId":49,"../util/Utilities":57}],17:[function(e,t,o){arguments[4][15][0].apply(o,arguments)},{dup:15}],18:[function(c,e,t){!function(){"use strict";var i=function(e){e.stopPropagation();for(var t=e.target;!t.latLng;)t=t.parentNode;c("../core/MapEditor")().zoomToPoint(t.latLng)},s=function(e){e.stopPropagation(),e.preventDefault();for(var t=e.target;!t.latLng;)t=t.parentNode;t.maneuverObjId?c("../core/NoteEditor")().newManeuverNote(t.maneuverObjId,t.latLng):t.noteObjId&&c("../core/NoteEditor")().editNote(t.noteObjId)},l=function(e){e.stopPropagation(),c("../core/MapEditor")().addItineraryPointMarker(e.target.objId,e.target.latLng)},d=function(e){e.stopPropagation(),c("../core/MapEditor")().removeObject(e.target.objId)};void 0!==e&&e.exports&&(e.exports=function(){return Object.seal({remove:function(){!function(){var e=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(e){var t,o,n,r=document.getElementsByClassName("TravelNotes-Control-Route-Header")[0];r&&e.removeChild(r);var a=document.getElementsByClassName("TravelNotes-Control-Route-ManeuversAndNotes")[0];if(a){for(o=a.childNodes,t=0;t<o.length;t++)(n=o[t]).removeEventListener("click",i,!1),n.removeEventListener("contextmenu",s,!1),n.removeEventListener("mouseenter",l,!1),n.removeEventListener("mouseleave",d,!1);e.removeChild(a)}}}()},add:function(){!function(){document.getElementById("TravelNotes-Control-ItineraryPaneButton").classList.add("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-TravelNotesPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),window.osmSearch&&document.getElementById("TravelNotes-Control-SearchPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton");var e=c("../UI/HTMLViewsFactory")();e.classNamePrefix="TravelNotes-Control-";var t=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(t){var o,n,r;t.appendChild(e.routeHeaderHTML),t.appendChild(e.routeManeuversAndNotesHTML);var a=document.getElementsByClassName("TravelNotes-Control-Route-ManeuversAndNotes")[0];if(a)for(n=a.childNodes,o=0;o<n.length;o++)(r=n[o]).addEventListener("click",i,!1),r.addEventListener("contextmenu",s,!1),r.addEventListener("mouseenter",l,!1),r.addEventListener("mouseleave",d,!1)}}()}})})}()},{"../UI/HTMLViewsFactory":16,"../core/MapEditor":33,"../core/NoteEditor":34}],19:[function(w,e,t){!function(){"use strict";var x,M,R=w("../UI/Translator")(),j={editionButtons:[],preDefinedIconsList:[]},A={editionButtons:[],preDefinedIconsList:[]},B={editionButtons:[],preDefinedIconsList:[]},P=function(){return 0===document.getElementById("TravelNotes-NoteDialog-TextArea-IconHtmlContent").value.length?(document.getElementById("TravelNotes-BaseDialog-ErrorDiv").innerHTML=R.getText("Notedialog - The icon content cannot be empty"),document.getElementById("TravelNotes-BaseDialog-ErrorDiv").classList.remove("TravelNotes-BaseDialog-ErrorDivHidden"),!1):(x.iconWidth=document.getElementById("TravelNotes-NoteDialog-WidthNumberInput").value,x.iconHeight=document.getElementById("TravelNotes-NoteDialog-HeightNumberInput").value,x.iconContent=document.getElementById("TravelNotes-NoteDialog-TextArea-IconHtmlContent").value,x.popupContent=document.getElementById("TravelNotes-NoteDialog-TextArea-PopupContent").value,x.tooltipContent=document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value,x.address=document.getElementById("TravelNotes-NoteDialog-InputText-Adress").value,x.url=document.getElementById("TravelNotes-NoteDialog-InputText-Link").value,x.phone=document.getElementById("TravelNotes-NoteDialog-InputText-Phone").value,w("../core/NoteEditor")().afterNoteDialog(x,M),!0)};void 0!==e&&e.exports&&(e.exports=function(t,o,e){var n=function(){B.preDefinedIconsList=A.preDefinedIconsList.concat(j.preDefinedIconsList),B.preDefinedIconsList.sort(function(e,t){return e.name.localeCompare(t.name)});var e=0;for(e=c.length-1;0<=e;e--)c.remove(e);for(e=0;e<B.preDefinedIconsList.length;e++){var t=s.create("option",{text:B.preDefinedIconsList[e].name});c.add(t)}},r=function(e){e.forEach(function(e){s.create("button",{type:"button",innerHTML:e.title||"?",htmlBefore:e.htmlBefore||"",htmlAfter:e.htmlAfter||"",className:"TravelNotes-NoteDialog-EditorButton"},d).addEventListener("click",a,!1)})},a=function(e){if(u){for(var t=e.target;!t.htmlBefore;)t=t.parentNode;var o=t.htmlAfter&&0<t.htmlAfter.length,n=u.selectionStart,r=u.selectionEnd,a=u.value;u.value=a.substring(0,n)+(o?t.htmlBefore+a.substring(n,r)+t.htmlAfter:t.htmlBefore)+a.substring(r),u.setSelectionRange(o||n===r?n+t.htmlBefore.length:n,(o?r:n)+t.htmlBefore.length),u.focus()}};x=t,M=o;var i=w("../UI/BaseDialog")();i.title=R.getText("NoteDialog - Note"),i.addClickOkButtonEventListener(P);var s=w("./HTMLElementsFactory")(),l=s.create("div",{id:"TravelNotes-NoteDialog-MainDataDiv"},i.content),d=s.create("div",{className:"TravelNotes-NoteDialog-ToolbarDiv",id:"TravelNotes-NoteDialog-ToolbarDiv"},l),c=s.create("select",{className:"TravelNotes-NoteDialog-Select",id:"TravelNotes-NoteDialog-IconSelect"},d);c.addEventListener("change",function(e){c.selectedIndex;var t=B.preDefinedIconsList[c.selectedIndex];T.value=t.width,f.value=t.height,L.value=t.icon,E.value=t.tooltip},!1);var u=null,v=s.create("div",{id:"TravelNotes-NoteDialog-OpenEditorFileDiv"},d),g=s.create("input",{id:"TravelNotes-NoteDialog-OpenEditorFileInput",type:"file",accept:".json"},v);g.addEventListener("change",function(e){var o=new FileReader;o.onload=function(e){try{var t=JSON.parse(o.result);j.editionButtons=j.editionButtons.concat(t.editionButtons),j.preDefinedIconsList=j.preDefinedIconsList.concat(t.preDefinedIconsList),r(t.editionButtons),n()}catch(e){}},e.target.files[0].name,o.readAsText(e.target.files[0])},!1);var p=s.create("div",{id:"TravelNotes-NoteDialog-OpenStyleFakeDiv"},v);s.create("button",{id:"TravelNotes-NoteDialog-OpenEditorFileButton",className:"TravelNotes-NoteDialog-EditorButton",title:R.getText("NoteDialog - Open a configuration file"),innerHTML:"&#x23CD;"},p).addEventListener("click",function(){g.click()},!1),r([{title:"div",htmlBefore:"<div>",htmlAfter:"</div>"},{title:"p",htmlBefore:"<p>",htmlAfter:"</p>"},{title:"span",htmlBefore:"<span>",htmlAfter:"</span>"},{title:"a",htmlBefore:'<a target="_blank" href="">',htmlAfter:"</a>"}]),r(A.editionButtons),r(j.editionButtons),n();var m=s.create("div",{className:"TravelNotes-NoteDialog-DataDiv",id:"TravelNotes-NoteDialog-DimensionsDataDiv"},l);s.create("text",{data:R.getText("NoteDialog - Icon width")},m);var T=s.create("input",{type:"number",className:"TravelNotes-NoteDialog-NumberInput",id:"TravelNotes-NoteDialog-WidthNumberInput"},m);T.value=t.iconWidth,s.create("text",{data:R.getText("NoteDialog - Icon height")},m);var f=s.create("input",{type:"number",className:"TravelNotes-NoteDialog-NumberInput",id:"TravelNotes-NoteDialog-HeightNumberInput"},m);if(f.value=t.iconHeight,console.log("_RouteObjId = "+M),-1<M){var N=function(e){document.getElementById("TravelNotes-NoteDialog-TextArea-IconHtmlContent").value=e.svg,null!==e.direction&&(e.direction<35?document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=R.getText("NoteDialog - Turn right"):e.direction<80?document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=R.getText("NoteDialog - Turn slight right"):e.direction<100?document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=R.getText("NoteDialog - Continue"):e.direction<145?document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=R.getText("NoteDialog - Turn slight left"):e.direction<200?document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=R.getText("NoteDialog - Turn left"):e.direction<270?document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=R.getText("NoteDialog - Turn sharp left"):e.direction<340?document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=R.getText("NoteDialog - Turn sharp right"):document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=R.getText("NoteDialog - Turn right"))};s.create("text",{data:R.getText("NoteDialog - SVG icon from OSM")},m);var I=s.create("input",{type:"checkbox",className:"TravelNotes-NoteDialog-CheckboxInput",id:"TravelNotes-NoteDialog-SvgIconFromOsmInput"},m);I.addEventListener("change",function(e){I.checked&&w("../core/SvgIconFromOsmFactory")().getSvgIcon(t.latLng,o,N)},!1)}s.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",id:"TravelNotes-NoteDialog-IconContentTitleDiv",innerHTML:R.getText("NoteDialog - Icon content")},l);var L=s.create("textarea",{className:"TravelNotes-NoteDialog-TextArea",id:"TravelNotes-NoteDialog-TextArea-IconHtmlContent"},l);L.addEventListener("focus",function(e){u=L},!1),L.value=t.iconContent,s.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:R.getText("NoteDialog - Text")},l);var h=s.create("textarea",{className:"TravelNotes-NoteDialog-TextArea",id:"TravelNotes-NoteDialog-TextArea-PopupContent"},l);h.addEventListener("focus",function(e){u=h},!1),h.value=t.popupContent,s.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:R.getText("NoteDialog - Tooltip content")},l);var E=s.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Tooltip"},l);E.addEventListener("focus",function(e){u=E},!1),E.value=t.tooltipContent,s.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:"<span id='TravelNotes-NoteDialog-Reset-Address-Button'>&#x1f504;</span>&nbsp;"+R.getText("NoteDialog - Address&nbsp;:")},l),document.getElementById("TravelNotes-NoteDialog-Reset-Address-Button").addEventListener("click",function(){w("../core/GeoCoder")().getAddress(t.lat,t.lng,function(e){y.value=e})},!1);var y=s.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Adress"},l);y.addEventListener("focus",function(e){u=y},!1),y.value=t.address,s.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:R.getText("NoteDialog - Link")},l);var b=s.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Link"},l);b.addEventListener("focus",function(e){u=null},!1),b.value=t.url,s.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:R.getText("NoteDialog - Phone")},l);var C=s.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Phone"},l);if(C.addEventListener("focus",function(e){u=C},!1),C.value=t.phone,0===A.preDefinedIconsList.length){var D=new XMLHttpRequest;D.onreadystatechange=function(e){if(this.readyState===D.DONE)if(200===this.status)try{A=JSON.parse(this.responseText),r(A.editionButtons),A.preDefinedIconsList.push({name:"",icon:"",tooltip:"",width:40,height:40}),n()}catch(e){console.log("Error reading TravelNotesNoteDialog.json")}else console.log("Error sending request for TravelNotesNoteDialog.json")},D.open("GET",window.location.href.substr(0,window.location.href.lastIndexOf("/")+1)+"TravelNotesNoteDialog.json",!0),D.send(null)}w("../L.TravelNotes").config.note.reverseGeocoding&&""===t.address&&e&&w("../core/GeoCoder")().getAddress(t.lat,t.lng,function(e){y.value=e}),i.center()})}()},{"../L.TravelNotes":7,"../UI/BaseDialog":9,"../UI/Translator":25,"../core/GeoCoder":32,"../core/NoteEditor":34,"../core/SvgIconFromOsmFactory":38,"./HTMLElementsFactory":15}],20:[function(g,e,t){!function(){"use strict";var c=g("../L.TravelNotes"),u=function(e){e.stopPropagation(),c.routing.provider=e.target.provider,document.getElementsByClassName("TravelNotes-Control-ActiveProviderImgButton")[0].classList.remove("TravelNotes-Control-ActiveProviderImgButton"),e.target.classList.add("TravelNotes-Control-ActiveProviderImgButton");var t=c.providers.get(e.target.provider);t.transitModes.car?document.getElementById("TravelNotes-Control-carImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-carImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),t.transitModes.bike?document.getElementById("TravelNotes-Control-bikeImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-bikeImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),t.transitModes.pedestrian?document.getElementById("TravelNotes-Control-pedestrianImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-pedestrianImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),t.transitModes.train?document.getElementById("TravelNotes-Control-trainImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-trainImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),c.providers.get(e.target.provider).transitModes[c.routing.transitMode]||(t.transitModes.bike?document.getElementById("TravelNotes-Control-bikeImgButton").click():t.transitModes.pedestrian?document.getElementById("TravelNotes-Control-pedestrianImgButton").click():t.transitModes.car?document.getElementById("TravelNotes-Control-carImgButton").click():t.transitModes.train&&document.getElementById("TravelNotes-Control-trainImgButton").click()),g("../core/RouteEditor")().startRouting()},v=function(e){e.stopPropagation(),c.routing.transitMode=e.target.transitMode,document.getElementsByClassName("TravelNotes-Control-ActiveTransitModeImgButton")[0].classList.remove("TravelNotes-Control-ActiveTransitModeImgButton"),e.target.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),g("../core/RouteEditor")().startRouting()};void 0!==e&&e.exports&&(e.exports=function(){var o=null,n=g("../UI/HtmlElementsFactory")(),r=!1,a=null,i=null,s=null,l=null,t=function(e){var t=n.create("img",{src:"data:image/png;base64,"+e.icon,id:"TravelNotes-Control-"+e.name+"ImgButton",className:"TravelNotes-Control-ImgButton",title:e.name},o);t.provider=e.name.toLowerCase(),t.addEventListener("click",u,!1),r||(t.classList.add("TravelNotes-Control-ActiveProviderImgButton"),c.routing.provider=t.provider,r=!0,e.transitModes.bike?(a.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),c.routing.transitMode="bike"):e.transitModes.pedestrian?(i.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),c.routing.transitMode="pedestrian"):e.transitModes.car?(s.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),c.routing.transitMode="car"):e.transitModes.train&&(l.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),c.routing.transitMode="train"),e.transitModes.car||s.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),e.transitModes.pedestrian||i.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),e.transitModes.bike||a.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),e.transitModes.train||l.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"))},d=function(e){o=n.create("div",{id:"TravelNotes-Control-ItineraryButtonsDiv",className:"TravelNotes-Control-ButtonsDiv"},e),(a=n.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AoaESkaC0SxrgAABMdJREFUSMfNl1loVGcYhp//n+WcZmbiJE4WjVKVaLWOGxglilFTSmYUF1ILKiIILSjplQiKS65EXG4UvBGrQvVCUAdjoRrEGmtwjQbtWKlpEsTGGDMxkzKTzHr+XiRucbK4ts/lOd/5X853vuU9gj4YN+48Dx58DUBOzrmhnZ0qXykWJBKqKJlkYjyusgAsFtFqMnHPbBa/CcEvaWnir5YWT1vvM3ojUl2cPv1XamqK8fv/MBcWPtwfDhuLlWKYUvSLECAEzTabPHP16uc/uN1fJp6fNShhpRROZ+WSzk7jVDyuTLwDFotIpqXJb4LBkgohRP/Cbvc5/H6krhsnolFVOtAbDoQQoGnCF4nIb91uDL/f8+KefDXQ70e6XOpIJPL+ot2Zg0hElbpc6ojf/7qWBPB6q1FKoevqRCBgrOYDEwgYq3VdnVBK4fVWd2cjL6+SpqYSnM5zi4PBZAUfEafTtCQY9JzJy6tENjWVsH79ZWs4bJziIxMOG6fWr79sbWoq6S4uTTt7MBo1vuMToGnyx2jU+71ITz/rCoWM3w2D3AFKBUj0NIL5nYWl5IndLidJw2CsUgOJwtSp6SQSC7h5czZO50vhIUPMTJrkYMIEO8OHa4Op9FzDYKyUEs9gWqelJUpbm8GcOdcJBmOAARjEYgZFRUOoqZnNyJGDEkZKPOZIRM0bTIricUU8blBePhaQKAXJZBzDUMyYkcnly21cvx7sPRpSEomoeWZgQv9hSUAxYoSD8+efsmdPIxkZVgBMJrDZTKxdO4YLF56Sm/sZT5509jzX76SdYI7FurdMKoqKMti8eQyZmVakFOTkaGzaFGP79gZCoSSaJpk82UFl5VN2727k+PEpxGIGHR0Jdu5s4Natf1KeG4uprD7Lc86cDPbuHc/y5Xd4/DhKa+tXNDZ2cfJkC9euFXLw4EMMA6ZNG8KOHfUcPjyZKVPSWbnyNg0NEXy+aaxadYcbN1KLS6tVtKZK75YtY1ix4i51dZ0sWpTF3bshurqSZGdruN3VLFyYS3HxUEKhJAsXZpGbq1Faeovt28dz716IpUtvs21bfs+neh2rVbSagftAVu+edTotdHUl0XVJdraV+fOvcejQJPLzbSj1lHXr/GiapL09gc83lWg0ycyZDk6ffozNZiIUSpKdbe3p/ze4LzVNVKVIBJcuteHxuOjqSrJvXyNpaSaKi134fM2AoL6+C6/Xxf79X7Bx45/Y7RZ27XpIeXkdoVCcuXMzuXIldZVrmqgSdvvZwnDYuNK7l9PTzVRVzUAIQV1dmLlzh7Jhw32OHm16ZY0r8vPTSCQUXm8WW7fmc/p0C263g5wcK7NmXePZs/gbO9pmk7MGGJkJvN5cRo9O4+efW3j0KNKXaQEMJk50sGzZMOrrwxw79nfKlno+MgexJFR/Lumt458vCQlQVmYvs1hEgj79oHiLNdB3vMUiEmVl9rL/3gh4vdW0t5ec0XXp+1iiui597e0lZ7zeal4YgZecky6XOvKhfZfLJX8KBMQa8BgpXabbjREIiDW6LnxCvL+gEKDrwhcIiDVuN8b/wtCnXJ4FBRfp6PBU1NaO0h0OeUBKmgeTASFASpodDnmgtnaU3tHhqSgouDj4f6dP8dP2L6C7Ld6Z4dDBAAAAAElFTkSuQmCC",id:"TravelNotes-Control-bikeImgButton",className:"TravelNotes-Control-ImgButton"},o)).transitMode="bike",a.addEventListener("click",v,!1),(i=n.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AoaESo7bADyMwAABNlJREFUSMe1V19oU1cY/52Te5Ob3DR/SfzTNNCufxRXxmarONCnPbi+ykYrFdRSkeJLX5ykZcKcFfG5oIJ2Y2sVFZQ+iPoiUhC128OIiJrUlgQTm9o0t23SJufmnj2k2ura5syx7ynknu/7nd93vr8E6wghBJxzAEAgAEsmc3pToWD1y3L6M8NQfABA6eIUY54xs3kh5Xb3JONx5D/WXdX2Wh9crkPIZAbAOVBRcbpvYaHuO87lDZyTCs7lFaochDAQwucANmmzRa7PzfWECFm2IQTsdrdiZuYqHI5quVg80J7P113WdR+AIsTEBEmagsUSOayq539PpVLM5WpFJnO1POOtW+GMRH4dKRa9jZxTABz/TggIMSDLU+Fg8NDuaBTaxyfoux8ORxsAwG7vrI5Ehl7pur+Rc/IJoCX3c05QKGxsnJgYemW3d1avxPgH42AQzkRi6JWuOz3ljReX7k3KnpQkLb158/6aWGyZOS0F0kF4vX45mRwY0XV3WdCGBhsePvwa3d1BAEZZYF13e5LJgRGv1y87nQdLjCmlMAwDqvrj4Wx2x6XyDAw8eLADe/b4AQCqehu5nJj7bbYnHbncT5cppaCGYYBzIJ+vu7TiydcNnP7+GBKJRQwPJ5HL6YLvTlEo1F3iHDAMo4Rkt5/qK6UMFwK+du0NurvDePt2EQ0NdkE9Dl33wW4/1QcApKoKltevrz01DLVWNGKbmhwYHd1dCrEiR0vLY9y7Ny0UaJRmo5WV339OZ2b6NgGyXzRRVFXC4OCXKwwBd+/uRH//VkHmsn9mpm8TZUzxcU4comzb2zciEFCg6yWQZ8/mcOJEGF1dNaivV8tb4MTBmOKjkpSuLdXe8lJZacb5819g374/QEiphJpMBGfPvlxiTwSAZUjSdC0tdZnyCiYTwfBwMx49SuPOnSkA7P3/7/QZM4SC0zCsPkn0bX0+GU+eTCMUGgNAcO7cGEwmCbOzFITI2Lv3ESYmFsWruar2tmWzu4bEjhtLxY4jn/8G2ayByck8mpsfY36+CPEAfbif6ronSggTLgKAgQsXtmF+nuLIkTC2bHGhpcUj3EwIYdB1b5TK8uIUIXxW9LbBoBXt7VW4ciWOGzeSuHnzNQYHvxJ3MeGzZvPiFHW7Q0mApcTUiujtrYHVChw79hyAjOPHX6JYJLh4cZtQwyCEpVyuUJLG48hbrS+uA6aySvX1Kjo7q9HV9fS9a6PRHG7dSqCtLYBAwFp2OlGUF9fjceRJKbcAWf6N67p3zbciBBgZ2Ym6OjsaGh4gk1luDmYzQT7/LUKhZzhzZnyN0kkgSdNg7AAhBKCUUhACWCyRjvVc1dxcgV273Dh58jkymQ+DsVAwcPToX1AUsm5GmM2RjiXQ0tVcroMAbsvZ7Nk/GdvYuNoF/H4ZGzZYEA7PrcpIUSgoBXI5Y9VskOU3Yafzh+2MtTBN++W/jD7iIklauqpqf834+Eejz7tBLBaDpij3myRJS4sNBeXzXpK0tKLcbxofh+Z0tq0/3tbWwhmLDYww5vv/x9vlDaIV0Sg0jye03WYbPSxJ0xBJtQ8H+mlus412eDwntkej0Fyu1k9dYX7uW1ioX3OFoZQB4HOEsEmr9RNXmLWWtspKWDRt9aVN1z1jsryQcjh6komE2NL2N0SHF0QJfjNNAAAAAElFTkSuQmCC",id:"TravelNotes-Control-pedestrianImgButton",className:"TravelNotes-Control-ImgButton"},o)).transitMode="pedestrian",i.addEventListener("click",v,!1),(s=n.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AoaESgBmDpJAwAABQBJREFUSMe9V09MFFcY/703szOz7PLP2WVBV6rtdm21HqhG2wiCh8bL2jWhsl71IhqJJ4oHL4RIxKP1HzESLh4MEGPkoAeNYRWtGkPShGRF+aeFld2psd0BZnZmXg+LW4SdrW3EX/Iub775fe/7977vEdigrCyMmZnrAABZbvGoavkGSh0hy3LtNAzuS57nZAAwTVPhOHOEUnXAstL9Ltd0TFFOJ5dyLAXJtSnLMhRFwaNHoDt3nj2v66vDjHHljDkAsIXf2CKKzB4haRBixgVh6vrAwNEj27bB8ng8SCaTH6aYMcDtPh3StM/6DKNIACz8N1Dw/J+6KI7Xp1It/YTkkliEwsJmnD8PIopdvbOzX90wDPf/UAoAFgzDLczOfn1Dkrp6T5wAKSpqtre4tRXk5MkLV3W9ch8+IgRhsqel5XCkrS0bn4xiWZaRTCqQpK5eTfPVYwUgiq/75ucP/uT1ZmJOvd4wFEWBy9UR0nXPiigFAF331LtcHaFkMomysnDG4mgUdNeuq3OZmK4ceD6lP34ccVZVwSIZN5y9qGlfHLJPJAa/X4LbzeUlnp21MDk5Z1csAChE8XmnpjU1Eln+2fPmzXe/WZZYbkcoyxympn6AaaahKCrIkvpgjKGkpACSJCAQuI2JibR9oVEtXlz862ZeVSs2MMaV57NkzRoHBIFi06aHGB5+m/XC4sIIBAoxMrILfr+YVzFjXPncXPkGSikfytxIeapyIQKHDlUAAIJBN3p7t+Lata0IBt0AGBobVy/IsrxcjDlACL+Htyx3zT+nz3GnEqCyUkJ39wSOHYvh7t1vUVvrz37fu3cNotHfUVs7BElywO+XAKj5VIMxdw01TS5onwwWHjzYjp6ebaiokFBdXYJUSl8mNT9voq6uBH6/hO7uLXjy5HtQamsKTJMLUo7j5NwWMxw44Mf27TIKCnjs3u1DNFqDVGq5bDJp4M6dHQiHV6OggMeWLaU4enQt7Hg5jltF88WjqIjPNo13aGj4fJnc/v3r32swAFBcnD9vqGmaSm5XE5w58xINDYMgBKiru4ebN+NIpxlGR1WMjWXW6KgKTbMwOKigunoAhACHDz/CqVNjsOM1TVPhBOHHsGG4KnOfK41z577BunWFcDgscByDzyfh9u04Xr5UMTmZWT6fhFevVAQCBaiqKkVpKYfLl6fzNI3UEE9pKgr4duSOB0EqZQAAVNXAyIiKp0/fgudJ1qWEAJcujYEQAll2LMiaiwaG5ZyEpKK8ZRn9hKSPM8bnul3R1TWJUGgtLlyYwtDQX3njtn69E01NQVy58gqMEZvyTIMxo586ndMxQsy4Hdn4eBr37ycwPj6/YIH9mprScO9eAs+eaXnuBTPudE7HFprELxc1LZCnSVhLh5W804e9LIUgPO/U9aZGAgDDw6CbN1+dM82VbYscl9JjsYgzEIBFy8rC2LgRlihO1BNirphSQkyI4nh9IAArOwh4vV7MzCQ+7egDAIlEAoQAra0H9wnCRM/HVioIEz2trQf3EYLsjP1eFrS3N7Pjx49ERPF138dwe8a9r/va2o5E2tub2QcO9B0hTVv3aQb6d/B4ZKhqS/+tWxGnJL3opFSLE2IsOifJcXYCQgxQqsUl6UXn4GDEqaot/V6v58PfTpmECyORWPpo4/dYlrvGMLggz3OrFh5tf1BqPuO4VNSyjBsuVzymKB3/+mj7G1dPIltjqpC6AAAAAElFTkSuQmCC",id:"TravelNotes-Control-carImgButton",className:"TravelNotes-Control-ImgButton"},o)).transitMode="car",s.addEventListener("click",v,!1),(l=n.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4goTCiEjvCsRvgAABXRJREFUSMe9V11MFFcU/u7MsDPLrgvu7A80BEhLsRIxEFIlcSXBF41BN2ExqC8kPHQraV80iA+GhKAYaLUihkLaaErig1FCiCZq2kQDjS0YfcGYQKtBg7DL7hbFHdaZnTu3D0tR7C7aRvxeJrn3zP3O3z3nXIIUcLm8mJ0dBADIcpNDUbLWcVxalWFYKnSd/1QQeBkAKKURnqd/cJwyZBjxqxbLzHgk0hF+84w3QZItyrKMSCSC0VFwFRVnuzXtIy9jfBZjaQDY4m/stSMSa4TEQQgNmEzTg0NDXzVs2gTD4XAgHA6/GzFjgNXaUaWqef26bjMBBv4bOAjCvCaKk75otOkqIckkXsOaNY3o7gYRxXOXFxY+u6Lr1v9BCgAGdN1qWlhYf0WSzl0+ehTEZmtMbXFLC8jx499f1LTcPXiPMJmeXGpqOlDb2roUnwSxLMsIhyOQpHOXVdXtwypAFIP9L1/W1zidiZhzTqcXkUgEFkt7laY5VoUUADTN4bNY2qvC4TBcLm/C4uFhcJWVF2OJmK4eBCGq3blTay4thUESbjjbo6qf+JMlks3GYX7egNfrgtv9A+bn55Geng673Y7du3eD0iL4/ffx6JECm03A3JwOxlJnuyj+2auqX3/Jy/Jhh6Ks72SMtyZPDAJNY9i40Yq+vi9QU1OD6elp5OXlIRgMorp6C4qL14BSBkWhCAY1CAJgJL0MDIyl52Rm5v8kKEr2Osb4rJQXw0iob7ebMDIygvLy8qW9/Px89PT0oKSkBGfOfItTpwK4fz8KWU5DMBhH8hrBZ8ViWes4jhOqEhUpORwOEW63Cdu2CSgvL8fY2BgYY2CMobOzEzt27IDD4UBnZydevEi42WYTUp7HWBoIEXYJhmHd+qr8/Rvd3RuQns5j374NOH/+PLKzs9HX1wdCCOx2O+rq6pCTkwNN00AIQSCgYnx8AUAsFTUYs24VKOULl9fe5XjyJIbm5s9x4sQJlJSUwO12g1KaUtHe3l7k5lbg3r35FBIElPKFHM/z8koWHzu2BUNDQ7h27RpKS0tXJAUAv9+Pykr7ChIMPM/bhbfdPb/fj4GBAfT39y+tud1ubN68GRkZGQiFQpiamsKzZ8+gKApisRhGR/sAFK18pymlEYA4U1lNKUVlZSUuXLiA7du3w25fbg1J0nri8Tiam39ewdU0IvA8nYjHmTOVZnv37kVhYSE8Hg/YYmX45zs5OYmZmRmUlZVBkqTF0qhB1/W3uJpOcBwXHU7RlgEA1dXV4HkegiDgwIEGdHR8A13XQQjBxMQEPB4P2tvbl+T379+PgwcPrUBMQEh0mEjSd1tU9eNfGUse7p07HcjOlvD0aRPMZjMGBgaW9nw+HyoqKqAoCjRNA6UUU1NTuH79OmZmfkxOS3SI4iMPWbv2sOP58/IxwxBTVi9CgPr6HITDzXC5XJAkCV1dXSltOnToF5w8qSav1pwayMj4vViYm+sIi2LXoKoWJG0SZjOBIHAoK7OB484gM/M31NXV4e7du7h5U0Ju7gzM5hhu3bqFkZEReDzHcfr0wgoj0dPBubmOMAGABw/AFRdfjFG6um2R56Pa+HituaAABudyeVFUBEMUH/sIoatGSgiFKE76CgpgLA0CTqcTs7OhDzv6AEAoFAIhQEtL/R6T6fGl901qMj2+1NJSv4cQLM3Yy8bbtrZGduRIQ60oBvvfh9sT7g32t7Y21La1NbJ3HOjbq1Q1/8MM9K+avwxFabp640atWZIe9nKcGiBEf01PkkR3AkJ0cJwakKSHvbdv15oVpemq0+l497dTIuG8CIXefLQJuwzDulXX+UJB4O2LTeQvjqMTPB8dNgz9isUSGI9E2t/6aPsbwfNWty4y/a8AAAAASUVORK5CYII=",id:"TravelNotes-Control-trainImgButton",className:"TravelNotes-Control-ImgButton"},o)).transitMode="train",l.addEventListener("click",v,!1),c.providers&&(r=!1,c.providers.forEach(t))};return Object.seal({createUI:function(e){d(e)},get provider(){return c.routing.provider},set provider(e){var t,o;t=e,(o=document.getElementById("TravelNotes-Control-"+t+"ImgButton"))&&o.click()},get transitMode(){return c.routing.transitMode},set transitMode(e){var t,o;t=e,(o=document.getElementById("TravelNotes-Control-"+t+"ImgButton"))&&o.click()}})})}()},{"../L.TravelNotes":7,"../UI/HtmlElementsFactory":17,"../core/RouteEditor":36}],21:[function(I,e,t){!function(){"use strict";var a=I("./Translator")(),i=null,s=function(e){if(e.stopPropagation(),-1!==I("../L.TravelNotes").routeEdition.routeInitialObjId){document.getElementById("TravelNotes-Control-RouteHeaderDiv").classList.toggle("TravelNotes-Control-SmallHeader"),document.getElementById("TravelNotes-Control-RouteDataDiv").classList.toggle("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-RouteButtonsDiv").classList.toggle("TravelNotes-Control-HiddenList");var t=document.getElementById("TravelNotes-Control-RouteDataDiv").classList.contains("TravelNotes-Control-HiddenList");document.getElementById("TravelNotes-Control-RouteExpandButton").innerHTML=t?"&#x25b6;":"&#x25bc;",document.getElementById("TravelNotes-Control-RouteExpandButton").title=t?a.getText("RouteEditorUI - Show"):a.getText("RouteEditorUI - Hide")}},l=function(e){e.stopPropagation(),I("../core/WaypointEditor")().removeWayPoint(e.itemNode.dataObjId)},d=function(e){e.stopPropagation(),I("../core/WaypointEditor")().swapWayPoints(e.itemNode.dataObjId,!0)},c=function(e){e.stopPropagation(),I("../core/WaypointEditor")().swapWayPoints(e.itemNode.dataObjId,!1)},u=function(e){e.stopPropagation(),I("../core/WaypointEditor")().renameWayPoint(e.dataObjId,e.changeValue)},v=function(e){e.stopPropagation(),I("../core/WaypointEditor")().wayPointDropped(e.draggedObjId,e.targetObjId,e.draggedBefore)},g=function(e){e.stopPropagation(),document.getElementById("TravelNotes-Control-RouteDataDiv").classList.toggle("TravelNotes-Control-ExpandedList");var t=document.getElementById("TravelNotes-Control-RouteDataDiv").classList.contains("TravelNotes-Control-ExpandedList");document.getElementById("TravelNotes-Control-ExpandWayPointsListButton").innerHTML=t?"&#x25b3;":"&#x25bd;",document.getElementById("TravelNotes-Control-ExpandWayPointsListButton").title=t?a.getText("RouteEditorUI - Reduce the list"):a.getText("RouteEditorUI - Expand the list")},p=function(e){e.stopPropagation(),I("../core/RouteEditor")().cancelEdition()},m=function(e){e.stopPropagation(),I("../core/RouteEditor")().saveEdition()},T=function(e){e.stopPropagation(),I("../core/RouteEditor")().saveGpx()},f=function(e){e.stopPropagation(),I("../core/WaypointEditor")().reverseWayPoints()},N=function(e){e.stopPropagation(),I("../core/WaypointEditor")().removeAllWayPoints()};void 0!==e&&e.exports&&(e.exports=function(){return Object.seal({createUI:function(e){!function(e){if(!document.getElementById("TravelNotes-Control-RouteDataDiv")){var t=I("./HTMLElementsFactory")(),o=t.create("div",{id:"TravelNotes-Control-RouteHeaderDiv",className:"TravelNotes-Control-HeaderDiv"},e);t.create("span",{innerHTML:"&#x25bc;",id:"TravelNotes-Control-RouteExpandButton",className:"TravelNotes-Control-ExpandButton"},o).addEventListener("click",s,!1),t.create("span",{innerHTML:a.getText("RouteEditorUI - Waypoints"),id:"TravelNotes-Control-RouteHeaderText",className:"TravelNotes-Control-HeaderText"},o);var n=t.create("div",{id:"TravelNotes-Control-RouteDataDiv",className:"TravelNotes-Control-DataDiv"},e);(i=I("./SortableList")({minSize:0,listStyle:"LimitedSort",id:"TravelNotes-Control-RouteWaypointsList"},n)).container.addEventListener("SortableListDelete",l,!1),i.container.addEventListener("SortableListUpArrow",d,!1),i.container.addEventListener("SortableListDownArrow",c,!1),i.container.addEventListener("SortableListChange",u,!1),i.container.addEventListener("SortableListDrop",v,!1);var r=t.create("div",{id:"TravelNotes-Control-RouteButtonsDiv",className:"TravelNotes-Control-ButtonsDiv"},e);t.create("div",{id:"TravelNotes-Control-ExpandWayPointsListButton",className:"TravelNotes-Control-Button",title:a.getText("RouteEditorUI - Expand the list"),innerHTML:"&#x25bd;"},r).addEventListener("click",g,!1),t.create("div",{id:"TravelNotes-Control-CancelRouteButton",className:"TravelNotes-Control-Button",title:a.getText("RouteEditorUI - Cancel"),innerHTML:"&#x274c"},r).addEventListener("click",p,!1),t.create("div",{id:"TravelNotes-Control-SaveRouteButton",className:"TravelNotes-Control-Button",title:a.getText("RouteEditorUI - Save"),innerHTML:"&#x1f4be;"},r).addEventListener("click",m,!1),t.create("div",{id:"TravelNotes-Control-gpxButton",className:"TravelNotes-Control-Button",title:a.getText("RouteEditorUI - Save the route in a gpx file"),innerHTML:"gpx"},r).addEventListener("click",T,!1),t.create("div",{id:"TravelNotes-Control-ReverseWayPointsButton",className:"TravelNotes-Control-Button",title:a.getText("RouteEditorUI - Invert waypoints"),innerHTML:"&#x21C5;"},r).addEventListener("click",f,!1),t.create("div",{id:"TravelNotes-Control-RemoveAllWayPointsButton",className:"TravelNotes-Control-Button",title:a.getText("RouteEditorUI - Delete all waypoints"),innerHTML:"&#x267b;"},r).addEventListener("click",N,!1)}}(e)},expand:function(){document.getElementById("TravelNotes-Control-RouteExpandButton").innerHTML="&#x25bc;",document.getElementById("TravelNotes-Control-RouteExpandButton").title="Masquer",document.getElementById("TravelNotes-Control-RouteDataDiv").classList.remove("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-RouteButtonsDiv").classList.remove("TravelNotes-Control-HiddenList")},reduce:function(){document.getElementById("TravelNotes-Control-RouteExpandButton").innerHTML="&#x25b6;",document.getElementById("TravelNotes-Control-RouteExpandButton").title="Afficher",document.getElementById("TravelNotes-Control-RouteDataDiv").classList.add("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-RouteButtonsDiv").classList.add("TravelNotes-Control-HiddenList")},setWayPointsList:function(){!function(){if(i.removeAllItems(),-1!==I("../L.TravelNotes").routeEdition.routeInitialObjId)for(var e=I("../L.TravelNotes").editedRoute.wayPoints.iterator;!e.done;){var t=e.first?"A":e.last?" B":e.index,o=e.first?a.getText("RouteEditorUI - Start"):e.last?a.getText("RouteEditorUI - End"):a.getText("RouteEditorUI - Via");i.addItem(e.value.UIName,t,o,e.value.objId,e.last)}}()}})})}()},{"../L.TravelNotes":7,"../core/RouteEditor":36,"../core/WaypointEditor":40,"./HTMLElementsFactory":15,"./SortableList":24,"./Translator":25}],22:[function(g,e,t){!function(){"use strict";var v=g("../UI/Translator")();void 0!==e&&e.exports&&(e.exports=function(e){var t=g("../UI/ColorDialog")(e.color);t.title=v.getText("RoutePropertiesDialog - Route properties"),t.addClickOkButtonEventListener(function(){return e.color=t.getNewColor(),e.width=parseInt(a.value),e.chain=u.checked,e.dashArray=s.selectedIndex,g("../core/MapEditor")().editRoute(e),g("../core/RouteEditor")().chainRoutes(),g("../UI/TravelEditorUI")().setRoutesList(),g("../core/TravelEditor")().updateRoadBook(),!0});var o=g("./HTMLElementsFactory")(),n=o.create("div",{id:"TravelNotes-RoutePropertiesDialog-MainDataDiv"},t.content),r=o.create("div",{className:"TravelNotes-RoutePropertiesDialog-DataDiv",id:"TravelNotes-RoutePropertiesDialog-WithDiv"},n);r.innerHTML="<span>"+v.getText("RoutePropertiesDialog - Width")+"</span>";var a=o.create("input",{type:"number",id:"TravelNotes-RoutePropertiesDialog-WidthInput"},r);a.value=e.width,a.min=1,a.max=40;var i=o.create("div",{className:"TravelNotes-RoutePropertiesDialog-DataDiv",id:"TravelNotes-RoutePropertiesDialog-dashDiv"},n);i.innerHTML="<span>"+v.getText("RoutePropertiesDialog - Linetype")+"</span>";for(var s=o.create("select",{className:"TravelNotes-RoutePropertiesDialog-Select",id:"TravelNotes-RoutePropertiesDialog-DashSelect"},i),l=g("../L.TravelNotes").config.route.dashChoices,d=0;d<l.length;d++)s.add(o.create("option",{text:l[d].text}));s.selectedIndex=e.dashArray<l.length?e.dashArray:0;var c=o.create("div",{className:"TravelNotes-RoutePropertiesDialog-DataDiv",id:"TravelNotes-RoutePropertiesDialog-ChainDiv"},n);c.innerHTML="<span>"+v.getText("RoutePropertiesDialog - Chained route")+"</span>";var u=o.create("input",{type:"checkbox",id:"TravelNotes-RoutePropertiesDialog-ChainInput"},c);return u.checked=e.chain,t})}()},{"../L.TravelNotes":7,"../UI/ColorDialog":10,"../UI/Translator":25,"../UI/TravelEditorUI":26,"../core/MapEditor":33,"../core/RouteEditor":36,"../core/TravelEditor":39,"./HTMLElementsFactory":15}],23:[function(g,e,t){!function(){"use strict";var a=g("../core/OsmSearchEngine")(),i="",s=function(e){"Enter"===e.key&&l(e)},l=function(e){i=document.getElementById("TravelNotes-Control-SearchInput").value;for(var t=document.getElementById("TravelNotes-Control-SearchDiv"),o=document.getElementsByClassName("TravelNotes-Control-SearchResult");0!==o.length;)o[0].removeEventListener("click",d,!1),o[0].removeEventListener("contextmenu",c,!1),o[0].removeEventListener("mouseenter",u,!1),o[0].removeEventListener("mouseleave",v,!1),t.removeChild(o[0]);if(!document.getElementById("TravelNotes-Control-SearchWaitBullet")){var n=g("./HTMLElementsFactory")();n.create("div",{id:"TravelNotes-Control-SearchWaitBullet"},n.create("div",{id:"TravelNotes-Control-SearchWait"},t))}a.search()},d=function(e){e.stopPropagation();for(var t=e.target;!t.latLng;)t=t.parentNode;g("../core/MapEditor")().zoomToSearchResult(t.latLng,t.geometry)},c=function(e){e.stopPropagation(),e.preventDefault();for(var t=e.target;!t.latLng;)t=t.parentNode;g("../core/NoteEditor")().newSearchNote(t.searchResult)},u=function(e){e.stopPropagation(),g("../core/MapEditor")().addSearchPointMarker(e.target.objId,e.target.latLng,e.target.geometry)},v=function(e){e.stopPropagation(),g("../core/MapEditor")().removeObject(e.target.objId)};void 0!==e&&e.exports&&(e.exports=function(){return Object.seal({remove:function(){!function(){var e=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(e){a.hide();var t=document.getElementById("TravelNotes-Control-SearchButton");t&&t.removeEventListener("click",l,!1);var o=document.getElementById("TravelNotes-Control-SearchInput");o&&o.removeEventListener("change",l,!1);var n=document.getElementById("TravelNotes-Control-SearchDiv"),r=document.getElementsByClassName("TravelNotes-Control-SearchResult");Array.prototype.forEach.call(r,function(e){e.removeEventListener("click",d,!1),e.removeEventListener("contextmenu",c,!1),e.removeEventListener("mouseenter",u,!1),e.removeEventListener("mouseleave",v,!1)}),n&&e.removeChild(n)}}()},add:function(){!function(){document.getElementById("TravelNotes-Control-ItineraryPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-TravelNotesPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-SearchPaneButton").classList.add("TravelNotes-Control-ActivePaneButton");var e=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(e){a.show();var o=g("./HTMLElementsFactory")(),n=o.create("div",{id:"TravelNotes-Control-SearchDiv"},e);o.create("div",{id:"TravelNotes-Control-SearchButton",className:"TravelNotes-Control-Button",title:g("./Translator")().getText("SearchPaneUI - Search OpenStreetMap"),innerHTML:"&#x1f50e"},n).addEventListener("click",l,!1);var t=o.create("input",{type:"text",id:"TravelNotes-Control-SearchInput",placeholder:g("./Translator")().getText("SearchPaneUI - Search phrase"),value:i},n);t.addEventListener("change",l,!1),t.addEventListener("keydown",s,!1),t.focus();var r=0;g("../L.TravelNotes").searchData.forEach(function(e){var t=o.create("div",{id:"TravelNotes-Control-SearchResult"+r++,className:"TravelNotes-Control-SearchResult",innerHTML:(""!=e.description?"<p class='TravelNotes-Control-SearchResultDescription'>"+e.description+"</p>":"")+(e.tags.name?"<p>"+e.tags.name+"</p>":"")+(e.tags["addr:street"]?"<p>"+e.tags["addr:street"]+" "+(e.tags["addr:housenumber"]?e.tags["addr:housenumber"]:"")+"</p>":"")+(e.tags["addr:city"]?"<p>"+(e.tags["addr:postcode"]?e.tags["addr:postcode"]+" ":"")+e.tags["addr:city"]+"</p>":"")+(e.tags.phone?"<p>"+e.tags.phone+"</p>":"")+(e.tags.email?"<p><a href='mailto:"+e.tags.email+"'>"+e.tags.email+"</a></p>":"")+(e.tags.website?"<p><a href='"+e.tags.website+"' target='_blank'>"+e.tags.website+"</a></p>":"")+(e.ranking?"<p>&#x26ab;"+e.ranking+"</p>":"")},n);t.searchResult=e,t.objId=g("../data/ObjId")(),t.osmId=e.id,t.latLng=L.latLng([e.lat,e.lon]),t.geometry=e.geometry,t.addEventListener("click",d,!1),t.addEventListener("contextmenu",c,!1),t.addEventListener("mouseenter",u,!1),t.addEventListener("mouseleave",v,!1)})}}()}})})}()},{"../L.TravelNotes":7,"../core/MapEditor":33,"../core/NoteEditor":34,"../core/OsmSearchEngine":35,"../data/ObjId":49,"./HTMLElementsFactory":15,"./Translator":25}],24:[function(n,e,t){!function(){"use strict";var d=n("../UI/Translator")(),r=0,c=function(e){e.stopPropagation();try{e.dataTransfer.setData("Text",e.target.dataObjId),e.dataTransfer.dropEffect="move"}catch(e){}r=e.target.dataObjId-1},a=function(e){e.preventDefault()},i=function(e){e.preventDefault();for(var t=e.target;!t.dataObjId;)t=t.parentElement;var o=t.getBoundingClientRect(),n=new Event("SortableListDrop");n.draggedObjId=r+1,n.targetObjId=t.dataObjId,n.draggedBefore=e.clientY-o.top<o.bottom-e.clientY,t.parentNode.dispatchEvent(n)},u=function(e){var t=new Event("SortableListDelete");t.itemNode=e.target.parentNode,e.target.parentNode.parentNode.dispatchEvent(t),e.stopPropagation()},v=function(e){var t=new Event("SortableListUpArrow");t.itemNode=e.target.parentNode,e.target.parentNode.parentNode.dispatchEvent(t),e.stopPropagation()},g=function(e){var t=new Event("SortableListDownArrow");t.itemNode=e.target.parentNode,e.target.parentNode.parentNode.dispatchEvent(t),e.stopPropagation()},p=function(e){var t=new Event("SortableListRightArrow");t.itemNode=e.target.parentNode,e.target.parentNode.parentNode.dispatchEvent(t),e.stopPropagation()},m=function(e){var t=new Event("SortableListChange");t.dataObjId=e.target.parentNode.dataObjId,t.changeValue=e.target.value,e.target.parentNode.parentNode.dispatchEvent(t),e.stopPropagation()},s=function(e){e.deltaY&&(e.target.scrollTop=e.target.scrollTop+10*e.deltaY),e.stopPropagation()},o=function(e,t){var l=n("./HTMLElementsFactory")();this.items=[],this.removeAllItems=function(){for(var e=0;e<this.items.length;e++)this.container.removeChild(this.items[e]);this.items.length=0},this.addItem=function(e,t,o,n,r){e=e||"",t=t||"",o=o||"",n=n||-1;var a=l.create("div",{draggable:!1,className:"TravelNotes-SortableList-Item"});l.create("div",{className:"TravelNotes-SortableList-ItemTextIndex",innerHTML:t},a);var i=l.create("input",{type:"text",className:"TravelNotes-SortableList-ItemInput",placeholder:o,value:e},a);i.addEventListener("change",m,!1),i.addEventListener("focus",function(e){e.target.parentElement.draggable=!1},!1),i.addEventListener("blur",function(e){e.target.parentElement.draggable=e.target.parentElement.canDrag},!1),l.create("div",{className:"TravelNotes-SortableList-ItemUpArrowButton",title:d.getText("SortableList - Move up"),innerHTML:String.fromCharCode(8679)},a).addEventListener("click",v,!1),l.create("div",{className:"TravelNotes-SortableList-ItemDownArrowButton",title:d.getText("SortableList - Move down"),innerHTML:String.fromCharCode(8681)},a).addEventListener("click",g,!1);var s=l.create("div",{className:"TravelNotes-SortableList-ItemRightArrowButton",title:d.getText("SortableList - Edit"),innerHTML:String.fromCharCode(8688)},a);"AllSort"===this.options.listStyle&&s.addEventListener("click",p,!1),l.create("div",{className:"TravelNotes-SortableList-ItemDeleteButton",title:d.getText("SortableList - Delete"),innerHTML:"&#x267b;"},a).addEventListener("click",u,!1),a.dataObjId=n,a.canDrag=!1,("LimitedSort"!==this.options.listStyle||1<this.items.length)&&!r&&(a.draggable=!0,a.addEventListener("dragstart",c,!1),a.classList.add("TravelNotes-SortableList-MoveCursor"),a.canDrag=!0),this.items.push(a),this.container.appendChild(a)},this._create=function(e,t){for(var o in this.options={minSize:2,listStyle:"AllSort",id:"TravelNotes-SortableList-Container"},e)this.options[o]=e[o];"LimitedSort"===this.options.listStyle&&this.options.minSize<2&&(this.options.minSize=0),this.container=l.create("div",{id:e.id,className:"TravelNotes-SortableList-Container"}),this.container.classList.add(this.options.listStyle),this.container.addEventListener("drop",i,!1),this.container.addEventListener("dragover",a,!1),this.container.addEventListener("wheel",s,!1),t&&t.appendChild(this.container);for(var n=0;n<this.options.minSize;n++)this.addItem()},this._create(e,t)};void 0!==e&&e.exports&&(e.exports=function(e,t){return new o(e,t)})}()},{"../UI/Translator":25,"./HTMLElementsFactory":15}],25:[function(e,t,o){(function(n){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){return n.translations||(n.translations=new Map),{setTranslations:function(e){e.forEach(function(e){n.translations.set(e.msgid,e.msgstr)})},getText:function(e,t){var o=n.translations.get(e);return t&&o&&Object.getOwnPropertyNames(t).forEach(function(e){o=o.replace("{"+e+"}",t[e])}),o||e}}})}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],26:[function(A,e,t){!function(){"use strict";var c=A("./Translator")(),u=A("../L.TravelNotes"),v=null,t=null,g=function(e){t&&(clearTimeout(t),t=null),document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Minimize"),document.getElementById("TravelNotes-Control-MainDiv").classList.add("TravelNotes-Control-MainDiv-Maximize")},o=function(){document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Maximize"),document.getElementById("TravelNotes-Control-MainDiv").classList.add("TravelNotes-Control-MainDiv-Minimize")},p=function(e){t=setTimeout(o,u.config.travelEditor.timeout)},m=function(e){e.stopPropagation(),document.getElementById("TravelNotes-Control-TravelHeaderDiv").classList.toggle("TravelNotes-Control-SmallHeader"),document.getElementById("TravelNotes-Control-TravelDataDiv").classList.toggle("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-ControlTravelButtonsDiv").classList.toggle("TravelNotes-Control-HiddenList");var t=document.getElementById("TravelNotes-Control-TravelDataDiv").classList.contains("TravelNotes-Control-HiddenList");document.getElementById("TravelNotes-ControlTravelExpandButton").innerHTML=t?"&#x25b6;":"&#x25bc;",document.getElementById("TravelNotes-ControlTravelExpandButton").title=t?c.getText("TravelEditorUI - Show"):c.getText("TravelEditorUI - Hide"),e.stopPropagation()},T=function(e){var t=document.getElementById("TravelNotes-Control-MainDiv");10060===e.target.innerHTML.charCodeAt(0)?(e.target.innerHTML="&#x1f4cc;",t.addEventListener("mouseenter",g,!1),t.addEventListener("mouseleave",p,!1)):(e.target.innerHTML="&#x274c;",t.removeEventListener("mouseenter",g,!1),t.removeEventListener("mouseleave",p,!1))},f=function(e){e.stopPropagation(),A("../core/TravelEditor")().removeRoute(e.itemNode.dataObjId)},N=function(e){e.stopPropagation(),A("../core/TravelEditor")().swapRoute(e.itemNode.dataObjId,!0)},I=function(e){e.stopPropagation(),A("../core/TravelEditor")().swapRoute(e.itemNode.dataObjId,!1)},L=function(e){e.stopPropagation(),A("../core/TravelEditor")().editRoute(e.itemNode.dataObjId)},h=function(e){e.stopPropagation(),A("../core/TravelEditor")().renameRoute(e.dataObjId,e.changeValue)},E=function(e){e.stopPropagation(),A("../core/TravelEditor")().routeDropped(e.draggedObjId,e.targetObjId,e.draggedBefore)},y=function(e){e.stopPropagation(),document.getElementById("TravelNotes-Control-TravelDataDiv").classList.toggle("TravelNotes-Control-ExpandedList");var t=document.getElementById("TravelNotes-Control-TravelDataDiv").classList.contains("TravelNotes-Control-ExpandedList");document.getElementById("TravelNotes-Control-ExpandRoutesListButton").innerHTML=t?"&#x25b3;":"&#x25bd;",document.getElementById("TravelNotes-Control-ExpandRoutesListButton").title=t?c.getText("TravelEditorUI - Reduce the list"):c.getText("TravelEditorUI - Expand the list")},b=function(e){e.stopPropagation(),A("../core/TravelEditor")().clear(),A("../L.TravelNotes").config.travelEditor.startupRouteEdition&&A("../core/RouteEditor")().editRoute(A("../L.TravelNotes").travel.routes.first.objId),A("../L.TravelNotes").map.fire("travelnotesfileloaded",{readOnly:!1,name:""})},C=function(e){e.stopPropagation(),A("../core/TravelEditor")().saveTravel()},D=function(e){e.stopPropagation(),A("../core/RouteEditor")().cancelEdition(),A("../core/FileLoader")().openLocalFile(e)},x=function(){A("../core/TravelEditor")().confirmClose()&&document.getElementById("TravelNotes-Control-OpenTravelInput").click()},M=function(e){e.stopPropagation(),A("../core/FileLoader")().mergeLocalFile(e)},R=function(e){document.getElementById("TravelNotes-Control-ImportTravelInput").click()},j=function(e){e.stopPropagation(),A("../core/TravelEditor")().addRoute()};void 0!==e&&e.exports&&(e.exports=function(){return Object.seal({createUI:function(e){!function(e){if(!document.getElementById("TravelNotes-Control-TravelDataDiv")){var t=A("./HTMLElementsFactory")(),o=t.create("div",{id:"TravelNotes-Control-TravelHeaderDiv",className:"TravelNotes-Control-HeaderDiv"},e);t.create("span",{innerHTML:"&#x25bc;",id:"TravelNotes-ControlTravelExpandButton",className:"TravelNotes-Control-ExpandButton"},o).addEventListener("click",m,!1),t.create("span",{innerHTML:c.getText("TravelEditorUI - Travel routes"),id:"TravelNotes-Control-TravelHeaderText",className:"TravelNotes-Control-HeaderText"},o);var n=t.create("span",{innerHTML:"&#x274c;",id:"TravelNotes-Control-PinButton"},o);n.addEventListener("click",T,!1);var r=t.create("div",{id:"TravelNotes-Control-TravelDataDiv",className:"TravelNotes-Control-DataDiv"},e);(v=A("./SortableList")({minSize:0,id:"TravelNotes-Control-TravelRoutesList"},r)).container.addEventListener("SortableListDelete",f,!1),v.container.addEventListener("SortableListUpArrow",N,!1),v.container.addEventListener("SortableListDownArrow",I,!1),v.container.addEventListener("SortableListRightArrow",L,!1),v.container.addEventListener("SortableListChange",h,!1),v.container.addEventListener("SortableListDrop",E,!1);var a=t.create("div",{id:"TravelNotes-ControlTravelButtonsDiv",className:"TravelNotes-Control-ButtonsDiv"},e);t.create("div",{id:"TravelNotes-Control-ExpandRoutesListButton",className:"TravelNotes-Control-Button",title:c.getText("TravelEditorUI - Expand the list"),innerHTML:"&#x25bd;"},a).addEventListener("click",y,!1),t.create("div",{id:"TravelNotes-Control-CancelTravelButton",className:"TravelNotes-Control-Button",title:c.getText("TravelEditorUI - Cancel travel"),innerHTML:"&#x274c"},a).addEventListener("click",b,!1),t.create("div",{id:"TravelNotes-Control-SaveTravelButton",className:"TravelNotes-Control-Button",title:c.getText("TravelEditorUI - Save travel"),innerHTML:"&#x1f4be;"},a).addEventListener("click",C,!1);var i=t.create("div",{id:"TravelNotes-Control-OpenTravelDiv"},a);t.create("input",{id:"TravelNotes-Control-OpenTravelInput",type:"file",accept:".trv"},i).addEventListener("change",D,!1);var s=t.create("div",{id:"TravelNotes-Control-OpenTravelFakeDiv"},i);t.create("div",{id:"TravelNotes-Control-OpenTravelButton",className:"TravelNotes-Control-Button",title:c.getText("TravelEditorUI - Open travel"),innerHTML:"&#x1F4C2;"},s).addEventListener("click",x,!1);var l=t.create("div",{id:"TravelNotes-Control-ImportTravelDiv"},a);t.create("input",{id:"TravelNotes-Control-ImportTravelInput",type:"file",accept:".trv,.map"},l).addEventListener("change",M,!1);var d=t.create("div",{id:"TravelNotes-Control-ImportTravelFakeDiv"},l);t.create("div",{id:"TravelNotes-Control-ImportTravelButton",className:"TravelNotes-Control-Button",title:c.getText("TravelEditorUI - Import travel"),innerHTML:"&#x1F30F;"},d).addEventListener("click",R,!1),t.create("div",{id:"TravelNotes-Control-OpenTravelRoadbookButton",className:"TravelNotes-Control-Button",title:c.getText("TravelEditorUI - Open travel roadbook"),innerHTML:'<a id="TravelNotes-Control-OpenTravelRoadbookLink" href="TravelNotesRoadbook.html?page='+u.UUID+'" target="_blank">&#x1F4CB;</a>'},a),t.create("div",{id:"TravelNotes-Control-AddRoutesButton",className:"TravelNotes-Control-Button",title:c.getText("TravelEditorUI - New route"),innerHTML:"+"},a).addEventListener("click",j,!1),u.config.travelEditor.startMinimized?(n.innerHTML="&#x1f4cc;",e.addEventListener("mouseenter",g,!1),e.addEventListener("mouseleave",p,!1),e.classList.add("TravelNotes-Control-MainDiv-Minimize")):e.classList.add("TravelNotes-Control-MainDiv-Maximize")}}(e)},setRoutesList:function(){!function(){v.removeAllItems();for(var e=u.travel.routes.iterator;!e.done;)v.addItem(e.value.name,e.value.chain?"&#x26d3;":"",c.getText("TravelEditorUI - Route"),e.value.objId,!1)}()}})})}()},{"../L.TravelNotes":7,"../core/FileLoader":31,"../core/RouteEditor":36,"../core/TravelEditor":39,"./HTMLElementsFactory":15,"./SortableList":24,"./Translator":25}],27:[function(d,e,t){!function(){"use strict";var n=0,r=function(e){e.stopPropagation();try{e.dataTransfer.setData("Text",e.target.dataObjId),e.dataTransfer.dropEffect="move"}catch(e){}n=e.target.noteObjId-1},a=function(e){e.preventDefault()},i=function(e){e.preventDefault();for(var t=e.target;!t.noteObjId;)t=t.parentElement;var o=t.getBoundingClientRect();d("../core/NoteEditor")().noteDropped(n+1,t.noteObjId,e.clientY-o.top<o.bottom-e.clientY)},s=function(e){e.stopPropagation(),e.preventDefault();for(var t=e.target;!t.noteObjId;)t=t.parentNode;d("../core/MapEditor")().zoomToNote(t.noteObjId)},l=function(e){e.stopPropagation(),e.preventDefault();for(var t=e.target;!t.noteObjId;)t=t.parentNode;d("../core/NoteEditor")().editNote(t.noteObjId)};void 0!==e&&e.exports&&(e.exports=function(){return Object.seal({remove:function(){!function(){var e=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(e){var t=e.firstChild;t&&(t.childNodes.forEach(function(e){e.removeEventListener("click",s,!1),e.removeEventListener("contextmenu",l,!1),e.removeEventListener("dragstart",r,!1)}),e.removeChild(t))}}()},add:function(){!function(){document.getElementById("TravelNotes-Control-ItineraryPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-TravelNotesPaneButton").classList.add("TravelNotes-Control-ActivePaneButton"),window.osmSearch&&document.getElementById("TravelNotes-Control-SearchPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton");var e=d("../UI/HTMLViewsFactory")();e.classNamePrefix="TravelNotes-Control-";var t=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(t){var o=e.travelNotesHTML;o.addEventListener("drop",i,!1),o.addEventListener("dragover",a,!1),t.appendChild(o),o.childNodes.forEach(function(e){e.addEventListener("click",s,!1),e.addEventListener("contextmenu",l,!1),e.draggable=!0,e.addEventListener("dragstart",r,!1),e.classList.add("TravelNotes-SortableList-MoveCursor")})}}()}})})}()},{"../UI/HTMLViewsFactory":16,"../core/MapEditor":33,"../core/NoteEditor":34}],28:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){var e=document.getElementById("TravelNotes-Control-MainDiv");return e||(e=t("./HTMLElementsFactory")().create("div",{id:"TravelNotes-Control-MainDiv"}),t("./HTMLElementsFactory")().create("div",{id:"TravelNotes-Control-MainDiv-Title",innerHTML:"Travel&nbsp;&amp;&nbsp;Notes"},e),t("./TravelEditorUI")().createUI(e),t("./RouteEditorUI")().createUI(e),t("./DataPanesUI")().createUI(e),t("./ProvidersToolbarUI")().createUI(e),t("./ErrorEditorUI")().createUI(e),e.addEventListener("click",function(e){e.target.classList.contains("TravelNotes-SortableList-ItemInput")||e.target.id&&-1!==["TravelNotes-Control-OpenTravelInput","TravelNotes-Control-OpenTravelButton","TravelNotes-Control-ImportTravelInput","TravelNotes-Control-ImportTravelButton","TravelNotes-Control-OpenTravelRoadbookLink"].indexOf(e.target.id)||(e.stopPropagation(),e.preventDefault())},!1),e.addEventListener("dblclick",function(e){e.stopPropagation(),e.preventDefault()},!1),e.addEventListener("wheel",function(e){e.stopPropagation(),e.preventDefault()},!1)),{get UI(){return e}}})}()},{"./DataPanesUI":13,"./ErrorEditorUI":14,"./HTMLElementsFactory":15,"./ProvidersToolbarUI":20,"./RouteEditorUI":21,"./TravelEditorUI":26}],29:[function(e,t,o){arguments[4][9][0].apply(o,arguments)},{"../UI/Translator":25,"./HTMLElementsFactory":15,dup:9}],30:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){return{showError:function(e){t("../UI/ErrorEditorUI")().message='<span class="TravelNotes-Control-Error">'+e+"</span>"},clear:function(){t("../UI/ErrorEditorUI")().message=""}}})}()},{"../UI/ErrorEditorUI":14}],31:[function(c,e,t){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){var n=c("../L.TravelNotes"),t=!1,o="",r=!1,a={},i=function(){a.routes.forEach(function(o){o.itinerary.itineraryPoints.latLngs=c("@mapbox/polyline").decode(o.itinerary.itineraryPoints.latLngs,6);var n=[],r=0;o.itinerary.itineraryPoints.latLngs.forEach(function(e){var t={};t.lat=e[0],t.lng=e[1],t.distance=o.itinerary.itineraryPoints.distances[r],t.objId=o.itinerary.itineraryPoints.objIds[r],t.objType=o.itinerary.itineraryPoints.objType,n.push(t),r++}),o.itinerary.itineraryPoints=n}),t?e():s()},e=function(){var e=c("../Data/Travel")();e.object=a;for(var t=e.routes.iterator;!t.done;)n.travel.routes.add(t.value);for(var o=e.notes.iterator;!o.done;)n.travel.notes.add(o.value);l()},s=function(){n.travel.object=a,""!==o&&(n.travel.name=o.substr(0,o.lastIndexOf("."))),n.travel.readOnly=r,l()},l=function(){var e=c("../core/MapEditor")();e.removeAllObjects();for(var t=n.travel.routes.iterator;!t.done;)e.addRoute(t.value,!0,!1,r);for(var o=n.travel.notes.iterator;!o.done;)e.addNote(o.value,r);e.zoomToTravel(),r?(document.getElementById("TravelNotes-Control-MainDiv").classList.add("TravelNotes-Control-MainDiv-Hidden"),document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Maximize"),document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Minimize")):(c("../UI/TravelEditorUI")().setRoutesList(),c("../core/TravelEditor")().updateRoadBook(!1)),n.map.fire("travelnotesfileloaded",{readOnly:r,name:n.travel.name})},d=function(e){o=e.target.files[0].name;var t=new FileReader;t.onload=function(e){try{a=JSON.parse(t.result),i()}catch(e){}},t.readAsText(e.target.files[0])};return Object.seal({openLocalFile:function(e){r=t=!1,d(e)},mergeLocalFile:function(e){r=!(t=!0),d(e)},openDistantFile:function(e){r=!0,a=e,i()}})})}()},{"../Data/Travel":5,"../L.TravelNotes":7,"../UI/TravelEditorUI":26,"../core/MapEditor":33,"../core/TravelEditor":39,"@mapbox/polyline":1}],32:[function(s,e,t){!function(){"use strict";var i=!1;void 0!==e&&e.exports&&(e.exports=function(){return{getAddress:function(e,t,o,n){if(!i){i=!0;var r="https://nominatim.openstreetmap.org/reverse?format=json&lat="+e+"&lon="+t+"&zoom=18&addressdetails=1&accept-language="+s("../L.TravelNotes").config.language,a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var e;i=!1;try{e=JSON.parse(this.responseText)}catch(e){return}var t="";void 0!==e.address.house_number&&(t+=e.address.house_number+" "),void 0!==e.address.road?t+=e.address.road+" ":void 0!==e.address.pedestrian&&(t+=e.address.pedestrian+" "),void 0!==e.address.village?t+=e.address.village:void 0!==e.address.town?t+=e.address.town:void 0!==e.address.city&&(t+=e.address.city),0===t.length&&(t+=e.address.country),o.call(null,t,n)}},a.open("GET",r,!0),a.send(null)}}}})}()},{"../L.TravelNotes":7}],33:[function(T,e,t){!function(){"use strict";var m=T("../L.TravelNotes");void 0!==e&&e.exports&&(e.exports=function(){var d=T("../Data/DataSearchEngine")(),c=function(e){var t=d.getRoute(e.target.objId),o=T("../core/RouteEditor")().getClosestLatLngDistance(t,[e.latlng.lat,e.latlng.lng]).distance;o+=t.chainedDistance,o=T("../util/Utilities")().formatDistance(o);var n=m.mapObjects.get(e.target.objId);n.closeTooltip();var r=d.getRoute(e.target.objId).name;r+=0===r.length?"":" - ",r+=o,n.setTooltipContent(r),n.openTooltip(e.latlng)},u=function(e,t){t.objId=e,t.addTo(m.map),m.mapObjects.set(e,t)},a=function(e){var t=m.mapObjects.get(e);t&&(L.DomEvent.off(t),m.map.removeLayer(t),m.mapObjects.delete(e))},s=function(e){var t=L.latLng([90,180]),o=L.latLng([-90,-180]);return e.forEach(function(e){t.lat=Math.min(t.lat,e[0]),t.lng=Math.min(t.lng,e[1]),o.lat=Math.max(o.lat,e[0]),o.lng=Math.max(o.lng,e[1])}),L.latLngBounds(t,o)},n=function(e){var t=[];return e.itinerary.itineraryPoints.forEach(function(e){t.push(e.latLng)}),e.notes.forEach(function(e){t.push(e.latLng),t.push(e.iconLatLng)}),t},v=function(e){e.dashArray>=m.config.route.dashChoices.length&&(e.dashArray=0);var t=m.config.route.dashChoices[e.dashArray].iDashArray;if(t){var o="",n=0;for(n=0;n<t.length-1;n++)o+=t[n]*e.width+",";return o+=t[n]*e.width}return null},r=function(e){m.map.setView(e,m.config.itineraryPointZoom)},g=function(e,t){if(0!==e.lat||0!==e.lng){var o='<div class="TravelNotes-WayPoint TravelNotes-WayPoint'+("A"===t?"Start":"B"===t?"End":"Via")+'"></div><div class="TravelNotes-WayPointText">'+t+"</div>",n=L.marker(e.latLng,{icon:L.divIcon({iconSize:[40,40],iconAnchor:[20,40],html:o,className:"TravelNotes-WayPointStyle"}),draggable:!0});n.bindTooltip(function(e){return d.getWayPoint(e.objId).UIName}),n.getTooltip().options.offset=[20,-20],L.DomEvent.on(n,"contextmenu",function(e){T("../UI/ContextMenu")(e,T("../UI/ContextMenuFactory")().getWayPointContextMenu(e.target.objId))}),n.objId=e.objId,u(e.objId,n),L.DomEvent.on(n,"dragend",function(e){m.editedRoute.wayPoints.getAt(e.target.objId).latLng=[e.target.getLatLng().lat,e.target.getLatLng().lng],T("../core/WaypointEditor")().wayPointDragEnd(e.target.objId)})}},p=function(e,t){t=t||!1;var o=L.marker(e.latLng,{icon:L.divIcon({iconSize:[m.config.note.grip.size,m.config.note.grip.size],iconAnchor:[m.config.note.grip.size/2,m.config.note.grip.size/2],html:"<div></div>"}),zIndexOffset:-1e3,opacity:m.config.note.grip.opacity,draggable:!t});o.objId=e.objId,t||(L.DomEvent.on(o,"dragend",function(e){var t=d.getNoteAndRoute(e.target.objId),o=t.note,n=t.route,r=m.mapObjects.get(e.target.objId);if(null!=n){var a=T("../core/RouteEditor")().getClosestLatLngDistance(n,[e.target.getLatLng().lat,e.target.getLatLng().lng]);o.latLng=a.latLng,o.distance=a.distance,n.notes.sort(function(e,t){return e.distance-t.distance}),r.getLayer(r.bulletId).setLatLng(a.latLng),T("../UI/DataPanesUI")().updateItinerary()}else o.latLng=[e.target.getLatLng().lat,e.target.getLatLng().lng],T("../UI/DataPanesUI")().updateTravelNotes();r.getLayer(r.polylineId).setLatLngs([o.latLng,o.iconLatLng]),T("../core/TravelEditor")().updateRoadBook()}),L.DomEvent.on(o,"drag",function(e){var t=d.getNoteAndRoute(e.target.objId).note,o=m.mapObjects.get(e.target.objId);o.getLayer(o.polylineId).setLatLngs([[e.latlng.lat,e.latlng.lng],t.iconLatLng])}));var n=L.divIcon({iconSize:[e.iconWidth,e.iconHeight],iconAnchor:[e.iconWidth/2,e.iconHeight/2],popupAnchor:[0,-e.iconHeight/2],html:e.iconContent,className:m.config.note.style}),r=L.marker(e.iconLatLng,{icon:n,draggable:!t});r.objId=e.objId,r.bindPopup(function(e){var t=d.getNoteAndRoute(e.objId).note;return T("../core/NoteEditor")().getNoteHTML(t,"TravelNotes-")}),0!==e.tooltipContent.length&&(r.bindTooltip(function(e){return d.getNoteAndRoute(e.objId).note.tooltipContent}),r.getTooltip().options.offset[0]=e.iconWidth/2),t||(L.DomEvent.on(r,"contextmenu",function(e){T("../UI/ContextMenu")(e,T("../UI/ContextMenuFactory")().getNoteContextMenu(e.target.objId))}),L.DomEvent.on(r,"dragend",function(e){var t=d.getNoteAndRoute(e.target.objId).note;t.iconLatLng=[e.target.getLatLng().lat,e.target.getLatLng().lng];var o=m.mapObjects.get(e.target.objId);o.getLayer(o.polylineId).setLatLngs([t.latLng,t.iconLatLng])}),L.DomEvent.on(r,"drag",function(e){var t=d.getNoteAndRoute(e.target.objId).note,o=m.mapObjects.get(e.target.objId);o.getLayer(o.polylineId).setLatLngs([t.latLng,[e.latlng.lat,e.latlng.lng]])}));var a=L.polyline([e.latLng,e.iconLatLng],m.config.note.polyline);a.objId=e.objId;var i=L.layerGroup([r,a,o]);i.markerId=L.Util.stamp(r),i.polylineId=L.Util.stamp(a),i.bulletId=L.Util.stamp(o),u(e.objId,i)};return Object.seal({removeRoute:function(e,t,o){!function(e,t,o){if(a(e.objId),t)for(var n=e.notes.iterator;!n.done;)a(n.value.objId);if(o)for(var r=e.wayPoints.iterator;!r.done;)a(r.value.objId)}(e,t,o)},addRoute:function(e,t,o,n){!function(e,t,o,n){n=n||!1;for(var r=[],a=e.itinerary.itineraryPoints.iterator;!a.done;)r.push(a.value.latLng);var i=L.polyline(r,{color:e.color,weight:e.width,dashArray:v(e)});if(u(e.objId,i),i.bindTooltip(e.name,{sticky:!0,direction:"right"}),i.on("mouseover",c),i.on("mousemove",c),i.bindPopup(function(e){var t=d.getRoute(e.objId);return T("../core/RouteEditor")().getRouteHTML(t,"TravelNotes-")}),L.DomEvent.on(i,"click",function(e){e.target.openPopup(e.latlng)}),n||L.DomEvent.on(i,"contextmenu",function(e){T("../UI/ContextMenu")(e,T("../UI/ContextMenuFactory")().getRouteContextMenu(e.target.objId))}),t)for(var s=e.notes.iterator;!s.done;)p(s.value,n);if(o)for(var l=m.editedRoute.wayPoints.iterator;!l.done;)g(l.value,l.first?"A":l.last?"B":l.index)}(e,t,o,n)},editRoute:function(e){var t;t=e,m.mapObjects.get(t.objId).setStyle({color:t.color,weight:t.width,dashArray:v(t)})},removeObject:function(e){a(e)},removeAllObjects:function(){m.mapObjects.forEach(function(e,t,o){L.DomEvent.off(e),m.map.removeLayer(e)}),m.mapObjects.clear()},zoomToPoint:function(e){r(e)},zoomToSearchResult:function(e,t){!function(e,t){if(t){var o=[];t.forEach(function(e){o=o.concat(e)}),m.map.fitBounds(s(o))}else r(e)}(e,t)},zoomToNote:function(e){var t;t=e,r(d.getNoteAndRoute(t).note.iconLatLng)},zoomToRoute:function(e){var t,o;t=e,0!==(o=n(d.getRoute(t))).length&&m.map.fitBounds(s(o))},zoomToTravel:function(){var t;t=[],m.travel.routes.forEach(function(e){t=t.concat(n(e))}),m.travel.notes.forEach(function(e){t.push(e.latLng),t.push(e.iconLatLng)}),0!==t.length&&m.map.fitBounds(s(t))},addItineraryPointMarker:function(e,t){var o;o=t,u(e,L.circleMarker(o,m.config.itineraryPointMarker))},addSearchPointMarker:function(e,t,o){!function(e,t,o){var n=!1;if(o){var r=[];o.forEach(function(e){r=r.concat(e)});var a=s(r),i=m.map.getBounds();n=.01<(a.getEast()-a.getWest())/(i.getEast()-i.getWest())&&.01<(a.getNorth()-a.getSouth())/(i.getNorth()-i.getSouth())}u(e,n?L.polyline(o,m.config.searchPointPolyline):L.circleMarker(t,m.config.searchPointMarker))}(e,t,o)},addRectangle:function(e,t,o){var n,r;n=t,r=o,u(e,L.rectangle(n,r))},addWayPoint:function(e,t){g(e,t)},redrawNote:function(e){var t;a((t=e).objId),p(t)},addNote:function(e,t){p(e,t)},editNote:function(e){var t,o,n,r;t=e,o=L.divIcon({iconSize:[t.iconWidth,t.iconHeight],iconAnchor:[t.iconWidth/2,t.iconHeight/2],popupAnchor:[0,-t.iconHeight/2],html:t.iconContent,className:m.config.note.style}),n=m.mapObjects.get(t.objId),(r=n.getLayer(n.markerId)).setIcon(o),r.unbindTooltip(),0!==t.tooltipContent.length&&(r.bindTooltip(function(e){return d.getNoteAndRoute(e.objId).note.tooltipContent}),r.getTooltip().options.offset[0]=t.iconWidth/2),r.isPopupOpen()&&(r.closePopup(),r.openPopup())}})})}()},{"../Data/DataSearchEngine":2,"../L.TravelNotes":7,"../UI/ContextMenu":11,"../UI/ContextMenuFactory":12,"../UI/DataPanesUI":13,"../core/NoteEditor":34,"../core/RouteEditor":36,"../core/TravelEditor":39,"../core/WaypointEditor":40,"../util/Utilities":57}],34:[function(c,e,t){!function(){"use strict";var d=c("../L.TravelNotes");void 0!==e&&e.exports&&(e.exports=function(){var r=c("../UI/Translator")(),l=c("../Data/DataSearchEngine")(),s=function(e){var t=c("../data/Note")();return t.latLng=e,t.iconLatLng=e,t},o=function(){for(var e=d.travel.notes.iterator;!e.done;)c("../core/MapEditor")().removeObject(e.value.objId);for(var t=d.travel.routes.iterator;!t.done;)for(e=t.value.notes.iterator;!e.done;)c("../core/MapEditor")().removeObject(e.value.objId)};return Object.seal({newRouteNote:function(e,t){var o,n,r,a;o=e,n=t,r=c("../core/RouteEditor")().getClosestLatLngDistance(l.getRoute(o),[n.latlng.lat,n.latlng.lng]),(a=s(r.latLng)).distance=r.distance,c("../UI/NoteDialog")(a,o,!0)},newSearchNote:function(e){var t,o;(o=s([(t=e).lat,t.lon])).address=(t.tags["addr:housenumber"]?t.tags["addr:housenumber"]+" ":"")+(t.tags["addr:street"]?t.tags["addr:street"]+" ":"")+(t.tags["addr:city"]?t.tags["addr:city"]+" ":""),o.url=t.tags.website||"",o.phone=t.tags.phone||"",o.tooltipContent=t.tags.name||"",o.popupContent=t.tags.name||"",c("../UI/NoteDialog")(o,-1,!0)},newManeuverNote:function(e,t){var o,n,r,a,i;o=e,n=t,r=c("../core/RouteEditor")().getClosestLatLngDistance(d.editedRoute,n),a=d.editedRoute.itinerary.maneuvers.getAt(o),(i=s(n)).distance=r.distance,i.iconContent="<div class='TravelNotes-ManeuverNote TravelNotes-ManeuverNote-"+a.iconName+"'></div>",i.popupContent=a.instruction,i.iconWidth=40,i.iconHeight=40,c("../UI/NoteDialog")(i,d.editedRoute.objId,!0)},newTravelNote:function(e){var t;t=s(e),c("../UI/NoteDialog")(t,-1,!0)},afterNoteDialog:function(e,t){!function(e,t){var o=l.getNoteAndRoute(e.objId);if(o.note)c("../core/MapEditor")().editNote(e),o.route?c("../UI/DataPanesUI")().setItinerary():c("../UI/DataPanesUI")().setTravelNotes();else{if(-1===t)d.travel.notes.add(e),c("../UI/DataPanesUI")().setTravelNotes();else{var n=l.getRoute(t);n.notes.add(e),e.chainedDistance=n.chainedDistance,n.notes.sort(function(e,t){return e.distance-t.distance}),c("../UI/DataPanesUI")().setItinerary()}c("../core/MapEditor")().addNote(e)}c("../core/TravelEditor")().updateRoadBook()}(e,t)},editNote:function(e){var t,o;t=e,o=l.getNoteAndRoute(t),c("../UI/NoteDialog")(o.note,null===o.route?-1:o.route.objId,!1)},removeNote:function(e){!function(e){c("../core/MapEditor")().removeObject(e);var t=l.getNoteAndRoute(e);t.route?(t.route.notes.remove(e),c("../UI/DataPanesUI")().updateItinerary()):(d.travel.notes.remove(e),c("../UI/DataPanesUI")().updateTravelNotes()),c("../core/TravelEditor")().updateRoadBook()}(e)},hideNotes:function(){o()},showNotes:function(){!function(){o();for(var e=d.travel.notes.iterator;!e.done;)c("../core/MapEditor")().addNote(e.value);for(var t=d.travel.routes.iterator;!t.done;)for(e=t.value.notes.iterator;!e.done;)c("../core/MapEditor")().addNote(e.value)}()},zoomToNote:function(e){var t;t=e,c("../core/MapEditor")().zoomToPoint(l.getNoteAndRoute(t).note.latLng)},attachNoteToRoute:function(e){var t,n,r,a,i,s;t=e,n=l.getNoteAndRoute(t),r=Number.MAX_VALUE,s=i=a=null,d.travel.routes.forEach(function(e){var t=c("../core/RouteEditor")().getClosestLatLngDistance(e,n.note.latLng);if(t){var o=L.latLng(n.note.latLng).distanceTo(L.latLng(t.latLng));o<r&&(r=o,a=e,i=t.latLng,s=t.distance)}}),a&&(d.travel.notes.remove(t),n.note.distance=s,n.note.latLng=i,n.note.chainedDistance=a.chainedDistance,a.notes.add(n.note),a.notes.sort(function(e,t){return e.distance-t.distance}),c("../core/MapEditor")().redrawNote(n.note),c("../UI/DataPanesUI")().updateItinerary(),c("../UI/DataPanesUI")().updateTravelNotes(),c("../core/TravelEditor")().updateRoadBook())},detachNoteFromRoute:function(e){var t,o;t=e,(o=l.getNoteAndRoute(t)).route.notes.remove(t),o.note.distance=-1,o.note.chainedDistance=0,d.travel.notes.add(o.note),c("../UI/DataPanesUI")().updateItinerary(),c("../UI/DataPanesUI")().updateTravelNotes(),c("../core/TravelEditor")().updateRoadBook()},noteDropped:function(e,t,o){var n,r,a;n=e,r=t,a=o,d.travel.notes.moveTo(n,r,a),c("../UI/DataPanesUI")().updateTravelNotes(),c("../core/TravelEditor")().updateRoadBook()},getNoteHTML:function(e,t){return function(e,t){var o="";0!==e.tooltipContent.length&&(o+='<div class="'+t+'NoteHtml-TooltipContent">'+e.tooltipContent+"</div>"),0!==e.popupContent.length&&(o+='<div class="'+t+'NoteHtml-PopupContent">'+e.popupContent+"</div>"),0!==e.address.length&&(o+='<div class="'+t+'NoteHtml-Address">'+r.getText("NoteEditor - Address")+e.address+"</div>"),0!==e.phone.length&&(o+='<div class="'+t+'NoteHtml-Phone">'+r.getText("NoteEditor - Phone")+e.phone+"</div>"),0!==e.url.length&&(o+='<div class="'+t+'NoteHtml-Url">'+r.getText("NoteEditor - Link")+'<a href="'+e.url+'" target="_blank">'+e.url.substr(0,40)+"...</a></div>");var n=c("../util/Utilities")();return o+='<div class="'+t+'NoteHtml-LatLng">'+r.getText("NoteEditor - Latitude Longitude",{lat:n.formatLat(e.lat),lng:n.formatLng(e.lng)})+"</div>",-1!==e.distance&&(o+='<div class="'+t+'NoteHtml-Distance">'+r.getText("NoteEditor - Distance",{distance:n.formatDistance(e.chainedDistance+e.distance)})+"</div>"),o}(e,t)}})})}()},{"../Data/DataSearchEngine":2,"../L.TravelNotes":7,"../UI/DataPanesUI":13,"../UI/NoteDialog":19,"../UI/Translator":25,"../core/MapEditor":33,"../core/RouteEditor":36,"../core/TravelEditor":39,"../data/Note":48,"../util/Utilities":57}],35:[function(c,u,e){!function(){"use strict";var o=c("../L.TravelNotes"),t=!1,n={searchPhrase:"",bbox:null},e=-1,r=-1,a=window.osmSearch?window.osmSearch.searchLimits:null,i=function(){n.bbox&&(-1!==e?c("../core/MapEditor")().removeObject(e):e=c("../data/ObjId")(),c("../core/MapEditor")().addRectangle(e,L.latLngBounds(n.bbox.southWest,n.bbox.northEast),o.config.previousSearchLimit))},s=function(e){o.searchData=e,t=!1,i(),c("../UI/DataPanesUI")().updateSearch()},l=function(e){console.log(e),t=!1},d=function(e){var t=o.map.getCenter();-1!==r?c("../core/MapEditor")().removeObject(r):r=c("../data/ObjId")(),c("../core/MapEditor")().addRectangle(r,L.latLngBounds(L.latLng(t.lat-a.lat,t.lng-a.lng),L.latLng(t.lat+a.lat,t.lng+a.lng)),o.config.nextSearchLimit)};void 0!==u&&u.exports&&(u.exports=function(){return Object.seal({search:function(){!function(){if(!t){t=!0;var e=o.map.getBounds();n={bbox:{southWest:e.getSouthWest(),northEast:e.getNorthEast()},searchPhrase:document.getElementById("TravelNotes-Control-SearchInput").value},o.searchData=[],window.osmSearch.getSearchPromise(n).then(s,l)}}()},show:function(){o.map.on("zoom",d),o.map.on("move",d),d(),i()},hide:function(){o.map.off("zoom",d),o.map.off("move",d),-1!==r&&(c("../core/MapEditor")().removeObject(r),r=-1),-1!==e&&(c("../core/MapEditor")().removeObject(e),e=-1)}})})}()},{"../L.TravelNotes":7,"../UI/DataPanesUI":13,"../core/MapEditor":33,"../data/ObjId":49}],36:[function(v,e,t){!function(){"use strict";var c=v("../L.TravelNotes"),s=!1;void 0!==e&&e.exports&&(e.exports=function(){var n=v("../Data/DataSearchEngine")(),i=v("../UI/Translator")(),r=(v("../core/NoteEditor")(),v("../core/MapEditor")()),o=v("../UI/RouteEditorUI")(),u=function(e,t){if(0===e.itinerary.itineraryPoints.length)return null;for(var o=e.itinerary.itineraryPoints.iterator,n=(o.done,Number.MAX_VALUE),r=L.Projection.SphericalMercator.project(L.latLng(t[0],t[1])),a=L.Projection.SphericalMercator.project(L.latLng(o.value.lat,o.value.lng)),i=null,s=0,l=o.value.distance;!o.done;){var d=L.Projection.SphericalMercator.project(L.latLng(o.value.lat,o.value.lng)),c=L.LineUtil.pointToSegmentDistance(r,a,d);c<n&&(n=c,s=l-(i=L.Projection.SphericalMercator.unproject(L.LineUtil.closestPointOnSegment(r,a,d))).distanceTo(L.latLng(o.value.lat,o.value.lng))),l+=o.value.distance,a=d}return{latLng:[i.lat,i.lng],distance:s}},a=function(){for(var e=c.travel.routes.iterator,t=0;!e.done;){e.value.chain?(e.value.chainedDistance=t,t+=e.value.distance):e.value.chainedDistance=0;for(var o=e.value.notes.iterator;!o.done;)o.value.chainedDistance=e.value.chainedDistance}},t=function(){r.removeRoute(c.editedRoute,!0,!0),-1!==c.routeEdition.routeInitialObjId&&r.addRoute(n.getRoute(c.routeEdition.routeInitialObjId),!0,!1),c.editedRoute=v("../data/Route")(),c.routeEdition.routeChanged=!1,c.routeEdition.routeInitialObjId=-1,v("../UI/TravelEditorUI")().setRoutesList(),o.setWayPointsList(),o.reduce(),v("../UI/DataPanesUI")().setItinerary(),a(),v("../core/TravelEditor")().updateRoadBook()};return Object.seal({cutRoute:function(e,t){return function(e,t){var o=[v("../data/Route")(),v("../data/Route")()];o[0].object=e.object,o[1].object=e.object,o[0].itinerary.itineraryPoints.removeAll(),o[1].itinerary.itineraryPoints.removeAll();for(var n,r=u(e,t),a=e.itinerary.itineraryPoints.iterator,i=0,s=null,l=0;!a.done;){if((n=v("../data/ItineraryPoint")()).object=a.value.object,0===l&&0!=i&&i>r.distance){var d=L.latLng(r.latLng).distanceTo(L.latLng(a.value.latLng)),c=v("../data/ItineraryPoint")();c.latLng=r.latLng,o[0].itinerary.itineraryPoints.add(c),o[0].distance=i-d,s&&(s.distance-=d),l=1,(c=v("../data/ItineraryPoint")()).latLng=r.latLng,c.distance=d,o[1].itinerary.itineraryPoints.add(c),i=d}o[l].itinerary.itineraryPoints.add(n),i+=a.value.distance,s=n}return o[l].distance=i,o}(e,t)},computeRouteDistances:function(e){!function(e){var t=e.itinerary.itineraryPoints.iterator,o=e.itinerary.maneuvers.iterator;t.done,o.done;var n=t.value,r=o.value;for(r.distance=0,o.done,e.distance=0,e.duration=0;!t.done;)n.distance=L.latLng(n.latLng).distanceTo(L.latLng(t.value.latLng)),o.value.itineraryPointObjId===t.value.objId&&(e.duration+=r.duration,r=o.value,o.value.distance=0,o.done),e.distance+=n.distance,r.distance+=n.distance,n=t.value}(e)},getClosestLatLngDistance:function(e,t){return u(e,t)},saveGpx:function(){!function(){var e="\n\t",t="\n\t\t",o="time='"+(new Date).toISOString()+"' ",n="<?xml version='1.0'?>\n";n+="<gpx xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xsi:schemaLocation='http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd' version='1.1' creator='leaflet.TravelNotes'>";for(var r=c.editedRoute.wayPoints.iterator;!r.done;)n+=e+"<wpt lat='"+r.value.lat+"' lon='"+r.value.lng+"' "+o+"/>";n+=e+"<rte>";for(var a=c.editedRoute.itinerary.maneuvers.iterator;!a.done;){var i=c.editedRoute.itinerary.itineraryPoints.getAt(a.value.itineraryPointObjId),s=a.value.instruction.replace("&","&amp;").replace("'","&apos;").replace('"',"&quote;").replace(">","&gt;").replace("<","&lt;");n+=t+"<rtept lat='"+i.lat+"' lon='"+i.lng+"' "+o+"desc='"+s+"' />"}n+=e+"</rte>",n+=e+"<trk>",n+=t+"<trkseg>";for(var l=c.editedRoute.itinerary.itineraryPoints.iterator;!l.done;)n+="\n\t\t\t<trkpt lat='"+l.value.lat+"' lon='"+l.value.lng+"' "+o+" />";n+=t+"</trkseg>",n+=e+"</trk>",n+="\n</gpx>";var d=c.editedRoute.name;""===d&&(d="TravelNote"),d+=".gpx",v("../util/Utilities")().saveFile(d,n)}()},getRouteHTML:function(e,t){return o=e,n=t,r=v("../util/Utilities")(),a='<div class="'+n+'Route-Header-Name">'+o.name+"</div>",0!==o.distance&&(a+='<div class="'+n+'Route-Header-Distance">'+i.getText("RouteEditor - Distance",{distance:r.formatDistance(o.distance)})+'</div><div class="'+n+'Route-Header-Duration">'+i.getText("RouteEditor - Duration",{duration:r.formatTime(o.duration)})+"</div>"),a;var o,n,r,a},chainRoutes:function(){a()},startRouting:function(){c.config.routing.auto&&(s=0===c.editedRoute.itinerary.itineraryPoints.length,v("../core/Router")().startRouting(c.editedRoute))},endRouting:function(){!function(){r.removeRoute(c.editedRoute,!0,!0);for(var e=c.editedRoute.notes.iterator;!e.done;){var t=u(c.editedRoute,e.value.latLng);e.value.latLng=t.latLng,e.value.distance=t.distance}c.editedRoute.notes.sort(function(e,t){return e.distance-t.distance}),r.addRoute(c.editedRoute,!0,!0),s&&r.zoomToRoute(c.editedRoute.objId),v("../UI/DataPanesUI")().setItinerary(),o.setWayPointsList(),a(),v("../core/TravelEditor")().updateRoadBook()}()},saveEdition:function(){var e;(e=v("../data/Route")()).object=c.editedRoute.object,c.travel.routes.replace(c.routeEdition.routeInitialObjId,e),c.routeEdition.routeInitialObjId=e.objId,t()},cancelEdition:function(){t()},routeProperties:function(e){var t,o;t=e,o=n.getRoute(t),v("../UI/RoutePropertiesDialog")(o)},hideRoute:function(e){var t,o;t=e,(o=n.getRoute(t))&&(r.removeRoute(o,!0,!0),o.hidden=!0)},showRoutes:function(){!function(){for(var e=c.travel.routes.iterator;!e.done;)e.value.hidden&&r.addRoute(e.value,!0,!0,!1)}()}})})}()},{"../Data/DataSearchEngine":2,"../L.TravelNotes":7,"../UI/DataPanesUI":13,"../UI/RouteEditorUI":21,"../UI/RoutePropertiesDialog":22,"../UI/Translator":25,"../UI/TravelEditorUI":26,"../core/MapEditor":33,"../core/NoteEditor":34,"../core/Router":37,"../core/TravelEditor":39,"../data/ItineraryPoint":46,"../data/Route":51,"../util/Utilities":57}],37:[function(a,e,t){!function(){"use strict";var n=!1,r=a("../L.TravelNotes");void 0!==e&&e.exports&&(e.exports=function(){var t=function(e){n=!1,a("../core/ErrorEditor")().showError(e)},o=function(e){n=!1,a("./RouteEditor")().computeRouteDistances(r.editedRoute);for(var t=r.editedRoute.wayPoints.iterator;!t.done;)t.first?t.value.latLng=r.editedRoute.itinerary.itineraryPoints.first.latLng:t.last?t.value.latLng=r.editedRoute.itinerary.itineraryPoints.last.latLng:t.value.latLng=a("./RouteEditor")().getClosestLatLngDistance(r.editedRoute,t.value.latLng).latLng;a("./RouteEditor")().endRouting()},e=function(){if(n)return!1;if(!r.editedRoute.wayPoints.forEach(function(e,t){return null===t&&(t=!0),t&=0!==e.lat&&0!==e.lng}))return!1;n=!0;var e=r.providers.get(r.routing.provider);return r.editedRoute.itinerary.provider=e.name,r.editedRoute.itinerary.transitMode=r.routing.transitMode,e.getPromiseRoute(r.editedRoute,null).then(o,t),!0};return Object.seal({startRouting:function(){return e()}})})}()},{"../L.TravelNotes":7,"../core/ErrorEditor":30,"./RouteEditor":36}],38:[function(e,t,o){!function(){"use strict";var C=e("../L.TravelNotes"),D=!1;void 0!==t&&t.exports&&(t.exports=function(){var p=L.latLng(0,0),m=0,n=null,r={},a=0,i=[],s="",l=new Map,d=new Map,c=null,T=L.point(0,0),f="",N=0,I=null,h=e("../L.TravelNotes").config.note.svgIconWidth,E=e("../Data/DataSearchEngine")(),u=function(e){D=!1},v=function(e){D=!1,n({svg:c.outerHTML,direction:I})},g=function(e,t){var o;l.clear(),d.clear(),r.elements.forEach(function(e){switch(e.type){case"way":e.nodesIds=e.nodes,delete e.nodes,l.set(e.id,e);break;case"node":d.set(e.id,e)}}),(c=document.createElementNS("http://www.w3.org/2000/svg","svg")).setAttributeNS(null,"viewBox",h/4+" "+h/4+" "+h/2+" "+h/2),c.setAttributeNS(null,"class","TravelNotes-SvgIcon"),(o=document.createElementNS("http://www.w3.org/2000/svg","polyline")).setAttributeNS(null,"points",f),o.setAttributeNS(null,"class","TravelNotes-OSM-Itinerary"),o.setAttributeNS(null,"transform","rotate("+N+","+h/2+","+h/2+")"),c.appendChild(o),l.forEach(function(e){var n="";e.nodesIds.forEach(function(e){var t=d.get(e),o=C.map.project(L.latLng(t.lat,t.lon),17).add(T);n+=o.x.toFixed(0)+","+o.y.toFixed(0)+" "});var t=document.createElementNS("http://www.w3.org/2000/svg","polyline");t.setAttributeNS(null,"points",n),t.setAttributeNS(null,"class","TravelNotes-OSM-Highway TravelNotes-OSM-Highway-"+e.tags.highway),t.setAttributeNS(null,"transform","rotate("+N+","+h/2+","+h/2+")"),c.appendChild(t)}),e("")},y=function(e,t){var o=new XMLHttpRequest;o.timeout=5e3,o.ontimeout=function(e){t("TimeOut error")},o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status){try{r=JSON.parse(o.responseText)}catch(e){t("JSON parsing error")}e(new Promise(i[a++]))}else t("Status : "+this.status+" statusText : "+this.statusText)},o.open("GET",s,!0),o.overrideMimeType("application/json"),o.send(null)},b=function(e,t,o){if(D)return!1;D=!0,p=L.latLng(e),m=t,n=o,r={},c=null,function(){var e=E.getRoute(m);if(e){var o=Number.MAX_VALUE,n=-1,r=0,t=e.itinerary.itineraryPoints.object;t.forEach(function(e){var t=p.distanceTo(L.latLng(e.lat,e.lng));t<o&&(o=t,n=r),r++}),p=L.latLng(e.itinerary.itineraryPoints.getAt(t[n].objId).latLng),T=L.point(h/2,h/2).subtract(C.map.project(p,17));var a=C.map.project(L.latLng(t[n].lat,t[n].lng),17).add(T);r=n;for(var i=0;0<r--&&i<100;)i+=t[r].distance;var s=r;for(s<0&&(s=0),r=n,i=0;0<r--&&i<10;)i+=t[r].distance;var l=r;if(0<=l){var d=C.map.project(L.latLng(t[l].lat,t[l].lng),17).add(T);(N=180*Math.atan((a.y-d.y)/(d.x-a.x))/Math.PI)<0&&(N+=360),N-=270,d.x-a.x<0&&(N+=180)}for(r=n,i=0;r<n+1||r<t.length&&i<100;)i+=t[r].distance,r++;var c=r;for(c>=t.length&&(c=t.length-1),r=n,i=0;r<n+1||r<t.length&&i<10;)i+=t[r].distance,r++;var u=r;if(u<t.length){var v=C.map.project(L.latLng(t[u].lat,t[u].lng),17).add(T);for(I=180*Math.atan((a.y-v.y)/(v.x-a.x))/Math.PI,v.x-a.x<0&&(I+=180),I-=N;I<0;)I+=360;for(;360<I;)I-=360;l<0&&(N=-I-90,I=null)}else I=null;for(f="",r=s;r<=c;r++){var g=C.map.project(L.latLng(t[r].lat,t[r].lng),17).add(T);f+=g.x.toFixed(0)+","+g.y.toFixed(0)+" "}}}(),s="https://lz4.overpass-api.de/api/interpreter?data=[out:json];way[highway](around:"+h+","+p.lat.toFixed(6)+","+p.lng.toFixed(6)+")->.a;(.a >;.a;);out;",a=0,(i=[]).push(y),i.push(g),new Promise(i[a++]).then(v,u)};return Object.seal({getSvgIcon:function(e,t,o){return b(e,t,o)}})})}()},{"../Data/DataSearchEngine":2,"../L.TravelNotes":7}],39:[function(c,e,t){!function(){"use strict";var d=c("../L.TravelNotes"),o=!1,n=!1;void 0!==e&&e.exports&&(e.exports=function(){var i=c("../UI/Translator")(),s=c("../UI/TravelEditorUI")(),l=function(e){if(n||(window.addEventListener("unload",function(e){localStorage.removeItem(c("../L.TravelNotes").UUID+"-TravelNotesHTML")}),n=!0),e||o||!d.config.haveBeforeUnloadWarning||(window.addEventListener("beforeunload",function(e){return e.returnValue="x"}),o=!0),c("../util/Utilities")().storageAvailable("localStorage")){var t=c("../UI/HTMLViewsFactory")();t.classNamePrefix="TravelNotes-Roadbook-",localStorage.setItem(d.UUID+"-TravelNotesHTML",t.travelHTML.outerHTML)}},e=function(){return!o||window.confirm(i.getText("TravelEditor - This page ask to close; data are perhaps not saved."))};return Object.seal({updateRoadBook:function(e){l(e)},addRoute:function(){d.travel.routes.add(c("../Data/Route")()),s.setRoutesList(),c("../core/RouteEditor")().chainRoutes(),l()},removeRoute:function(e){var t;(t=e)===d.routeEdition.routeInitialObjId&&d.routeEdition.routeChanged?c("./ErrorEditor")().showError(i.getText("TravelEditor - Cannot remove an edited route")):(c("./MapEditor")().removeRoute(c("../Data/DataSearchEngine")().getRoute(t),!0,!0),d.travel.routes.remove(t),s.setRoutesList(),t===d.routeEdition.routeInitialObjId&&c("./RouteEditor")().cancelEdition(),c("../core/RouteEditor")().chainRoutes(),l())},editRoute:function(e){!function(e){if(d.routeEdition.routeChanged)c("../core/ErrorEditor")().showError(i.getText("RouteEditor - Not possible to edit a route without a save or cancel"));else{-1!==d.routeEdition.routeInitialObjId&&c("../core/RouteEditor")().cancelEdition();var t=c("../data/DataSearchEngine")().getRoute(e),o=t.itinerary.provider;if(!o||""===o||d.providers.get(o.toLowerCase())){c("../UI/ProvidersToolbarUI")().provider=o;var n=t.itinerary.transitMode;n&&""!==n&&(c("../UI/ProvidersToolbarUI")().transitMode=n),d.editedRoute=c("../data/Route")(),d.editedRoute.object=t.object,d.routeEdition.routeInitialObjId=t.objId,d.editedRoute.hidden=!1,t.hidden=!1;var r=c("../core/MapEditor")();r.removeRoute(t,!0,!1),r.addRoute(d.editedRoute,!0,!0),c("../core/RouteEditor")().chainRoutes();var a=c("../UI/RouteEditorUI")();a.expand(),a.setWayPointsList(),c("../UI/DataPanesUI")().setItinerary()}else c("../core/ErrorEditor")().showError(i.getText("RouteEditor - Not possible to edit a route created with this provider",{provider:o}))}}(e)},renameRoute:function(e,t){var o,n;o=e,n=t,c("../Data/DataSearchEngine")().getRoute(o).name=n,s.setRoutesList(),o===d.routeEdition.routeInitialObjId&&(d.editedRoute.name=n),l()},swapRoute:function(e,t){var o,n;o=e,n=t,d.travel.routes.swap(o,n),s.setRoutesList(),c("../core/RouteEditor")().chainRoutes(),l()},routeDropped:function(e,t,o){var n,r,a;n=e,r=t,a=o,d.travel.routes.moveTo(n,r,a),s.setRoutesList(),c("../core/RouteEditor")().chainRoutes(),l()},saveTravel:function(){!function(){if(d.routeEdition.routeChanged)c("./ErrorEditor")().showError(i.getText("TravelEditor - Not possible to save a travel without a save or cancel"));else{for(var e=d.travel.routes.iterator;!e.done;)e.value.hidden=!1;var t=d.travel.object;t.routes.forEach(function(e){var t={};0!==e.itinerary.itineraryPoints.length&&(t=e.itinerary.itineraryPoints[0].objType);var o={latLngs:[],distances:[],objIds:[],objType:t};e.itinerary.itineraryPoints.forEach(function(e){o.latLngs.push([e.lat,e.lng]),o.distances.push(e.distance),o.objIds.push(e.objId)}),o.latLngs=c("@mapbox/polyline").encode(o.latLngs,6),e.itinerary.itineraryPoints=o}),c("../util/Utilities")().saveFile(t.name+".trv",JSON.stringify(t))}}()},confirmClose:function(){return e()},clear:function(){e()&&(c("../core/MapEditor")().removeAllObjects(),d.editedRoute=c("../Data/Route")(),d.routeEdition.routeChanged=!1,d.routeEdition.routeInitialObjId=-1,d.travel=c("../Data/Travel")(),d.travel.routes.add(c("../Data/Route")()),c("../UI/TravelEditorUI")().setRoutesList(),c("../UI/RouteEditorUI")().setWayPointsList(),c("../UI/DataPanesUI")().setItinerary(),l(!0))}})})}()},{"../Data/DataSearchEngine":2,"../Data/Route":4,"../Data/Travel":5,"../L.TravelNotes":7,"../UI/DataPanesUI":13,"../UI/HTMLViewsFactory":16,"../UI/ProvidersToolbarUI":20,"../UI/RouteEditorUI":21,"../UI/Translator":25,"../UI/TravelEditorUI":26,"../core/ErrorEditor":30,"../core/MapEditor":33,"../core/RouteEditor":36,"../data/DataSearchEngine":44,"../data/Route":51,"../util/Utilities":57,"./ErrorEditor":30,"./MapEditor":33,"./RouteEditor":36,"@mapbox/polyline":1}],40:[function(c,e,t){!function(){"use strict";var d=c("../L.TravelNotes");void 0!==e&&e.exports&&(e.exports=function(){var r=c("../core/MapEditor")(),a=c("../core/RouteEditor")(),i=c("../UI/RouteEditorUI")(),s=function(e,t){d.routeEdition.routeChanged=!0;var o=c("../data/Waypoint.js")();if(e&&(o.latLng=e,d.config.wayPoint.reverseGeocoding&&c("../core/GeoCoder")().getAddress(e[0],e[1],l,o.objId)),d.editedRoute.wayPoints.add(o),r.addWayPoint(d.editedRoute.wayPoints.last,d.editedRoute.wayPoints.length-2),t){for(var n=d.editedRoute.wayPoints.iterator;!n.done;)if(t<a.getClosestLatLngDistance(d.editedRoute,n.value.latLng).distance){d.editedRoute.wayPoints.moveTo(o.objId,n.value.objId,!0);break}}else d.editedRoute.wayPoints.swap(o.objId,!0);i.setWayPointsList(),a.startRouting()},l=function(e,t){d.routeEdition.routeChanged=!0,d.editedRoute.wayPoints.getAt(t).name=e,i.setWayPointsList()};return Object.seal({addWayPoint:function(e){s(e)},addWayPointOnRoute:function(e,t){var o,n,r;o=e,n=t,r=a.getClosestLatLngDistance(c("../Data/DataSearchEngine")().getRoute(o),[n.latlng.lat,n.latlng.lng]),s(r.latLng,r.distance)},reverseWayPoints:function(){!function(){d.routeEdition.routeChanged=!0;for(var e=d.editedRoute.wayPoints.iterator;!e.done;)r.removeObject(e.value.objId);for(d.editedRoute.wayPoints.reverse(),e=d.editedRoute.wayPoints.iterator;!e.done;)r.addWayPoint(e.value,e.first?"A":e.last?"B":e.index);i.setWayPointsList(),a.startRouting()}()},removeAllWayPoints:function(){!function(){d.routeEdition.routeChanged=!0;for(var e=d.editedRoute.wayPoints.iterator;!e.done;)r.removeObject(e.value.objId);d.editedRoute.wayPoints.removeAll(!0),i.setWayPointsList(),a.startRouting()}()},removeWayPoint:function(e){var t;t=e,d.routeEdition.routeChanged=!0,r.removeObject(t),d.editedRoute.wayPoints.remove(t),i.setWayPointsList(),a.startRouting()},renameWayPoint:function(e,t){l(e,t)},swapWayPoints:function(e,t){var o,n;o=e,n=t,d.routeEdition.routeChanged=!0,d.editedRoute.wayPoints.swap(o,n),i.setWayPointsList(),a.startRouting()},setStartPoint:function(e){var t;t=e,d.routeEdition.routeChanged=!0,0!==d.editedRoute.wayPoints.first.lat&&r.removeObject(d.editedRoute.wayPoints.first.objId),d.editedRoute.wayPoints.first.latLng=t,d.config.wayPoint.reverseGeocoding&&c("../core/GeoCoder")().getAddress(t[0],t[1],l,d.editedRoute.wayPoints.first.objId),r.addWayPoint(d.editedRoute.wayPoints.first,"A"),i.setWayPointsList(),a.startRouting()},setEndPoint:function(e){var t;t=e,d.routeEdition.routeChanged=!0,0!==d.editedRoute.wayPoints.last.lat&&r.removeObject(d.editedRoute.wayPoints.last.objId),d.editedRoute.wayPoints.last.latLng=t,d.config.wayPoint.reverseGeocoding&&c("../core/GeoCoder")().getAddress(t[0],t[1],l,d.editedRoute.wayPoints.last.objId),r.addWayPoint(d.editedRoute.wayPoints.last,"B"),i.setWayPointsList(),a.startRouting()},wayPointDragEnd:function(e){!function(e){if(d.routeEdition.routeChanged=!0,d.config.wayPoint.reverseGeocoding){var t=d.editedRoute.wayPoints.getAt(e).latLng;c("../core/GeoCoder")().getAddress(t[0],t[1],l,e)}i.setWayPointsList(),a.startRouting()}(e)},wayPointDropped:function(e,t,o){!function(e,t,o){if(d.routeEdition.routeChanged=!0,(t!==d.editedRoute.wayPoints.first.objId||!o)&&(t!==d.editedRoute.wayPoints.last.objId||o)){d.editedRoute.wayPoints.moveTo(e,t,o),i.setWayPointsList();for(var n=d.editedRoute.wayPoints.iterator;!n.done;)r.removeObject(n.value.objId),r.addWayPoint(n.value,n.first?"A":n.last?"B":n.index);a.startRouting()}}(e,t,o)}})})}()},{"../Data/DataSearchEngine":2,"../L.TravelNotes":7,"../UI/RouteEditorUI":21,"../core/GeoCoder":32,"../core/MapEditor":33,"../core/RouteEditor":36,"../data/Waypoint.js":56}],41:[function(e,t,o){arguments[4][40][0].apply(o,arguments)},{"../Data/DataSearchEngine":2,"../L.TravelNotes":7,"../UI/RouteEditorUI":21,"../core/GeoCoder":32,"../core/MapEditor":33,"../core/RouteEditor":36,"../data/Waypoint.js":56,dup:40}],42:[function(i,e,t){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(e){var s=[],n=e,r=function(e){if(!e.objType||!e.objType.name||e.objType.name!==n)throw"invalid object name for add function";s.push(e)},l=function(t){return s.findIndex(function(e){return e.objId===t})},a=function(){var e=-1;return{get value(){return e<s.length?s[e]:null},get done(){return++e>=s.length},get first(){return 0===e},get last(){return e>=s.length-1},get index(){return e}}};return Object.seal({add:function(e){r(e)},forEach:function(e){return function(e){for(var t=null,o=a();!o.done;)t=e(o.value,t);return t}(e)},getAt:function(e){return-1===(t=l(e))?null:s[t];var t},moveTo:function(e,t,o){var n,r,a,i;n=t,r=o,a=l(e),i=l(n),r||i++,s.splice(i,0,s[a]),i<a&&a++,s.splice(a,1)},remove:function(e){!function(e){if(-1===l(e))throw"invalid objId for remove function";s.splice(l(e),1)}(e)},removeAll:function(e){e?s.splice(1,s.length-2):s.length=0},replace:function(e,t){!function(e,t){var o=l(e);if(-1===o)throw"invalid objId for replace function";s[o]=t}(e,t)},reverse:function(){s.reverse()},sort:function(e){var t;t=e,s.sort(t)},swap:function(e,t){!function(e,t){var o=l(e);if(-1===o||0===o&&t||s.length-1===o&&!t)throw"invalid objId for swap function";var n=s[o];s[o]=s[o+(t?-1:1)],s[o+(t?-1:1)]=n}(e,t)},get first(){return s[0]},get iterator(){return a()},get last(){return s[s.length-1]},get length(){return s.length},get object(){return function(){for(var e=[],t=a();!t.done;)e.push(t.value.object);return e}()},set object(e){var t,o;t=e,s.length=0,t.forEach(function(e){switch(n){case"Route":o=i("../data/Route")();break;case"Note":o=i("../data/Note")();break;case"WayPoint":o=i("../data/WayPoint")();break;case"Maneuver":o=i("../data/Maneuver")();break;case"ItineraryPoint":o=i("../data/ItineraryPoint")();break;default:throw"invalid ObjName ( "+n+" ) in Collection.m_SetObject"}o.object=e,r(o)})}})})}()},{"../data/ItineraryPoint":46,"../data/Maneuver":47,"../data/Note":48,"../data/Route":51,"../data/WayPoint":55}],43:[function(e,r,t){!function(){"use strict";var t,n,o;void 0!==r&&r.exports&&(r.exports=(t={contextMenu:{timeout:1500},errorMessages:{timeout:2e4},routing:{auto:!0},language:"fr",itineraryPointMarker:{color:"red",weight:2,radius:7,fill:!1},searchPointMarker:{color:"green",weight:4,radius:20,fill:!1},searchPointPolyline:{color:"green",weight:4,radius:20,fill:!1},previousSearchLimit:{color:"green",fill:!1,weight:1},nextSearchLimit:{color:"red",fill:!1,weight:1},wayPoint:{reverseGeocoding:!1},route:{color:"#ff0000",width:3,dashArray:0,dashChoices:[{text:"——————",iDashArray:null},{text:"— — — — —",iDashArray:[4,2]},{text:"—‧—‧—‧—‧—",iDashArray:[4,2,0,2]},{text:"················",iDashArray:[0,2]}]},note:{reverseGeocoding:!1,grip:{size:10,opacity:0},polyline:{color:"gray",weight:1},style:"TravelNotes-NotesStyle",svgIconWidth:200},itineraryPointZoom:17,routeEditor:{displayEditionInHTMLPage:!0},travelEditor:{clearAfterSave:!0,startMinimized:!0,timeout:1e3,startupRouteEdition:!0},haveBeforeUnloadWarning:!0},n=function(e,t){if("object"==typeof e&&"object"==typeof t)try{var o;for(o in t)"object"==typeof t[o]?n(e[o],t[o]):t[o]=e[o]||t[o];for(o in e)"object"==typeof e[o]?("[object Array]"==Object.prototype.toString.call(e[o])?t[o]=t[o]||[]:t[o]=t[o]||{},n(e[o],t[o])):t[o]=e[o]}catch(e){console.log(e),console.log("Not possible to overload Config")}},o=function(e){var t;for(t in e)"object"==typeof e[t]&&(e[t]=o(e[t]));return Object.freeze(e)},{get contextMenu(){return t.contextMenu},get errorMessages(){return t.errorMessages},get routing(){return t.routing},get language(){return t.language},get itineraryPointMarker(){return t.itineraryPointMarker},get searchPointMarker(){return t.searchPointMarker},get searchPointPolyline(){return t.searchPointPolyline},get previousSearchLimit(){return t.previousSearchLimit},get nextSearchLimit(){return t.nextSearchLimit},get wayPoint(){return t.wayPoint},get route(){return t.route},get note(){return t.note},get itineraryPointZoom(){return t.itineraryPointZoom},get routeEditor(){return t.routeEditor},get travelEditor(){return t.travelEditor},get haveBeforeUnloadWarning(){return t.haveBeforeUnloadWarning},overload:function(e){n(e,t),t=o(t)}}))}()},{}],44:[function(e,t,o){arguments[4][2][0].apply(o,arguments)},{"../L.TravelNotes":7,dup:2}],45:[function(e,t,o){arguments[4][3][0].apply(o,arguments)},{"../data/Collection":42,"../data/ObjId":49,"../data/ObjType":50,"./Version":54,dup:3}],46:[function(s,e,t){!function(){"use strict";var i=s("../data/ObjType")("ItineraryPoint",s("./Version"));void 0!==e&&e.exports&&(e.exports=function(){var o=0,n=0,r=0,a=s("../data/ObjId")();return Object.seal({get lat(){return o},set lat(e){o=e},get lng(){return n},set lng(e){n=e},get latLng(){return[o,n]},set latLng(e){o=e[0],n=e[1]},get distance(){return r},set distance(e){r=e},get objId(){return a},get objType(){return i},get object(){return{lat:parseFloat(o.toFixed(6)),lng:parseFloat(n.toFixed(6)),distance:parseFloat(r.toFixed(2)),objId:a,objType:i.object}},set object(e){var t;t=e,t=i.validate(t),o=t.lat||0,n=t.lng||0,r=t.distance||0,a=s("../data/ObjId")()}})})}()},{"../data/ObjId":49,"../data/ObjType":50,"./Version":54}],47:[function(d,e,t){!function(){"use strict";var l=d("../data/ObjType")("Maneuver",d("./Version"));void 0!==e&&e.exports&&(e.exports=function(){var o=d("../data/ObjId")(),n="",r="",a=-1,i=0,s=0;return Object.seal({get iconName(){return n},set iconName(e){n=e},get instruction(){return r},set instruction(e){r=e},get itineraryPointObjId(){return a},set itineraryPointObjId(e){a=e},get distance(){return i},set distance(e){i=e},get duration(){return s},set duration(e){s=e},get objId(){return o},get objType(){return l},get object(){return{iconName:n,instruction:r,distance:parseFloat(i.toFixed(2)),duration:s,itineraryPointObjId:a,objId:o,objType:l.object}},set object(e){var t;t=e,t=l.validate(t),n=t.iconName||"",r=t.instruction||"",i=t.distance||0,s=t.duration||0,a=t.itineraryPointObjId||-1,o=d("../data/ObjId")()}})})}()},{"../data/ObjId":49,"../data/ObjType":50,"./Version":54}],48:[function(N,e,t){!function(){"use strict";var f=N("../data/ObjType")("Note",N("./Version"));void 0!==e&&e.exports&&(e.exports=function(){var o=N("../data/ObjId")(),n=40,r=40,a="",i="",s="",l="",d="",c="",u=0,v=0,g=0,p=0,m=-1,T=0;return Object.seal({get isRouteNote(){return-1!==m},get iconHeight(){return n},set iconHeight(e){n=e},get iconWidth(){return r},set iconWidth(e){r=e},get iconContent(){return a},set iconContent(e){a=e},get popupContent(){return i},set popupContent(e){i=e},get tooltipContent(){return s},set tooltipContent(e){s=e},get phone(){return l},set phone(e){l=e},get url(){return d},set url(e){d=e},get address(){return c},set address(e){c=e},get iconLat(){return u},set iconLat(e){u=e},get iconLng(){return v},set iconLng(e){v=e},get iconLatLng(){return[u,v]},set iconLatLng(e){u=e[0],v=e[1]},get lat(){return g},set lat(e){g=e},get lng(){return p},set lng(e){p=e},get latLng(){return[g,p]},set latLng(e){g=e[0],p=e[1]},get distance(){return m},set distance(e){m=e},get chainedDistance(){return T},set chainedDistance(e){T=e},get objId(){return o},get objType(){return f},get object(){return{iconHeight:n,iconWidth:r,iconContent:a,popupContent:i,tooltipContent:s,phone:l,url:d,address:c,iconLat:parseFloat(u.toFixed(6)),iconLng:parseFloat(v.toFixed(6)),lat:parseFloat(g.toFixed(6)),lng:parseFloat(p.toFixed(6)),distance:parseFloat(m.toFixed(2)),chainedDistance:parseFloat(T.toFixed(2)),objId:o,objType:f.object}},set object(e){var t;t=e,t=f.validate(t),n=t.iconHeight||40,r=t.iconWidth||40,a=t.iconContent||"",i=t.popupContent||"",s=t.tooltipContent||"",l=t.phone||"",d=t.url||"",c=t.address||"",u=t.iconLat||0,v=t.iconLng||0,g=t.lat||0,p=t.lng||0,m=t.distance||-1,T=t.chainedDistance,o=N("../data/ObjId")()}})})}()},{"../data/ObjId":49,"../data/ObjType":50,"./Version":54}],49:[function(e,t,o){(function(e){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){return e.TravelNotesObjId||(e.TravelNotesObjId=0),++e.TravelNotesObjId})}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],50:[function(e,t,o){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(e,t){var o=e,n=t;return Object.seal({get name(){return o},get version(){return n},get object(){return{name:o,version:n}},validate:function(e){return function(e){if(!e.objType)throw"No objType for "+o;if(!e.objType.name)throw"No name for "+o;if(o!==e.objType.name)throw"Invalid name for "+o;if(!e.objType.version)throw"No version for "+o;if(n!==e.objType.version&&("1.0.0"===e.objType.version&&("Route"===e.objType.name&&(e.dashArray=0,e.hidden=!1),e.objType.version="1.1.0"),"1.1.0"===e.objType.version&&(e.objType.version="1.2.0"),"1.2.0"===e.objType.version&&(e.objType.version="1.3.0"),"1.3.0"===e.objType.version&&(e.objType.version="1.4.0"),n!==e.objType.version))throw"invalid version for "+o;if(!e.objId)throw"No objId for "+o;return e}(e)}})})}()},{}],51:[function(e,t,o){arguments[4][4][0].apply(o,arguments)},{"../L.TravelNotes":7,"../data/Collection":42,"../data/Itinerary":45,"../data/ObjId":49,"../data/ObjType":50,"../data/Waypoint":56,"./Itinerary":45,"./Version":54,dup:4}],52:[function(e,t,o){arguments[4][5][0].apply(o,arguments)},{"../data/Collection":42,"../data/ObjId":49,"../data/ObjType":50,"./Version":54,dup:5}],53:[function(e,t,o){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){var t={config:e("../data/Config"),map:null,providers:new Map,mapObjects:new Map,travel:e("../data/Travel")(),editedRoute:null,routeEdition:Object.seal({routeChanged:!1,routeInitialObjId:-1}),routing:Object.seal({provider:"",transitMode:""}),searchData:[],UUID:e("../util/Utilities")().UUID};return Object.seal({get config(){return t.config},set config(e){t.config.overload(e)},get map(){return t.map},set map(e){t.map=e},get providers(){return t.providers},get mapObjects(){return t.mapObjects},get travel(){return t.travel},set travel(e){t.travel=e},get editedRoute(){return t.editedRoute},set editedRoute(e){t.editedRoute=e},get routeEdition(){return t.routeEdition},get routing(){return t.routing},get searchData(){return t.searchData},set searchData(e){t.searchData=e},get UUID(){return t.UUID}})})}()},{"../data/Config":43,"../data/Travel":52,"../util/Utilities":57}],54:[function(e,t,o){arguments[4][6][0].apply(o,arguments)},{dup:6}],55:[function(s,e,t){!function(){"use strict";var i=s("../data/ObjType")("WayPoint",s("./Version"));void 0!==e&&e.exports&&(e.exports=function(){var o="",n=0,r=0,a=s("../data/ObjId")();return Object.seal({get name(){return o},set name(e){o=e},get UIName(){return""!==o?o:0!==n&&0!==r?n.toFixed(6)+(0<n?" N - ":" S - ")+r.toFixed(6)+(0<r?" E":" W"):""},get lat(){return n},set lat(e){n=e},get lng(){return r},set lng(e){r=e},get latLng(){return[n,r]},set latLng(e){n=e[0],r=e[1]},get objId(){return a},get objType(){return i},get object(){return{name:o,lat:parseFloat(n.toFixed(6)),lng:parseFloat(r.toFixed(6)),objId:a,objType:i.object}},set object(e){var t;t=e,t=i.validate(t),o=t.name||"",n=t.lat||0,r=t.lng||0,a=s("../data/ObjId")()}})})}()},{"../data/ObjId":49,"../data/ObjType":50,"./Version":54}],56:[function(e,t,o){arguments[4][55][0].apply(o,arguments)},{"../data/ObjId":49,"../data/ObjType":50,"./Version":54,dup:55}],57:[function(e,t,o){!function(){"use strict";var a=e("../UI/Translator")();void 0!==t&&t.exports&&(t.exports=function(){return{get UUID(){return function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}()},storageAvailable:function(e){try{var t=window[e],o="__storage_test__";return t.setItem(o,o),t.removeItem(o),!0}catch(e){return!1}},fileAPIAvailable:function(){try{return new File(["testdata"],{type:"text/plain"}),!0}catch(e){return!!window.navigator.msSaveOrOpenBlob}},saveFile:function(e,t,o){if(o||(o="text/plain"),window.navigator.msSaveOrOpenBlob)try{window.navigator.msSaveOrOpenBlob(new Blob([t]),e)}catch(e){}else try{var n=window.URL.createObjectURL(new File([t],{type:o})),r=document.createElement("a");r.setAttribute("href",n),r.setAttribute("download",e),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(n)}catch(e){}},formatTime:function(e){if(0===(e=Math.floor(e)))return"";var t=Math.floor(e/86400),o=Math.floor(e%86400/3600),n=Math.floor(e%3600/60),r=Math.floor(e%60);return 0<t?t+"&nbsp;"+a.getText("Utilities - Day")+"&nbsp;"+o+"&nbsp;"+a.getText("Utilities - Hour"):0<o?o+"&nbsp;"+a.getText("Utilities - Hour")+"&nbsp;"+n+"&nbsp;"+a.getText("Utilities - Minute"):0<n?n+"&nbsp;"+a.getText("Utilities - Minute"):r+"&nbsp;"+a.getText("Utilities - Second")},formatDistance:function(e){return 0===(e=Math.floor(e))?"":e<1e3?e.toFixed(0)+"&nbsp;m":Math.floor(e/1e3)+"."+Math.floor(e%1e3)+"&nbsp;km"},formatLat:function(e){return 0<e?e.toFixed(6)+"&nbsp;N":(-e).toFixed(6)+"&nbsp;S"},formatLng:function(e){return 0<e?e.toFixed(6)+"&nbsp;E":(-e).toFixed(6)+"&nbsp;W"},formatLatLng:function(e){return this.formatLat(e[0])+"&nbsp;-&nbsp;"+this.formatLng(e[1])}}})}()},{"../UI/Translator":25}]},{},[7]);