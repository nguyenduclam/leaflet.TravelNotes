/*! leaflet.travelnotes - version 1.5.0 - build 0002 - 2019-10-03T10:53:33+0200 - Copyright 2017 2019 wwwouaiebe - Contact: http//www.ouaie.be/ - This  program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or any later version.*/


!function r(i,s,l){function d(e,t){if(!s[e]){if(!i[e]){var o="function"==typeof require&&require;if(!t&&o)return o(e,!0);if(c)return c(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var a=s[e]={exports:{}};i[e][0].call(a.exports,function(t){return d(i[e][1][t]||t)},a,a.exports,r,i,s,l)}return s[e].exports}for(var c="function"==typeof require&&require,t=0;t<l.length;t++)d(l[t]);return d}({1:[function(t,e,o){"use strict";var n={};function r(t){return Math.floor(Math.abs(t)+.5)*(0<=t?1:-1)}function s(t,e,o){var n=(t=r(t*o))-(e=r(e*o));n<<=1,t-e<0&&(n=~n);for(var a="";32<=n;)a+=String.fromCharCode(63+(32|31&n)),n>>=5;return a+=String.fromCharCode(n+63)}function a(t){for(var e=[],o=0;o<t.length;o++)e.push(t[o].slice().reverse());return e}n.decode=function(t,e){for(var o,n=0,a=0,r=0,i=[],s=0,l=0,d=null,c=Math.pow(10,Number.isInteger(e)?e:5);n<t.length;){for(d=null,l=s=0;l|=(31&(d=t.charCodeAt(n++)-63))<<s,s+=5,32<=d;);for(o=1&l?~(l>>1):l>>1,s=l=0;l|=(31&(d=t.charCodeAt(n++)-63))<<s,s+=5,32<=d;);a+=o,r+=1&l?~(l>>1):l>>1,i.push([a/c,r/c])}return i},n.encode=function(t,e){if(!t.length)return"";for(var o=Math.pow(10,Number.isInteger(e)?e:5),n=s(t[0][0],0,o)+s(t[0][1],0,o),a=1;a<t.length;a++){var r=t[a],i=t[a-1];n+=s(r[0],i[0],o),n+=s(r[1],i[1],o)}return n},n.fromGeoJSON=function(t,e){if(t&&"Feature"===t.type&&(t=t.geometry),!t||"LineString"!==t.type)throw new Error("Input must be a GeoJSON LineString");return n.encode(a(t.coordinates),e)},n.toGeoJSON=function(t,e){return{type:"LineString",coordinates:a(n.decode(t,e))}},"object"==typeof e&&e.exports&&(e.exports=n)},{}],2:[function(v,t,e){!function(){"use strict";var c=v("../L.TravelNotes"),s=!1;void 0!==t&&t.exports&&(t.exports=function(){function o(){for(var t=c.travel.routes.iterator,e=0;!t.done;){t.value.chain?(t.value.chainedDistance=e,e+=t.value.distance):t.value.chainedDistance=0;for(var o=t.value.notes.iterator;!o.done;)o.value.chainedDistance=t.value.chainedDistance}}var n=v("../Data/DataSearchEngine")(),a=v("../UI/Translator")(),r=(v("../core/NoteEditor")(),v("../core/MapEditor")()),i=v("../UI/RouteEditorUI")(),u=function(t,e){if(0===t.itinerary.itineraryPoints.length)return null;for(var o=t.itinerary.itineraryPoints.iterator,n=(o.done,Number.MAX_VALUE),a=L.Projection.SphericalMercator.project(L.latLng(e[0],e[1])),r=L.Projection.SphericalMercator.project(L.latLng(o.value.lat,o.value.lng)),i=null,s=0,l=o.value.distance;!o.done;){var d=L.Projection.SphericalMercator.project(L.latLng(o.value.lat,o.value.lng)),c=L.LineUtil.pointToSegmentDistance(a,r,d);c<n&&(n=c,s=l-(i=L.Projection.SphericalMercator.unproject(L.LineUtil.closestPointOnSegment(a,r,d))).distanceTo(L.latLng(o.value.lat,o.value.lng))),l+=o.value.distance,r=d}return{latLng:[i.lat,i.lng],distance:s}},e=function(){r.removeRoute(c.editedRoute,!0,!0),-1!==c.routeEdition.routeInitialObjId&&r.addRoute(n.getRoute(c.routeEdition.routeInitialObjId),!0,!1),c.editedRoute=v("../data/Route")(),c.routeEdition.routeChanged=!1,c.routeEdition.routeInitialObjId=-1,v("../UI/TravelEditorUI")().setRoutesList(),i.setWayPointsList(),i.reduce(),v("../UI/DataPanesUI")().setItinerary(),o(),v("../core/TravelEditor")().updateRoadBook()};return Object.seal({cutRoute:function(t,e){return function(t,e){var o=[v("../data/Route")(),v("../data/Route")()];o[0].object=t.object,o[1].object=t.object,o[0].itinerary.itineraryPoints.removeAll(),o[1].itinerary.itineraryPoints.removeAll();for(var n,a=u(t,e),r=t.itinerary.itineraryPoints.iterator,i=0,s=null,l=0;!r.done;){if((n=v("../data/ItineraryPoint")()).object=r.value.object,0===l&&0!=i&&i>a.distance){var d=L.latLng(a.latLng).distanceTo(L.latLng(r.value.latLng)),c=v("../data/ItineraryPoint")();c.latLng=a.latLng,o[0].itinerary.itineraryPoints.add(c),o[0].distance=i-d,s&&(s.distance-=d),l=1,(c=v("../data/ItineraryPoint")()).latLng=a.latLng,c.distance=d,o[1].itinerary.itineraryPoints.add(c),i=d}o[l].itinerary.itineraryPoints.add(n),i+=r.value.distance,s=n}return o[l].distance=i,o}(t,e)},computeRouteDistances:function(t){!function(t){var e=t.itinerary.itineraryPoints.iterator,o=t.itinerary.maneuvers.iterator;e.done;o.done;var n=e.value,a=o.value;for(a.distance=0,o.done,t.distance=0,t.duration=0;!e.done;)n.distance=L.latLng(n.latLng).distanceTo(L.latLng(e.value.latLng)),o.value.itineraryPointObjId===e.value.objId&&(t.duration+=a.duration,a=o.value,o.value.distance=0,o.done),t.distance+=n.distance,a.distance+=n.distance,n=e.value}(t)},getClosestLatLngDistance:function(t,e){return u(t,e)},saveGpx:function(){!function(){var t="\n\t",e="\n\t\t",o="time='"+(new Date).toISOString()+"' ",n="<?xml version='1.0'?>\n";n+="<gpx xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xsi:schemaLocation='http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd' version='1.1' creator='leaflet.TravelNotes'>";for(var a=c.editedRoute.wayPoints.iterator;!a.done;)n+=t+"<wpt lat='"+a.value.lat+"' lon='"+a.value.lng+"' "+o+"/>";n+=t+"<rte>";for(var r=c.editedRoute.itinerary.maneuvers.iterator;!r.done;){var i=c.editedRoute.itinerary.itineraryPoints.getAt(r.value.itineraryPointObjId),s=r.value.instruction.replace("&","&amp;").replace("'","&apos;").replace('"',"&quote;").replace(">","&gt;").replace("<","&lt;");n+=e+"<rtept lat='"+i.lat+"' lon='"+i.lng+"' "+o+"desc='"+s+"' />"}n+=t+"</rte>",n+=t+"<trk>",n+=e+"<trkseg>";for(var l=c.editedRoute.itinerary.itineraryPoints.iterator;!l.done;)n+="\n\t\t\t<trkpt lat='"+l.value.lat+"' lon='"+l.value.lng+"' "+o+" />";n+=e+"</trkseg>",n+=t+"</trk>",n+="\n</gpx>";var d=c.editedRoute.name;""===d&&(d="TravelNote"),d+=".gpx",v("../util/Utilities")().saveFile(d,n)}()},getRouteHTML:function(t,e){return function(t,e){var o=v("../util/Utilities")(),n='<div class="'+e+'Route-Header-Name">'+t.name+"</div>";return 0!==t.distance&&(n+='<div class="'+e+'Route-Header-Distance">'+a.getText("RouteEditor - Distance",{distance:o.formatDistance(t.distance)})+'</div><div class="'+e+'Route-Header-Duration">'+a.getText("RouteEditor - Duration",{duration:o.formatTime(t.duration)})+"</div>"),n}(t,e)},chainRoutes:function(){o()},startRouting:function(){c.config.routing.auto&&(s=0===c.editedRoute.itinerary.itineraryPoints.length,v("../core/Router")().startRouting(c.editedRoute))},endRouting:function(){!function(){r.removeRoute(c.editedRoute,!0,!0);for(var t=c.editedRoute.notes.iterator;!t.done;){var e=u(c.editedRoute,t.value.latLng);t.value.latLng=e.latLng,t.value.distance=e.distance}c.editedRoute.notes.sort(function(t,e){return t.distance-e.distance}),r.addRoute(c.editedRoute,!0,!0),s&&r.zoomToRoute(c.editedRoute.objId),v("../UI/DataPanesUI")().setItinerary(),i.setWayPointsList(),o(),v("../core/TravelEditor")().updateRoadBook()}()},saveEdition:function(){!function(){var t=v("../data/Route")();t.object=c.editedRoute.object,c.travel.routes.replace(c.routeEdition.routeInitialObjId,t),c.routeEdition.routeInitialObjId=t.objId,e()}()},cancelEdition:function(){e()},routeProperties:function(t){!function(t){var e=n.getRoute(t);v("../UI/RoutePropertiesDialog")(e)}(t)},hideRoute:function(t){!function(t){var e=n.getRoute(t);e&&(r.removeRoute(e,!0,!0),e.hidden=!0)}(t)},showRoutes:function(){!function(){for(var t=c.travel.routes.iterator;!t.done;)t.value.hidden&&r.addRoute(t.value,!0,!0,!1)}()}})})}()},{"../Data/DataSearchEngine":3,"../L.TravelNotes":8,"../UI/DataPanesUI":14,"../UI/RouteEditorUI":22,"../UI/RoutePropertiesDialog":23,"../UI/Translator":26,"../UI/TravelEditorUI":27,"../core/MapEditor":34,"../core/NoteEditor":35,"../core/Router":38,"../core/TravelEditor":40,"../data/ItineraryPoint":47,"../data/Route":52,"../util/Utilities":58}],3:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){var n=t("../L.TravelNotes");return Object.seal({getRoute:function(t){return function(t){var e=null;return(e=n.travel.routes.getAt(t))||t===n.editedRoute.objId&&(e=n.editedRoute),e||console.log("Invalid noteObjId "+t+" for function DataSearchEngine.getRoute ( )"),e}(t)},getNoteAndRoute:function(t){return function(t){var e=null;if(e=n.travel.notes.getAt(t))return{note:e,route:null};for(var o=n.travel.routes.iterator;!o.done;)if(e=o.value.notes.getAt(t))return{note:e,route:o.value};return(e=n.editedRoute.notes.getAt(t))?{note:e,route:n.editedRoute}:(console.log("Invalid noteObjId "+t+" for function DataSearchEngine.getNote ( )"),{note:null,route:null})}(t)},getWayPoint:function(t){return function(t){for(var e=null,o=n.travel.routes.iterator;!o.done;)if(e=o.value.wayPoints.getAt(t))return e;return(e=n.editedRoute.wayPoints.getAt(t))||(console.log("Invalid wayPointObjId "+t+" for function DataSearchEngine.getWayPoint ( )"),null)}(t)}})})}()},{"../L.TravelNotes":8}],4:[function(u,t,e){!function(){"use strict";var c=u("../data/ObjType")("Itinerary",u("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var r="",i="",s=u("../data/Collection")("ItineraryPoint"),l=u("../data/Collection")("Maneuver"),d=u("../data/ObjId")();return Object.seal({get itineraryPoints(){return s},get maneuvers(){return l},get provider(){return r},set provider(t){r=t},get transitMode(){return i},set transitMode(t){i=t},get objId(){return d},get objType(){return c},get object(){return{itineraryPoints:s.object,maneuvers:l.object,provider:r,transitMode:i,objId:d,objType:c.object}},set object(t){!function(t){t=c.validate(t),s.object=t.itineraryPoints||[],l.object=t.maneuvers||[],r=t.provider||"",i=t.transitMode||"",d=u("../data/ObjId")();for(var e=new Map,o=0,n=s.iterator;!n.done;)e.set(t.itineraryPoints[o].objId,n.value.objId),o++;for(var a=l.iterator;!a.done;)a.value.itineraryPointObjId=e.get(a.value.itineraryPointObjId)}(t)}})})}()},{"../data/Collection":43,"../data/ObjId":50,"../data/ObjType":51,"./Version":7}],5:[function(m,t,e){!function(){"use strict";var p=m("../data/ObjType")("Route",m("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var e="",o=m("../data/Collection")("WayPoint");o.add(m("../data/Waypoint")()),o.add(m("../data/Waypoint")());var n=m("../data/Collection")("Note"),a=m("../data/Itinerary")(),r=m("../L.TravelNotes").config.route.width||5,i=m("../L.TravelNotes").config.route.color||"#ff0000",s=m("../L.TravelNotes").config.route.dashArray||0,l=!1,d=0,c=0,u=0,v=!1,g=m("../data/ObjId")();return Object.seal({get wayPoints(){return o},get itinerary(){return a},get notes(){return n},get name(){return e},set name(t){e=t},get width(){return r},set width(t){r=t},get color(){return i},set color(t){i=t},get dashArray(){return s},set dashArray(t){s=t},get chain(){return l},set chain(t){l=t},get chainedDistance(){return d},set chainedDistance(t){d=t},get distance(){return c},set distance(t){c=t},get duration(){return u},set duration(t){u=t},get hidden(){return v},set hidden(t){v=t},get objId(){return g},get objType(){return p},get object(){return{name:e,wayPoints:o.object,notes:n.object,itinerary:a.object,width:r,color:i,dashArray:s,chain:l,distance:parseFloat(c.toFixed(2)),duration:u,hidden:v,chainedDistance:parseFloat(d.toFixed(2)),objId:g,objType:p.object}},set object(t){!function(t){t=p.validate(t),e=t.name||"",o.object=t.wayPoints||[],n.object=t.notes||[],a.object=t.itinerary||m("./Itinerary")().object,r=t.width||5,i=t.color||"#000000",s=t.dashArray||0,l=t.chain||!1,c=t.distance,u=t.duration,v=t.hidden||!1,d=t.chainedDistance,g=m("../data/ObjId")()}(t)}})})}()},{"../L.TravelNotes":8,"../data/Collection":43,"../data/Itinerary":46,"../data/ObjId":50,"../data/ObjType":51,"../data/Waypoint":57,"./Itinerary":4,"./Version":7}],6:[function(l,t,e){!function(){"use strict";var s=l("../data/ObjType")("Travel",l("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var e="TravelNotes",o=l("../data/Collection")("Route"),n=l("../data/Collection")("Note"),a=l("../data/ObjId")(),r=!1,i={};return Object.seal({get routes(){return o},get notes(){return n},get name(){return e},set name(t){e=t},get readOnly(){return r},set readOnly(t){r=t},get userData(){return i},set userData(t){i=t},get objId(){return a},get objType(){return s},get object(){return{name:e,routes:o.object,notes:n.object,userData:i,readOnly:r,objId:a,objType:s.object}},set object(t){!function(t){t=s.validate(t),e=t.name||"",i=t.userData||{},r=t.readOnly||!1,o.object=t.routes||[],n.object=t.notes||[],a=l("../data/ObjId")()}(t)}})})}()},{"../data/Collection":43,"../data/ObjId":50,"../data/ObjType":51,"./Version":7}],7:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports="1.5.0")}()},{}],8:[function(g,t,e){!function(){"use strict";L.travelNotes=function(){var r=g("./data/TravelNotesData")();void 0!==t&&t.exports&&(t.exports=r);function n(e,o){var n=new XMLHttpRequest;n.timeout=2e4,n.ontimeout=function(t){o("XMLHttpRequest TimeOut. File : "+n.responseURL)},n.onreadystatechange=function(){if(4===n.readyState)if(200===n.status){var t;try{t=JSON.parse(n.responseText)}catch(t){o("JSON parsing error. File : "+n.responseURL)}e(t)}else o("Error XMLHttpRequest - Status : "+n.status+" - StatusText : "+n.statusText+" - File : "+n.responseURL)},n.open("GET",v,!0),n.overrideMimeType("application/json"),n.send(null)}function o(t,e){r.map=t,function(){var a="?";decodeURI(window.location.search).substr(1).split("&").forEach(function(t){if("fil="===t.substr(0,4).toLowerCase())u=decodeURIComponent(escape(atob(t.substr(4)))),a+="?"===a?"":"&",a+=t;else{var e=t.split("=");if(2===e.length)if(-1!==e[0].indexOf("ProviderKey")){var o=e[0].substr(0,e[0].length-11).toLowerCase(),n=r.providers.get(o);n&&n.providerKeyNeeded&&(n.providerKey=e[1]),sessionStorage.setItem(o,btoa(e[1]))}else a+="?"===a?"":"&",a+=t,"lng"===e[0].toLowerCase()&&(c=e[1].toLowerCase())}});history.replaceState({index:"bar"},"page",a),r.providers.forEach(function(t){if(t.providerKeyNeeded&&0===t.providerKey){var e=null;g("./util/Utilities")().storageAvailable("sessionStorage")&&(e=sessionStorage.getItem(t.name.toLowerCase())),e?t.providerKey=atob(e):r.providers.delete(t.name.toLowerCase())}})}();var o=[];v=window.location.href.substr(0,window.location.href.lastIndexOf("/")+1)+"TravelNotesConfig.json",o.push(new Promise(n)),v=window.location.href.substr(0,window.location.href.lastIndexOf("/")+1)+"TravelNotes"+(c||r.config.language).toUpperCase()+".json",o.push(new Promise(n)),u&&(v=u,o.push(new Promise(n))),Promise.all(o).then(function(t){c&&(t[0].language=c),r.config=t[0],window.osmSearch?window.osmSearch.getDictionaryPromise(r.config.language,"travelNotes").then(function(){console.log("Dictionary loaded")},function(t){console.log(t)}):console.log("osmSearch not found"),r.providers.forEach(function(t){t.userLanguage=r.config.language}),g("./UI/Translator")().setTranslations(t[1]),r.travel=g("./data/Travel")(),r.travel.routes.add(g("./data/Route")()),r.editedRoute=g("./data/Route")(),document.getElementById(e).appendChild(g("./UI/UserInterface")().UI),g("./UI/TravelEditorUI")().setRoutesList(r.travel.routes),g("./core/TravelEditor")().updateRoadBook(!0),u?g("./core/FileLoader")().openDistantFile(t[2]):r.config.travelEditor.startupRouteEdition?g("./core/TravelEditor")().editRoute(r.travel.routes.first.objId):g("./UI/RouteEditorUI")().reduce()}).catch(function(t){console.log(t)})}function a(t){r.travel.readOnly||g("./UI/ContextMenu")(t,g("./UI/ContextMenuFactory")().getMapContextMenu([t.latlng.lat,t.latlng.lng]).concat(i))}function e(t){r.travel.readOnly||g("./UI/ContextMenu")(t,g("./UI/ContextMenuFactory")().getMapContextMenu([t.latlng.lat,t.latlng.lng]).concat(s))}var i=[],s=[],l=!1,d=!1,c=null,u=null,v="";return{addControl:function(t,e){return o(t,e)},addProvider:function(t){r.providers.set(t.name.toLowerCase(),t)},addMapContextMenu:function(t,e){t&&(r.map.on("click",a),l=!0),e&&(r.map.on("contextmenu",a),d=!0)},get baseDialog(){return g("./UI/baseDialog")()},get userData(){return r.travel.userData},set userData(t){r.travel.userData=t},get rightContextMenu(){return d},set rightContextMenu(t){t&&!d?(r.map.on("contextmenu",e),d=!0):!t&&d&&(r.map.off("contextmenu",e),d=!1)},get leftContextMenu(){return l},set leftContextMenu(t){t&&!l?(r.map.on("click",a),l=!0):!t&&l&&(r.map.off("click",a),l=!1)},get leftUserContextMenu(){return i},set leftUserContextMenu(t){i=t},get rightUserContextMenu(){return s},set rightUserContextMenu(t){s=t},get maneuver(){return g("./data/Maneuver")()},get itineraryPoint(){return g("./data/ItineraryPoint")()},get version(){return g("./data/Version")}}}()}()},{"./UI/ContextMenu":12,"./UI/ContextMenuFactory":13,"./UI/RouteEditorUI":22,"./UI/Translator":26,"./UI/TravelEditorUI":27,"./UI/UserInterface":29,"./UI/baseDialog":30,"./core/FileLoader":32,"./core/TravelEditor":40,"./data/ItineraryPoint":47,"./data/Maneuver":48,"./data/Route":52,"./data/Travel":53,"./data/TravelNotesData":54,"./data/Version":55,"./util/Utilities":58}],9:[function(o,t,e){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(t){var e=o("../UI/BaseDialog")();return e.title=o("../UI/Translator")().getText("AboutDialog - About Travel & Notes"),o("./HTMLElementsFactory")().create("div",{id:"TravelNotes-AboutDialog-AboutDiv"},e.content).innerHTML="<p>This  program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or any later version.</p><p>Copyright - 2017 2019 - wwwouaiebe</p><p>Contact : <a href='http://www.ouaie.be/blog/pages/contact' target='_blank'>http://www.ouaie.be/</a></p><p>GitHub : <a href='https://github.com/wwwouaiebe/leaflet.TravelNotes' target='_blank'>https://github.com/wwwouaiebe/leaflet.TravelNotes</a></p><p>Version : "+o("../data/Version")+".<p>This program uses: <a href='https://leafletjs.com/' target='_blank'>leaflet</a>, <a href='https://github.com/mapbox/polyline' target='_blank'>mapbox/polyline</a>, <a href='https://github.com/Project-OSRM/osrm-text-instructions' target='_blank'>Project-OSRM/osrm-text-instructions</a> and  <a href='https://github.com/drolbr/Overpass-API' target='_blank'>the Overpass API</a></p>",e.center(),e})}()},{"../UI/BaseDialog":10,"../UI/Translator":26,"../data/Version":55,"./HTMLElementsFactory":16}],10:[function(N,t,e){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){var e=null,o=null,n=null,t=N("./HTMLElementsFactory")(),a=function(t){if("Escape"===t.key||"Esc"===t.key){if(n&&!n())return;document.removeEventListener("keydown",a,!0),document.getElementsByTagName("body")[0].removeChild(document.getElementById("TravelNotes-BaseDialog-BackgroundDiv"))}},r=document.getElementsByTagName("body")[0],i=t.create("div",{id:"TravelNotes-BaseDialog-BackgroundDiv",className:"TravelNotes-BaseDialog-BackgroundDiv"},r);i.addEventListener("dragover",function(t){},!1),i.addEventListener("drop",function(t){},!1);var s=i.clientWidth,l=i.clientHeight,d=0,c=0,u=0,v=0,g=t.create("div",{id:"TravelNotes-BaseDialog-Container",className:"TravelNotes-BaseDialog-Container"},i),p=t.create("div",{id:"TravelNotes-BaseDialog-TopBar",className:"TravelNotes-BaseDialog-TopBar",draggable:!0},g);t.create("div",{innerHTML:"&#x274c",id:"TravelNotes-BaseDialog-CancelButton",title:N("../UI/Translator")().getText("BaseDialog - Cancel")},p).addEventListener("click",function(){o&&!o()||(document.removeEventListener("keydown",a,!0),document.getElementsByTagName("body")[0].removeChild(i))},!1),p.addEventListener("dragstart",function(t){try{t.dataTransfer.setData("Text","1")}catch(t){}d=t.screenX,c=t.screenY},!1),p.addEventListener("dragend",function(t){u+=t.screenX-d,v+=t.screenY-c,u=Math.min(Math.max(u,20),s-g.clientWidth-20),v=Math.max(v,20);var e=l-Math.max(v,0)-20;g.setAttribute("style","top:"+v+"px;left:"+u+"px;max-height:"+e+"px;")},!1);var m=t.create("div",{className:"TravelNotes-BaseDialog-HeaderDiv",id:"TravelNotes-BaseDialog-HeaderDiv"},g),f=t.create("div",{className:"TravelNotes-BaseDialog-ContentDiv",id:"TravelNotes-BaseDialog-ContentDiv"},g),T=(t.create("div",{className:"TravelNotes-BaseDialog-ErrorDiv TravelNotes-BaseDialog-ErrorDivHidden",id:"TravelNotes-BaseDialog-ErrorDiv"},g),t.create("div",{className:"TravelNotes-BaseDialog-FooterDiv",id:"TravelNotes-BaseDialog-FooterDiv"},g));return t.create("div",{innerHTML:"&#x1f4be;",id:"TravelNotes-BaseDialog-OkButton",className:"TravelNotes-BaseDialog-Button"},T).addEventListener("click",function(){e&&!e()||(document.removeEventListener("keydown",a,!0),document.getElementsByTagName("body")[0].removeChild(i))},!1),document.addEventListener("keydown",a,!0),{addClickOkButtonEventListener:function(t){e=t},addClickCancelButtonEventListener:function(t){o=t},addEscapeKeyEventListener:function(t){n=t},get title(){return m.innerHTML},set title(t){m.innerHTML=t},center:function(){u=(s-g.clientWidth)/2,v=(l-g.clientHeight)/2,u=Math.min(Math.max(u,20),s-g.clientWidth-20),v=Math.max(v,20);var t=l-Math.max(v,0)-20;g.setAttribute("style","top:"+v+"px;left:"+u+"px;max-height:"+t+"px;")},get header(){return m},set header(t){m=t},get content(){return f},set content(t){f=t},get footer(){return T},set footer(t){T=t}}})}()},{"../UI/Translator":26,"./HTMLElementsFactory":16}],11:[function(C,t,e){!function(){"use strict";function b(){return!0}void 0!==t&&t.exports&&(t.exports=function(t){function o(t){return{r:parseInt(t.substr(1,2),16),g:parseInt(t.substr(3,2),16),b:parseInt(t.substr(5,2),16)}}function s(t,e,o){return String.prototype.padStart||(String.prototype.padStart=function(t,e){return t>>=0,e=String(e||" "),this.length>t?String(this):((t-=this.length)>e.length&&(e+=e.repeat(t/e.length)),e.slice(0,t)+String(this))}),"#"+parseInt(t).toString(16).padStart(2,"0")+parseInt(e).toString(16).padStart(2,"0")+parseInt(o).toString(16).padStart(2,"0")}function e(t){r=t.target.colorValue;var e=o(r);h.value=e.r,y.value=e.g,E.value=e.b,document.getElementById("TravelNotes-ColorDialog-ColorSampleDiv").setAttribute("style","background-color:"+t.target.colorValue+";")}function n(t){for(var e=t.target.redValue,o=255,n=255,a=0;++a<7;){var r=0;for(o=255;++r<7;){var i=document.getElementById("TravelNotes-ColorDialog-CellColorDiv"+a+r);i.colorValue=s(e,o,n),i.setAttribute("style","background-color:"+s(e,o,n)),o-=51}n-=51}}function a(){r=s(h.value,y.value,E.value),document.getElementById("TravelNotes-ColorDialog-ColorSampleDiv").setAttribute("style","background-color:"+r+";")}var r=t,i=C("../UI/Translator")(),l=C("./HTMLElementsFactory")(),d=C("../UI/BaseDialog")();d.title=i.getText("ColorDialog - Colors"),d.addClickOkButtonEventListener(b),d.getNewColor=function(){return r};for(var c=l.create("div",{className:"TravelNotes-ColorDialog-ColorDiv",id:"TravelNotes-ColorDialog-ColorDiv"},d.content),u=l.create("div",{className:"TravelNotes-ColorDialog-ButtonsDiv",id:"TravelNotes-ColorDialog-ButtonsDiv"},c),v=255,g=255,p=255,m=0;++m<8;){var f=l.create("div",{className:"TravelNotes-ColorDialog-RowColorDiv",id:"TravelNotes-ColorDialog-RowColorDiv"+m},u),T=0;for(g=255;++T<7;){m<7&&"TravelNotes-ColorDialog-CellColorDiv TravelNotes-ColorDialog-RedDiv";var N=l.create("div",{className:"TravelNotes-ColorDialog-CellColorDiv",id:"TravelNotes-ColorDialog-CellColorDiv"+m+T},f);if(m<7)N.setAttribute("style","background-color:"+s(v,g,p)),N.colorValue=s(v,g,p),N.addEventListener("click",e,!1),g-=51;else{var I=s(255,v=51*(T-1),v);N.setAttribute("style","background-color:"+I),N.redValue=255-v,N.addEventListener("click",n,!1)}}p-=51}var L=l.create("div",{className:"TravelNotes-ColorDialog-DataDiv",id:"TravelNotes-ColorDialog-DataDiv"},c);l.create("text",{data:i.getText("ColorDialog - Red")},L);var h=l.create("input",{type:"number",className:"TravelNotes-ColorDialog-NumberInput",id:"TravelNotes-ColorDialog-RedInput"},L);h.value=o(t).r,h.min=0,h.max=255,h.addEventListener("input",a,!1),l.create("text",{data:i.getText("ColorDialog - Green")},L);var y=l.create("input",{type:"number",className:"TravelNotes-ColorDialog-NumberInput",id:"TravelNotes-ColorDialog-GreenInput"},L);y.value=o(t).g,y.min=0,y.max=255,y.addEventListener("input",a,!1),l.create("text",{data:i.getText("ColorDialog - Blue")},L);var E=l.create("input",{type:"number",className:"TravelNotes-ColorDialog-NumberInput",id:"TravelNotes-ColorDialog-BlueInput"},L);return E.value=o(t).b,E.min=0,E.max=255,E.addEventListener("input",a,!1),l.create("div",{className:"TravelNotes-ColorDialog-ColorSampleDiv",id:"TravelNotes-ColorDialog-ColorSampleDiv"},c).setAttribute("style","background-color:"+t+";"),d.center(),d})}()},{"../UI/BaseDialog":10,"../UI/Translator":26,"./HTMLElementsFactory":16}],12:[function(h,t,e){!function(){"use strict";function c(t){t.stopPropagation(),u[t.target.menuItem].param?u[t.target.menuItem].action.call(u[t.target.menuItem].context,u[t.target.menuItem].param,g):u[t.target.menuItem].action.call(u[t.target.menuItem].context,g),T()}var u=[],v=null,g=null,o=0,p=0,m=0,f=null,T=function(){f&&(clearTimeout(f),f=null),m=p=0,document.removeEventListener("keydown",N,!0),document.removeEventListener("keypress",I,!0),document.removeEventListener("keyup",L,!0);var t=v.childNodes;t[0].firstChild.removeEventListener("click",T,!1);for(var e=1;e<t.length;e++)t[e].firstChild.removeEventListener("click",T,!1);document.getElementsByTagName("body")[0].removeChild(v),v=null,o=0},N=function(t){v&&(t.preventDefault(),t.stopPropagation()),"Escape"!==t.key&&"Esc"!==t.key||T(),"ArrowDown"!==t.key&&"ArrowRight"!==t.key&&"Tab"!==t.key||(o=o>=u.length?1:++o,v.childNodes[o].firstChild.focus()),"ArrowUp"!==t.key&&"ArrowLeft"!==t.key||(o=o<=1?u.length:--o,v.childNodes[o].firstChild.focus()),"Home"===t.key&&(o=1,v.childNodes[o].firstChild.focus()),"End"===t.key&&(o=u.length,v.childNodes[o].firstChild.focus()),"Enter"===t.key&&0<o&&u[o-1].action&&v.childNodes[o].firstChild.click()},I=function(t){t.preventDefault(),t.stopPropagation()},L=function(t){t.preventDefault(),t.stopPropagation()};void 0!==t&&t.exports&&(t.exports=function(t,e){if(t.latlng.lat!==p||t.latlng.lng!==m)if(p=t.latlng.lat,m=t.latlng.lng,g=t,v)T();else{u=e;var o=document.getElementsByTagName("body")[0],n=h("./HTMLElementsFactory")(),a=n.create("div",{className:"TravelNotes-ContextMenu-Panel"},o),r=a.clientWidth,i=a.clientHeight;o.removeChild(a),(v=n.create("div",{id:"TravelNotes-ContextMenu-Container",className:"TravelNotes-ContextMenu-Container"},o)).addEventListener("mouseenter",function(){f&&(clearTimeout(f),f=null)},!1),v.addEventListener("mouseleave",function(){f=setTimeout(T,h("../L.TravelNotes").config.contextMenu.timeout)},!1),n.create("div",{innerHTML:"&#x274c",className:"TravelNotes-ContextMenu-CloseButton",title:h("./Translator")().getText("ContextMenu - Close")},v).addEventListener("click",T,!1);var s=0;u.forEach(function(t){var e=n.create("div",{className:"TravelNotes-ContextMenu-ItemContainer"},v),o=n.create("button",{innerHTML:t.name,id:"TravelNotes-ContextMenu-Item"+s,className:t.action?"TravelNotes-ContextMenu-Item":"TravelNotes-ContextMenu-Item TravelNotes-ContextMenu-ItemDisabled"},e);t.action&&o.addEventListener("click",c,!1),o.menuItem=s,++s});var l=Math.min(t.originalEvent.clientY,i-v.clientHeight-20),d=Math.min(t.originalEvent.clientX,r-v.clientWidth-20);v.setAttribute("style","top:"+l+"px;left:"+d+"px;"),document.addEventListener("keydown",N,!0),document.addEventListener("keypress",I,!0),document.addEventListener("keyup",L,!0)}else m=p=0})}()},{"../L.TravelNotes":8,"./HTMLElementsFactory":16,"./Translator":26}],13:[function(l,t,e){!function(){"use strict";var s=l("../L.TravelNotes");void 0!==t&&t.exports&&(t.exports=function(){var e=l("../core/MapEditor")(),n=l("../core/NoteEditor")(),o=l("../core/RouteEditor")(),a=l("../core/TravelEditor")(),r=l("../core/waypointEditor")(),i=l("../UI/Translator")();return Object.seal({getMapContextMenu:function(t){return function(t){return[{context:r,name:i.getText("ContextMenuFactory - Select this point as start point"),action:-1!==s.routeEdition.routeInitialObjId&&0===s.editedRoute.wayPoints.first.lat?l("../core/waypointEditor")().setStartPoint:null,param:t},{context:r,name:i.getText("ContextMenuFactory - Select this point as way point"),action:-1!==s.routeEdition.routeInitialObjId?l("../core/waypointEditor")().addWayPoint:null,param:t},{context:r,name:i.getText("ContextMenuFactory - Select this point as end point"),action:-1!==s.routeEdition.routeInitialObjId&&0===s.editedRoute.wayPoints.last.lat?l("../core/waypointEditor")().setEndPoint:null,param:t},{context:n,name:i.getText("ContextMenuFactory - New travel note"),action:n.newTravelNote,param:t},{context:n,name:i.getText("ContextMenuFactory - Hide notes"),action:n.hideNotes},{context:n,name:i.getText("ContextMenuFactory - Show notes"),action:n.showNotes},{context:o,name:i.getText("ContextMenuFactory - Show all routes"),action:o.showRoutes},{context:e,name:i.getText("ContextMenuFactory - Zoom to travel"),action:e.zoomToTravel},{context:null,name:i.getText("ContextMenuFactory - About Travel & Notes"),action:l("../UI/AboutDialog")}]}(t)},getWayPointContextMenu:function(t){return function(t){return[{context:r,name:i.getText("ContextMenuFactory - Delete this waypoint"),action:s.editedRoute.wayPoints.first.objId!==t&&s.editedRoute.wayPoints.last.objId!==t?l("../core/waypointEditor")().removeWayPoint:null,param:t}]}(t)},getRouteContextMenu:function(t){return function(t){return[{context:o,name:i.getText("ContextMenuFactory - Edit this route"),action:s.routeEdition.routeInitialObjId===t||s.routeEdition.routeChanged?null:a.editRoute,param:t},{context:a,name:i.getText("ContextMenuFactory - Delete this route"),action:s.routeEdition.routeInitialObjId===t||s.routeEdition.routeChanged?null:a.removeRoute,param:t},{context:o,name:i.getText("ContextMenuFactory - Hide this route"),action:s.editedRoute.objId!==t?o.hideRoute:null,param:t},{context:r,name:i.getText("ContextMenuFactory - Add a waypoint on the route"),action:-1!==s.routeEdition.routeInitialObjId?r.addWayPointOnRoute:null,param:t},{context:n,name:i.getText("ContextMenuFactory - Add a note on the route"),action:n.newRouteNote,param:t},{context:o,name:i.getText("ContextMenuFactory - Properties"),action:o.routeProperties,param:t},{context:e,name:i.getText("ContextMenuFactory - Zoom to route"),action:e.zoomToRoute,param:t},{context:o,name:i.getText("ContextMenuFactory - Save modifications on this route"),action:s.editedRoute.objId===t?o.saveEdition:null},{context:o,name:i.getText("ContextMenuFactory - Cancel modifications on this route"),action:s.editedRoute.objId===t?o.cancelEdition:null}]}(t)},getNoteContextMenu:function(t){return function(t){var e=[];e.push({context:n,name:i.getText("ContextMenuFactory - Edit this note"),action:n.editNote,param:t}),e.push({context:n,name:i.getText("ContextMenuFactory - Delete this note"),action:n.removeNote,param:t}),e.push({context:n,name:i.getText("ContextMenuFactory - Zoom to note"),action:n.zoomToNote,param:t});var o=l("../data/DataSearchEngine")().getNoteAndRoute(t).route;return e.push({context:n,name:o?i.getText("ContextMenuFactory - Detach note from route"):i.getText("ContextMenuFactory - Attach note to route"),action:0!==s.travel.routes.length&&-1===s.routeEdition.routeInitialObjId?o?n.detachNoteFromRoute:n.attachNoteToRoute:null,param:t}),e}(t)}})})}()},{"../L.TravelNotes":8,"../UI/AboutDialog":9,"../UI/Translator":26,"../core/MapEditor":34,"../core/NoteEditor":35,"../core/RouteEditor":37,"../core/TravelEditor":40,"../core/waypointEditor":42,"../data/DataSearchEngine":45}],14:[function(d,t,e){!function(){"use strict";function a(t){t.deltaY&&(t.target.scrollTop=t.target.scrollTop+10*t.deltaY),t.stopPropagation()}function r(t){e().setItinerary()}function i(t){e().setTravelNotes()}function s(t){e().setSearch()}var l=-1,e=function(){function t(){switch(l){case 0:n.remove();break;case 1:e.remove();break;case 2:window.osmSearch&&o.remove()}}var e=d("../UI/TravelNotesPaneUI")(),o=d("../UI/SearchPaneUI")(),n=d("../UI/ItineraryPaneUI")();return Object.seal({createUI:function(t){!function(t){if(!document.getElementById("TravelNotes-Control-ItineraryDataDiv")){var e=d("../UI/HTMLElementsFactory")(),o=e.create("div",{id:"TravelNotes-Control-ItineraryHeaderDiv",className:"TravelNotes-Control-HeaderDiv"},t);e.create("div",{innerHTML:d("../UI/Translator")().getText("DataPanesUI - Itinerary"),id:"TravelNotes-Control-ItineraryPaneButton",className:"TravelNotes-Control-PaneButton"},o).addEventListener("click",r,!1),e.create("div",{innerHTML:d("../UI/Translator")().getText("DataPanesUI - Travel notes"),id:"TravelNotes-Control-TravelNotesPaneButton",className:"TravelNotes-Control-PaneButton"},o).addEventListener("click",i,!1),window.osmSearch&&e.create("div",{innerHTML:d("../UI/Translator")().getText("DataPanesUI - Search"),id:"TravelNotes-Control-SearchPaneButton",className:"TravelNotes-Control-PaneButton"},o).addEventListener("click",s,!1),e.create("div",{id:"TravelNotes-Control-ItineraryDataDiv",className:"TravelNotes-Control-DataDiv"},t).addEventListener("wheel",a,!1)}}(t)},setItinerary:function(){t(),n.add(),l=0},updateItinerary:function(){0===l&&(n.remove(),n.add())},setTravelNotes:function(){t(),e.add(),l=1},updateTravelNotes:function(){1===l&&(e.remove(),e.add())},setSearch:function(){t(),o.add(),l=2},updateSearch:function(){2===l&&(o.remove(),o.add())}})};void 0!==t&&t.exports&&(t.exports=e)}()},{"../UI/HTMLElementsFactory":16,"../UI/ItineraryPaneUI":19,"../UI/SearchPaneUI":24,"../UI/Translator":26,"../UI/TravelNotesPaneUI":28}],15:[function(i,t,e){!function(){"use strict";var e=null;void 0!==t&&t.exports&&(t.exports=function(){function a(){document.getElementById("TravelNotes-Control-ErrorDataDiv").classList.add("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-ErrorMessageDiv").innerHTML=""}var r=i("./Translator")();return{createUI:function(t){!function(t){if(!document.getElementById("TravelNotes-Control-ErrorDataDiv")){var e=i("./HTMLElementsFactory")(),o=e.create("div",{id:"TravelNotes-Control-ErrorDataDiv",className:"TravelNotes-Control-DataDiv TravelNotes-Control-HiddenList"},t),n=e.create("div",{id:"TravelNotes-Control-ErrorHeaderDiv",className:"TravelNotes-Control-HeaderDiv TravelNotes-Control-HiddenList"},o);e.create("span",{innerHTML:"&#x274c",title:r.getText("ErrorEditorUI - Hide"),id:"TravelNotes-Control-ErrorExpandButton",className:"TravelNotes-Control-HiddenList"},n).addEventListener("click",function(t){t.stopPropagation(),document.getElementById("TravelNotes-Control-ErrorMessageDiv").innerHTML.length&&a()},!1);e.create("div",{id:"TravelNotes-Control-ErrorMessageDiv"},o)}}(t)},set message(t){!function(t){e&&(clearTimeout(e),e=null),document.getElementById("TravelNotes-Control-ErrorMessageDiv").innerHTML=t,document.getElementById("TravelNotes-Control-ErrorDataDiv").classList.remove("TravelNotes-Control-HiddenList"),e=setTimeout(a,i("../L.TravelNotes").config.errorMessages.timeout)}(t)},get message(){return document.getElementById("TravelNotes-Control-ErrorDataDiv").innerHTML}}})}()},{"../L.TravelNotes":8,"./HTMLElementsFactory":16,"./Translator":26}],16:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){return{create:function(t,e,o){var n;if(n="text"===t.toLowerCase()?document.createTextNode(""):document.createElement(t),o&&o.appendChild(n),e)for(var a in e)try{n[a]=e[a]}catch(t){console.log("Invalid property : "+a)}return n}}})}()},{}],17:[function(T,t,e){!function(){"use strict";var g=T("../UI/HTMLElementsFactory")(),d=T("../L.TravelNotes"),p=T("../UI/Translator")(),m=T("../util/Utilities")(),c=T("../core/NoteEditor")(),e=T("../core/RouteEditor")(),u=T("../L.TravelNotes").config.note.svgIconWidth,f="TravelNotes-Control-";void 0!==t&&t.exports&&(t.exports=function(){function v(t,e){var o=g.create("div",{className:f+"Travel-Notes-IconCell",innerHTML:t.iconContent},e);"svg"===o.firstChild.tagName&&"TravelNotes-Roadbook-"===f&&o.firstChild.setAttributeNS(null,"viewBox","0 0 "+u+" "+u),g.create("div",{className:f+"Travel-Notes-Cell",innerHTML:c.getNoteHTML(t,f)},e),e.noteObjId=t.objId}function n(){var t=g.create("div",{className:f+"Travel-Header"});g.create("div",{className:f+"Travel-Header-Name",innerHTML:d.travel.name},t);for(var e=0,o=d.travel.routes.iterator;!o.done;)g.create("div",{className:f+"Travel-Header-RouteName",innerHTML:'<a href="#route'+o.value.objId+'">'+o.value.name+"</a>&nbsp;:&nbsp;"+m.formatDistance(o.value.distance)+"."},t),o.value.chain&&(e+=o.value.distance);return g.create("div",{className:f+"Travel-Header-TravelDistance",innerHTML:p.getText("HTMLViewsFactory - Travel distance&nbsp;:&nbsp;{distance}",{distance:m.formatDistance(e)})},t),t}function a(){for(var t=g.create("div",{className:f+"Travel-Notes"}),e=d.travel.notes.iterator;!e.done;){var o=g.create("div",{className:f+"Travel-Notes-Row"},t);v(e.value,o)}return t}function r(t){return g.create("div",{className:f+"Route-Header",id:"route"+t.objId,innerHTML:e.getRouteHTML(t,f)})}function i(t){for(var e=g.create("div",{className:f+"Route-ManeuversAndNotes"}),o=t.notes.iterator,n=o.done,a=n?Number.MAX_VALUE:o.value.distance,r=a,i=t.itinerary.maneuvers.iterator,s=i.done,l=0;!s||!n;){var d=g.create("div",{className:f+"Route-ManeuversAndNotes-Row"},e);if(l<=a){if(!s){d.className=f+"Route-Maneuvers-Row",g.create("div",{className:f+"Route-ManeuversAndNotes-IconCell TravelNotes-ManeuverNote-"+i.value.iconName},d);var c="<div>"+i.value.instruction+"</div>";0<i.value.distance&&(c+="<div>"+p.getText("HTMLViewsFactory - To next instruction&nbsp;:&nbsp;{distance}&nbsp;-&nbsp;{duration}",{distance:m.formatDistance(i.value.distance),duration:m.formatTime(i.value.duration)})+"</div>"),g.create("div",{className:f+"Route-ManeuversAndNotes-Cell",innerHTML:c},d),d.objId=T("../data/ObjId")(),d.latLng=t.itinerary.itineraryPoints.getAt(i.value.itineraryPointObjId).latLng,d.maneuverObjId=i.value.objId,l+=i.value.distance,(s=i.done)&&(l=Number.MAX_VALUE)}}else if(!n&&(d.className=f+"Route-Notes-Row",v(o.value,d),d.objId=T("../data/ObjId")(),d.latLng=o.value.latLng,d.noteObjId=o.value.objId,r=o.value.distance,a=(n=o.done)?Number.MAX_VALUE:o.value.distance,!n)){var u=o.value.distance-r;9<u&&g.create("div",{className:f+"NoteHtml-NextDistance",innerHTML:p.getText("HTMLViewsFactory - Next distance&nbsp;:&nbsp;{distance}",{distance:m.formatDistance(u)})},d.lastChild)}}return e}function s(t){var e="";return""!==t.itinerary.provider&&""!==t.itinerary.transitMode&&(e=p.getText("HTMLViewsFactory - Itinerary computed by {provider} and optimized for {transitMode}",{provider:t.itinerary.provider,transitMode:p.getText("HTMLViewsFactory - TransitMode "+t.itinerary.transitMode)})),g.create("div",{className:f+"RouteFooter",innerHTML:e})}function l(){return g.create("div",{className:f+"TravelFooter",innerHTML:p.getText("HTMLViewsFactory - Travel footer")})}return{set classNamePrefix(t){f=t},get classNamePrefix(){return f},get travelHeaderHTML(){return n()},get travelNotesHTML(){return a()},get routeHeaderHTML(){return r(d.editedRoute)},get routeManeuversAndNotesHTML(){return i(d.editedRoute)},get routeFooterHTML(){return s(d.editedRoute)},get travelFooterHTML(){return l()},get travelHTML(){return function(){var t=g.create("div",{className:f+"Travel"});t.appendChild(n()),t.appendChild(a());for(var e=d.travel.routes.iterator;!e.done;){var o=d.config.routeEditor.displayEditionInHTMLPage&&e.value.objId===d.routeEdition.routeInitialObjId;t.appendChild(r(o?d.editedRoute:e.value)),t.appendChild(i(o?d.editedRoute:e.value)),t.appendChild(s(o?d.editedRoute:e.value))}return t.appendChild(l()),t}()}}})}()},{"../L.TravelNotes":8,"../UI/HTMLElementsFactory":16,"../UI/Translator":26,"../core/NoteEditor":35,"../core/RouteEditor":37,"../data/ObjId":50,"../util/Utilities":58}],18:[function(t,e,o){arguments[4][16][0].apply(o,arguments)},{dup:16}],19:[function(c,t,e){!function(){"use strict";function i(t){t.stopPropagation();for(var e=t.target;!e.latLng;)e=e.parentNode;c("../core/MapEditor")().zoomToPoint(e.latLng)}function s(t){t.stopPropagation(),t.preventDefault();for(var e=t.target;!e.latLng;)e=e.parentNode;e.maneuverObjId?c("../core/NoteEditor")().newManeuverNote(e.maneuverObjId,e.latLng):e.noteObjId&&c("../core/NoteEditor")().editNote(e.noteObjId)}function l(t){t.stopPropagation(),c("../core/MapEditor")().addItineraryPointMarker(t.target.objId,t.target.latLng)}function d(t){t.stopPropagation(),c("../core/MapEditor")().removeObject(t.target.objId)}void 0!==t&&t.exports&&(t.exports=function(){return Object.seal({remove:function(){!function(){var t=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(t){var e,o,n,a=document.getElementsByClassName("TravelNotes-Control-Route-Header")[0];a&&t.removeChild(a);var r=document.getElementsByClassName("TravelNotes-Control-Route-ManeuversAndNotes")[0];if(r){for(o=r.childNodes,e=0;e<o.length;e++)(n=o[e]).removeEventListener("click",i,!1),n.removeEventListener("contextmenu",s,!1),n.removeEventListener("mouseenter",l,!1),n.removeEventListener("mouseleave",d,!1);t.removeChild(r)}}}()},add:function(){!function(){document.getElementById("TravelNotes-Control-ItineraryPaneButton").classList.add("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-TravelNotesPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),window.osmSearch&&document.getElementById("TravelNotes-Control-SearchPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton");var t=c("../UI/HTMLViewsFactory")();t.classNamePrefix="TravelNotes-Control-";var e=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(e){var o,n,a;e.appendChild(t.routeHeaderHTML),e.appendChild(t.routeManeuversAndNotesHTML);var r=document.getElementsByClassName("TravelNotes-Control-Route-ManeuversAndNotes")[0];if(r)for(n=r.childNodes,o=0;o<n.length;o++)(a=n[o]).addEventListener("click",i,!1),a.addEventListener("contextmenu",s,!1),a.addEventListener("mouseenter",l,!1),a.addEventListener("mouseleave",d,!1)}}()}})})}()},{"../UI/HTMLViewsFactory":17,"../core/MapEditor":34,"../core/NoteEditor":35}],20:[function(C,t,e){!function(){"use strict";var h=C("../UI/Translator")(),y={editionButtons:[],preDefinedIconsList:[]},E={editionButtons:[],preDefinedIconsList:[]},b={editionButtons:[],preDefinedIconsList:[]};void 0!==t&&t.exports&&(t.exports=function(o,n,e){function t(){return 0===document.getElementById("TravelNotes-NoteDialog-TextArea-IconHtmlContent").value.length?(document.getElementById("TravelNotes-BaseDialog-ErrorDiv").innerHTML=h.getText("Notedialog - The icon content cannot be empty"),document.getElementById("TravelNotes-BaseDialog-ErrorDiv").classList.remove("TravelNotes-BaseDialog-ErrorDivHidden"),!1):(o.iconWidth=document.getElementById("TravelNotes-NoteDialog-WidthNumberInput").value,o.iconHeight=document.getElementById("TravelNotes-NoteDialog-HeightNumberInput").value,o.iconContent=document.getElementById("TravelNotes-NoteDialog-TextArea-IconHtmlContent").value,o.popupContent=document.getElementById("TravelNotes-NoteDialog-TextArea-PopupContent").value,o.tooltipContent=document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value,o.address=document.getElementById("TravelNotes-NoteDialog-InputText-Adress").value,o.url=document.getElementById("TravelNotes-NoteDialog-InputText-Link").value,o.phone=document.getElementById("TravelNotes-NoteDialog-InputText-Phone").value,o.latLng=f,C("../core/NoteEditor")().afterNoteDialog(o,n),!0)}function a(t){N=T="",t.address.house_number&&(T+=t.address.house_number+" "),t.address.road?T+=t.address.road+" ":t.address.pedestrian&&(T+=t.address.pedestrian+" "),t.address.village?N=t.address.village:t.address.town?N=t.address.town:t.address.city&&(N=t.address.city),""!==N&&(T+=C("../L.TravelNotes").config.note.cityPrefix+N+C("../L.TravelNotes").config.note.cityPostfix),0===T.length&&(T+=t.address.country),C("../L.TravelNotes").config.note.reverseGeocoding&&""===o.address&&e&&(document.getElementById("TravelNotes-NoteDialog-InputText-Adress").value=T)}function r(t){document.getElementById("TravelNotes-NoteDialog-TextArea-IconHtmlContent").value=t.svg.outerHTML;var e="";if(null!==t.direction){var o=C("../L.TravelNotes").config.note.svgAnleMaxDirection;e=t.direction<o.right?(document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=h.getText("NoteDialog - Turn right"),String.fromCodePoint(129154)):t.direction<o.slightRight?(document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=h.getText("NoteDialog - Turn slight right"),String.fromCodePoint(129157)):t.direction<o.continue?(document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=h.getText("NoteDialog - Continue"),String.fromCodePoint(129153)):t.direction<o.slightLeft?(document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=h.getText("NoteDialog - Turn slight left"),String.fromCodePoint(129156)):t.direction<o.left?(document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=h.getText("NoteDialog - Turn left"),String.fromCodePoint(129152)):t.direction<o.sharpLeft?(document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=h.getText("NoteDialog - Turn sharp left"),String.fromCodePoint(129159)):t.direction<o.sharpRight?(document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=h.getText("NoteDialog - Turn sharp right"),String.fromCodePoint(129158)):(document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=h.getText("NoteDialog - Turn right"),String.fromCodePoint(129154))}-1===t.startStop?document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=h.getText("NoteDialog - Start"):1===t.startStop&&(document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=h.getText("NoteDialog - Stop"));for(var n="",a=0,r=0;r<t.streets.length;r++)switch(0!==r&&t.streets.length-1!==r||""!==t.streets[r]?(n+=t.streets[r],a--):(n+="???",a++),r){case t.streets.length-2:n+=e;break;case t.streets.length-1:break;default:n+=String.fromCodePoint(10917)}t.city||""===N||(t.city=N),t.city&&(n+=" "+C("../L.TravelNotes").config.note.cityPrefix+t.city+C("../L.TravelNotes").config.note.cityPostfix),t.place&&t.place!==t.city&&2!==a&&(n+=" ("+t.place+")"),document.getElementById("TravelNotes-NoteDialog-InputText-Adress").value=n,document.getElementById("TravelNotes-BaseDialog-OkButton").style.visibility="visible",f=t.latLng}function i(){document.getElementById("TravelNotes-BaseDialog-ErrorDiv").innerHTML=h.getText("Notedialog - an error occurs when creating the SVG icon"),document.getElementById("TravelNotes-BaseDialog-ErrorDiv").classList.remove("TravelNotes-BaseDialog-ErrorDivHidden"),document.getElementById("TravelNotes-BaseDialog-OkButton").style.visibility="visible"}function s(t){var e=b.preDefinedIconsList[t.target.selectedIndex];e.name===h.getText("NoteDialog - SVG icon from OSM")?(document.getElementById("TravelNotes-BaseDialog-OkButton").style.visibility="hidden",C("../core/SvgIconFromOsmFactory")().getPromiseSvgIcon(o.latLng,n).then(r,i)):(document.getElementById("TravelNotes-NoteDialog-WidthNumberInput").value=e.width,document.getElementById("TravelNotes-NoteDialog-HeightNumberInput").value=e.height,document.getElementById("TravelNotes-NoteDialog-TextArea-IconHtmlContent").value=e.icon,document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=e.tooltip)}function l(t){if(p){for(var e=t.target;!e.htmlBefore;)e=e.parentNode;var o=e.htmlAfter&&0<e.htmlAfter.length,n=p.selectionStart,a=p.selectionEnd,r=p.value;p.value=r.substring(0,n)+(o?e.htmlBefore+r.substring(n,a)+e.htmlAfter:e.htmlBefore)+r.substring(a),p.setSelectionRange(o||n===a?n+e.htmlBefore.length:n,(o?a:n)+e.htmlBefore.length),p.focus()}}function d(t){var o=new FileReader;o.onload=function(t){try{var e=JSON.parse(o.result);y.editionButtons=y.editionButtons.concat(e.editionButtons),y.preDefinedIconsList=y.preDefinedIconsList.concat(e.preDefinedIconsList),L(e.editionButtons),I()}catch(t){}},t.target.files[0].name,o.readAsText(t.target.files[0])}function c(t){p=t.target}var u,v=null,g=null,p=null,m=C("./HTMLElementsFactory")(),f=o.latLng,T="",N="",I=function(){b.preDefinedIconsList=E.preDefinedIconsList.concat(y.preDefinedIconsList),-1<n&&b.preDefinedIconsList.push({name:h.getText("NoteDialog - SVG icon from OSM"),icon:"",tooltip:"",width:40,height:40}),b.preDefinedIconsList.sort(function(t,e){return t.name.localeCompare(e.name)});var t=0,e=document.getElementById("TravelNotes-NoteDialog-IconSelect");for(t=e.length-1;0<=t;t--)e.remove(t);for(t=0;t<b.preDefinedIconsList.length;t++){var o=m.create("option",{text:b.preDefinedIconsList[t].name});e.add(o)}},L=function(t){t.forEach(function(t){m.create("button",{type:"button",innerHTML:t.title||"?",htmlBefore:t.htmlBefore||"",htmlAfter:t.htmlAfter||"",className:"TravelNotes-NoteDialog-EditorButton"},document.getElementById("TravelNotes-NoteDialog-ToolbarDiv")).addEventListener("click",l,!1)})};(v=C("../UI/BaseDialog")()).title=h.getText("NoteDialog - Note"),v.addClickOkButtonEventListener(t),g=m.create("div",{id:"TravelNotes-NoteDialog-MainDataDiv"},v.content),function(){var t=m.create("div",{className:"TravelNotes-NoteDialog-ToolbarDiv",id:"TravelNotes-NoteDialog-ToolbarDiv"},g);m.create("select",{className:"TravelNotes-NoteDialog-Select",id:"TravelNotes-NoteDialog-IconSelect"},t).addEventListener("change",s,!1);var e=m.create("div",{id:"TravelNotes-NoteDialog-OpenEditorFileDiv"},t),o=m.create("input",{id:"TravelNotes-NoteDialog-OpenEditorFileInput",type:"file",accept:".json"},e);o.addEventListener("change",d,!1);var n=m.create("div",{id:"TravelNotes-NoteDialog-OpenStyleFakeDiv"},e);m.create("button",{id:"TravelNotes-NoteDialog-OpenEditorFileButton",className:"TravelNotes-NoteDialog-EditorButton",title:h.getText("NoteDialog - Open a configuration file"),innerHTML:"&#x23CD;"},n).addEventListener("click",function(){o.click()},!1),L(E.editionButtons),L(y.editionButtons),I()}(),u=m.create("div",{className:"TravelNotes-NoteDialog-DataDiv",id:"TravelNotes-NoteDialog-DimensionsDataDiv"},g),m.create("text",{data:h.getText("NoteDialog - Icon width")},u),m.create("input",{type:"number",className:"TravelNotes-NoteDialog-NumberInput",id:"TravelNotes-NoteDialog-WidthNumberInput"},u).value=o.iconWidth,m.create("text",{data:h.getText("NoteDialog - Icon height")},u),m.create("input",{type:"number",className:"TravelNotes-NoteDialog-NumberInput",id:"TravelNotes-NoteDialog-HeightNumberInput"},u).value=o.iconHeight,function(){m.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",id:"TravelNotes-NoteDialog-IconContentTitleDiv",innerHTML:h.getText("NoteDialog - Icon content")},g);var t=m.create("textarea",{className:"TravelNotes-NoteDialog-TextArea",id:"TravelNotes-NoteDialog-TextArea-IconHtmlContent"},g);t.addEventListener("focus",c,!1),t.value=o.iconContent}(),function(){m.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:h.getText("NoteDialog - Text")},g);var t=m.create("textarea",{className:"TravelNotes-NoteDialog-TextArea",id:"TravelNotes-NoteDialog-TextArea-PopupContent"},g);t.addEventListener("focus",c,!1),t.value=o.popupContent}(),function(){m.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:h.getText("NoteDialog - Tooltip content")},g);var t=m.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Tooltip"},g);t.addEventListener("focus",c,!1),t.value=o.tooltipContent}(),function(){m.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:"<span id='TravelNotes-NoteDialog-Reset-Address-Button'>&#x1f504;</span>&nbsp;"+h.getText("NoteDialog - Address&nbsp;:")},g),document.getElementById("TravelNotes-NoteDialog-Reset-Address-Button").addEventListener("click",function(){t.value=T},!1);var t=m.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Adress"},g);t.addEventListener("focus",c,!1),t.value=o.address,C("../core/GeoCoder")().getPromiseAddress(o.lat,o.lng).then(a)}(),function(){m.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:h.getText("NoteDialog - Link")},g);var t=m.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Link"},g);t.addEventListener("focus",function(t){p=null},!1),t.value=o.url}(),function(){m.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:h.getText("NoteDialog - Phone")},g);var t=m.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Phone"},g);t.addEventListener("focus",c,!1),t.value=o.phone}(),function(){if(0===E.preDefinedIconsList.length){var e=new XMLHttpRequest;e.onreadystatechange=function(t){if(this.readyState===e.DONE)if(200===this.status)try{E=JSON.parse(this.responseText),L(E.editionButtons),E.preDefinedIconsList.push({name:"",icon:"",tooltip:"",width:40,height:40}),I()}catch(t){console.log("Error reading TravelNotesNoteDialog.json")}else console.log("Error sending request for TravelNotesNoteDialog"+C("../L.TravelNotes").config.language.toUpperCase()+".json")},e.open("GET",window.location.href.substr(0,window.location.href.lastIndexOf("/")+1)+"TravelNotesNoteDialog"+C("../L.TravelNotes").config.language.toUpperCase()+".json",!0),e.send(null)}}(),v.center()})}()},{"../L.TravelNotes":8,"../UI/BaseDialog":10,"../UI/Translator":26,"../core/GeoCoder":33,"../core/NoteEditor":35,"../core/SvgIconFromOsmFactory":39,"./HTMLElementsFactory":16}],21:[function(g,t,e){!function(){"use strict";function c(t){t.stopPropagation(),v.routing.provider=t.target.provider,document.getElementsByClassName("TravelNotes-Control-ActiveProviderImgButton")[0].classList.remove("TravelNotes-Control-ActiveProviderImgButton"),t.target.classList.add("TravelNotes-Control-ActiveProviderImgButton");var e=v.providers.get(t.target.provider);e.transitModes.car?document.getElementById("TravelNotes-Control-carImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-carImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),e.transitModes.bike?document.getElementById("TravelNotes-Control-bikeImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-bikeImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),e.transitModes.pedestrian?document.getElementById("TravelNotes-Control-pedestrianImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-pedestrianImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),e.transitModes.train?document.getElementById("TravelNotes-Control-trainImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-trainImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),v.providers.get(t.target.provider).transitModes[v.routing.transitMode]||(e.transitModes.bike?document.getElementById("TravelNotes-Control-bikeImgButton").click():e.transitModes.pedestrian?document.getElementById("TravelNotes-Control-pedestrianImgButton").click():e.transitModes.car?document.getElementById("TravelNotes-Control-carImgButton").click():e.transitModes.train&&document.getElementById("TravelNotes-Control-trainImgButton").click()),g("../core/RouteEditor")().startRouting()}function u(t){t.stopPropagation(),v.routing.transitMode=t.target.transitMode,document.getElementsByClassName("TravelNotes-Control-ActiveTransitModeImgButton")[0].classList.remove("TravelNotes-Control-ActiveTransitModeImgButton"),t.target.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),g("../core/RouteEditor")().startRouting()}var v=g("../L.TravelNotes");void 0!==t&&t.exports&&(t.exports=function(){function e(t){var e=a.create("img",{src:"data:image/png;base64,"+t.icon,id:"TravelNotes-Control-"+t.name+"ImgButton",className:"TravelNotes-Control-ImgButton",title:t.name},n);e.provider=t.name.toLowerCase(),e.addEventListener("click",c,!1),r||(e.classList.add("TravelNotes-Control-ActiveProviderImgButton"),v.routing.provider=e.provider,r=!0,t.transitModes.bike?(i.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),v.routing.transitMode="bike"):t.transitModes.pedestrian?(s.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),v.routing.transitMode="pedestrian"):t.transitModes.car?(l.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),v.routing.transitMode="car"):t.transitModes.train&&(d.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),v.routing.transitMode="train"),t.transitModes.car||l.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),t.transitModes.pedestrian||s.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),t.transitModes.bike||i.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),t.transitModes.train||d.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"))}function o(t){n=a.create("div",{id:"TravelNotes-Control-ItineraryButtonsDiv",className:"TravelNotes-Control-ButtonsDiv"},t),(i=a.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AoaESkaC0SxrgAABMdJREFUSMfNl1loVGcYhp//n+WcZmbiJE4WjVKVaLWOGxglilFTSmYUF1ILKiIILSjplQiKS65EXG4UvBGrQvVCUAdjoRrEGmtwjQbtWKlpEsTGGDMxkzKTzHr+XiRucbK4ts/lOd/5X853vuU9gj4YN+48Dx58DUBOzrmhnZ0qXykWJBKqKJlkYjyusgAsFtFqMnHPbBa/CcEvaWnir5YWT1vvM3ojUl2cPv1XamqK8fv/MBcWPtwfDhuLlWKYUvSLECAEzTabPHP16uc/uN1fJp6fNShhpRROZ+WSzk7jVDyuTLwDFotIpqXJb4LBkgohRP/Cbvc5/H6krhsnolFVOtAbDoQQoGnCF4nIb91uDL/f8+KefDXQ70e6XOpIJPL+ot2Zg0hElbpc6ojf/7qWBPB6q1FKoevqRCBgrOYDEwgYq3VdnVBK4fVWd2cjL6+SpqYSnM5zi4PBZAUfEafTtCQY9JzJy6tENjWVsH79ZWs4bJziIxMOG6fWr79sbWoq6S4uTTt7MBo1vuMToGnyx2jU+71ITz/rCoWM3w2D3AFKBUj0NIL5nYWl5IndLidJw2CsUgOJwtSp6SQSC7h5czZO50vhIUPMTJrkYMIEO8OHa4Op9FzDYKyUEs9gWqelJUpbm8GcOdcJBmOAARjEYgZFRUOoqZnNyJGDEkZKPOZIRM0bTIricUU8blBePhaQKAXJZBzDUMyYkcnly21cvx7sPRpSEomoeWZgQv9hSUAxYoSD8+efsmdPIxkZVgBMJrDZTKxdO4YLF56Sm/sZT5509jzX76SdYI7FurdMKoqKMti8eQyZmVakFOTkaGzaFGP79gZCoSSaJpk82UFl5VN2727k+PEpxGIGHR0Jdu5s4Natf1KeG4uprD7Lc86cDPbuHc/y5Xd4/DhKa+tXNDZ2cfJkC9euFXLw4EMMA6ZNG8KOHfUcPjyZKVPSWbnyNg0NEXy+aaxadYcbN1KLS6tVtKZK75YtY1ix4i51dZ0sWpTF3bshurqSZGdruN3VLFyYS3HxUEKhJAsXZpGbq1Faeovt28dz716IpUtvs21bfs+neh2rVbSagftAVu+edTotdHUl0XVJdraV+fOvcejQJPLzbSj1lHXr/GiapL09gc83lWg0ycyZDk6ffozNZiIUSpKdbe3p/ze4LzVNVKVIBJcuteHxuOjqSrJvXyNpaSaKi134fM2AoL6+C6/Xxf79X7Bx45/Y7RZ27XpIeXkdoVCcuXMzuXIldZVrmqgSdvvZwnDYuNK7l9PTzVRVzUAIQV1dmLlzh7Jhw32OHm16ZY0r8vPTSCQUXm8WW7fmc/p0C263g5wcK7NmXePZs/gbO9pmk7MGGJkJvN5cRo9O4+efW3j0KNKXaQEMJk50sGzZMOrrwxw79nfKlno+MgexJFR/Lumt458vCQlQVmYvs1hEgj79oHiLNdB3vMUiEmVl9rL/3gh4vdW0t5ec0XXp+1iiui597e0lZ7zeal4YgZecky6XOvKhfZfLJX8KBMQa8BgpXabbjREIiDW6LnxCvL+gEKDrwhcIiDVuN8b/wtCnXJ4FBRfp6PBU1NaO0h0OeUBKmgeTASFASpodDnmgtnaU3tHhqSgouDj4f6dP8dP2L6C7Ld6Z4dDBAAAAAElFTkSuQmCC",id:"TravelNotes-Control-bikeImgButton",className:"TravelNotes-Control-ImgButton"},n)).transitMode="bike",i.addEventListener("click",u,!1),(s=a.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AoaESo7bADyMwAABNlJREFUSMe1V19oU1cY/52Te5Ob3DR/SfzTNNCufxRXxmarONCnPbi+ykYrFdRSkeJLX5ykZcKcFfG5oIJ2Y2sVFZQ+iPoiUhC128OIiJrUlgQTm9o0t23SJufmnj2k2ura5syx7ynknu/7nd93vr8E6wghBJxzAEAgAEsmc3pToWD1y3L6M8NQfABA6eIUY54xs3kh5Xb3JONx5D/WXdX2Wh9crkPIZAbAOVBRcbpvYaHuO87lDZyTCs7lFaochDAQwucANmmzRa7PzfWECFm2IQTsdrdiZuYqHI5quVg80J7P113WdR+AIsTEBEmagsUSOayq539PpVLM5WpFJnO1POOtW+GMRH4dKRa9jZxTABz/TggIMSDLU+Fg8NDuaBTaxyfoux8ORxsAwG7vrI5Ehl7pur+Rc/IJoCX3c05QKGxsnJgYemW3d1avxPgH42AQzkRi6JWuOz3ljReX7k3KnpQkLb158/6aWGyZOS0F0kF4vX45mRwY0XV3WdCGBhsePvwa3d1BAEZZYF13e5LJgRGv1y87nQdLjCmlMAwDqvrj4Wx2x6XyDAw8eLADe/b4AQCqehu5nJj7bbYnHbncT5cppaCGYYBzIJ+vu7TiydcNnP7+GBKJRQwPJ5HL6YLvTlEo1F3iHDAMo4Rkt5/qK6UMFwK+du0NurvDePt2EQ0NdkE9Dl33wW4/1QcApKoKltevrz01DLVWNGKbmhwYHd1dCrEiR0vLY9y7Ny0UaJRmo5WV339OZ2b6NgGyXzRRVFXC4OCXKwwBd+/uRH//VkHmsn9mpm8TZUzxcU4comzb2zciEFCg6yWQZ8/mcOJEGF1dNaivV8tb4MTBmOKjkpSuLdXe8lJZacb5819g374/QEiphJpMBGfPvlxiTwSAZUjSdC0tdZnyCiYTwfBwMx49SuPOnSkA7P3/7/QZM4SC0zCsPkn0bX0+GU+eTCMUGgNAcO7cGEwmCbOzFITI2Lv3ESYmFsWruar2tmWzu4bEjhtLxY4jn/8G2ayByck8mpsfY36+CPEAfbif6ronSggTLgKAgQsXtmF+nuLIkTC2bHGhpcUj3EwIYdB1b5TK8uIUIXxW9LbBoBXt7VW4ciWOGzeSuHnzNQYHvxJ3MeGzZvPiFHW7Q0mApcTUiujtrYHVChw79hyAjOPHX6JYJLh4cZtQwyCEpVyuUJLG48hbrS+uA6aySvX1Kjo7q9HV9fS9a6PRHG7dSqCtLYBAwFp2OlGUF9fjceRJKbcAWf6N67p3zbciBBgZ2Ym6OjsaGh4gk1luDmYzQT7/LUKhZzhzZnyN0kkgSdNg7AAhBKCUUhACWCyRjvVc1dxcgV273Dh58jkymQ+DsVAwcPToX1AUsm5GmM2RjiXQ0tVcroMAbsvZ7Nk/GdvYuNoF/H4ZGzZYEA7PrcpIUSgoBXI5Y9VskOU3Yafzh+2MtTBN++W/jD7iIklauqpqf834+Eejz7tBLBaDpij3myRJS4sNBeXzXpK0tKLcbxofh+Z0tq0/3tbWwhmLDYww5vv/x9vlDaIV0Sg0jye03WYbPSxJ0xBJtQ8H+mlus412eDwntkej0Fyu1k9dYX7uW1ioX3OFoZQB4HOEsEmr9RNXmLWWtspKWDRt9aVN1z1jsryQcjh6komE2NL2N0SHF0QJfjNNAAAAAElFTkSuQmCC",id:"TravelNotes-Control-pedestrianImgButton",className:"TravelNotes-Control-ImgButton"},n)).transitMode="pedestrian",s.addEventListener("click",u,!1),(l=a.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AoaESgBmDpJAwAABQBJREFUSMe9V09MFFcY/703szOz7PLP2WVBV6rtdm21HqhG2wiCh8bL2jWhsl71IhqJJ4oHL4RIxKP1HzESLh4MEGPkoAeNYRWtGkPShGRF+aeFld2psd0BZnZmXg+LW4SdrW3EX/Iub775fe/7977vEdigrCyMmZnrAABZbvGoavkGSh0hy3LtNAzuS57nZAAwTVPhOHOEUnXAstL9Ltd0TFFOJ5dyLAXJtSnLMhRFwaNHoDt3nj2v66vDjHHljDkAsIXf2CKKzB4haRBixgVh6vrAwNEj27bB8ng8SCaTH6aYMcDtPh3StM/6DKNIACz8N1Dw/J+6KI7Xp1It/YTkkliEwsJmnD8PIopdvbOzX90wDPf/UAoAFgzDLczOfn1Dkrp6T5wAKSpqtre4tRXk5MkLV3W9ch8+IgRhsqel5XCkrS0bn4xiWZaRTCqQpK5eTfPVYwUgiq/75ucP/uT1ZmJOvd4wFEWBy9UR0nXPiigFAF331LtcHaFkMomysnDG4mgUdNeuq3OZmK4ceD6lP34ccVZVwSIZN5y9qGlfHLJPJAa/X4LbzeUlnp21MDk5Z1csAChE8XmnpjU1Eln+2fPmzXe/WZZYbkcoyxympn6AaaahKCrIkvpgjKGkpACSJCAQuI2JibR9oVEtXlz862ZeVSs2MMaV57NkzRoHBIFi06aHGB5+m/XC4sIIBAoxMrILfr+YVzFjXPncXPkGSikfytxIeapyIQKHDlUAAIJBN3p7t+Lata0IBt0AGBobVy/IsrxcjDlACL+Htyx3zT+nz3GnEqCyUkJ39wSOHYvh7t1vUVvrz37fu3cNotHfUVs7BElywO+XAKj5VIMxdw01TS5onwwWHjzYjp6ebaiokFBdXYJUSl8mNT9voq6uBH6/hO7uLXjy5HtQamsKTJMLUo7j5NwWMxw44Mf27TIKCnjs3u1DNFqDVGq5bDJp4M6dHQiHV6OggMeWLaU4enQt7Hg5jltF88WjqIjPNo13aGj4fJnc/v3r32swAFBcnD9vqGmaSm5XE5w58xINDYMgBKiru4ebN+NIpxlGR1WMjWXW6KgKTbMwOKigunoAhACHDz/CqVNjsOM1TVPhBOHHsGG4KnOfK41z577BunWFcDgscByDzyfh9u04Xr5UMTmZWT6fhFevVAQCBaiqKkVpKYfLl6fzNI3UEE9pKgr4duSOB0EqZQAAVNXAyIiKp0/fgudJ1qWEAJcujYEQAll2LMiaiwaG5ZyEpKK8ZRn9hKSPM8bnul3R1TWJUGgtLlyYwtDQX3njtn69E01NQVy58gqMEZvyTIMxo586ndMxQsy4Hdn4eBr37ycwPj6/YIH9mprScO9eAs+eaXnuBTPudE7HFprELxc1LZCnSVhLh5W804e9LIUgPO/U9aZGAgDDw6CbN1+dM82VbYscl9JjsYgzEIBFy8rC2LgRlihO1BNirphSQkyI4nh9IAArOwh4vV7MzCQ+7egDAIlEAoQAra0H9wnCRM/HVioIEz2trQf3EYLsjP1eFrS3N7Pjx49ERPF138dwe8a9r/va2o5E2tub2QcO9B0hTVv3aQb6d/B4ZKhqS/+tWxGnJL3opFSLE2IsOifJcXYCQgxQqsUl6UXn4GDEqaot/V6v58PfTpmECyORWPpo4/dYlrvGMLggz3OrFh5tf1BqPuO4VNSyjBsuVzymKB3/+mj7G1dPIltjqpC6AAAAAElFTkSuQmCC",id:"TravelNotes-Control-carImgButton",className:"TravelNotes-Control-ImgButton"},n)).transitMode="car",l.addEventListener("click",u,!1),(d=a.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4goTCiEjvCsRvgAABXRJREFUSMe9V11MFFcU/u7MsDPLrgvu7A80BEhLsRIxEFIlcSXBF41BN2ExqC8kPHQraV80iA+GhKAYaLUihkLaaErig1FCiCZq2kQDjS0YfcGYQKtBg7DL7hbFHdaZnTu3D0tR7C7aRvxeJrn3zP3O3z3nXIIUcLm8mJ0dBADIcpNDUbLWcVxalWFYKnSd/1QQeBkAKKURnqd/cJwyZBjxqxbLzHgk0hF+84w3QZItyrKMSCSC0VFwFRVnuzXtIy9jfBZjaQDY4m/stSMSa4TEQQgNmEzTg0NDXzVs2gTD4XAgHA6/GzFjgNXaUaWqef26bjMBBv4bOAjCvCaKk75otOkqIckkXsOaNY3o7gYRxXOXFxY+u6Lr1v9BCgAGdN1qWlhYf0WSzl0+ehTEZmtMbXFLC8jx499f1LTcPXiPMJmeXGpqOlDb2roUnwSxLMsIhyOQpHOXVdXtwypAFIP9L1/W1zidiZhzTqcXkUgEFkt7laY5VoUUADTN4bNY2qvC4TBcLm/C4uFhcJWVF2OJmK4eBCGq3blTay4thUESbjjbo6qf+JMlks3GYX7egNfrgtv9A+bn55Geng673Y7du3eD0iL4/ffx6JECm03A3JwOxlJnuyj+2auqX3/Jy/Jhh6Ks72SMtyZPDAJNY9i40Yq+vi9QU1OD6elp5OXlIRgMorp6C4qL14BSBkWhCAY1CAJgJL0MDIyl52Rm5v8kKEr2Osb4rJQXw0iob7ebMDIygvLy8qW9/Px89PT0oKSkBGfOfItTpwK4fz8KWU5DMBhH8hrBZ8ViWes4jhOqEhUpORwOEW63Cdu2CSgvL8fY2BgYY2CMobOzEzt27IDD4UBnZydevEi42WYTUp7HWBoIEXYJhmHd+qr8/Rvd3RuQns5j374NOH/+PLKzs9HX1wdCCOx2O+rq6pCTkwNN00AIQSCgYnx8AUAsFTUYs24VKOULl9fe5XjyJIbm5s9x4sQJlJSUwO12g1KaUtHe3l7k5lbg3r35FBIElPKFHM/z8koWHzu2BUNDQ7h27RpKS0tXJAUAv9+Pykr7ChIMPM/bhbfdPb/fj4GBAfT39y+tud1ubN68GRkZGQiFQpiamsKzZ8+gKApisRhGR/sAFK18pymlEYA4U1lNKUVlZSUuXLiA7du3w25fbg1J0nri8Tiam39ewdU0IvA8nYjHmTOVZnv37kVhYSE8Hg/YYmX45zs5OYmZmRmUlZVBkqTF0qhB1/W3uJpOcBwXHU7RlgEA1dXV4HkegiDgwIEGdHR8A13XQQjBxMQEPB4P2tvbl+T379+PgwcPrUBMQEh0mEjSd1tU9eNfGUse7p07HcjOlvD0aRPMZjMGBgaW9nw+HyoqKqAoCjRNA6UUU1NTuH79OmZmfkxOS3SI4iMPWbv2sOP58/IxwxBTVi9CgPr6HITDzXC5XJAkCV1dXSltOnToF5w8qSav1pwayMj4vViYm+sIi2LXoKoWJG0SZjOBIHAoK7OB484gM/M31NXV4e7du7h5U0Ju7gzM5hhu3bqFkZEReDzHcfr0wgoj0dPBubmOMAGABw/AFRdfjFG6um2R56Pa+HituaAABudyeVFUBEMUH/sIoatGSgiFKE76CgpgLA0CTqcTs7OhDzv6AEAoFAIhQEtL/R6T6fGl901qMj2+1NJSv4cQLM3Yy8bbtrZGduRIQ60oBvvfh9sT7g32t7Y21La1NbJ3HOjbq1Q1/8MM9K+avwxFabp640atWZIe9nKcGiBEf01PkkR3AkJ0cJwakKSHvbdv15oVpemq0+l497dTIuG8CIXefLQJuwzDulXX+UJB4O2LTeQvjqMTPB8dNgz9isUSGI9E2t/6aPsbwfNWty4y/a8AAAAASUVORK5CYII=",id:"TravelNotes-Control-trainImgButton",className:"TravelNotes-Control-ImgButton"},n)).transitMode="train",d.addEventListener("click",u,!1),v.providers&&(r=!1,v.providers.forEach(e))}var n=null,a=g("../UI/HtmlElementsFactory")(),r=!1,i=null,s=null,l=null,d=null;return Object.seal({createUI:function(t){o(t)},get provider(){return v.routing.provider},set provider(t){!function(t){var e=document.getElementById("TravelNotes-Control-"+t+"ImgButton");e&&e.click()}(t)},get transitMode(){return v.routing.transitMode},set transitMode(t){!function(t){var e=document.getElementById("TravelNotes-Control-"+t+"ImgButton");e&&e.click()}(t)}})})}()},{"../L.TravelNotes":8,"../UI/HtmlElementsFactory":18,"../core/RouteEditor":37}],22:[function(I,t,e){!function(){"use strict";function r(t){if(t.stopPropagation(),-1!==I("../L.TravelNotes").routeEdition.routeInitialObjId){document.getElementById("TravelNotes-Control-RouteHeaderDiv").classList.toggle("TravelNotes-Control-SmallHeader"),document.getElementById("TravelNotes-Control-RouteDataDiv").classList.toggle("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-RouteButtonsDiv").classList.toggle("TravelNotes-Control-HiddenList");var e=document.getElementById("TravelNotes-Control-RouteDataDiv").classList.contains("TravelNotes-Control-HiddenList");document.getElementById("TravelNotes-Control-RouteExpandButton").innerHTML=e?"&#x25b6;":"&#x25bc;",document.getElementById("TravelNotes-Control-RouteExpandButton").title=e?T.getText("RouteEditorUI - Show"):T.getText("RouteEditorUI - Hide")}}function i(t){t.stopPropagation(),I("../core/WaypointEditor")().removeWayPoint(t.itemNode.dataObjId)}function s(t){t.stopPropagation(),I("../core/WaypointEditor")().swapWayPoints(t.itemNode.dataObjId,!0)}function l(t){t.stopPropagation(),I("../core/WaypointEditor")().swapWayPoints(t.itemNode.dataObjId,!1)}function d(t){t.stopPropagation(),I("../core/WaypointEditor")().renameWayPoint(t.dataObjId,t.changeValue)}function c(t){t.stopPropagation(),I("../core/WaypointEditor")().wayPointDropped(t.draggedObjId,t.targetObjId,t.draggedBefore)}function u(t){t.stopPropagation(),document.getElementById("TravelNotes-Control-RouteDataDiv").classList.toggle("TravelNotes-Control-ExpandedList");var e=document.getElementById("TravelNotes-Control-RouteDataDiv").classList.contains("TravelNotes-Control-ExpandedList");document.getElementById("TravelNotes-Control-ExpandWayPointsListButton").innerHTML=e?"&#x25b3;":"&#x25bd;",document.getElementById("TravelNotes-Control-ExpandWayPointsListButton").title=e?T.getText("RouteEditorUI - Reduce the list"):T.getText("RouteEditorUI - Expand the list")}function v(t){t.stopPropagation(),I("../core/RouteEditor")().cancelEdition()}function g(t){t.stopPropagation(),I("../core/RouteEditor")().saveEdition()}function p(t){t.stopPropagation(),I("../core/RouteEditor")().saveGpx()}function m(t){t.stopPropagation(),I("../core/WaypointEditor")().reverseWayPoints()}function f(t){t.stopPropagation(),I("../core/WaypointEditor")().removeAllWayPoints()}var T=I("./Translator")(),N=null;void 0!==t&&t.exports&&(t.exports=function(){return Object.seal({createUI:function(t){!function(t){if(!document.getElementById("TravelNotes-Control-RouteDataDiv")){var e=I("./HTMLElementsFactory")(),o=e.create("div",{id:"TravelNotes-Control-RouteHeaderDiv",className:"TravelNotes-Control-HeaderDiv"},t);e.create("span",{innerHTML:"&#x25bc;",id:"TravelNotes-Control-RouteExpandButton",className:"TravelNotes-Control-ExpandButton"},o).addEventListener("click",r,!1),e.create("span",{innerHTML:T.getText("RouteEditorUI - Waypoints"),id:"TravelNotes-Control-RouteHeaderText",className:"TravelNotes-Control-HeaderText"},o);var n=e.create("div",{id:"TravelNotes-Control-RouteDataDiv",className:"TravelNotes-Control-DataDiv"},t);(N=I("./SortableList")({minSize:0,listStyle:"LimitedSort",id:"TravelNotes-Control-RouteWaypointsList"},n)).container.addEventListener("SortableListDelete",i,!1),N.container.addEventListener("SortableListUpArrow",s,!1),N.container.addEventListener("SortableListDownArrow",l,!1),N.container.addEventListener("SortableListChange",d,!1),N.container.addEventListener("SortableListDrop",c,!1);var a=e.create("div",{id:"TravelNotes-Control-RouteButtonsDiv",className:"TravelNotes-Control-ButtonsDiv"},t);e.create("div",{id:"TravelNotes-Control-ExpandWayPointsListButton",className:"TravelNotes-Control-Button",title:T.getText("RouteEditorUI - Expand the list"),innerHTML:"&#x25bd;"},a).addEventListener("click",u,!1),e.create("div",{id:"TravelNotes-Control-CancelRouteButton",className:"TravelNotes-Control-Button",title:T.getText("RouteEditorUI - Cancel"),innerHTML:"&#x274c"},a).addEventListener("click",v,!1),e.create("div",{id:"TravelNotes-Control-SaveRouteButton",className:"TravelNotes-Control-Button",title:T.getText("RouteEditorUI - Save"),innerHTML:"&#x1f4be;"},a).addEventListener("click",g,!1),e.create("div",{id:"TravelNotes-Control-gpxButton",className:"TravelNotes-Control-Button",title:T.getText("RouteEditorUI - Save the route in a gpx file"),innerHTML:"gpx"},a).addEventListener("click",p,!1),e.create("div",{id:"TravelNotes-Control-ReverseWayPointsButton",className:"TravelNotes-Control-Button",title:T.getText("RouteEditorUI - Invert waypoints"),innerHTML:"&#x21C5;"},a).addEventListener("click",m,!1),e.create("div",{id:"TravelNotes-Control-RemoveAllWayPointsButton",className:"TravelNotes-Control-Button",title:T.getText("RouteEditorUI - Delete all waypoints"),innerHTML:"&#x267b;"},a).addEventListener("click",f,!1)}}(t)},expand:function(){document.getElementById("TravelNotes-Control-RouteExpandButton").innerHTML="&#x25bc;",document.getElementById("TravelNotes-Control-RouteExpandButton").title="Masquer",document.getElementById("TravelNotes-Control-RouteDataDiv").classList.remove("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-RouteButtonsDiv").classList.remove("TravelNotes-Control-HiddenList")},reduce:function(){document.getElementById("TravelNotes-Control-RouteExpandButton").innerHTML="&#x25b6;",document.getElementById("TravelNotes-Control-RouteExpandButton").title="Afficher",document.getElementById("TravelNotes-Control-RouteDataDiv").classList.add("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-RouteButtonsDiv").classList.add("TravelNotes-Control-HiddenList")},setWayPointsList:function(){!function(){if(N.removeAllItems(),-1!==I("../L.TravelNotes").routeEdition.routeInitialObjId)for(var t=I("../L.TravelNotes").editedRoute.wayPoints.iterator;!t.done;){var e=t.first?"A":t.last?" B":t.index,o=t.first?T.getText("RouteEditorUI - Start"):t.last?T.getText("RouteEditorUI - End"):T.getText("RouteEditorUI - Via");N.addItem(t.value.UIName,e,o,t.value.objId,t.last)}}()}})})}()},{"../L.TravelNotes":8,"../core/RouteEditor":37,"../core/WaypointEditor":41,"./HTMLElementsFactory":16,"./SortableList":25,"./Translator":26}],23:[function(g,t,e){!function(){"use strict";var v=g("../UI/Translator")();void 0!==t&&t.exports&&(t.exports=function(t){var e=g("../UI/ColorDialog")(t.color);e.title=v.getText("RoutePropertiesDialog - Route properties"),e.addClickOkButtonEventListener(function(){return t.color=e.getNewColor(),t.width=parseInt(r.value),t.chain=u.checked,t.dashArray=s.selectedIndex,g("../core/MapEditor")().editRoute(t),g("../core/RouteEditor")().chainRoutes(),g("../UI/TravelEditorUI")().setRoutesList(),g("../core/TravelEditor")().updateRoadBook(),!0});var o=g("./HTMLElementsFactory")(),n=o.create("div",{id:"TravelNotes-RoutePropertiesDialog-MainDataDiv"},e.content),a=o.create("div",{className:"TravelNotes-RoutePropertiesDialog-DataDiv",id:"TravelNotes-RoutePropertiesDialog-WithDiv"},n);a.innerHTML="<span>"+v.getText("RoutePropertiesDialog - Width")+"</span>";var r=o.create("input",{type:"number",id:"TravelNotes-RoutePropertiesDialog-WidthInput"},a);r.value=t.width,r.min=1,r.max=40;var i=o.create("div",{className:"TravelNotes-RoutePropertiesDialog-DataDiv",id:"TravelNotes-RoutePropertiesDialog-dashDiv"},n);i.innerHTML="<span>"+v.getText("RoutePropertiesDialog - Linetype")+"</span>";for(var s=o.create("select",{className:"TravelNotes-RoutePropertiesDialog-Select",id:"TravelNotes-RoutePropertiesDialog-DashSelect"},i),l=g("../L.TravelNotes").config.route.dashChoices,d=0;d<l.length;d++)s.add(o.create("option",{text:l[d].text}));s.selectedIndex=t.dashArray<l.length?t.dashArray:0;var c=o.create("div",{className:"TravelNotes-RoutePropertiesDialog-DataDiv",id:"TravelNotes-RoutePropertiesDialog-ChainDiv"},n);c.innerHTML="<span>"+v.getText("RoutePropertiesDialog - Chained route")+"</span>";var u=o.create("input",{type:"checkbox",id:"TravelNotes-RoutePropertiesDialog-ChainInput"},c);return u.checked=t.chain,e})}()},{"../L.TravelNotes":8,"../UI/ColorDialog":11,"../UI/Translator":26,"../UI/TravelEditorUI":27,"../core/MapEditor":34,"../core/RouteEditor":37,"../core/TravelEditor":40,"./HTMLElementsFactory":16}],24:[function(g,t,e){!function(){"use strict";function r(t){"Enter"===t.key&&l(t)}var i=g("../core/OsmSearchEngine")(),s="",l=function(t){s=document.getElementById("TravelNotes-Control-SearchInput").value;for(var e=document.getElementById("TravelNotes-Control-SearchDiv"),o=document.getElementsByClassName("TravelNotes-Control-SearchResult");0!==o.length;)o[0].removeEventListener("click",d,!1),o[0].removeEventListener("contextmenu",c,!1),o[0].removeEventListener("mouseenter",u,!1),o[0].removeEventListener("mouseleave",v,!1),e.removeChild(o[0]);if(!document.getElementById("TravelNotes-Control-SearchWaitBullet")){var n=g("./HTMLElementsFactory")();n.create("div",{id:"TravelNotes-Control-SearchWaitBullet"},n.create("div",{id:"TravelNotes-Control-SearchWait"},e))}i.search()},d=function(t){t.stopPropagation();for(var e=t.target;!e.latLng;)e=e.parentNode;g("../core/MapEditor")().zoomToSearchResult(e.latLng,e.geometry)},c=function(t){t.stopPropagation(),t.preventDefault();for(var e=t.target;!e.latLng;)e=e.parentNode;g("../core/NoteEditor")().newSearchNote(e.searchResult)},u=function(t){t.stopPropagation(),g("../core/MapEditor")().addSearchPointMarker(t.target.objId,t.target.latLng,t.target.geometry)},v=function(t){t.stopPropagation(),g("../core/MapEditor")().removeObject(t.target.objId)};void 0!==t&&t.exports&&(t.exports=function(){return Object.seal({remove:function(){!function(){var t=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(t){i.hide();var e=document.getElementById("TravelNotes-Control-SearchButton");e&&e.removeEventListener("click",l,!1);var o=document.getElementById("TravelNotes-Control-SearchInput");o&&o.removeEventListener("change",l,!1);var n=document.getElementById("TravelNotes-Control-SearchDiv"),a=document.getElementsByClassName("TravelNotes-Control-SearchResult");Array.prototype.forEach.call(a,function(t){t.removeEventListener("click",d,!1),t.removeEventListener("contextmenu",c,!1),t.removeEventListener("mouseenter",u,!1),t.removeEventListener("mouseleave",v,!1)}),n&&t.removeChild(n)}}()},add:function(){!function(){document.getElementById("TravelNotes-Control-ItineraryPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-TravelNotesPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-SearchPaneButton").classList.add("TravelNotes-Control-ActivePaneButton");var t=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(t){i.show();var o=g("./HTMLElementsFactory")(),n=o.create("div",{id:"TravelNotes-Control-SearchDiv"},t);o.create("div",{id:"TravelNotes-Control-SearchButton",className:"TravelNotes-Control-Button",title:g("./Translator")().getText("SearchPaneUI - Search OpenStreetMap"),innerHTML:"&#x1f50e"},n).addEventListener("click",l,!1);var e=o.create("input",{type:"text",id:"TravelNotes-Control-SearchInput",placeholder:g("./Translator")().getText("SearchPaneUI - Search phrase"),value:s},n);e.addEventListener("change",l,!1),e.addEventListener("keydown",r,!1),e.focus();var a=0;g("../L.TravelNotes").searchData.forEach(function(t){var e=o.create("div",{id:"TravelNotes-Control-SearchResult"+a++,className:"TravelNotes-Control-SearchResult",innerHTML:(""!=t.description?"<p class='TravelNotes-Control-SearchResultDescription'>"+t.description+"</p>":"")+(t.tags.name?"<p>"+t.tags.name+"</p>":"")+(t.tags["addr:street"]?"<p>"+t.tags["addr:street"]+" "+(t.tags["addr:housenumber"]?t.tags["addr:housenumber"]:"")+"</p>":"")+(t.tags["addr:city"]?"<p>"+(t.tags["addr:postcode"]?t.tags["addr:postcode"]+" ":"")+t.tags["addr:city"]+"</p>":"")+(t.tags.phone?"<p>"+t.tags.phone+"</p>":"")+(t.tags.email?"<p><a href='mailto:"+t.tags.email+"'>"+t.tags.email+"</a></p>":"")+(t.tags.website?"<p><a href='"+t.tags.website+"' target='_blank'>"+t.tags.website+"</a></p>":"")+(t.ranking?"<p>&#x26ab;"+t.ranking+"</p>":"")},n);e.searchResult=t,e.objId=g("../data/ObjId")(),e.osmId=t.id,e.latLng=L.latLng([t.lat,t.lon]),e.geometry=t.geometry,e.addEventListener("click",d,!1),e.addEventListener("contextmenu",c,!1),e.addEventListener("mouseenter",u,!1),e.addEventListener("mouseleave",v,!1)})}}()}})})}()},{"../L.TravelNotes":8,"../core/MapEditor":34,"../core/NoteEditor":35,"../core/OsmSearchEngine":36,"../data/ObjId":50,"./HTMLElementsFactory":16,"./Translator":26}],25:[function(n,t,e){!function(){"use strict";function d(t){t.stopPropagation();try{t.dataTransfer.setData("Text",t.target.dataObjId),t.dataTransfer.dropEffect="move"}catch(t){}s=t.target.dataObjId-1}function a(t){t.preventDefault()}function r(t){t.preventDefault();for(var e=t.target;!e.dataObjId;)e=e.parentElement;var o=e.getBoundingClientRect(),n=new Event("SortableListDrop");n.draggedObjId=s+1,n.targetObjId=e.dataObjId,n.draggedBefore=t.clientY-o.top<o.bottom-t.clientY,e.parentNode.dispatchEvent(n)}function c(t){var e=new Event("SortableListDelete");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()}function u(t){var e=new Event("SortableListUpArrow");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()}function v(t){var e=new Event("SortableListDownArrow");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()}function g(t){var e=new Event("SortableListRightArrow");e.itemNode=t.target.parentNode,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()}function p(t){var e=new Event("SortableListChange");e.dataObjId=t.target.parentNode.dataObjId,e.changeValue=t.target.value,t.target.parentNode.parentNode.dispatchEvent(e),t.stopPropagation()}function i(t){t.deltaY&&(t.target.scrollTop=t.target.scrollTop+10*t.deltaY),t.stopPropagation()}function o(t,e){var l=n("./HTMLElementsFactory")();this.items=[],this.removeAllItems=function(){for(var t=0;t<this.items.length;t++)this.container.removeChild(this.items[t]);this.items.length=0},this.addItem=function(t,e,o,n,a){t=t||"",e=e||"",o=o||"",n=n||-1;var r=l.create("div",{draggable:!1,className:"TravelNotes-SortableList-Item"});l.create("div",{className:"TravelNotes-SortableList-ItemTextIndex",innerHTML:e},r);var i=l.create("input",{type:"text",className:"TravelNotes-SortableList-ItemInput",placeholder:o,value:t},r);i.addEventListener("change",p,!1),i.addEventListener("focus",function(t){t.target.parentElement.draggable=!1},!1),i.addEventListener("blur",function(t){t.target.parentElement.draggable=t.target.parentElement.canDrag},!1),l.create("div",{className:"TravelNotes-SortableList-ItemUpArrowButton",title:m.getText("SortableList - Move up"),innerHTML:String.fromCharCode(8679)},r).addEventListener("click",u,!1),l.create("div",{className:"TravelNotes-SortableList-ItemDownArrowButton",title:m.getText("SortableList - Move down"),innerHTML:String.fromCharCode(8681)},r).addEventListener("click",v,!1);var s=l.create("div",{className:"TravelNotes-SortableList-ItemRightArrowButton",title:m.getText("SortableList - Edit"),innerHTML:String.fromCharCode(8688)},r);"AllSort"===this.options.listStyle&&s.addEventListener("click",g,!1),l.create("div",{className:"TravelNotes-SortableList-ItemDeleteButton",title:m.getText("SortableList - Delete"),innerHTML:"&#x267b;"},r).addEventListener("click",c,!1),r.dataObjId=n,r.canDrag=!1,("LimitedSort"!==this.options.listStyle||1<this.items.length)&&!a&&(r.draggable=!0,r.addEventListener("dragstart",d,!1),r.classList.add("TravelNotes-SortableList-MoveCursor"),r.canDrag=!0),this.items.push(r),this.container.appendChild(r)},this._create=function(t,e){for(var o in this.options={minSize:2,listStyle:"AllSort",id:"TravelNotes-SortableList-Container"},t)this.options[o]=t[o];"LimitedSort"===this.options.listStyle&&this.options.minSize<2&&(this.options.minSize=0),this.container=l.create("div",{id:t.id,className:"TravelNotes-SortableList-Container"}),this.container.classList.add(this.options.listStyle),this.container.addEventListener("drop",r,!1),this.container.addEventListener("dragover",a,!1),this.container.addEventListener("wheel",i,!1),e&&e.appendChild(this.container);for(var n=0;n<this.options.minSize;n++)this.addItem()},this._create(t,e)}var m=n("../UI/Translator")(),s=0;void 0!==t&&t.exports&&(t.exports=function(t,e){return new o(t,e)})}()},{"../UI/Translator":26,"./HTMLElementsFactory":16}],26:[function(t,e,o){(function(n){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){return n.translations||(n.translations=new Map),{setTranslations:function(t){t.forEach(function(t){n.translations.set(t.msgid,t.msgstr)})},getText:function(t,e){var o=n.translations.get(t);return e&&o&&Object.getOwnPropertyNames(e).forEach(function(t){o=o.replace("{"+t+"}",e[t])}),o||t}}})}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],27:[function(B,t,e){!function(){"use strict";function c(t){o&&(clearTimeout(o),o=null),document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Minimize"),document.getElementById("TravelNotes-Control-MainDiv").classList.add("TravelNotes-Control-MainDiv-Maximize")}function e(){document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Maximize"),document.getElementById("TravelNotes-Control-MainDiv").classList.add("TravelNotes-Control-MainDiv-Minimize")}function u(t){o=setTimeout(e,R.config.travelEditor.timeout)}function v(t){t.stopPropagation(),document.getElementById("TravelNotes-Control-TravelHeaderDiv").classList.toggle("TravelNotes-Control-SmallHeader"),document.getElementById("TravelNotes-Control-TravelDataDiv").classList.toggle("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-ControlTravelButtonsDiv").classList.toggle("TravelNotes-Control-HiddenList");var e=document.getElementById("TravelNotes-Control-TravelDataDiv").classList.contains("TravelNotes-Control-HiddenList");document.getElementById("TravelNotes-ControlTravelExpandButton").innerHTML=e?"&#x25b6;":"&#x25bc;",document.getElementById("TravelNotes-ControlTravelExpandButton").title=e?M.getText("TravelEditorUI - Show"):M.getText("TravelEditorUI - Hide"),t.stopPropagation()}function g(t){var e=document.getElementById("TravelNotes-Control-MainDiv");10060===t.target.innerHTML.charCodeAt(0)?(t.target.innerHTML="&#x1f4cc;",e.addEventListener("mouseenter",c,!1),e.addEventListener("mouseleave",u,!1)):(t.target.innerHTML="&#x274c;",e.removeEventListener("mouseenter",c,!1),e.removeEventListener("mouseleave",u,!1))}function p(t){t.stopPropagation(),B("../core/TravelEditor")().removeRoute(t.itemNode.dataObjId)}function m(t){t.stopPropagation(),B("../core/TravelEditor")().swapRoute(t.itemNode.dataObjId,!0)}function f(t){t.stopPropagation(),B("../core/TravelEditor")().swapRoute(t.itemNode.dataObjId,!1)}function T(t){t.stopPropagation(),B("../core/TravelEditor")().editRoute(t.itemNode.dataObjId)}function N(t){t.stopPropagation(),B("../core/TravelEditor")().renameRoute(t.dataObjId,t.changeValue)}function I(t){t.stopPropagation(),B("../core/TravelEditor")().routeDropped(t.draggedObjId,t.targetObjId,t.draggedBefore)}function L(t){t.stopPropagation(),document.getElementById("TravelNotes-Control-TravelDataDiv").classList.toggle("TravelNotes-Control-ExpandedList");var e=document.getElementById("TravelNotes-Control-TravelDataDiv").classList.contains("TravelNotes-Control-ExpandedList");document.getElementById("TravelNotes-Control-ExpandRoutesListButton").innerHTML=e?"&#x25b3;":"&#x25bd;",document.getElementById("TravelNotes-Control-ExpandRoutesListButton").title=e?M.getText("TravelEditorUI - Reduce the list"):M.getText("TravelEditorUI - Expand the list")}function h(t){t.stopPropagation(),B("../core/TravelEditor")().clear(),B("../L.TravelNotes").config.travelEditor.startupRouteEdition&&B("../core/RouteEditor")().editRoute(B("../L.TravelNotes").travel.routes.first.objId),B("../L.TravelNotes").map.fire("travelnotesfileloaded",{readOnly:!1,name:""})}function y(t){t.stopPropagation(),B("../core/TravelEditor")().saveTravel()}function E(t){t.stopPropagation(),B("../core/RouteEditor")().cancelEdition(),B("../core/FileLoader")().openLocalFile(t)}function b(){B("../core/TravelEditor")().confirmClose()&&document.getElementById("TravelNotes-Control-OpenTravelInput").click()}function C(t){t.stopPropagation(),B("../core/FileLoader")().mergeLocalFile(t)}function D(t){document.getElementById("TravelNotes-Control-ImportTravelInput").click()}function x(t){t.stopPropagation(),B("../core/TravelEditor")().addRoute()}var M=B("./Translator")(),R=B("../L.TravelNotes"),j=null,o=null;void 0!==t&&t.exports&&(t.exports=function(){return Object.seal({createUI:function(t){!function(t){if(!document.getElementById("TravelNotes-Control-TravelDataDiv")){var e=B("./HTMLElementsFactory")(),o=e.create("div",{id:"TravelNotes-Control-TravelHeaderDiv",className:"TravelNotes-Control-HeaderDiv"},t);e.create("span",{innerHTML:"&#x25bc;",id:"TravelNotes-ControlTravelExpandButton",className:"TravelNotes-Control-ExpandButton"},o).addEventListener("click",v,!1),e.create("span",{innerHTML:M.getText("TravelEditorUI - Travel routes"),id:"TravelNotes-Control-TravelHeaderText",className:"TravelNotes-Control-HeaderText"},o);var n=e.create("span",{innerHTML:"&#x274c;",id:"TravelNotes-Control-PinButton"},o);n.addEventListener("click",g,!1);var a=e.create("div",{id:"TravelNotes-Control-TravelDataDiv",className:"TravelNotes-Control-DataDiv"},t);(j=B("./SortableList")({minSize:0,id:"TravelNotes-Control-TravelRoutesList"},a)).container.addEventListener("SortableListDelete",p,!1),j.container.addEventListener("SortableListUpArrow",m,!1),j.container.addEventListener("SortableListDownArrow",f,!1),j.container.addEventListener("SortableListRightArrow",T,!1),j.container.addEventListener("SortableListChange",N,!1),j.container.addEventListener("SortableListDrop",I,!1);var r=e.create("div",{id:"TravelNotes-ControlTravelButtonsDiv",className:"TravelNotes-Control-ButtonsDiv"},t);e.create("div",{id:"TravelNotes-Control-ExpandRoutesListButton",className:"TravelNotes-Control-Button",title:M.getText("TravelEditorUI - Expand the list"),innerHTML:"&#x25bd;"},r).addEventListener("click",L,!1),e.create("div",{id:"TravelNotes-Control-CancelTravelButton",className:"TravelNotes-Control-Button",title:M.getText("TravelEditorUI - Cancel travel"),innerHTML:"&#x274c"},r).addEventListener("click",h,!1),e.create("div",{id:"TravelNotes-Control-SaveTravelButton",className:"TravelNotes-Control-Button",title:M.getText("TravelEditorUI - Save travel"),innerHTML:"&#x1f4be;"},r).addEventListener("click",y,!1);var i=e.create("div",{id:"TravelNotes-Control-OpenTravelDiv"},r);e.create("input",{id:"TravelNotes-Control-OpenTravelInput",type:"file",accept:".trv"},i).addEventListener("change",E,!1);var s=e.create("div",{id:"TravelNotes-Control-OpenTravelFakeDiv"},i);e.create("div",{id:"TravelNotes-Control-OpenTravelButton",className:"TravelNotes-Control-Button",title:M.getText("TravelEditorUI - Open travel"),innerHTML:"&#x1F4C2;"},s).addEventListener("click",b,!1);var l=e.create("div",{id:"TravelNotes-Control-ImportTravelDiv"},r);e.create("input",{id:"TravelNotes-Control-ImportTravelInput",type:"file",accept:".trv,.map"},l).addEventListener("change",C,!1);var d=e.create("div",{id:"TravelNotes-Control-ImportTravelFakeDiv"},l);e.create("div",{id:"TravelNotes-Control-ImportTravelButton",className:"TravelNotes-Control-Button",title:M.getText("TravelEditorUI - Import travel"),innerHTML:"&#x1F30F;"},d).addEventListener("click",D,!1),e.create("div",{id:"TravelNotes-Control-OpenTravelRoadbookButton",className:"TravelNotes-Control-Button",title:M.getText("TravelEditorUI - Open travel roadbook"),innerHTML:'<a id="TravelNotes-Control-OpenTravelRoadbookLink" href="TravelNotesRoadbook.html?page='+R.UUID+'" target="_blank">&#x1F4CB;</a>'},r),e.create("div",{id:"TravelNotes-Control-AddRoutesButton",className:"TravelNotes-Control-Button",title:M.getText("TravelEditorUI - New route"),innerHTML:"+"},r).addEventListener("click",x,!1),R.config.travelEditor.startMinimized?(n.innerHTML="&#x1f4cc;",t.addEventListener("mouseenter",c,!1),t.addEventListener("mouseleave",u,!1),t.classList.add("TravelNotes-Control-MainDiv-Minimize")):t.classList.add("TravelNotes-Control-MainDiv-Maximize")}}(t)},setRoutesList:function(){!function(){j.removeAllItems();for(var t=R.travel.routes.iterator;!t.done;)j.addItem(t.value.name,t.value.chain?"&#x26d3;":"",M.getText("TravelEditorUI - Route"),t.value.objId,!1)}()}})})}()},{"../L.TravelNotes":8,"../core/FileLoader":32,"../core/RouteEditor":37,"../core/TravelEditor":40,"./HTMLElementsFactory":16,"./SortableList":25,"./Translator":26}],28:[function(d,t,e){!function(){"use strict";function n(t){t.stopPropagation();try{t.dataTransfer.setData("Text",t.target.dataObjId),t.dataTransfer.dropEffect="move"}catch(t){}l=t.target.noteObjId-1}function a(t){t.preventDefault()}function r(t){t.preventDefault();for(var e=t.target;!e.noteObjId;)e=e.parentElement;var o=e.getBoundingClientRect();d("../core/NoteEditor")().noteDropped(l+1,e.noteObjId,t.clientY-o.top<o.bottom-t.clientY)}function i(t){t.stopPropagation(),t.preventDefault();for(var e=t.target;!e.noteObjId;)e=e.parentNode;d("../core/MapEditor")().zoomToNote(e.noteObjId)}function s(t){t.stopPropagation(),t.preventDefault();for(var e=t.target;!e.noteObjId;)e=e.parentNode;d("../core/NoteEditor")().editNote(e.noteObjId)}var l=0;void 0!==t&&t.exports&&(t.exports=function(){return Object.seal({remove:function(){!function(){var t=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(t){var e=t.firstChild;e&&(e.childNodes.forEach(function(t){t.removeEventListener("click",i,!1),t.removeEventListener("contextmenu",s,!1),t.removeEventListener("dragstart",n,!1)}),t.removeChild(e))}}()},add:function(){!function(){document.getElementById("TravelNotes-Control-ItineraryPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-TravelNotesPaneButton").classList.add("TravelNotes-Control-ActivePaneButton"),window.osmSearch&&document.getElementById("TravelNotes-Control-SearchPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton");var t=d("../UI/HTMLViewsFactory")();t.classNamePrefix="TravelNotes-Control-";var e=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(e){var o=t.travelNotesHTML;o.addEventListener("drop",r,!1),o.addEventListener("dragover",a,!1),e.appendChild(o),o.childNodes.forEach(function(t){t.addEventListener("click",i,!1),t.addEventListener("contextmenu",s,!1),t.draggable=!0,t.addEventListener("dragstart",n,!1),t.classList.add("TravelNotes-SortableList-MoveCursor")})}}()}})})}()},{"../UI/HTMLViewsFactory":17,"../core/MapEditor":34,"../core/NoteEditor":35}],29:[function(e,t,o){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){var t=document.getElementById("TravelNotes-Control-MainDiv");return t||(t=e("./HTMLElementsFactory")().create("div",{id:"TravelNotes-Control-MainDiv"}),e("./HTMLElementsFactory")().create("div",{id:"TravelNotes-Control-MainDiv-Title",innerHTML:"Travel&nbsp;&amp;&nbsp;Notes"},t),e("./TravelEditorUI")().createUI(t),e("./RouteEditorUI")().createUI(t),e("./DataPanesUI")().createUI(t),e("./ProvidersToolbarUI")().createUI(t),e("./ErrorEditorUI")().createUI(t),t.addEventListener("click",function(t){t.target.classList.contains("TravelNotes-SortableList-ItemInput")||t.target.id&&-1!==["TravelNotes-Control-OpenTravelInput","TravelNotes-Control-OpenTravelButton","TravelNotes-Control-ImportTravelInput","TravelNotes-Control-ImportTravelButton","TravelNotes-Control-OpenTravelRoadbookLink"].indexOf(t.target.id)||(t.stopPropagation(),t.preventDefault())},!1),t.addEventListener("dblclick",function(t){t.stopPropagation(),t.preventDefault()},!1),t.addEventListener("wheel",function(t){t.stopPropagation(),t.preventDefault()},!1)),{get UI(){return t}}})}()},{"./DataPanesUI":14,"./ErrorEditorUI":15,"./HTMLElementsFactory":16,"./ProvidersToolbarUI":21,"./RouteEditorUI":22,"./TravelEditorUI":27}],30:[function(t,e,o){arguments[4][10][0].apply(o,arguments)},{"../UI/Translator":26,"./HTMLElementsFactory":16,dup:10}],31:[function(e,t,o){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){return{showError:function(t){e("../UI/ErrorEditorUI")().message='<span class="TravelNotes-Control-Error">'+t+"</span>"},clear:function(){e("../UI/ErrorEditorUI")().message=""}}})}()},{"../UI/ErrorEditorUI":15}],32:[function(c,t,e){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){function o(){s.routes.forEach(function(o){o.itinerary.itineraryPoints.latLngs=c("@mapbox/polyline").decode(o.itinerary.itineraryPoints.latLngs,6);var n=[],a=0;o.itinerary.itineraryPoints.latLngs.forEach(function(t){var e={};e.lat=t[0],e.lng=t[1],e.distance=o.itinerary.itineraryPoints.distances[a],e.objId=o.itinerary.itineraryPoints.objIds[a],e.objType=o.itinerary.itineraryPoints.objType,n.push(e),a++}),o.itinerary.itineraryPoints=n}),a?t():l()}function e(t){r=t.target.files[0].name;var e=new FileReader;e.onload=function(t){try{s=JSON.parse(e.result),o()}catch(t){}},e.readAsText(t.target.files[0])}var n=c("../L.TravelNotes"),a=!1,r="",i=!1,s={},t=function(){var t=c("../Data/Travel")();t.object=s;for(var e=t.routes.iterator;!e.done;)n.travel.routes.add(e.value);for(var o=t.notes.iterator;!o.done;)n.travel.notes.add(o.value);c("../Core/RouteEditor")().chainRoutes(),d()},l=function(){n.travel.object=s,""!==r&&(n.travel.name=r.substr(0,r.lastIndexOf("."))),n.travel.readOnly=i,d()},d=function(){var t=c("../core/MapEditor")();t.removeAllObjects();for(var e=n.travel.routes.iterator;!e.done;)t.addRoute(e.value,!0,!1,i);for(var o=n.travel.notes.iterator;!o.done;)t.addNote(o.value,i);t.zoomToTravel(),i?(document.getElementById("TravelNotes-Control-MainDiv").classList.add("TravelNotes-Control-MainDiv-Hidden"),document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Maximize"),document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Minimize")):(c("../UI/TravelEditorUI")().setRoutesList(),c("../core/TravelEditor")().updateRoadBook(!1)),n.map.fire("travelnotesfileloaded",{readOnly:i,name:n.travel.name})};return Object.seal({openLocalFile:function(t){!function(t){i=a=!1,e(t)}(t)},mergeLocalFile:function(t){!function(t){i=!(a=!0),e(t)}(t)},openDistantFile:function(t){!function(t){i=!0,s=t,o()}(t)}})})}()},{"../Core/RouteEditor":2,"../Data/Travel":6,"../L.TravelNotes":8,"../UI/TravelEditorUI":27,"../core/MapEditor":34,"../core/TravelEditor":40,"@mapbox/polyline":1}],33:[function(d,t,e){!function(){"use strict";var l=!1;void 0!==t&&t.exports&&(t.exports=function(){function n(e,o){var n=new XMLHttpRequest;n.timeout=d("../L.TravelNotes").config.note.svgTimeOut,n.ontimeout=function(t){o("TimeOut error")},n.onreadystatechange=function(){if(4==n.readyState)if(200==n.status){var t;l=!1;try{t=JSON.parse(this.responseText)}catch(t){l=!1,o("Parsing error")}l=!1,t.objId=r,e(t)}else l=!1,o("Status : "+this.status+" statusText : "+this.statusText)};var t=d("../L.TravelNotes").config.nominatim.url+"reverse?format=json&lat="+i+"&lon="+s+"&zoom=18&addressdetails=1",a=d("../L.TravelNotes").config.nominatim.language;a&&"*"!==a&&(t+="&accept-language="+a),n.open("GET",t,!0),a&&"*"===a&&n.setRequestHeader("accept-language",""),n.overrideMimeType("application/json"),n.send(null)}var r=-1,i=0,s=0;return Object.seal({getPromiseAddress:function(t,e,o){return function(t,e,o){return l?Promise.reject():(l=!0,r=o||-1,i=t,s=e,new Promise(n))}(t,e,o)}})})}()},{"../L.TravelNotes":8}],34:[function(f,t,e){!function(){"use strict";var m=f("../L.TravelNotes");void 0!==t&&t.exports&&(t.exports=function(){function d(t){var e=v.getRoute(t.target.objId),o=f("../core/RouteEditor")().getClosestLatLngDistance(e,[t.latlng.lat,t.latlng.lng]).distance;o+=e.chainedDistance,o=f("../util/Utilities")().formatDistance(o);var n=m.mapObjects.get(t.target.objId);n.closeTooltip();var a=v.getRoute(t.target.objId).name;m.travel.readOnly||(a+=0===a.length?"":" - ",a+=o),n.setTooltipContent(a),n.openTooltip(t.latlng)}function c(t,e){e.objId=t,e.addTo(m.map),m.mapObjects.set(t,e)}function r(t){var e=m.mapObjects.get(t);e&&(L.DomEvent.off(e),m.map.removeLayer(e),m.mapObjects.delete(t))}function s(t){var e=L.latLng([90,180]),o=L.latLng([-90,-180]);return t.forEach(function(t){e.lat=Math.min(e.lat,t[0]),e.lng=Math.min(e.lng,t[1]),o.lat=Math.max(o.lat,t[0]),o.lng=Math.max(o.lng,t[1])}),L.latLngBounds(e,o)}function o(t){var e=[];return t.itinerary.itineraryPoints.forEach(function(t){e.push(t.latLng)}),t.notes.forEach(function(t){e.push(t.latLng),e.push(t.iconLatLng)}),e}function u(t){t.dashArray>=m.config.route.dashChoices.length&&(t.dashArray=0);var e=m.config.route.dashChoices[t.dashArray].iDashArray;if(e){var o="",n=0;for(n=0;n<e.length-1;n++)o+=e[n]*t.width+",";return o+=e[n]*t.width}return null}function n(t){m.map.setView(t,m.config.itineraryPointZoom)}var v=f("../Data/DataSearchEngine")(),g=function(t,e){if(0!==t.lat||0!==t.lng){var o='<div class="TravelNotes-WayPoint TravelNotes-WayPoint'+("A"===e?"Start":"B"===e?"End":"Via")+'"></div><div class="TravelNotes-WayPointText">'+e+"</div>",n=L.marker(t.latLng,{icon:L.divIcon({iconSize:[40,40],iconAnchor:[20,40],html:o,className:"TravelNotes-WayPointStyle"}),draggable:!0});n.bindTooltip(function(t){return v.getWayPoint(t.objId).UIName}),n.getTooltip().options.offset=[20,-20],L.DomEvent.on(n,"contextmenu",function(t){f("../UI/ContextMenu")(t,f("../UI/ContextMenuFactory")().getWayPointContextMenu(t.target.objId))}),n.objId=t.objId,c(t.objId,n),L.DomEvent.on(n,"dragend",function(t){m.editedRoute.wayPoints.getAt(t.target.objId).latLng=[t.target.getLatLng().lat,t.target.getLatLng().lng],f("../core/WaypointEditor")().wayPointDragEnd(t.target.objId)})}},p=function(t,e){e=e||!1;var o=L.marker(t.latLng,{icon:L.divIcon({iconSize:[m.config.note.grip.size,m.config.note.grip.size],iconAnchor:[m.config.note.grip.size/2,m.config.note.grip.size/2],html:"<div></div>"}),zIndexOffset:-1e3,opacity:m.config.note.grip.opacity,draggable:!e});o.objId=t.objId,e||(L.DomEvent.on(o,"dragend",function(t){var e=v.getNoteAndRoute(t.target.objId),o=e.note,n=e.route,a=m.mapObjects.get(t.target.objId);if(null!=n){var r=f("../core/RouteEditor")().getClosestLatLngDistance(n,[t.target.getLatLng().lat,t.target.getLatLng().lng]);o.latLng=r.latLng,o.distance=r.distance,n.notes.sort(function(t,e){return t.distance-e.distance}),a.getLayer(a.bulletId).setLatLng(r.latLng),f("../UI/DataPanesUI")().updateItinerary()}else o.latLng=[t.target.getLatLng().lat,t.target.getLatLng().lng],f("../UI/DataPanesUI")().updateTravelNotes();a.getLayer(a.polylineId).setLatLngs([o.latLng,o.iconLatLng]),f("../core/TravelEditor")().updateRoadBook()}),L.DomEvent.on(o,"drag",function(t){var e=v.getNoteAndRoute(t.target.objId).note,o=m.mapObjects.get(t.target.objId);o.getLayer(o.polylineId).setLatLngs([[t.latlng.lat,t.latlng.lng],e.iconLatLng])}));var n=L.divIcon({iconSize:[t.iconWidth,t.iconHeight],iconAnchor:[t.iconWidth/2,t.iconHeight/2],popupAnchor:[0,-t.iconHeight/2],html:t.iconContent,className:m.config.note.style}),a=L.marker(t.iconLatLng,{icon:n,draggable:!e});a.objId=t.objId,a.bindPopup(function(t){var e=v.getNoteAndRoute(t.objId).note;return f("../core/NoteEditor")().getNoteHTML(e,"TravelNotes-")}),0!==t.tooltipContent.length&&(a.bindTooltip(function(t){return v.getNoteAndRoute(t.objId).note.tooltipContent}),a.getTooltip().options.offset[0]=t.iconWidth/2),e||(L.DomEvent.on(a,"contextmenu",function(t){f("../UI/ContextMenu")(t,f("../UI/ContextMenuFactory")().getNoteContextMenu(t.target.objId))}),L.DomEvent.on(a,"dragend",function(t){var e=v.getNoteAndRoute(t.target.objId).note;e.iconLatLng=[t.target.getLatLng().lat,t.target.getLatLng().lng];var o=m.mapObjects.get(t.target.objId);o.getLayer(o.polylineId).setLatLngs([e.latLng,e.iconLatLng])}),L.DomEvent.on(a,"drag",function(t){var e=v.getNoteAndRoute(t.target.objId).note,o=m.mapObjects.get(t.target.objId);o.getLayer(o.polylineId).setLatLngs([e.latLng,[t.latlng.lat,t.latlng.lng]])}));var r=L.polyline([t.latLng,t.iconLatLng],m.config.note.polyline);r.objId=t.objId;var i=L.layerGroup([a,r,o]);i.markerId=L.Util.stamp(a),i.polylineId=L.Util.stamp(r),i.bulletId=L.Util.stamp(o),c(t.objId,i)};return Object.seal({removeRoute:function(t,e,o){!function(t,e,o){if(r(t.objId),e)for(var n=t.notes.iterator;!n.done;)r(n.value.objId);if(o)for(var a=t.wayPoints.iterator;!a.done;)r(a.value.objId)}(t,e,o)},addRoute:function(t,e,o,n){!function(t,e,o,n){n=n||!1;for(var a=[],r=t.itinerary.itineraryPoints.iterator;!r.done;)a.push(r.value.latLng);var i=L.polyline(a,{color:t.color,weight:t.width,dashArray:u(t)});if(c(t.objId,i),i.bindTooltip(t.name,{sticky:!0,direction:"right"}),i.on("mouseover",d),i.on("mousemove",d),i.bindPopup(function(t){var e=v.getRoute(t.objId);return f("../core/RouteEditor")().getRouteHTML(e,"TravelNotes-")}),L.DomEvent.on(i,"click",function(t){t.target.openPopup(t.latlng)}),n||L.DomEvent.on(i,"contextmenu",function(t){f("../UI/ContextMenu")(t,f("../UI/ContextMenuFactory")().getRouteContextMenu(t.target.objId))}),e)for(var s=t.notes.iterator;!s.done;)p(s.value,n);if(o)for(var l=m.editedRoute.wayPoints.iterator;!l.done;)g(l.value,l.first?"A":l.last?"B":l.index)}(t,e,o,n)},editRoute:function(t){!function(t){m.mapObjects.get(t.objId).setStyle({color:t.color,weight:t.width,dashArray:u(t)})}(t)},removeObject:function(t){r(t)},removeAllObjects:function(){m.mapObjects.forEach(function(t,e,o){L.DomEvent.off(t),m.map.removeLayer(t)}),m.mapObjects.clear()},zoomToPoint:function(t){n(t)},zoomToSearchResult:function(t,e){!function(t,e){if(e){var o=[];e.forEach(function(t){o=o.concat(t)}),m.map.fitBounds(s(o))}else n(t)}(t,e)},zoomToNote:function(t){!function(t){n(v.getNoteAndRoute(t).note.iconLatLng)}(t)},zoomToRoute:function(t){!function(t){var e=o(v.getRoute(t));0!==e.length&&m.map.fitBounds(s(e))}(t)},zoomToTravel:function(){!function(){var e=[];m.travel.routes.forEach(function(t){e=e.concat(o(t))}),m.travel.notes.forEach(function(t){e.push(t.latLng),e.push(t.iconLatLng)}),0!==e.length&&m.map.fitBounds(s(e))}()},addItineraryPointMarker:function(t,e){!function(t,e){c(t,L.circleMarker(e,m.config.itineraryPointMarker))}(t,e)},addSearchPointMarker:function(t,e,o){!function(t,e,o){var n=!1;if(o){var a=[];o.forEach(function(t){a=a.concat(t)});var r=s(a),i=m.map.getBounds();n=.01<(r.getEast()-r.getWest())/(i.getEast()-i.getWest())&&.01<(r.getNorth()-r.getSouth())/(i.getNorth()-i.getSouth())}c(t,n?L.polyline(o,m.config.searchPointPolyline):L.circleMarker(e,m.config.searchPointMarker))}(t,e,o)},addRectangle:function(t,e,o){!function(t,e,o){c(t,L.rectangle(e,o))}(t,e,o)},addWayPoint:function(t,e){g(t,e)},redrawNote:function(t){!function(t){r(t.objId),p(t)}(t)},addNote:function(t,e){p(t,e)},editNote:function(t){!function(t){var e=L.divIcon({iconSize:[t.iconWidth,t.iconHeight],iconAnchor:[t.iconWidth/2,t.iconHeight/2],popupAnchor:[0,-t.iconHeight/2],html:t.iconContent,className:m.config.note.style}),o=m.mapObjects.get(t.objId),n=o.getLayer(o.markerId);n.setIcon(e),n.unbindTooltip(),0!==t.tooltipContent.length&&(n.bindTooltip(function(t){return v.getNoteAndRoute(t.objId).note.tooltipContent}),n.getTooltip().options.offset[0]=t.iconWidth/2),n.isPopupOpen()&&(n.closePopup(),n.openPopup())}(t)}})})}()},{"../Data/DataSearchEngine":3,"../L.TravelNotes":8,"../UI/ContextMenu":12,"../UI/ContextMenuFactory":13,"../UI/DataPanesUI":14,"../core/NoteEditor":35,"../core/RouteEditor":37,"../core/TravelEditor":40,"../core/WaypointEditor":41,"../util/Utilities":58}],35:[function(c,t,e){!function(){"use strict";var d=c("../L.TravelNotes");void 0!==t&&t.exports&&(t.exports=function(){function r(t){var e=c("../data/Note")();return e.latLng=t,e.iconLatLng=t,e}function o(){for(var t=d.travel.notes.iterator;!t.done;)c("../core/MapEditor")().removeObject(t.value.objId);for(var e=d.travel.routes.iterator;!e.done;)for(t=e.value.notes.iterator;!t.done;)c("../core/MapEditor")().removeObject(t.value.objId)}var a=c("../UI/Translator")(),l=c("../Data/DataSearchEngine")();return Object.seal({newRouteNote:function(t,e){!function(t,e){var o=c("../core/RouteEditor")().getClosestLatLngDistance(l.getRoute(t),[e.latlng.lat,e.latlng.lng]),n=r(o.latLng);n.distance=o.distance,c("../UI/NoteDialog")(n,t,!0)}(t,e)},newSearchNote:function(t){!function(t){var e=r([t.lat,t.lon]);e.address=(t.tags["addr:housenumber"]?t.tags["addr:housenumber"]+" ":"")+(t.tags["addr:street"]?t.tags["addr:street"]+" ":"")+(t.tags["addr:city"]?t.tags["addr:city"]+" ":""),e.url=t.tags.website||"",e.phone=t.tags.phone||"",e.tooltipContent=t.tags.name||"",e.popupContent=t.tags.name||"",c("../UI/NoteDialog")(e,-1,!0)}(t)},newManeuverNote:function(t,e){!function(t,e){var o=c("../core/RouteEditor")().getClosestLatLngDistance(d.editedRoute,e),n=d.editedRoute.itinerary.maneuvers.getAt(t),a=r(e);a.distance=o.distance,a.iconContent="<div class='TravelNotes-ManeuverNote TravelNotes-ManeuverNote-"+n.iconName+"'></div>",a.popupContent=n.instruction,a.iconWidth=40,a.iconHeight=40,c("../UI/NoteDialog")(a,d.editedRoute.objId,!0)}(t,e)},newTravelNote:function(t){!function(t){var e=r(t);c("../UI/NoteDialog")(e,-1,!0)}(t)},afterNoteDialog:function(t,e){!function(t,e){var o=l.getNoteAndRoute(t.objId);if(o.note)c("../core/MapEditor")().redrawNote(t),o.route?c("../UI/DataPanesUI")().setItinerary():c("../UI/DataPanesUI")().setTravelNotes();else{if(-1===e)d.travel.notes.add(t),c("../UI/DataPanesUI")().setTravelNotes();else{var n=l.getRoute(e);n.notes.add(t),t.chainedDistance=n.chainedDistance,n.notes.sort(function(t,e){return t.distance-e.distance}),c("../UI/DataPanesUI")().setItinerary()}c("../core/MapEditor")().addNote(t)}c("../core/TravelEditor")().updateRoadBook()}(t,e)},editNote:function(t){!function(t){var e=l.getNoteAndRoute(t);c("../UI/NoteDialog")(e.note,null===e.route?-1:e.route.objId,!1)}(t)},removeNote:function(t){!function(t){c("../core/MapEditor")().removeObject(t);var e=l.getNoteAndRoute(t);e.route?(e.route.notes.remove(t),c("../UI/DataPanesUI")().updateItinerary()):(d.travel.notes.remove(t),c("../UI/DataPanesUI")().updateTravelNotes()),c("../core/TravelEditor")().updateRoadBook()}(t)},hideNotes:function(){o()},showNotes:function(){!function(){o();for(var t=d.travel.notes.iterator;!t.done;)c("../core/MapEditor")().addNote(t.value);for(var e=d.travel.routes.iterator;!e.done;)for(t=e.value.notes.iterator;!t.done;)c("../core/MapEditor")().addNote(t.value)}()},zoomToNote:function(t){!function(t){c("../core/MapEditor")().zoomToPoint(l.getNoteAndRoute(t).note.latLng)}(t)},attachNoteToRoute:function(t){!function(t){var n=l.getNoteAndRoute(t),a=Number.MAX_VALUE,r=null,i=null,s=null;d.travel.routes.forEach(function(t){var e=c("../core/RouteEditor")().getClosestLatLngDistance(t,n.note.latLng);if(e){var o=L.latLng(n.note.latLng).distanceTo(L.latLng(e.latLng));o<a&&(a=o,r=t,i=e.latLng,s=e.distance)}}),r&&(d.travel.notes.remove(t),n.note.distance=s,n.note.latLng=i,n.note.chainedDistance=r.chainedDistance,r.notes.add(n.note),r.notes.sort(function(t,e){return t.distance-e.distance}),c("../core/MapEditor")().redrawNote(n.note),c("../UI/DataPanesUI")().updateItinerary(),c("../UI/DataPanesUI")().updateTravelNotes(),c("../core/TravelEditor")().updateRoadBook())}(t)},detachNoteFromRoute:function(t){!function(t){var e=l.getNoteAndRoute(t);e.route.notes.remove(t),e.note.distance=-1,e.note.chainedDistance=0,d.travel.notes.add(e.note),c("../UI/DataPanesUI")().updateItinerary(),c("../UI/DataPanesUI")().updateTravelNotes(),c("../core/TravelEditor")().updateRoadBook()}(t)},noteDropped:function(t,e,o){!function(t,e,o){d.travel.notes.moveTo(t,e,o),c("../UI/DataPanesUI")().updateTravelNotes(),c("../core/TravelEditor")().updateRoadBook()}(t,e,o)},getNoteHTML:function(t,e){return function(t,e){var o="";0!==t.tooltipContent.length&&(o+='<div class="'+e+'NoteHtml-TooltipContent">'+t.tooltipContent+"</div>"),0!==t.popupContent.length&&(o+='<div class="'+e+'NoteHtml-PopupContent">'+t.popupContent+"</div>"),0!==t.address.length&&(o+='<div class="'+e+'NoteHtml-Address">'+a.getText("NoteEditor - Address")+t.address+"</div>"),0!==t.phone.length&&(o+='<div class="'+e+'NoteHtml-Phone">'+a.getText("NoteEditor - Phone")+t.phone+"</div>"),0!==t.url.length&&(o+='<div class="'+e+'NoteHtml-Url">'+a.getText("NoteEditor - Link")+'<a href="'+t.url+'" target="_blank">'+t.url.substr(0,40)+"...</a></div>");var n=c("../util/Utilities")();return o+='<div class="'+e+'NoteHtml-LatLng">'+a.getText("NoteEditor - Latitude Longitude",{lat:n.formatLat(t.lat),lng:n.formatLng(t.lng)})+"</div>",-1!==t.distance&&(o+='<div class="'+e+'NoteHtml-Distance">'+a.getText("NoteEditor - Distance",{distance:n.formatDistance(t.chainedDistance+t.distance)})+"</div>"),o}(t,e)}})})}()},{"../Data/DataSearchEngine":3,"../L.TravelNotes":8,"../UI/DataPanesUI":14,"../UI/NoteDialog":20,"../UI/Translator":26,"../core/MapEditor":34,"../core/RouteEditor":37,"../core/TravelEditor":40,"../data/Note":49,"../util/Utilities":58}],36:[function(c,u,t){!function(){"use strict";function e(){i.bbox&&(-1!==s?c("../core/MapEditor")().removeObject(s):s=c("../data/ObjId")(),c("../core/MapEditor")().addRectangle(s,L.latLngBounds(i.bbox.southWest,i.bbox.northEast),a.config.previousSearchLimit))}function o(t){a.searchData=t,r=!1,e(),c("../UI/DataPanesUI")().updateSearch()}function n(t){console.log(t),r=!1}function t(t){var e=a.map.getCenter();-1!==l?c("../core/MapEditor")().removeObject(l):l=c("../data/ObjId")(),c("../core/MapEditor")().addRectangle(l,L.latLngBounds(L.latLng(e.lat-d.lat,e.lng-d.lng),L.latLng(e.lat+d.lat,e.lng+d.lng)),a.config.nextSearchLimit)}var a=c("../L.TravelNotes"),r=!1,i={searchPhrase:"",bbox:null},s=-1,l=-1,d=window.osmSearch?window.osmSearch.searchLimits:null;void 0!==u&&u.exports&&(u.exports=function(){return Object.seal({search:function(){!function(){if(!r){r=!0;var t=a.map.getBounds();i={bbox:{southWest:t.getSouthWest(),northEast:t.getNorthEast()},searchPhrase:document.getElementById("TravelNotes-Control-SearchInput").value},a.searchData=[],window.osmSearch.getSearchPromise(i).then(o,n)}}()},show:function(){a.map.on("zoom",t),a.map.on("move",t),t(),e()},hide:function(){a.map.off("zoom",t),a.map.off("move",t),-1!==l&&(c("../core/MapEditor")().removeObject(l),l=-1),-1!==s&&(c("../core/MapEditor")().removeObject(s),s=-1)}})})}()},{"../L.TravelNotes":8,"../UI/DataPanesUI":14,"../core/MapEditor":34,"../data/ObjId":50}],37:[function(t,e,o){arguments[4][2][0].apply(o,arguments)},{"../Data/DataSearchEngine":3,"../L.TravelNotes":8,"../UI/DataPanesUI":14,"../UI/RouteEditorUI":22,"../UI/RoutePropertiesDialog":23,"../UI/Translator":26,"../UI/TravelEditorUI":27,"../core/MapEditor":34,"../core/NoteEditor":35,"../core/Router":38,"../core/TravelEditor":40,"../data/ItineraryPoint":47,"../data/Route":52,"../util/Utilities":58,dup:2}],38:[function(r,t,e){!function(){"use strict";var n=!1,a=r("../L.TravelNotes");void 0!==t&&t.exports&&(t.exports=function(){function e(t){n=!1,r("../core/ErrorEditor")().showError(t)}function o(t){n=!1,r("./RouteEditor")().computeRouteDistances(a.editedRoute);for(var e=a.editedRoute.wayPoints.iterator;!e.done;)e.first?e.value.latLng=a.editedRoute.itinerary.itineraryPoints.first.latLng:e.last?e.value.latLng=a.editedRoute.itinerary.itineraryPoints.last.latLng:e.value.latLng=r("./RouteEditor")().getClosestLatLngDistance(a.editedRoute,e.value.latLng).latLng;r("./RouteEditor")().endRouting()}function t(){if(n)return!1;if(!a.editedRoute.wayPoints.forEach(function(t,e){return null===e&&(e=!0),e&=0!==t.lat&&0!==t.lng}))return!1;n=!0;var t=a.providers.get(a.routing.provider);return a.editedRoute.itinerary.provider=t.name,a.editedRoute.itinerary.transitMode=a.routing.transitMode,t.getPromiseRoute(a.editedRoute,null).then(o,e),!0}return Object.seal({startRouting:function(){return t()}})})}()},{"../L.TravelNotes":8,"../core/ErrorEditor":31,"./RouteEditor":37}],39:[function(R,t,e){!function(){"use strict";var x=R("../L.TravelNotes"),M=!1;void 0!==t&&t.exports&&(t.exports=function(){function r(t,e){g.clear(),p.clear(),i.elements.forEach(function(t){switch(t.type){case"area":t.tags&&t.tags.boundary&&t.tags.name&&(u=t.tags.name);break;case"way":t.nodesIds=t.nodes,delete t.nodes,g.set(t.id,t);break;case"node":p.set(t.id,t),t.tags&&t.tags.place&&["town","city","village","hamlet"].includes(t.tags.place)&&n.push(t)}}),(m=document.createElementNS("http://www.w3.org/2000/svg","svg")).setAttributeNS(null,"viewBox",h/4+" "+h/4+" "+h/2+" "+h/2),m.setAttributeNS(null,"class","TravelNotes-SvgIcon"),function(){var o=Number.MAX_VALUE,n=0;d.itinerary.itineraryPoints.forEach(function(t){var e=s.distanceTo(L.latLng(t.latLng));e<o&&(o=e,v=t,l=n),n+=t.distance}),s=L.latLng(v.latLng);function t(e){var o=!0;return d.wayPoints.forEach(function(t){Math.abs(e.lat-t.lat)<1e-5&&Math.abs(e.lng-t.lng)<1e-5&&(o=!1)}),o&&(v.lat!==e.lat||v.lng!==e.lng)}b=d.itinerary.itineraryPoints.previous(v.objId,t),C=d.itinerary.itineraryPoints.next(v.objId,t)}(),function(){var s=-1,l=-1,d=-1,e=Number.MAX_VALUE,o=Number.MAX_VALUE,n=Number.MAX_VALUE,a=0;p.forEach(function(t){v&&(a=L.latLng(t.lat,t.lon).distanceTo(L.latLng(v.lat,v.lng)))<e&&(s=t.id,e=a),b&&(a=L.latLng(t.lat,t.lon).distanceTo(L.latLng(b.lat,b.lng)))<o&&(l=t.id,o=a),C&&(a=L.latLng(t.lat,t.lon).distanceTo(L.latLng(C.lat,C.lng)))<n&&(d=t.id,n=a)});var c="",u="";g.forEach(function(t){var e=(t.tags.name?t.tags.name:"")+(t.tags.name&&t.tags.ref?" ":"")+(t.tags.ref?"["+t.tags.ref+"]":"");if(t.nodesIds.includes(s)){var o=t.nodesIds[0]===t.nodesIds[t.nodesIds.length-1],n=0!==t.nodesIds.indexOf(s)&&t.nodesIds.length-1!==t.nodesIds.lastIndexOf(s),a=t.nodesIds.includes(l),r=t.nodesIds.includes(d),i=""!=e;!n&&!a&&!r&&i&&D.push(e),(n&&i||o&&i)&&(a||r?(a&&!r||!a&&r)&&D.push(e):(D.push(e),D.push(e))),a&&(c=i?e:"???"),r&&(u=i?e:"???")}}),D.unshift(c),D.push(u)}(),function(){var o=Number.MAX_VALUE;n.forEach(function(t){var e=L.latLng(v.latLng).distanceTo(L.latLng(t.lat,t.lon));e<o&&(o=e,c=t.tags.name)})}(),T=L.point(h/2,h/2).subtract(x.map.project(s,y)),function(){var e=0,o=d.itinerary.itineraryPoints.first,n=d.itinerary.itineraryPoints.last,a=!1;d.itinerary.itineraryPoints.forEach(function(t){E<l-e&&(o=t),E<e-l&&!a&&(n=t,a=!0),e+=t.distance});var t=x.map.project(s,y).add(T);if(v.objId!==d.itinerary.itineraryPoints.first.objId){var r=x.map.project(L.latLng(o.latLng),y).add(T);(N=180*Math.atan((t.y-r.y)/(r.x-t.x))/Math.PI)<0&&(N+=360),N-=270,r.x-t.x<0&&(N+=180)}if(v.objId!==d.itinerary.itineraryPoints.last.objId){var i=x.map.project(L.latLng(n.latLng),y).add(T);for(I=180*Math.atan((t.y-i.y)/(i.x-t.x))/Math.PI,i.x-t.x<0&&(I+=180),I-=N;I<0;)I+=360;for(;360<I;)I-=360}v.objId===d.itinerary.itineraryPoints.first.objId&&(N=-I-90,I=null,f=-1),s.lat===d.itinerary.itineraryPoints.last.lat&&s.lng===d.itinerary.itineraryPoints.last.lng&&(I=null,f=1)}(),function(){var o=-1,n=-1,a=-1,r=[];if(d.itinerary.itineraryPoints.forEach(function(t){o++;var e=x.map.project(L.latLng(t.latLng),y).add(T);r.push(e),0<=e.x&&0<=e.y&&e.x<=h&&e.y<=h&&(-1===n&&(n=o),a=o)}),-1!==n&&-1!==a){0<n&&n--,d.itinerary.itineraryPoints.length-1>a&&a++;var t="";for(o=n;o<=a;o++)t+=r[o].x.toFixed(0)+","+r[o].y.toFixed(0)+" ";var e=document.createElementNS("http://www.w3.org/2000/svg","polyline");e.setAttributeNS(null,"points",t),e.setAttributeNS(null,"class","TravelNotes-OSM-Itinerary"),e.setAttributeNS(null,"transform","rotate("+N+","+h/2+","+h/2+")"),m.appendChild(e)}}(),g.forEach(function(t){var n=-1,a=-1,r=-1,i=[];if(t.nodesIds.forEach(function(t){r++;var e=p.get(t),o=x.map.project(L.latLng(e.lat,e.lon),y).add(T);i.push(o),0<=o.x&&0<=o.y&&o.x<=h&&o.y<=h&&(-1===n&&(n=r),a=r)}),-1!==n&&-1!==a){0<n&&n--,t.nodesIds.length-1>a&&a++;var e="";for(r=n;r<=a;r++)e+=i[r].x.toFixed(0)+","+i[r].y.toFixed(0)+" ";var o=document.createElementNS("http://www.w3.org/2000/svg","polyline");o.setAttributeNS(null,"points",e),o.setAttributeNS(null,"class","TravelNotes-OSM-Highway TravelNotes-OSM-Highway-"+t.tags.highway),o.setAttributeNS(null,"transform","rotate("+N+","+h/2+","+h/2+")"),m.appendChild(o)}})}function o(t,e){var o=new XMLHttpRequest;o.timeout=R("../L.TravelNotes").config.note.svgTimeOut,o.ontimeout=function(t){e("TimeOut error")},o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status){try{i=JSON.parse(o.responseText)}catch(t){M=!1,e("Parsing error")}r(),M=!1,t({svg:m,direction:I,startStop:f,city:u,place:c,streets:D,latLng:v.latLng})}else M=!1,e("Status : "+this.status+" statusText : "+this.statusText)};var n=s.lat.toFixed(6)+","+s.lng.toFixed(6),a=R("../L.TravelNotes").config.overpassApiUrl+"?data=[out:json][timeout:"+R("../L.TravelNotes").config.note.svgTimeOut+"];way[highway](around:"+(1.5*h).toFixed(0)+","+n+")->.a;(.a >;.a;)->.a;.a out;is_in("+n+')->.e;area.e[admin_level="2"][name="United Kingdom"]->.f;area.e[admin_level="8"]->.g;area.e[admin_level="10"]->.h;if(f.count(deriveds)==0){.g->.i;}else{if(h.count(deriveds)==0){.g->.i;}else{.h->.i;}}.i out;(node(area.i)[place="village"];node(area.i)[place="hamlet"];node(area.i)[place="city"];node(area.i)[place="town"];)->.k;( node(around:'+R("../L.TravelNotes").config.note.svgHamletDistance+","+n+')[place="hamlet"];node(around:'+R("../L.TravelNotes").config.note.svgVillageDistance+","+n+')[place="village"];node(around:'+R("../L.TravelNotes").config.note.svgCityDistance+","+n+')[place="city"];node(around:'+R("../L.TravelNotes").config.note.svgTownDistance+","+n+')[place="town"];)->.l;node.k.l->.m;.m out;';o.open("GET",a,!0),o.overrideMimeType("application/json"),o.send(null)}var s=L.latLng(0,0),l=0,v=null,d=null,i={},g=new Map,p=new Map,n=[],c=null,u=null,m=null,f=0,T=L.point(0,0),N=0,I=null,h=R("../L.TravelNotes").config.note.svgIconWidth,y=R("../L.TravelNotes").config.note.svgZoom,E=R("../L.TravelNotes").config.note.svgAngleDistance,b=null,C=null,D=[];return Object.seal({getPromiseSvgIcon:function(t,e){return function(t,e){return M?Promise.reject():(M=!0,s=L.latLng(t),d=R("../Data/DataSearchEngine")().getRoute(e),i={},u=m=null,new Promise(o))}(t,e)}})})}()},{"../Data/DataSearchEngine":3,"../L.TravelNotes":8}],40:[function(l,t,e){!function(){"use strict";var s=l("../L.TravelNotes"),o=!1,r=!1;void 0!==t&&t.exports&&(t.exports=function(){function n(t){if(r||(window.addEventListener("unload",function(t){localStorage.removeItem(l("../L.TravelNotes").UUID+"-TravelNotesHTML")}),r=!0),t||o||!s.config.haveBeforeUnloadWarning||(window.addEventListener("beforeunload",function(t){return t.returnValue="x"}),o=!0),l("../util/Utilities")().storageAvailable("localStorage")){var e=l("../UI/HTMLViewsFactory")();e.classNamePrefix="TravelNotes-Roadbook-",localStorage.setItem(s.UUID+"-TravelNotesHTML",e.travelHTML.outerHTML)}}function t(){return!o||window.confirm(i.getText("TravelEditor - This page ask to close; data are perhaps not saved."))}var i=l("../UI/Translator")(),a=l("../UI/TravelEditorUI")();return Object.seal({updateRoadBook:function(t){n(t)},addRoute:function(){s.travel.routes.add(l("../Data/Route")()),a.setRoutesList(),l("../core/RouteEditor")().chainRoutes(),n()},removeRoute:function(t){!function(t){t===s.routeEdition.routeInitialObjId&&s.routeEdition.routeChanged?l("./ErrorEditor")().showError(i.getText("TravelEditor - Cannot remove an edited route")):(l("./MapEditor")().removeRoute(l("../Data/DataSearchEngine")().getRoute(t),!0,!0),s.travel.routes.remove(t),a.setRoutesList(),t===s.routeEdition.routeInitialObjId&&l("./RouteEditor")().cancelEdition(),l("../core/RouteEditor")().chainRoutes(),n())}(t)},editRoute:function(t){!function(t){if(s.routeEdition.routeChanged)l("../core/ErrorEditor")().showError(i.getText("RouteEditor - Not possible to edit a route without a save or cancel"));else{-1!==s.routeEdition.routeInitialObjId&&l("../core/RouteEditor")().cancelEdition();var e=l("../data/DataSearchEngine")().getRoute(t),o=e.itinerary.provider;if(!o||""===o||s.providers.get(o.toLowerCase())){l("../UI/ProvidersToolbarUI")().provider=o;var n=e.itinerary.transitMode;n&&""!==n&&(l("../UI/ProvidersToolbarUI")().transitMode=n),s.editedRoute=l("../data/Route")(),s.editedRoute.object=e.object,s.routeEdition.routeInitialObjId=e.objId,s.editedRoute.hidden=!1,e.hidden=!1;var a=l("../core/MapEditor")();a.removeRoute(e,!0,!1),a.addRoute(s.editedRoute,!0,!0),l("../core/RouteEditor")().chainRoutes();var r=l("../UI/RouteEditorUI")();r.expand(),r.setWayPointsList(),l("../UI/DataPanesUI")().setItinerary()}else l("../core/ErrorEditor")().showError(i.getText("RouteEditor - Not possible to edit a route created with this provider",{provider:o}))}}(t)},renameRoute:function(t,e){!function(t,e){l("../Data/DataSearchEngine")().getRoute(t).name=e,a.setRoutesList(),t===s.routeEdition.routeInitialObjId&&(s.editedRoute.name=e),n()}(t,e)},swapRoute:function(t,e){!function(t,e){s.travel.routes.swap(t,e),a.setRoutesList(),l("../core/RouteEditor")().chainRoutes(),n()}(t,e)},routeDropped:function(t,e,o){!function(t,e,o){s.travel.routes.moveTo(t,e,o),a.setRoutesList(),l("../core/RouteEditor")().chainRoutes(),n()}(t,e,o)},saveTravel:function(){!function(){if(s.routeEdition.routeChanged)l("./ErrorEditor")().showError(i.getText("TravelEditor - Not possible to save a travel without a save or cancel"));else{for(var t=s.travel.routes.iterator;!t.done;)t.value.hidden=!1;var e=s.travel.object;e.routes.forEach(function(t){var e={};0!==t.itinerary.itineraryPoints.length&&(e=t.itinerary.itineraryPoints[0].objType);var o={latLngs:[],distances:[],objIds:[],objType:e};t.itinerary.itineraryPoints.forEach(function(t){o.latLngs.push([t.lat,t.lng]),o.distances.push(t.distance),o.objIds.push(t.objId)}),o.latLngs=l("@mapbox/polyline").encode(o.latLngs,6),t.itinerary.itineraryPoints=o}),l("../util/Utilities")().saveFile(e.name+".trv",JSON.stringify(e))}}()},confirmClose:function(){return t()},clear:function(){t()&&(l("../core/MapEditor")().removeAllObjects(),s.editedRoute=l("../Data/Route")(),s.routeEdition.routeChanged=!1,s.routeEdition.routeInitialObjId=-1,s.travel=l("../Data/Travel")(),s.travel.routes.add(l("../Data/Route")()),l("../UI/TravelEditorUI")().setRoutesList(),l("../UI/RouteEditorUI")().setWayPointsList(),l("../UI/DataPanesUI")().setItinerary(),n(!0))}})})}()},{"../Data/DataSearchEngine":3,"../Data/Route":5,"../Data/Travel":6,"../L.TravelNotes":8,"../UI/DataPanesUI":14,"../UI/HTMLViewsFactory":17,"../UI/ProvidersToolbarUI":21,"../UI/RouteEditorUI":22,"../UI/Translator":26,"../UI/TravelEditorUI":27,"../core/ErrorEditor":31,"../core/MapEditor":34,"../core/RouteEditor":37,"../data/DataSearchEngine":45,"../data/Route":52,"../util/Utilities":58,"./ErrorEditor":31,"./MapEditor":34,"./RouteEditor":37,"@mapbox/polyline":1}],41:[function(d,t,e){!function(){"use strict";var l=d("../L.TravelNotes");void 0!==t&&t.exports&&(t.exports=function(){function n(t,e){l.routeEdition.routeChanged=!0;var o=d("../data/Waypoint.js")();if(t&&(o.latLng=t,l.config.wayPoint.reverseGeocoding&&d("../core/GeoCoder")().getPromiseAddress(t[0],t[1],o.objId).then(s)),l.editedRoute.wayPoints.add(o),a.addWayPoint(l.editedRoute.wayPoints.last,l.editedRoute.wayPoints.length-2),e)for(var n=l.editedRoute.wayPoints.iterator;!n.done;){if(e<r.getClosestLatLngDistance(l.editedRoute,n.value.latLng).distance){l.editedRoute.wayPoints.moveTo(o.objId,n.value.objId,!0);break}}else l.editedRoute.wayPoints.swap(o.objId,!0);i.setWayPointsList(),r.startRouting()}function o(t,e){l.routeEdition.routeChanged=!0,l.editedRoute.wayPoints.getAt(e).name=t,i.setWayPointsList()}var a=d("../core/MapEditor")(),r=d("../core/RouteEditor")(),i=d("../UI/RouteEditorUI")(),s=function(t){var e="";t.address.house_number&&(e+=t.address.house_number+" "),t.address.road?e+=t.address.road+" ":t.address.pedestrian&&(e+=t.address.pedestrian+" "),t.address.village?e+=t.address.village:t.address.town?e+=t.address.town:t.address.city&&(e+=t.address.city),0===e.length&&(e+=t.address.country),o(e,t.objId)};return Object.seal({addWayPoint:function(t){n(t)},addWayPointOnRoute:function(t,e){!function(t,e){var o=r.getClosestLatLngDistance(d("../Data/DataSearchEngine")().getRoute(t),[e.latlng.lat,e.latlng.lng]);n(o.latLng,o.distance)}(t,e)},reverseWayPoints:function(){!function(){l.routeEdition.routeChanged=!0;for(var t=l.editedRoute.wayPoints.iterator;!t.done;)a.removeObject(t.value.objId);for(l.editedRoute.wayPoints.reverse(),t=l.editedRoute.wayPoints.iterator;!t.done;)a.addWayPoint(t.value,t.first?"A":t.last?"B":t.index);i.setWayPointsList(),r.startRouting()}()},removeAllWayPoints:function(){!function(){l.routeEdition.routeChanged=!0;for(var t=l.editedRoute.wayPoints.iterator;!t.done;)a.removeObject(t.value.objId);l.editedRoute.wayPoints.removeAll(!0),i.setWayPointsList(),r.startRouting()}()},removeWayPoint:function(t){!function(t){l.routeEdition.routeChanged=!0,a.removeObject(t),l.editedRoute.wayPoints.remove(t),i.setWayPointsList(),r.startRouting()}(t)},renameWayPoint:function(t,e){o(t,e)},swapWayPoints:function(t,e){!function(t,e){l.routeEdition.routeChanged=!0,l.editedRoute.wayPoints.swap(t,e),i.setWayPointsList(),r.startRouting()}(t,e)},setStartPoint:function(t){!function(t){l.routeEdition.routeChanged=!0,0!==l.editedRoute.wayPoints.first.lat&&a.removeObject(l.editedRoute.wayPoints.first.objId),l.editedRoute.wayPoints.first.latLng=t,l.config.wayPoint.reverseGeocoding&&d("../core/GeoCoder")().getPromiseAddress(t[0],t[1],l.editedRoute.wayPoints.first.objId).then(s),a.addWayPoint(l.editedRoute.wayPoints.first,"A"),i.setWayPointsList(),r.startRouting()}(t)},setEndPoint:function(t){!function(t){l.routeEdition.routeChanged=!0,0!==l.editedRoute.wayPoints.last.lat&&a.removeObject(l.editedRoute.wayPoints.last.objId),l.editedRoute.wayPoints.last.latLng=t,l.config.wayPoint.reverseGeocoding&&d("../core/GeoCoder")().getPromiseAddress(t[0],t[1],l.editedRoute.wayPoints.last.objId).then(s),a.addWayPoint(l.editedRoute.wayPoints.last,"B"),i.setWayPointsList(),r.startRouting()}(t)},wayPointDragEnd:function(t){!function(t){if(l.routeEdition.routeChanged=!0,l.config.wayPoint.reverseGeocoding){var e=l.editedRoute.wayPoints.getAt(t).latLng;d("../core/GeoCoder")().getPromiseAddress(e[0],e[1],t).then(s)}i.setWayPointsList(),r.startRouting()}(t)},wayPointDropped:function(t,e,o){!function(t,e,o){if(l.routeEdition.routeChanged=!0,(e!==l.editedRoute.wayPoints.first.objId||!o)&&(e!==l.editedRoute.wayPoints.last.objId||o)){l.editedRoute.wayPoints.moveTo(t,e,o),i.setWayPointsList();for(var n=l.editedRoute.wayPoints.iterator;!n.done;)a.removeObject(n.value.objId),a.addWayPoint(n.value,n.first?"A":n.last?"B":n.index);r.startRouting()}}(t,e,o)}})})}()},{"../Data/DataSearchEngine":3,"../L.TravelNotes":8,"../UI/RouteEditorUI":22,"../core/GeoCoder":33,"../core/MapEditor":34,"../core/RouteEditor":37,"../data/Waypoint.js":57}],42:[function(t,e,o){arguments[4][41][0].apply(o,arguments)},{"../Data/DataSearchEngine":3,"../L.TravelNotes":8,"../UI/RouteEditorUI":22,"../core/GeoCoder":33,"../core/MapEditor":34,"../core/RouteEditor":37,"../data/Waypoint.js":57,dup:41}],43:[function(l,t,e){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(t){function o(t){if(!t.objType||!t.objType.name||t.objType.name!==a)throw"invalid object name for add function";r.push(t)}function n(t,e,o){var n=i(t);if(-1===n)throw"invalid objId for next or previous function";for(e=e||function(){return!0},n+=o;-1<n&&n<r.length&&!e(r[n]);)n+=o;return-1===n||r.length===n?null:r[n]}var r=[],a=t,i=function(e){return r.findIndex(function(t){return t.objId===e})},s=function(){var t=-1;return{get value(){return t<r.length?r[t]:null},get done(){return++t>=r.length},get first(){return 0===t},get last(){return t>=r.length-1},get index(){return t}}};return Object.seal({add:function(t){o(t)},forEach:function(t){return function(t){for(var e=null,o=s();!o.done;)e=t(o.value,e);return e}(t)},getAt:function(t){return function(t){var e=i(t);return-1===e?null:r[e]}(t)},moveTo:function(t,e,o){!function(t,e,o){var n=i(t),a=i(e);o||a++,r.splice(a,0,r[n]),a<n&&n++,r.splice(n,1)}(t,e,o)},next:function(t,e){return n(t,e,1)},previous:function(t,e){return n(t,e,-1)},remove:function(t){!function(t){if(-1===i(t))throw"invalid objId for remove function";r.splice(i(t),1)}(t)},removeAll:function(t){!function(t){t?r.splice(1,r.length-2):r.length=0}(t)},replace:function(t,e){!function(t,e){var o=i(t);if(-1===o)throw"invalid objId for replace function";r[o]=e}(t,e)},reverse:function(){r.reverse()},sort:function(t){!function(t){r.sort(t)}(t)},swap:function(t,e){!function(t,e){var o=i(t);if(-1===o||0===o&&e||r.length-1===o&&!e)throw"invalid objId for swap function";var n=r[o];r[o]=r[o+(e?-1:1)],r[o+(e?-1:1)]=n}(t,e)},get first(){return r[0]},get iterator(){return s()},get last(){return r[r.length-1]},get length(){return r.length},get object(){return function(){for(var t=[],e=s();!e.done;)t.push(e.value.object);return t}()},set object(t){!function(t){var e;r.length=0,t.forEach(function(t){switch(a){case"Route":e=l("../data/Route")();break;case"Note":e=l("../data/Note")();break;case"WayPoint":e=l("../data/WayPoint")();break;case"Maneuver":e=l("../data/Maneuver")();break;case"ItineraryPoint":e=l("../data/ItineraryPoint")();break;default:throw"invalid ObjName ( "+a+" ) in Collection.m_SetObject"}e.object=t,o(e)})}(t)}})})}()},{"../data/ItineraryPoint":47,"../data/Maneuver":48,"../data/Note":49,"../data/Route":52,"../data/WayPoint":56}],44:[function(t,a,e){!function(){"use strict";var e,n,o;void 0!==a&&a.exports&&(a.exports=(e={contextMenu:{timeout:1500},errorMessages:{timeout:2e4},routing:{auto:!0},language:"fr",itineraryPointMarker:{color:"red",weight:2,radius:7,fill:!1},searchPointMarker:{color:"green",weight:4,radius:20,fill:!1},searchPointPolyline:{color:"green",weight:4,radius:20,fill:!1},previousSearchLimit:{color:"green",fill:!1,weight:1},nextSearchLimit:{color:"red",fill:!1,weight:1},wayPoint:{reverseGeocoding:!1},route:{color:"#ff0000",width:3,dashArray:0,dashChoices:[{text:"——————",iDashArray:null},{text:"— — — — —",iDashArray:[4,2]},{text:"—‧—‧—‧—‧—",iDashArray:[4,2,0,2]},{text:"················",iDashArray:[0,2]}]},note:{reverseGeocoding:!1,grip:{size:10,opacity:0},polyline:{color:"gray",weight:1},style:"TravelNotes-NotesStyle",svgIconWidth:200,svgAnleMaxDirection:{right:35,slightRight:80,continue:100,slightLeft:145,left:200,sharpLeft:270,sharpRight:340},svgZoom:17,svgAngleDistance:10,svgHamletDistance:200,svgVillageDistance:400,svgCityDistance:1200,svgTownDistance:1500,svgTimeOut:15e3,cityPrefix:"<span class='TravelNotes-NoteHtml-Address-City'>",cityPostfix:"</span>"},itineraryPointZoom:17,routeEditor:{displayEditionInHTMLPage:!0},travelEditor:{clearAfterSave:!0,startMinimized:!0,timeout:1e3,startupRouteEdition:!0},haveBeforeUnloadWarning:!0,overpassApiUrl:"https://lz4.overpass-api.de/api/interpreter",nominatim:{url:"https://nominatim.openstreetmap.org/",language:"*"}},n=function(t,e){if("object"==typeof t&&"object"==typeof e)try{var o;for(o in e)"object"==typeof e[o]?n(t[o],e[o]):e[o]=t[o]||e[o];for(o in t)"object"==typeof t[o]?("[object Array]"==Object.prototype.toString.call(t[o])?e[o]=e[o]||[]:e[o]=e[o]||{},n(t[o],e[o])):e[o]=t[o]}catch(t){console.log(t),console.log("Not possible to overload Config")}},o=function(t){var e;for(e in t)"object"==typeof t[e]&&(t[e]=o(t[e]));return Object.freeze(t)},{get contextMenu(){return e.contextMenu},get errorMessages(){return e.errorMessages},get routing(){return e.routing},get language(){return e.language},get itineraryPointMarker(){return e.itineraryPointMarker},get searchPointMarker(){return e.searchPointMarker},get searchPointPolyline(){return e.searchPointPolyline},get previousSearchLimit(){return e.previousSearchLimit},get nextSearchLimit(){return e.nextSearchLimit},get wayPoint(){return e.wayPoint},get route(){return e.route},get note(){return e.note},get itineraryPointZoom(){return e.itineraryPointZoom},get routeEditor(){return e.routeEditor},get travelEditor(){return e.travelEditor},get haveBeforeUnloadWarning(){return e.haveBeforeUnloadWarning},get overpassApiUrl(){return e.overpassApiUrl},get nominatim(){return e.nominatim},overload:function(t){!function(t){n(t,e),e=o(e)}(t)}}))}()},{}],45:[function(t,e,o){arguments[4][3][0].apply(o,arguments)},{"../L.TravelNotes":8,dup:3}],46:[function(t,e,o){arguments[4][4][0].apply(o,arguments)},{"../data/Collection":43,"../data/ObjId":50,"../data/ObjType":51,"./Version":55,dup:4}],47:[function(i,t,e){!function(){"use strict";var r=i("../data/ObjType")("ItineraryPoint",i("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var e=0,o=0,n=0,a=i("../data/ObjId")();return Object.seal({get lat(){return e},set lat(t){e=t},get lng(){return o},set lng(t){o=t},get latLng(){return[e,o]},set latLng(t){e=t[0],o=t[1]},get distance(){return n},set distance(t){n=t},get objId(){return a},get objType(){return r},get object(){return{lat:parseFloat(e.toFixed(6)),lng:parseFloat(o.toFixed(6)),distance:parseFloat(n.toFixed(2)),objId:a,objType:r.object}},set object(t){!function(t){t=r.validate(t),e=t.lat||0,o=t.lng||0,n=t.distance||0,a=i("../data/ObjId")()}(t)}})})}()},{"../data/ObjId":50,"../data/ObjType":51,"./Version":55}],48:[function(l,t,e){!function(){"use strict";var s=l("../data/ObjType")("Maneuver",l("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var e=l("../data/ObjId")(),o="",n="",a=-1,r=0,i=0;return Object.seal({get iconName(){return o},set iconName(t){o=t},get instruction(){return n},set instruction(t){n=t},get itineraryPointObjId(){return a},set itineraryPointObjId(t){a=t},get distance(){return r},set distance(t){r=t},get duration(){return i},set duration(t){i=t},get objId(){return e},get objType(){return s},get object(){return{iconName:o,instruction:n,distance:parseFloat(r.toFixed(2)),duration:i,itineraryPointObjId:a,objId:e,objType:s.object}},set object(t){!function(t){t=s.validate(t),o=t.iconName||"",n=t.instruction||"",r=t.distance||0,i=t.duration||0,a=t.itineraryPointObjId||-1,e=l("../data/ObjId")()}(t)}})})}()},{"../data/ObjId":50,"../data/ObjType":51,"./Version":55}],49:[function(T,t,e){!function(){"use strict";var f=T("../data/ObjType")("Note",T("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var e=T("../data/ObjId")(),o=40,n=40,a="",r="",i="",s="",l="",d="",c=0,u=0,v=0,g=0,p=-1,m=0;return Object.seal({get isRouteNote(){return-1!==p},get iconHeight(){return o},set iconHeight(t){o=t},get iconWidth(){return n},set iconWidth(t){n=t},get iconContent(){return a},set iconContent(t){a=t},get popupContent(){return r},set popupContent(t){r=t},get tooltipContent(){return i},set tooltipContent(t){i=t},get phone(){return s},set phone(t){s=t},get url(){return l},set url(t){l=t},get address(){return d},set address(t){d=t},get iconLat(){return c},set iconLat(t){c=t},get iconLng(){return u},set iconLng(t){u=t},get iconLatLng(){return[c,u]},set iconLatLng(t){c=t[0],u=t[1]},get lat(){return v},set lat(t){v=t},get lng(){return g},set lng(t){g=t},get latLng(){return[v,g]},set latLng(t){v=t[0],g=t[1]},get distance(){return p},set distance(t){p=t},get chainedDistance(){return m},set chainedDistance(t){m=t},get objId(){return e},get objType(){return f},get object(){return{iconHeight:o,iconWidth:n,iconContent:a,popupContent:r,tooltipContent:i,phone:s,url:l,address:d,iconLat:parseFloat(c.toFixed(6)),iconLng:parseFloat(u.toFixed(6)),lat:parseFloat(v.toFixed(6)),lng:parseFloat(g.toFixed(6)),distance:parseFloat(p.toFixed(2)),chainedDistance:parseFloat(m.toFixed(2)),objId:e,objType:f.object}},set object(t){!function(t){t=f.validate(t),o=t.iconHeight||40,n=t.iconWidth||40,a=t.iconContent||"",r=t.popupContent||"",i=t.tooltipContent||"",s=t.phone||"",l=t.url||"",d=t.address||"",c=t.iconLat||0,u=t.iconLng||0,v=t.lat||0,g=t.lng||0,p=t.distance||-1,m=t.chainedDistance,e=T("../data/ObjId")()}(t)}})})}()},{"../data/ObjId":50,"../data/ObjType":51,"./Version":55}],50:[function(t,e,o){(function(t){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){return t.TravelNotesObjId||(t.TravelNotesObjId=0),++t.TravelNotesObjId})}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],51:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(t,e){var o=t,n=e;return Object.seal({get name(){return o},get version(){return n},get object(){return{name:o,version:n}},validate:function(t){return function(t){if(!t.objType)throw"No objType for "+o;if(!t.objType.name)throw"No name for "+o;if(o!==t.objType.name)throw"Invalid name for "+o;if(!t.objType.version)throw"No version for "+o;if(n!==t.objType.version&&("1.0.0"===t.objType.version&&("Route"===t.objType.name&&(t.dashArray=0,t.hidden=!1),t.objType.version="1.1.0"),"1.1.0"===t.objType.version&&(t.objType.version="1.2.0"),"1.2.0"===t.objType.version&&(t.objType.version="1.3.0"),"1.3.0"===t.objType.version&&(t.objType.version="1.4.0"),n!==t.objType.version))throw"invalid version for "+o;if(!t.objId)throw"No objId for "+o;return t}(t)}})})}()},{}],52:[function(t,e,o){arguments[4][5][0].apply(o,arguments)},{"../L.TravelNotes":8,"../data/Collection":43,"../data/Itinerary":46,"../data/ObjId":50,"../data/ObjType":51,"../data/Waypoint":57,"./Itinerary":46,"./Version":55,dup:5}],53:[function(t,e,o){arguments[4][6][0].apply(o,arguments)},{"../data/Collection":43,"../data/ObjId":50,"../data/ObjType":51,"./Version":55,dup:6}],54:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){var e={config:t("../data/Config"),map:null,providers:new Map,mapObjects:new Map,travel:t("../data/Travel")(),editedRoute:null,routeEdition:Object.seal({routeChanged:!1,routeInitialObjId:-1}),routing:Object.seal({provider:"",transitMode:""}),searchData:[],UUID:t("../util/Utilities")().UUID};return Object.seal({get config(){return e.config},set config(t){e.config.overload(t)},get map(){return e.map},set map(t){e.map=t},get providers(){return e.providers},get mapObjects(){return e.mapObjects},get travel(){return e.travel},set travel(t){e.travel=t},get editedRoute(){return e.editedRoute},set editedRoute(t){e.editedRoute=t},get routeEdition(){return e.routeEdition},get routing(){return e.routing},get searchData(){return e.searchData},set searchData(t){e.searchData=t},get UUID(){return e.UUID}})})}()},{"../data/Config":44,"../data/Travel":53,"../util/Utilities":58}],55:[function(t,e,o){arguments[4][7][0].apply(o,arguments)},{dup:7}],56:[function(i,t,e){!function(){"use strict";var r=i("../data/ObjType")("WayPoint",i("./Version"));void 0!==t&&t.exports&&(t.exports=function(){var e="",o=0,n=0,a=i("../data/ObjId")();return Object.seal({get name(){return e},set name(t){e=t},get UIName(){return""!==e?e:0!==o&&0!==n?o.toFixed(6)+(0<o?" N - ":" S - ")+n.toFixed(6)+(0<n?" E":" W"):""},get lat(){return o},set lat(t){o=t},get lng(){return n},set lng(t){n=t},get latLng(){return[o,n]},set latLng(t){o=t[0],n=t[1]},get objId(){return a},get objType(){return r},get object(){return{name:e,lat:parseFloat(o.toFixed(6)),lng:parseFloat(n.toFixed(6)),objId:a,objType:r.object}},set object(t){!function(t){t=r.validate(t),e=t.name||"",o=t.lat||0,n=t.lng||0,a=i("../data/ObjId")()}(t)}})})}()},{"../data/ObjId":50,"../data/ObjType":51,"./Version":55}],57:[function(t,e,o){arguments[4][56][0].apply(o,arguments)},{"../data/ObjId":50,"../data/ObjType":51,"./Version":55,dup:56}],58:[function(t,e,o){!function(){"use strict";var r=t("../UI/Translator")();void 0!==e&&e.exports&&(e.exports=function(){return{get UUID(){return function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}()},storageAvailable:function(t){try{var e=window[t],o="__storage_test__";return e.setItem(o,o),e.removeItem(o),!0}catch(t){return!1}},fileAPIAvailable:function(){try{new File(["testdata"],{type:"text/plain"});return!0}catch(t){return!!window.navigator.msSaveOrOpenBlob}},saveFile:function(t,e,o){if(o=o||"text/plain",window.navigator.msSaveOrOpenBlob)try{window.navigator.msSaveOrOpenBlob(new Blob([e]),t)}catch(t){}else try{var n=window.URL.createObjectURL(new File([e],{type:o})),a=document.createElement("a");a.setAttribute("href",n),a.setAttribute("download",t),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(n)}catch(t){}},formatTime:function(t){if(0===(t=Math.floor(t)))return"";var e=Math.floor(t/86400),o=Math.floor(t%86400/3600),n=Math.floor(t%3600/60),a=Math.floor(t%60);return 0<e?e+"&nbsp;"+r.getText("Utilities - Day")+"&nbsp;"+o+"&nbsp;"+r.getText("Utilities - Hour"):0<o?o+"&nbsp;"+r.getText("Utilities - Hour")+"&nbsp;"+n+"&nbsp;"+r.getText("Utilities - Minute"):0<n?n+"&nbsp;"+r.getText("Utilities - Minute"):a+"&nbsp;"+r.getText("Utilities - Second")},formatDistance:function(t){return 0===(t=Math.floor(t))?"":Math.floor(t/1e3)+","+Math.floor(t%1e3/10).toFixed(0).padStart(2,"0").padEnd(3,"0")+"&nbsp;km"},formatLat:function(t){return 0<t?t.toFixed(6)+"&nbsp;N":(-t).toFixed(6)+"&nbsp;S"},formatLng:function(t){return 0<t?t.toFixed(6)+"&nbsp;E":(-t).toFixed(6)+"&nbsp;W"},formatLatLng:function(t){return this.formatLat(t[0])+"&nbsp;-&nbsp;"+this.formatLng(t[1])}}})}()},{"../UI/Translator":26}]},{},[8]);